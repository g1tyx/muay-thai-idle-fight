(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))s(i);new MutationObserver(i=>{for(const r of i)if(r.type==="childList")for(const o of r.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&s(o)}).observe(document,{childList:!0,subtree:!0});function n(i){const r={};return i.integrity&&(r.integrity=i.integrity),i.referrerPolicy&&(r.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?r.credentials="include":i.crossOrigin==="anonymous"?r.credentials="omit":r.credentials="same-origin",r}function s(i){if(i.ep)return;i.ep=!0;const r=n(i);fetch(i.href,r)}})();/**
* @vue/shared v3.5.13
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**//*! #__NO_SIDE_EFFECTS__ */function uc(t){const e=Object.create(null);for(const n of t.split(","))e[n]=1;return n=>n in e}const Ze={},fi=[],mn=()=>{},Rv=()=>!1,zo=t=>t.charCodeAt(0)===111&&t.charCodeAt(1)===110&&(t.charCodeAt(2)>122||t.charCodeAt(2)<97),dc=t=>t.startsWith("onUpdate:"),kt=Object.assign,hc=(t,e)=>{const n=t.indexOf(e);n>-1&&t.splice(n,1)},Dv=Object.prototype.hasOwnProperty,Ye=(t,e)=>Dv.call(t,e),Ce=Array.isArray,pi=t=>Yo(t)==="[object Map]",vf=t=>Yo(t)==="[object Set]",Ne=t=>typeof t=="function",pt=t=>typeof t=="string",ms=t=>typeof t=="symbol",it=t=>t!==null&&typeof t=="object",yf=t=>(it(t)||Ne(t))&&Ne(t.then)&&Ne(t.catch),_f=Object.prototype.toString,Yo=t=>_f.call(t),Mv=t=>Yo(t).slice(8,-1),Ef=t=>Yo(t)==="[object Object]",fc=t=>pt(t)&&t!=="NaN"&&t[0]!=="-"&&""+parseInt(t,10)===t,Qi=uc(",key,ref,ref_for,ref_key,onVnodeBeforeMount,onVnodeMounted,onVnodeBeforeUpdate,onVnodeUpdated,onVnodeBeforeUnmount,onVnodeUnmounted"),Qo=t=>{const e=Object.create(null);return n=>e[n]||(e[n]=t(n))},Ov=/-(\w)/g,ts=Qo(t=>t.replace(Ov,(e,n)=>n?n.toUpperCase():"")),Nv=/\B([A-Z])/g,vs=Qo(t=>t.replace(Nv,"-$1").toLowerCase()),Tf=Qo(t=>t.charAt(0).toUpperCase()+t.slice(1)),Qa=Qo(t=>t?`on${Tf(t)}`:""),Qn=(t,e)=>!Object.is(t,e),ho=(t,...e)=>{for(let n=0;n<t.length;n++)t[n](...e)},bf=(t,e,n,s=!1)=>{Object.defineProperty(t,e,{configurable:!0,enumerable:!1,writable:s,value:n})},wl=t=>{const e=parseFloat(t);return isNaN(e)?t:e},xv=t=>{const e=pt(t)?Number(t):NaN;return isNaN(e)?t:e};let ud;const Xo=()=>ud||(ud=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:typeof global<"u"?global:{});function qt(t){if(Ce(t)){const e={};for(let n=0;n<t.length;n++){const s=t[n],i=pt(s)?Lv(s):qt(s);if(i)for(const r in i)e[r]=i[r]}return e}else if(pt(t)||it(t))return t}const Vv=/;(?![^(]*\))/g,Fv=/:([^]+)/,$v=/\/\*[^]*?\*\//g;function Lv(t){const e={};return t.replace($v,"").split(Vv).forEach(n=>{if(n){const s=n.split(Fv);s.length>1&&(e[s[0].trim()]=s[1].trim())}}),e}function Oe(t){let e="";if(pt(t))e=t;else if(Ce(t))for(let n=0;n<t.length;n++){const s=Oe(t[n]);s&&(e+=s+" ")}else if(it(t))for(const n in t)t[n]&&(e+=n+" ");return e.trim()}const Bv="itemscope,allowfullscreen,formnovalidate,ismap,nomodule,novalidate,readonly",Uv=uc(Bv);function wf(t){return!!t||t===""}const Af=t=>!!(t&&t.__v_isRef===!0),L=t=>pt(t)?t:t==null?"":Ce(t)||it(t)&&(t.toString===_f||!Ne(t.toString))?Af(t)?L(t.value):JSON.stringify(t,If,2):String(t),If=(t,e)=>Af(e)?If(t,e.value):pi(e)?{[`Map(${e.size})`]:[...e.entries()].reduce((n,[s,i],r)=>(n[Xa(s,r)+" =>"]=i,n),{})}:vf(e)?{[`Set(${e.size})`]:[...e.values()].map(n=>Xa(n))}:ms(e)?Xa(e):it(e)&&!Ce(e)&&!Ef(e)?String(e):e,Xa=(t,e="")=>{var n;return ms(t)?`Symbol(${(n=t.description)!=null?n:e})`:t};/**
* @vue/reactivity v3.5.13
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**/let Lt;class Sf{constructor(e=!1){this.detached=e,this._active=!0,this.effects=[],this.cleanups=[],this._isPaused=!1,this.parent=Lt,!e&&Lt&&(this.index=(Lt.scopes||(Lt.scopes=[])).push(this)-1)}get active(){return this._active}pause(){if(this._active){this._isPaused=!0;let e,n;if(this.scopes)for(e=0,n=this.scopes.length;e<n;e++)this.scopes[e].pause();for(e=0,n=this.effects.length;e<n;e++)this.effects[e].pause()}}resume(){if(this._active&&this._isPaused){this._isPaused=!1;let e,n;if(this.scopes)for(e=0,n=this.scopes.length;e<n;e++)this.scopes[e].resume();for(e=0,n=this.effects.length;e<n;e++)this.effects[e].resume()}}run(e){if(this._active){const n=Lt;try{return Lt=this,e()}finally{Lt=n}}}on(){Lt=this}off(){Lt=this.parent}stop(e){if(this._active){this._active=!1;let n,s;for(n=0,s=this.effects.length;n<s;n++)this.effects[n].stop();for(this.effects.length=0,n=0,s=this.cleanups.length;n<s;n++)this.cleanups[n]();if(this.cleanups.length=0,this.scopes){for(n=0,s=this.scopes.length;n<s;n++)this.scopes[n].stop(!0);this.scopes.length=0}if(!this.detached&&this.parent&&!e){const i=this.parent.scopes.pop();i&&i!==this&&(this.parent.scopes[this.index]=i,i.index=this.index)}this.parent=void 0}}}function Cf(t){return new Sf(t)}function kf(){return Lt}function Hv(t,e=!1){Lt&&Lt.cleanups.push(t)}let tt;const Ja=new WeakSet;class Pf{constructor(e){this.fn=e,this.deps=void 0,this.depsTail=void 0,this.flags=5,this.next=void 0,this.cleanup=void 0,this.scheduler=void 0,Lt&&Lt.active&&Lt.effects.push(this)}pause(){this.flags|=64}resume(){this.flags&64&&(this.flags&=-65,Ja.has(this)&&(Ja.delete(this),this.trigger()))}notify(){this.flags&2&&!(this.flags&32)||this.flags&8||Df(this)}run(){if(!(this.flags&1))return this.fn();this.flags|=2,dd(this),Mf(this);const e=tt,n=cn;tt=this,cn=!0;try{return this.fn()}finally{Of(this),tt=e,cn=n,this.flags&=-3}}stop(){if(this.flags&1){for(let e=this.deps;e;e=e.nextDep)mc(e);this.deps=this.depsTail=void 0,dd(this),this.onStop&&this.onStop(),this.flags&=-2}}trigger(){this.flags&64?Ja.add(this):this.scheduler?this.scheduler():this.runIfDirty()}runIfDirty(){Al(this)&&this.run()}get dirty(){return Al(this)}}let Rf=0,Xi,Ji;function Df(t,e=!1){if(t.flags|=8,e){t.next=Ji,Ji=t;return}t.next=Xi,Xi=t}function pc(){Rf++}function gc(){if(--Rf>0)return;if(Ji){let e=Ji;for(Ji=void 0;e;){const n=e.next;e.next=void 0,e.flags&=-9,e=n}}let t;for(;Xi;){let e=Xi;for(Xi=void 0;e;){const n=e.next;if(e.next=void 0,e.flags&=-9,e.flags&1)try{e.trigger()}catch(s){t||(t=s)}e=n}}if(t)throw t}function Mf(t){for(let e=t.deps;e;e=e.nextDep)e.version=-1,e.prevActiveLink=e.dep.activeLink,e.dep.activeLink=e}function Of(t){let e,n=t.depsTail,s=n;for(;s;){const i=s.prevDep;s.version===-1?(s===n&&(n=i),mc(s),jv(s)):e=s,s.dep.activeLink=s.prevActiveLink,s.prevActiveLink=void 0,s=i}t.deps=e,t.depsTail=n}function Al(t){for(let e=t.deps;e;e=e.nextDep)if(e.dep.version!==e.version||e.dep.computed&&(Nf(e.dep.computed)||e.dep.version!==e.version))return!0;return!!t._dirty}function Nf(t){if(t.flags&4&&!(t.flags&16)||(t.flags&=-17,t.globalVersion===hr))return;t.globalVersion=hr;const e=t.dep;if(t.flags|=2,e.version>0&&!t.isSSR&&t.deps&&!Al(t)){t.flags&=-3;return}const n=tt,s=cn;tt=t,cn=!0;try{Mf(t);const i=t.fn(t._value);(e.version===0||Qn(i,t._value))&&(t._value=i,e.version++)}catch(i){throw e.version++,i}finally{tt=n,cn=s,Of(t),t.flags&=-3}}function mc(t,e=!1){const{dep:n,prevSub:s,nextSub:i}=t;if(s&&(s.nextSub=i,t.prevSub=void 0),i&&(i.prevSub=s,t.nextSub=void 0),n.subs===t&&(n.subs=s,!s&&n.computed)){n.computed.flags&=-5;for(let r=n.computed.deps;r;r=r.nextDep)mc(r,!0)}!e&&!--n.sc&&n.map&&n.map.delete(n.key)}function jv(t){const{prevDep:e,nextDep:n}=t;e&&(e.nextDep=n,t.prevDep=void 0),n&&(n.prevDep=e,t.nextDep=void 0)}let cn=!0;const xf=[];function ys(){xf.push(cn),cn=!1}function _s(){const t=xf.pop();cn=t===void 0?!0:t}function dd(t){const{cleanup:e}=t;if(t.cleanup=void 0,e){const n=tt;tt=void 0;try{e()}finally{tt=n}}}let hr=0;class Kv{constructor(e,n){this.sub=e,this.dep=n,this.version=n.version,this.nextDep=this.prevDep=this.nextSub=this.prevSub=this.prevActiveLink=void 0}}class vc{constructor(e){this.computed=e,this.version=0,this.activeLink=void 0,this.subs=void 0,this.map=void 0,this.key=void 0,this.sc=0}track(e){if(!tt||!cn||tt===this.computed)return;let n=this.activeLink;if(n===void 0||n.sub!==tt)n=this.activeLink=new Kv(tt,this),tt.deps?(n.prevDep=tt.depsTail,tt.depsTail.nextDep=n,tt.depsTail=n):tt.deps=tt.depsTail=n,Vf(n);else if(n.version===-1&&(n.version=this.version,n.nextDep)){const s=n.nextDep;s.prevDep=n.prevDep,n.prevDep&&(n.prevDep.nextDep=s),n.prevDep=tt.depsTail,n.nextDep=void 0,tt.depsTail.nextDep=n,tt.depsTail=n,tt.deps===n&&(tt.deps=s)}return n}trigger(e){this.version++,hr++,this.notify(e)}notify(e){pc();try{for(let n=this.subs;n;n=n.prevSub)n.sub.notify()&&n.sub.dep.notify()}finally{gc()}}}function Vf(t){if(t.dep.sc++,t.sub.flags&4){const e=t.dep.computed;if(e&&!t.dep.subs){e.flags|=20;for(let s=e.deps;s;s=s.nextDep)Vf(s)}const n=t.dep.subs;n!==t&&(t.prevSub=n,n&&(n.nextSub=t)),t.dep.subs=t}}const bo=new WeakMap,Vs=Symbol(""),Il=Symbol(""),fr=Symbol("");function Ot(t,e,n){if(cn&&tt){let s=bo.get(t);s||bo.set(t,s=new Map);let i=s.get(n);i||(s.set(n,i=new vc),i.map=s,i.key=n),i.track()}}function Pn(t,e,n,s,i,r){const o=bo.get(t);if(!o){hr++;return}const l=c=>{c&&c.trigger()};if(pc(),e==="clear")o.forEach(l);else{const c=Ce(t),u=c&&fc(n);if(c&&n==="length"){const h=Number(s);o.forEach((f,m)=>{(m==="length"||m===fr||!ms(m)&&m>=h)&&l(f)})}else switch((n!==void 0||o.has(void 0))&&l(o.get(n)),u&&l(o.get(fr)),e){case"add":c?u&&l(o.get("length")):(l(o.get(Vs)),pi(t)&&l(o.get(Il)));break;case"delete":c||(l(o.get(Vs)),pi(t)&&l(o.get(Il)));break;case"set":pi(t)&&l(o.get(Vs));break}}gc()}function qv(t,e){const n=bo.get(t);return n&&n.get(e)}function ii(t){const e=qe(t);return e===t?e:(Ot(e,"iterate",fr),rn(t)?e:e.map(Nt))}function Jo(t){return Ot(t=qe(t),"iterate",fr),t}const Gv={__proto__:null,[Symbol.iterator](){return Za(this,Symbol.iterator,Nt)},concat(...t){return ii(this).concat(...t.map(e=>Ce(e)?ii(e):e))},entries(){return Za(this,"entries",t=>(t[1]=Nt(t[1]),t))},every(t,e){return An(this,"every",t,e,void 0,arguments)},filter(t,e){return An(this,"filter",t,e,n=>n.map(Nt),arguments)},find(t,e){return An(this,"find",t,e,Nt,arguments)},findIndex(t,e){return An(this,"findIndex",t,e,void 0,arguments)},findLast(t,e){return An(this,"findLast",t,e,Nt,arguments)},findLastIndex(t,e){return An(this,"findLastIndex",t,e,void 0,arguments)},forEach(t,e){return An(this,"forEach",t,e,void 0,arguments)},includes(...t){return el(this,"includes",t)},indexOf(...t){return el(this,"indexOf",t)},join(t){return ii(this).join(t)},lastIndexOf(...t){return el(this,"lastIndexOf",t)},map(t,e){return An(this,"map",t,e,void 0,arguments)},pop(){return Ki(this,"pop")},push(...t){return Ki(this,"push",t)},reduce(t,...e){return hd(this,"reduce",t,e)},reduceRight(t,...e){return hd(this,"reduceRight",t,e)},shift(){return Ki(this,"shift")},some(t,e){return An(this,"some",t,e,void 0,arguments)},splice(...t){return Ki(this,"splice",t)},toReversed(){return ii(this).toReversed()},toSorted(t){return ii(this).toSorted(t)},toSpliced(...t){return ii(this).toSpliced(...t)},unshift(...t){return Ki(this,"unshift",t)},values(){return Za(this,"values",Nt)}};function Za(t,e,n){const s=Jo(t),i=s[e]();return s!==t&&!rn(t)&&(i._next=i.next,i.next=()=>{const r=i._next();return r.value&&(r.value=n(r.value)),r}),i}const Wv=Array.prototype;function An(t,e,n,s,i,r){const o=Jo(t),l=o!==t&&!rn(t),c=o[e];if(c!==Wv[e]){const f=c.apply(t,r);return l?Nt(f):f}let u=n;o!==t&&(l?u=function(f,m){return n.call(this,Nt(f),m,t)}:n.length>2&&(u=function(f,m){return n.call(this,f,m,t)}));const h=c.call(o,u,s);return l&&i?i(h):h}function hd(t,e,n,s){const i=Jo(t);let r=n;return i!==t&&(rn(t)?n.length>3&&(r=function(o,l,c){return n.call(this,o,l,c,t)}):r=function(o,l,c){return n.call(this,o,Nt(l),c,t)}),i[e](r,...s)}function el(t,e,n){const s=qe(t);Ot(s,"iterate",fr);const i=s[e](...n);return(i===-1||i===!1)&&Ec(n[0])?(n[0]=qe(n[0]),s[e](...n)):i}function Ki(t,e,n=[]){ys(),pc();const s=qe(t)[e].apply(t,n);return gc(),_s(),s}const zv=uc("__proto__,__v_isRef,__isVue"),Ff=new Set(Object.getOwnPropertyNames(Symbol).filter(t=>t!=="arguments"&&t!=="caller").map(t=>Symbol[t]).filter(ms));function Yv(t){ms(t)||(t=String(t));const e=qe(this);return Ot(e,"has",t),e.hasOwnProperty(t)}class $f{constructor(e=!1,n=!1){this._isReadonly=e,this._isShallow=n}get(e,n,s){if(n==="__v_skip")return e.__v_skip;const i=this._isReadonly,r=this._isShallow;if(n==="__v_isReactive")return!i;if(n==="__v_isReadonly")return i;if(n==="__v_isShallow")return r;if(n==="__v_raw")return s===(i?r?ry:Hf:r?Uf:Bf).get(e)||Object.getPrototypeOf(e)===Object.getPrototypeOf(s)?e:void 0;const o=Ce(e);if(!i){let c;if(o&&(c=Gv[n]))return c;if(n==="hasOwnProperty")return Yv}const l=Reflect.get(e,n,ht(e)?e:s);return(ms(n)?Ff.has(n):zv(n))||(i||Ot(e,"get",n),r)?l:ht(l)?o&&fc(n)?l:l.value:it(l)?i?jf(l):vi(l):l}}class Lf extends $f{constructor(e=!1){super(!1,e)}set(e,n,s,i){let r=e[n];if(!this._isShallow){const c=Ls(r);if(!rn(s)&&!Ls(s)&&(r=qe(r),s=qe(s)),!Ce(e)&&ht(r)&&!ht(s))return c?!1:(r.value=s,!0)}const o=Ce(e)&&fc(n)?Number(n)<e.length:Ye(e,n),l=Reflect.set(e,n,s,ht(e)?e:i);return e===qe(i)&&(o?Qn(s,r)&&Pn(e,"set",n,s):Pn(e,"add",n,s)),l}deleteProperty(e,n){const s=Ye(e,n);e[n];const i=Reflect.deleteProperty(e,n);return i&&s&&Pn(e,"delete",n,void 0),i}has(e,n){const s=Reflect.has(e,n);return(!ms(n)||!Ff.has(n))&&Ot(e,"has",n),s}ownKeys(e){return Ot(e,"iterate",Ce(e)?"length":Vs),Reflect.ownKeys(e)}}class Qv extends $f{constructor(e=!1){super(!0,e)}set(e,n){return!0}deleteProperty(e,n){return!0}}const Xv=new Lf,Jv=new Qv,Zv=new Lf(!0);const Sl=t=>t,to=t=>Reflect.getPrototypeOf(t);function ey(t,e,n){return function(...s){const i=this.__v_raw,r=qe(i),o=pi(r),l=t==="entries"||t===Symbol.iterator&&o,c=t==="keys"&&o,u=i[t](...s),h=n?Sl:e?Cl:Nt;return!e&&Ot(r,"iterate",c?Il:Vs),{next(){const{value:f,done:m}=u.next();return m?{value:f,done:m}:{value:l?[h(f[0]),h(f[1])]:h(f),done:m}},[Symbol.iterator](){return this}}}}function no(t){return function(...e){return t==="delete"?!1:t==="clear"?void 0:this}}function ty(t,e){const n={get(i){const r=this.__v_raw,o=qe(r),l=qe(i);t||(Qn(i,l)&&Ot(o,"get",i),Ot(o,"get",l));const{has:c}=to(o),u=e?Sl:t?Cl:Nt;if(c.call(o,i))return u(r.get(i));if(c.call(o,l))return u(r.get(l));r!==o&&r.get(i)},get size(){const i=this.__v_raw;return!t&&Ot(qe(i),"iterate",Vs),Reflect.get(i,"size",i)},has(i){const r=this.__v_raw,o=qe(r),l=qe(i);return t||(Qn(i,l)&&Ot(o,"has",i),Ot(o,"has",l)),i===l?r.has(i):r.has(i)||r.has(l)},forEach(i,r){const o=this,l=o.__v_raw,c=qe(l),u=e?Sl:t?Cl:Nt;return!t&&Ot(c,"iterate",Vs),l.forEach((h,f)=>i.call(r,u(h),u(f),o))}};return kt(n,t?{add:no("add"),set:no("set"),delete:no("delete"),clear:no("clear")}:{add(i){!e&&!rn(i)&&!Ls(i)&&(i=qe(i));const r=qe(this);return to(r).has.call(r,i)||(r.add(i),Pn(r,"add",i,i)),this},set(i,r){!e&&!rn(r)&&!Ls(r)&&(r=qe(r));const o=qe(this),{has:l,get:c}=to(o);let u=l.call(o,i);u||(i=qe(i),u=l.call(o,i));const h=c.call(o,i);return o.set(i,r),u?Qn(r,h)&&Pn(o,"set",i,r):Pn(o,"add",i,r),this},delete(i){const r=qe(this),{has:o,get:l}=to(r);let c=o.call(r,i);c||(i=qe(i),c=o.call(r,i)),l&&l.call(r,i);const u=r.delete(i);return c&&Pn(r,"delete",i,void 0),u},clear(){const i=qe(this),r=i.size!==0,o=i.clear();return r&&Pn(i,"clear",void 0,void 0),o}}),["keys","values","entries",Symbol.iterator].forEach(i=>{n[i]=ey(i,t,e)}),n}function yc(t,e){const n=ty(t,e);return(s,i,r)=>i==="__v_isReactive"?!t:i==="__v_isReadonly"?t:i==="__v_raw"?s:Reflect.get(Ye(n,i)&&i in s?n:s,i,r)}const ny={get:yc(!1,!1)},sy={get:yc(!1,!0)},iy={get:yc(!0,!1)};const Bf=new WeakMap,Uf=new WeakMap,Hf=new WeakMap,ry=new WeakMap;function oy(t){switch(t){case"Object":case"Array":return 1;case"Map":case"Set":case"WeakMap":case"WeakSet":return 2;default:return 0}}function ay(t){return t.__v_skip||!Object.isExtensible(t)?0:oy(Mv(t))}function vi(t){return Ls(t)?t:_c(t,!1,Xv,ny,Bf)}function ly(t){return _c(t,!1,Zv,sy,Uf)}function jf(t){return _c(t,!0,Jv,iy,Hf)}function _c(t,e,n,s,i){if(!it(t)||t.__v_raw&&!(e&&t.__v_isReactive))return t;const r=i.get(t);if(r)return r;const o=ay(t);if(o===0)return t;const l=new Proxy(t,o===2?s:n);return i.set(t,l),l}function Xn(t){return Ls(t)?Xn(t.__v_raw):!!(t&&t.__v_isReactive)}function Ls(t){return!!(t&&t.__v_isReadonly)}function rn(t){return!!(t&&t.__v_isShallow)}function Ec(t){return t?!!t.__v_raw:!1}function qe(t){const e=t&&t.__v_raw;return e?qe(e):t}function Tc(t){return!Ye(t,"__v_skip")&&Object.isExtensible(t)&&bf(t,"__v_skip",!0),t}const Nt=t=>it(t)?vi(t):t,Cl=t=>it(t)?jf(t):t;function ht(t){return t?t.__v_isRef===!0:!1}function ue(t){return cy(t,!1)}function cy(t,e){return ht(t)?t:new uy(t,e)}class uy{constructor(e,n){this.dep=new vc,this.__v_isRef=!0,this.__v_isShallow=!1,this._rawValue=n?e:qe(e),this._value=n?e:Nt(e),this.__v_isShallow=n}get value(){return this.dep.track(),this._value}set value(e){const n=this._rawValue,s=this.__v_isShallow||rn(e)||Ls(e);e=s?e:qe(e),Qn(e,n)&&(this._rawValue=e,this._value=s?e:Nt(e),this.dep.trigger())}}function ee(t){return ht(t)?t.value:t}const dy={get:(t,e,n)=>e==="__v_raw"?t:ee(Reflect.get(t,e,n)),set:(t,e,n,s)=>{const i=t[e];return ht(i)&&!ht(n)?(i.value=n,!0):Reflect.set(t,e,n,s)}};function Kf(t){return Xn(t)?t:new Proxy(t,dy)}function hy(t){const e=Ce(t)?new Array(t.length):{};for(const n in t)e[n]=py(t,n);return e}class fy{constructor(e,n,s){this._object=e,this._key=n,this._defaultValue=s,this.__v_isRef=!0,this._value=void 0}get value(){const e=this._object[this._key];return this._value=e===void 0?this._defaultValue:e}set value(e){this._object[this._key]=e}get dep(){return qv(qe(this._object),this._key)}}function py(t,e,n){const s=t[e];return ht(s)?s:new fy(t,e,n)}class gy{constructor(e,n,s){this.fn=e,this.setter=n,this._value=void 0,this.dep=new vc(this),this.__v_isRef=!0,this.deps=void 0,this.depsTail=void 0,this.flags=16,this.globalVersion=hr-1,this.next=void 0,this.effect=this,this.__v_isReadonly=!n,this.isSSR=s}notify(){if(this.flags|=16,!(this.flags&8)&&tt!==this)return Df(this,!0),!0}get value(){const e=this.dep.track();return Nf(this),e&&(e.version=this.dep.version),this._value}set value(e){this.setter&&this.setter(e)}}function my(t,e,n=!1){let s,i;return Ne(t)?s=t:(s=t.get,i=t.set),new gy(s,i,n)}const so={},wo=new WeakMap;let Rs;function vy(t,e=!1,n=Rs){if(n){let s=wo.get(n);s||wo.set(n,s=[]),s.push(t)}}function yy(t,e,n=Ze){const{immediate:s,deep:i,once:r,scheduler:o,augmentJob:l,call:c}=n,u=R=>i?R:rn(R)||i===!1||i===0?Rn(R,1):Rn(R);let h,f,m,y,C=!1,D=!1;if(ht(t)?(f=()=>t.value,C=rn(t)):Xn(t)?(f=()=>u(t),C=!0):Ce(t)?(D=!0,C=t.some(R=>Xn(R)||rn(R)),f=()=>t.map(R=>{if(ht(R))return R.value;if(Xn(R))return u(R);if(Ne(R))return c?c(R,2):R()})):Ne(t)?e?f=c?()=>c(t,2):t:f=()=>{if(m){ys();try{m()}finally{_s()}}const R=Rs;Rs=h;try{return c?c(t,3,[y]):t(y)}finally{Rs=R}}:f=mn,e&&i){const R=f,H=i===!0?1/0:i;f=()=>Rn(R(),H)}const S=kf(),M=()=>{h.stop(),S&&S.active&&hc(S.effects,h)};if(r&&e){const R=e;e=(...H)=>{R(...H),M()}}let P=D?new Array(t.length).fill(so):so;const V=R=>{if(!(!(h.flags&1)||!h.dirty&&!R))if(e){const H=h.run();if(i||C||(D?H.some((O,I)=>Qn(O,P[I])):Qn(H,P))){m&&m();const O=Rs;Rs=h;try{const I=[H,P===so?void 0:D&&P[0]===so?[]:P,y];c?c(e,3,I):e(...I),P=H}finally{Rs=O}}}else h.run()};return l&&l(V),h=new Pf(f),h.scheduler=o?()=>o(V,!1):V,y=R=>vy(R,!1,h),m=h.onStop=()=>{const R=wo.get(h);if(R){if(c)c(R,4);else for(const H of R)H();wo.delete(h)}},e?s?V(!0):P=h.run():o?o(V.bind(null,!0),!0):h.run(),M.pause=h.pause.bind(h),M.resume=h.resume.bind(h),M.stop=M,M}function Rn(t,e=1/0,n){if(e<=0||!it(t)||t.__v_skip||(n=n||new Set,n.has(t)))return t;if(n.add(t),e--,ht(t))Rn(t.value,e,n);else if(Ce(t))for(let s=0;s<t.length;s++)Rn(t[s],e,n);else if(vf(t)||pi(t))t.forEach(s=>{Rn(s,e,n)});else if(Ef(t)){for(const s in t)Rn(t[s],e,n);for(const s of Object.getOwnPropertySymbols(t))Object.prototype.propertyIsEnumerable.call(t,s)&&Rn(t[s],e,n)}return t}/**
* @vue/runtime-core v3.5.13
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**/function kr(t,e,n,s){try{return s?t(...s):t()}catch(i){Zo(i,e,n)}}function un(t,e,n,s){if(Ne(t)){const i=kr(t,e,n,s);return i&&yf(i)&&i.catch(r=>{Zo(r,e,n)}),i}if(Ce(t)){const i=[];for(let r=0;r<t.length;r++)i.push(un(t[r],e,n,s));return i}}function Zo(t,e,n,s=!0){const i=e?e.vnode:null,{errorHandler:r,throwUnhandledErrorInProduction:o}=e&&e.appContext.config||Ze;if(e){let l=e.parent;const c=e.proxy,u=`https://vuejs.org/error-reference/#runtime-${n}`;for(;l;){const h=l.ec;if(h){for(let f=0;f<h.length;f++)if(h[f](t,c,u)===!1)return}l=l.parent}if(r){ys(),kr(r,null,10,[t,c,u]),_s();return}}_y(t,n,i,s,o)}function _y(t,e,n,s=!0,i=!1){if(i)throw t;console.error(t)}const Bt=[];let fn=-1;const gi=[];let Gn=null,oi=0;const qf=Promise.resolve();let Ao=null;function bc(t){const e=Ao||qf;return t?e.then(this?t.bind(this):t):e}function Ey(t){let e=fn+1,n=Bt.length;for(;e<n;){const s=e+n>>>1,i=Bt[s],r=pr(i);r<t||r===t&&i.flags&2?e=s+1:n=s}return e}function wc(t){if(!(t.flags&1)){const e=pr(t),n=Bt[Bt.length-1];!n||!(t.flags&2)&&e>=pr(n)?Bt.push(t):Bt.splice(Ey(e),0,t),t.flags|=1,Gf()}}function Gf(){Ao||(Ao=qf.then(zf))}function Ty(t){Ce(t)?gi.push(...t):Gn&&t.id===-1?Gn.splice(oi+1,0,t):t.flags&1||(gi.push(t),t.flags|=1),Gf()}function fd(t,e,n=fn+1){for(;n<Bt.length;n++){const s=Bt[n];if(s&&s.flags&2){if(t&&s.id!==t.uid)continue;Bt.splice(n,1),n--,s.flags&4&&(s.flags&=-2),s(),s.flags&4||(s.flags&=-2)}}}function Wf(t){if(gi.length){const e=[...new Set(gi)].sort((n,s)=>pr(n)-pr(s));if(gi.length=0,Gn){Gn.push(...e);return}for(Gn=e,oi=0;oi<Gn.length;oi++){const n=Gn[oi];n.flags&4&&(n.flags&=-2),n.flags&8||n(),n.flags&=-2}Gn=null,oi=0}}const pr=t=>t.id==null?t.flags&2?-1:1/0:t.id;function zf(t){try{for(fn=0;fn<Bt.length;fn++){const e=Bt[fn];e&&!(e.flags&8)&&(e.flags&4&&(e.flags&=-2),kr(e,e.i,e.i?15:14),e.flags&4||(e.flags&=-2))}}finally{for(;fn<Bt.length;fn++){const e=Bt[fn];e&&(e.flags&=-2)}fn=-1,Bt.length=0,Wf(),Ao=null,(Bt.length||gi.length)&&zf()}}let Kt=null,Yf=null;function Io(t){const e=Kt;return Kt=t,Yf=t&&t.type.__scopeId||null,e}function Qf(t,e=Kt,n){if(!e||t._n)return t;const s=(...i)=>{s._d&&wd(-1);const r=Io(e);let o;try{o=t(...i)}finally{Io(r),s._d&&wd(1)}return o};return s._n=!0,s._c=!0,s._d=!0,s}function by(t,e){if(Kt===null)return t;const n=ia(Kt),s=t.dirs||(t.dirs=[]);for(let i=0;i<e.length;i++){let[r,o,l,c=Ze]=e[i];r&&(Ne(r)&&(r={mounted:r,updated:r}),r.deep&&Rn(o),s.push({dir:r,instance:n,value:o,oldValue:void 0,arg:l,modifiers:c}))}return t}function Ss(t,e,n,s){const i=t.dirs,r=e&&e.dirs;for(let o=0;o<i.length;o++){const l=i[o];r&&(l.oldValue=r[o].value);let c=l.dir[s];c&&(ys(),un(c,n,8,[t.el,l,t,e]),_s())}}const wy=Symbol("_vte"),Xf=t=>t.__isTeleport,Wn=Symbol("_leaveCb"),io=Symbol("_enterCb");function Ay(){const t={isMounted:!1,isLeaving:!1,isUnmounting:!1,leavingVNodes:new Map};return Wt(()=>{t.isMounted=!0}),Fs(()=>{t.isUnmounting=!0}),t}const tn=[Function,Array],Jf={mode:String,appear:Boolean,persisted:Boolean,onBeforeEnter:tn,onEnter:tn,onAfterEnter:tn,onEnterCancelled:tn,onBeforeLeave:tn,onLeave:tn,onAfterLeave:tn,onLeaveCancelled:tn,onBeforeAppear:tn,onAppear:tn,onAfterAppear:tn,onAppearCancelled:tn},Zf=t=>{const e=t.subTree;return e.component?Zf(e.component):e},Iy={name:"BaseTransition",props:Jf,setup(t,{slots:e}){const n=T_(),s=Ay();return()=>{const i=e.default&&np(e.default(),!0);if(!i||!i.length)return;const r=ep(i),o=qe(t),{mode:l}=o;if(s.isLeaving)return tl(r);const c=pd(r);if(!c)return tl(r);let u=kl(c,o,s,n,f=>u=f);c.type!==jt&&gr(c,u);let h=n.subTree&&pd(n.subTree);if(h&&h.type!==jt&&!Ms(c,h)&&Zf(n).type!==jt){let f=kl(h,o,s,n);if(gr(h,f),l==="out-in"&&c.type!==jt)return s.isLeaving=!0,f.afterLeave=()=>{s.isLeaving=!1,n.job.flags&8||n.update(),delete f.afterLeave,h=void 0},tl(r);l==="in-out"&&c.type!==jt?f.delayLeave=(m,y,C)=>{const D=tp(s,h);D[String(h.key)]=h,m[Wn]=()=>{y(),m[Wn]=void 0,delete u.delayedLeave,h=void 0},u.delayedLeave=()=>{C(),delete u.delayedLeave,h=void 0}}:h=void 0}else h&&(h=void 0);return r}}};function ep(t){let e=t[0];if(t.length>1){for(const n of t)if(n.type!==jt){e=n;break}}return e}const Sy=Iy;function tp(t,e){const{leavingVNodes:n}=t;let s=n.get(e.type);return s||(s=Object.create(null),n.set(e.type,s)),s}function kl(t,e,n,s,i){const{appear:r,mode:o,persisted:l=!1,onBeforeEnter:c,onEnter:u,onAfterEnter:h,onEnterCancelled:f,onBeforeLeave:m,onLeave:y,onAfterLeave:C,onLeaveCancelled:D,onBeforeAppear:S,onAppear:M,onAfterAppear:P,onAppearCancelled:V}=e,R=String(t.key),H=tp(n,t),O=(v,_)=>{v&&un(v,s,9,_)},I=(v,_)=>{const T=_[1];O(v,_),Ce(v)?v.every(b=>b.length<=1)&&T():v.length<=1&&T()},E={mode:o,persisted:l,beforeEnter(v){let _=c;if(!n.isMounted)if(r)_=S||c;else return;v[Wn]&&v[Wn](!0);const T=H[R];T&&Ms(t,T)&&T.el[Wn]&&T.el[Wn](),O(_,[v])},enter(v){let _=u,T=h,b=f;if(!n.isMounted)if(r)_=M||u,T=P||h,b=V||f;else return;let A=!1;const de=v[io]=W=>{A||(A=!0,W?O(b,[v]):O(T,[v]),E.delayedLeave&&E.delayedLeave(),v[io]=void 0)};_?I(_,[v,de]):de()},leave(v,_){const T=String(t.key);if(v[io]&&v[io](!0),n.isUnmounting)return _();O(m,[v]);let b=!1;const A=v[Wn]=de=>{b||(b=!0,_(),de?O(D,[v]):O(C,[v]),v[Wn]=void 0,H[T]===t&&delete H[T])};H[T]=t,y?I(y,[v,A]):A()},clone(v){const _=kl(v,e,n,s,i);return i&&i(_),_}};return E}function tl(t){if(ea(t))return t=is(t),t.children=null,t}function pd(t){if(!ea(t))return Xf(t.type)&&t.children?ep(t.children):t;const{shapeFlag:e,children:n}=t;if(n){if(e&16)return n[0];if(e&32&&Ne(n.default))return n.default()}}function gr(t,e){t.shapeFlag&6&&t.component?(t.transition=e,gr(t.component.subTree,e)):t.shapeFlag&128?(t.ssContent.transition=e.clone(t.ssContent),t.ssFallback.transition=e.clone(t.ssFallback)):t.transition=e}function np(t,e=!1,n){let s=[],i=0;for(let r=0;r<t.length;r++){let o=t[r];const l=n==null?o.key:String(n)+String(o.key!=null?o.key:r);o.type===mt?(o.patchFlag&128&&i++,s=s.concat(np(o.children,e,l))):(e||o.type!==jt)&&s.push(l!=null?is(o,{key:l}):o)}if(i>1)for(let r=0;r<s.length;r++)s[r].patchFlag=-2;return s}function sp(t){t.ids=[t.ids[0]+t.ids[2]+++"-",0,0]}function So(t,e,n,s,i=!1){if(Ce(t)){t.forEach((C,D)=>So(C,e&&(Ce(e)?e[D]:e),n,s,i));return}if(Zi(s)&&!i){s.shapeFlag&512&&s.type.__asyncResolved&&s.component.subTree.component&&So(t,e,n,s.component.subTree);return}const r=s.shapeFlag&4?ia(s.component):s.el,o=i?null:r,{i:l,r:c}=t,u=e&&e.r,h=l.refs===Ze?l.refs={}:l.refs,f=l.setupState,m=qe(f),y=f===Ze?()=>!1:C=>Ye(m,C);if(u!=null&&u!==c&&(pt(u)?(h[u]=null,y(u)&&(f[u]=null)):ht(u)&&(u.value=null)),Ne(c))kr(c,l,12,[o,h]);else{const C=pt(c),D=ht(c);if(C||D){const S=()=>{if(t.f){const M=C?y(c)?f[c]:h[c]:c.value;i?Ce(M)&&hc(M,r):Ce(M)?M.includes(r)||M.push(r):C?(h[c]=[r],y(c)&&(f[c]=h[c])):(c.value=[r],t.k&&(h[t.k]=c.value))}else C?(h[c]=o,y(c)&&(f[c]=o)):D&&(c.value=o,t.k&&(h[t.k]=o))};o?(S.id=-1,Yt(S,n)):S()}}}Xo().requestIdleCallback;Xo().cancelIdleCallback;const Zi=t=>!!t.type.__asyncLoader,ea=t=>t.type.__isKeepAlive;function Cy(t,e){ip(t,"a",e)}function ky(t,e){ip(t,"da",e)}function ip(t,e,n=Ct){const s=t.__wdc||(t.__wdc=()=>{let i=n;for(;i;){if(i.isDeactivated)return;i=i.parent}return t()});if(ta(e,s,n),n){let i=n.parent;for(;i&&i.parent;)ea(i.parent.vnode)&&Py(s,e,n,i),i=i.parent}}function Py(t,e,n,s){const i=ta(e,t,s,!0);Pr(()=>{hc(s[e],i)},n)}function ta(t,e,n=Ct,s=!1){if(n){const i=n[t]||(n[t]=[]),r=e.__weh||(e.__weh=(...o)=>{ys();const l=Rr(n),c=un(e,n,t,o);return l(),_s(),c});return s?i.unshift(r):i.push(r),r}}const Ln=t=>(e,n=Ct)=>{(!vr||t==="sp")&&ta(t,(...s)=>e(...s),n)},Ry=Ln("bm"),Wt=Ln("m"),Dy=Ln("bu"),My=Ln("u"),Fs=Ln("bum"),Pr=Ln("um"),Oy=Ln("sp"),Ny=Ln("rtg"),xy=Ln("rtc");function Vy(t,e=Ct){ta("ec",t,e)}const Fy=Symbol.for("v-ndc");function ns(t,e,n,s){let i;const r=n,o=Ce(t);if(o||pt(t)){const l=o&&Xn(t);let c=!1;l&&(c=!rn(t),t=Jo(t)),i=new Array(t.length);for(let u=0,h=t.length;u<h;u++)i[u]=e(c?Nt(t[u]):t[u],u,void 0,r)}else if(typeof t=="number"){i=new Array(t);for(let l=0;l<t;l++)i[l]=e(l+1,l,void 0,r)}else if(it(t))if(t[Symbol.iterator])i=Array.from(t,(l,c)=>e(l,c,void 0,r));else{const l=Object.keys(t);i=new Array(l.length);for(let c=0,u=l.length;c<u;c++){const h=l[c];i[c]=e(t[h],h,c,r)}}else i=[];return i}const Pl=t=>t?Ip(t)?ia(t):Pl(t.parent):null,er=kt(Object.create(null),{$:t=>t,$el:t=>t.vnode.el,$data:t=>t.data,$props:t=>t.props,$attrs:t=>t.attrs,$slots:t=>t.slots,$refs:t=>t.refs,$parent:t=>Pl(t.parent),$root:t=>Pl(t.root),$host:t=>t.ce,$emit:t=>t.emit,$options:t=>op(t),$forceUpdate:t=>t.f||(t.f=()=>{wc(t.update)}),$nextTick:t=>t.n||(t.n=bc.bind(t.proxy)),$watch:t=>o_.bind(t)}),nl=(t,e)=>t!==Ze&&!t.__isScriptSetup&&Ye(t,e),$y={get({_:t},e){if(e==="__v_skip")return!0;const{ctx:n,setupState:s,data:i,props:r,accessCache:o,type:l,appContext:c}=t;let u;if(e[0]!=="$"){const y=o[e];if(y!==void 0)switch(y){case 1:return s[e];case 2:return i[e];case 4:return n[e];case 3:return r[e]}else{if(nl(s,e))return o[e]=1,s[e];if(i!==Ze&&Ye(i,e))return o[e]=2,i[e];if((u=t.propsOptions[0])&&Ye(u,e))return o[e]=3,r[e];if(n!==Ze&&Ye(n,e))return o[e]=4,n[e];Rl&&(o[e]=0)}}const h=er[e];let f,m;if(h)return e==="$attrs"&&Ot(t.attrs,"get",""),h(t);if((f=l.__cssModules)&&(f=f[e]))return f;if(n!==Ze&&Ye(n,e))return o[e]=4,n[e];if(m=c.config.globalProperties,Ye(m,e))return m[e]},set({_:t},e,n){const{data:s,setupState:i,ctx:r}=t;return nl(i,e)?(i[e]=n,!0):s!==Ze&&Ye(s,e)?(s[e]=n,!0):Ye(t.props,e)||e[0]==="$"&&e.slice(1)in t?!1:(r[e]=n,!0)},has({_:{data:t,setupState:e,accessCache:n,ctx:s,appContext:i,propsOptions:r}},o){let l;return!!n[o]||t!==Ze&&Ye(t,o)||nl(e,o)||(l=r[0])&&Ye(l,o)||Ye(s,o)||Ye(er,o)||Ye(i.config.globalProperties,o)},defineProperty(t,e,n){return n.get!=null?t._.accessCache[e]=0:Ye(n,"value")&&this.set(t,e,n.value,null),Reflect.defineProperty(t,e,n)}};function gd(t){return Ce(t)?t.reduce((e,n)=>(e[n]=null,e),{}):t}let Rl=!0;function Ly(t){const e=op(t),n=t.proxy,s=t.ctx;Rl=!1,e.beforeCreate&&md(e.beforeCreate,t,"bc");const{data:i,computed:r,methods:o,watch:l,provide:c,inject:u,created:h,beforeMount:f,mounted:m,beforeUpdate:y,updated:C,activated:D,deactivated:S,beforeDestroy:M,beforeUnmount:P,destroyed:V,unmounted:R,render:H,renderTracked:O,renderTriggered:I,errorCaptured:E,serverPrefetch:v,expose:_,inheritAttrs:T,components:b,directives:A,filters:de}=e;if(u&&By(u,s,null),o)for(const G in o){const Q=o[G];Ne(Q)&&(s[G]=Q.bind(n))}if(i){const G=i.call(n,n);it(G)&&(t.data=vi(G))}if(Rl=!0,r)for(const G in r){const Q=r[G],le=Ne(Q)?Q.bind(n,n):Ne(Q.get)?Q.get.bind(n,n):mn,ke=!Ne(Q)&&Ne(Q.set)?Q.set.bind(n):mn,Ge=Le({get:le,set:ke});Object.defineProperty(s,G,{enumerable:!0,configurable:!0,get:()=>Ge.value,set:Fe=>Ge.value=Fe})}if(l)for(const G in l)rp(l[G],s,n,G);if(c){const G=Ne(c)?c.call(n):c;Reflect.ownKeys(G).forEach(Q=>{Gy(Q,G[Q])})}h&&md(h,t,"c");function q(G,Q){Ce(Q)?Q.forEach(le=>G(le.bind(n))):Q&&G(Q.bind(n))}if(q(Ry,f),q(Wt,m),q(Dy,y),q(My,C),q(Cy,D),q(ky,S),q(Vy,E),q(xy,O),q(Ny,I),q(Fs,P),q(Pr,R),q(Oy,v),Ce(_))if(_.length){const G=t.exposed||(t.exposed={});_.forEach(Q=>{Object.defineProperty(G,Q,{get:()=>n[Q],set:le=>n[Q]=le})})}else t.exposed||(t.exposed={});H&&t.render===mn&&(t.render=H),T!=null&&(t.inheritAttrs=T),b&&(t.components=b),A&&(t.directives=A),v&&sp(t)}function By(t,e,n=mn){Ce(t)&&(t=Dl(t));for(const s in t){const i=t[s];let r;it(i)?"default"in i?r=tr(i.from||s,i.default,!0):r=tr(i.from||s):r=tr(i),ht(r)?Object.defineProperty(e,s,{enumerable:!0,configurable:!0,get:()=>r.value,set:o=>r.value=o}):e[s]=r}}function md(t,e,n){un(Ce(t)?t.map(s=>s.bind(e.proxy)):t.bind(e.proxy),e,n)}function rp(t,e,n,s){let i=s.includes(".")?Ep(n,s):()=>n[s];if(pt(t)){const r=e[t];Ne(r)&&on(i,r)}else if(Ne(t))on(i,t.bind(n));else if(it(t))if(Ce(t))t.forEach(r=>rp(r,e,n,s));else{const r=Ne(t.handler)?t.handler.bind(n):e[t.handler];Ne(r)&&on(i,r,t)}}function op(t){const e=t.type,{mixins:n,extends:s}=e,{mixins:i,optionsCache:r,config:{optionMergeStrategies:o}}=t.appContext,l=r.get(e);let c;return l?c=l:!i.length&&!n&&!s?c=e:(c={},i.length&&i.forEach(u=>Co(c,u,o,!0)),Co(c,e,o)),it(e)&&r.set(e,c),c}function Co(t,e,n,s=!1){const{mixins:i,extends:r}=e;r&&Co(t,r,n,!0),i&&i.forEach(o=>Co(t,o,n,!0));for(const o in e)if(!(s&&o==="expose")){const l=Uy[o]||n&&n[o];t[o]=l?l(t[o],e[o]):e[o]}return t}const Uy={data:vd,props:yd,emits:yd,methods:Gi,computed:Gi,beforeCreate:$t,created:$t,beforeMount:$t,mounted:$t,beforeUpdate:$t,updated:$t,beforeDestroy:$t,beforeUnmount:$t,destroyed:$t,unmounted:$t,activated:$t,deactivated:$t,errorCaptured:$t,serverPrefetch:$t,components:Gi,directives:Gi,watch:jy,provide:vd,inject:Hy};function vd(t,e){return e?t?function(){return kt(Ne(t)?t.call(this,this):t,Ne(e)?e.call(this,this):e)}:e:t}function Hy(t,e){return Gi(Dl(t),Dl(e))}function Dl(t){if(Ce(t)){const e={};for(let n=0;n<t.length;n++)e[t[n]]=t[n];return e}return t}function $t(t,e){return t?[...new Set([].concat(t,e))]:e}function Gi(t,e){return t?kt(Object.create(null),t,e):e}function yd(t,e){return t?Ce(t)&&Ce(e)?[...new Set([...t,...e])]:kt(Object.create(null),gd(t),gd(e??{})):e}function jy(t,e){if(!t)return e;if(!e)return t;const n=kt(Object.create(null),t);for(const s in e)n[s]=$t(t[s],e[s]);return n}function ap(){return{app:null,config:{isNativeTag:Rv,performance:!1,globalProperties:{},optionMergeStrategies:{},errorHandler:void 0,warnHandler:void 0,compilerOptions:{}},mixins:[],components:{},directives:{},provides:Object.create(null),optionsCache:new WeakMap,propsCache:new WeakMap,emitsCache:new WeakMap}}let Ky=0;function qy(t,e){return function(s,i=null){Ne(s)||(s=kt({},s)),i!=null&&!it(i)&&(i=null);const r=ap(),o=new WeakSet,l=[];let c=!1;const u=r.app={_uid:Ky++,_component:s,_props:i,_container:null,_context:r,_instance:null,version:k_,get config(){return r.config},set config(h){},use(h,...f){return o.has(h)||(h&&Ne(h.install)?(o.add(h),h.install(u,...f)):Ne(h)&&(o.add(h),h(u,...f))),u},mixin(h){return r.mixins.includes(h)||r.mixins.push(h),u},component(h,f){return f?(r.components[h]=f,u):r.components[h]},directive(h,f){return f?(r.directives[h]=f,u):r.directives[h]},mount(h,f,m){if(!c){const y=u._ceVNode||Ue(s,i);return y.appContext=r,m===!0?m="svg":m===!1&&(m=void 0),t(y,h,m),c=!0,u._container=h,h.__vue_app__=u,ia(y.component)}},onUnmount(h){l.push(h)},unmount(){c&&(un(l,u._instance,16),t(null,u._container),delete u._container.__vue_app__)},provide(h,f){return r.provides[h]=f,u},runWithContext(h){const f=$s;$s=u;try{return h()}finally{$s=f}}};return u}}let $s=null;function Gy(t,e){if(Ct){let n=Ct.provides;const s=Ct.parent&&Ct.parent.provides;s===n&&(n=Ct.provides=Object.create(s)),n[t]=e}}function tr(t,e,n=!1){const s=Ct||Kt;if(s||$s){const i=$s?$s._context.provides:s?s.parent==null?s.vnode.appContext&&s.vnode.appContext.provides:s.parent.provides:void 0;if(i&&t in i)return i[t];if(arguments.length>1)return n&&Ne(e)?e.call(s&&s.proxy):e}}function Wy(){return!!(Ct||Kt||$s)}const lp={},cp=()=>Object.create(lp),up=t=>Object.getPrototypeOf(t)===lp;function zy(t,e,n,s=!1){const i={},r=cp();t.propsDefaults=Object.create(null),dp(t,e,i,r);for(const o in t.propsOptions[0])o in i||(i[o]=void 0);n?t.props=s?i:ly(i):t.type.props?t.props=i:t.props=r,t.attrs=r}function Yy(t,e,n,s){const{props:i,attrs:r,vnode:{patchFlag:o}}=t,l=qe(i),[c]=t.propsOptions;let u=!1;if((s||o>0)&&!(o&16)){if(o&8){const h=t.vnode.dynamicProps;for(let f=0;f<h.length;f++){let m=h[f];if(na(t.emitsOptions,m))continue;const y=e[m];if(c)if(Ye(r,m))y!==r[m]&&(r[m]=y,u=!0);else{const C=ts(m);i[C]=Ml(c,l,C,y,t,!1)}else y!==r[m]&&(r[m]=y,u=!0)}}}else{dp(t,e,i,r)&&(u=!0);let h;for(const f in l)(!e||!Ye(e,f)&&((h=vs(f))===f||!Ye(e,h)))&&(c?n&&(n[f]!==void 0||n[h]!==void 0)&&(i[f]=Ml(c,l,f,void 0,t,!0)):delete i[f]);if(r!==l)for(const f in r)(!e||!Ye(e,f))&&(delete r[f],u=!0)}u&&Pn(t.attrs,"set","")}function dp(t,e,n,s){const[i,r]=t.propsOptions;let o=!1,l;if(e)for(let c in e){if(Qi(c))continue;const u=e[c];let h;i&&Ye(i,h=ts(c))?!r||!r.includes(h)?n[h]=u:(l||(l={}))[h]=u:na(t.emitsOptions,c)||(!(c in s)||u!==s[c])&&(s[c]=u,o=!0)}if(r){const c=qe(n),u=l||Ze;for(let h=0;h<r.length;h++){const f=r[h];n[f]=Ml(i,c,f,u[f],t,!Ye(u,f))}}return o}function Ml(t,e,n,s,i,r){const o=t[n];if(o!=null){const l=Ye(o,"default");if(l&&s===void 0){const c=o.default;if(o.type!==Function&&!o.skipFactory&&Ne(c)){const{propsDefaults:u}=i;if(n in u)s=u[n];else{const h=Rr(i);s=u[n]=c.call(null,e),h()}}else s=c;i.ce&&i.ce._setProp(n,s)}o[0]&&(r&&!l?s=!1:o[1]&&(s===""||s===vs(n))&&(s=!0))}return s}const Qy=new WeakMap;function hp(t,e,n=!1){const s=n?Qy:e.propsCache,i=s.get(t);if(i)return i;const r=t.props,o={},l=[];let c=!1;if(!Ne(t)){const h=f=>{c=!0;const[m,y]=hp(f,e,!0);kt(o,m),y&&l.push(...y)};!n&&e.mixins.length&&e.mixins.forEach(h),t.extends&&h(t.extends),t.mixins&&t.mixins.forEach(h)}if(!r&&!c)return it(t)&&s.set(t,fi),fi;if(Ce(r))for(let h=0;h<r.length;h++){const f=ts(r[h]);_d(f)&&(o[f]=Ze)}else if(r)for(const h in r){const f=ts(h);if(_d(f)){const m=r[h],y=o[f]=Ce(m)||Ne(m)?{type:m}:kt({},m),C=y.type;let D=!1,S=!0;if(Ce(C))for(let M=0;M<C.length;++M){const P=C[M],V=Ne(P)&&P.name;if(V==="Boolean"){D=!0;break}else V==="String"&&(S=!1)}else D=Ne(C)&&C.name==="Boolean";y[0]=D,y[1]=S,(D||Ye(y,"default"))&&l.push(f)}}const u=[o,l];return it(t)&&s.set(t,u),u}function _d(t){return t[0]!=="$"&&!Qi(t)}const fp=t=>t[0]==="_"||t==="$stable",Ac=t=>Ce(t)?t.map(gn):[gn(t)],Xy=(t,e,n)=>{if(e._n)return e;const s=Qf((...i)=>Ac(e(...i)),n);return s._c=!1,s},pp=(t,e,n)=>{const s=t._ctx;for(const i in t){if(fp(i))continue;const r=t[i];if(Ne(r))e[i]=Xy(i,r,s);else if(r!=null){const o=Ac(r);e[i]=()=>o}}},gp=(t,e)=>{const n=Ac(e);t.slots.default=()=>n},mp=(t,e,n)=>{for(const s in e)(n||s!=="_")&&(t[s]=e[s])},Jy=(t,e,n)=>{const s=t.slots=cp();if(t.vnode.shapeFlag&32){const i=e._;i?(mp(s,e,n),n&&bf(s,"_",i,!0)):pp(e,s)}else e&&gp(t,e)},Zy=(t,e,n)=>{const{vnode:s,slots:i}=t;let r=!0,o=Ze;if(s.shapeFlag&32){const l=e._;l?n&&l===1?r=!1:mp(i,e,n):(r=!e.$stable,pp(e,i)),o=e}else e&&(gp(t,e),o={default:1});if(r)for(const l in i)!fp(l)&&o[l]==null&&delete i[l]},Yt=f_;function e_(t){return t_(t)}function t_(t,e){const n=Xo();n.__VUE__=!0;const{insert:s,remove:i,patchProp:r,createElement:o,createText:l,createComment:c,setText:u,setElementText:h,parentNode:f,nextSibling:m,setScopeId:y=mn,insertStaticContent:C}=t,D=(k,N,U,ne=null,J=null,oe=null,ge=void 0,he=null,ce=!!N.dynamicChildren)=>{if(k===N)return;k&&!Ms(k,N)&&(ne=xe(k),Fe(k,J,oe,!0),k=null),N.patchFlag===-2&&(ce=!1,N.dynamicChildren=null);const{type:re,ref:Ie,shapeFlag:ve}=N;switch(re){case sa:S(k,N,U,ne);break;case jt:M(k,N,U,ne);break;case fo:k==null&&P(N,U,ne,ge);break;case mt:b(k,N,U,ne,J,oe,ge,he,ce);break;default:ve&1?H(k,N,U,ne,J,oe,ge,he,ce):ve&6?A(k,N,U,ne,J,oe,ge,he,ce):(ve&64||ve&128)&&re.process(k,N,U,ne,J,oe,ge,he,ce,rt)}Ie!=null&&J&&So(Ie,k&&k.ref,oe,N||k,!N)},S=(k,N,U,ne)=>{if(k==null)s(N.el=l(N.children),U,ne);else{const J=N.el=k.el;N.children!==k.children&&u(J,N.children)}},M=(k,N,U,ne)=>{k==null?s(N.el=c(N.children||""),U,ne):N.el=k.el},P=(k,N,U,ne)=>{[k.el,k.anchor]=C(k.children,N,U,ne,k.el,k.anchor)},V=({el:k,anchor:N},U,ne)=>{let J;for(;k&&k!==N;)J=m(k),s(k,U,ne),k=J;s(N,U,ne)},R=({el:k,anchor:N})=>{let U;for(;k&&k!==N;)U=m(k),i(k),k=U;i(N)},H=(k,N,U,ne,J,oe,ge,he,ce)=>{N.type==="svg"?ge="svg":N.type==="math"&&(ge="mathml"),k==null?O(N,U,ne,J,oe,ge,he,ce):v(k,N,J,oe,ge,he,ce)},O=(k,N,U,ne,J,oe,ge,he)=>{let ce,re;const{props:Ie,shapeFlag:ve,transition:we,dirs:x}=k;if(ce=k.el=o(k.type,oe,Ie&&Ie.is,Ie),ve&8?h(ce,k.children):ve&16&&E(k.children,ce,null,ne,J,sl(k,oe),ge,he),x&&Ss(k,null,ne,"created"),I(ce,k,k.scopeId,ge,ne),Ie){for(const fe in Ie)fe!=="value"&&!Qi(fe)&&r(ce,fe,null,Ie[fe],oe,ne);"value"in Ie&&r(ce,"value",null,Ie.value,oe),(re=Ie.onVnodeBeforeMount)&&hn(re,ne,k)}x&&Ss(k,null,ne,"beforeMount");const te=n_(J,we);te&&we.beforeEnter(ce),s(ce,N,U),((re=Ie&&Ie.onVnodeMounted)||te||x)&&Yt(()=>{re&&hn(re,ne,k),te&&we.enter(ce),x&&Ss(k,null,ne,"mounted")},J)},I=(k,N,U,ne,J)=>{if(U&&y(k,U),ne)for(let oe=0;oe<ne.length;oe++)y(k,ne[oe]);if(J){let oe=J.subTree;if(N===oe||bp(oe.type)&&(oe.ssContent===N||oe.ssFallback===N)){const ge=J.vnode;I(k,ge,ge.scopeId,ge.slotScopeIds,J.parent)}}},E=(k,N,U,ne,J,oe,ge,he,ce=0)=>{for(let re=ce;re<k.length;re++){const Ie=k[re]=he?zn(k[re]):gn(k[re]);D(null,Ie,N,U,ne,J,oe,ge,he)}},v=(k,N,U,ne,J,oe,ge)=>{const he=N.el=k.el;let{patchFlag:ce,dynamicChildren:re,dirs:Ie}=N;ce|=k.patchFlag&16;const ve=k.props||Ze,we=N.props||Ze;let x;if(U&&Cs(U,!1),(x=we.onVnodeBeforeUpdate)&&hn(x,U,N,k),Ie&&Ss(N,k,U,"beforeUpdate"),U&&Cs(U,!0),(ve.innerHTML&&we.innerHTML==null||ve.textContent&&we.textContent==null)&&h(he,""),re?_(k.dynamicChildren,re,he,U,ne,sl(N,J),oe):ge||Q(k,N,he,null,U,ne,sl(N,J),oe,!1),ce>0){if(ce&16)T(he,ve,we,U,J);else if(ce&2&&ve.class!==we.class&&r(he,"class",null,we.class,J),ce&4&&r(he,"style",ve.style,we.style,J),ce&8){const te=N.dynamicProps;for(let fe=0;fe<te.length;fe++){const be=te[fe],Se=ve[be],Ve=we[be];(Ve!==Se||be==="value")&&r(he,be,Se,Ve,J,U)}}ce&1&&k.children!==N.children&&h(he,N.children)}else!ge&&re==null&&T(he,ve,we,U,J);((x=we.onVnodeUpdated)||Ie)&&Yt(()=>{x&&hn(x,U,N,k),Ie&&Ss(N,k,U,"updated")},ne)},_=(k,N,U,ne,J,oe,ge)=>{for(let he=0;he<N.length;he++){const ce=k[he],re=N[he],Ie=ce.el&&(ce.type===mt||!Ms(ce,re)||ce.shapeFlag&70)?f(ce.el):U;D(ce,re,Ie,null,ne,J,oe,ge,!0)}},T=(k,N,U,ne,J)=>{if(N!==U){if(N!==Ze)for(const oe in N)!Qi(oe)&&!(oe in U)&&r(k,oe,N[oe],null,J,ne);for(const oe in U){if(Qi(oe))continue;const ge=U[oe],he=N[oe];ge!==he&&oe!=="value"&&r(k,oe,he,ge,J,ne)}"value"in U&&r(k,"value",N.value,U.value,J)}},b=(k,N,U,ne,J,oe,ge,he,ce)=>{const re=N.el=k?k.el:l(""),Ie=N.anchor=k?k.anchor:l("");let{patchFlag:ve,dynamicChildren:we,slotScopeIds:x}=N;x&&(he=he?he.concat(x):x),k==null?(s(re,U,ne),s(Ie,U,ne),E(N.children||[],U,Ie,J,oe,ge,he,ce)):ve>0&&ve&64&&we&&k.dynamicChildren?(_(k.dynamicChildren,we,U,J,oe,ge,he),(N.key!=null||J&&N===J.subTree)&&vp(k,N,!0)):Q(k,N,U,Ie,J,oe,ge,he,ce)},A=(k,N,U,ne,J,oe,ge,he,ce)=>{N.slotScopeIds=he,k==null?N.shapeFlag&512?J.ctx.activate(N,U,ne,ge,ce):de(N,U,ne,J,oe,ge,ce):W(k,N,ce)},de=(k,N,U,ne,J,oe,ge)=>{const he=k.component=E_(k,ne,J);if(ea(k)&&(he.ctx.renderer=rt),b_(he,!1,ge),he.asyncDep){if(J&&J.registerDep(he,q,ge),!k.el){const ce=he.subTree=Ue(jt);M(null,ce,N,U)}}else q(he,k,N,U,J,oe,ge)},W=(k,N,U)=>{const ne=N.component=k.component;if(d_(k,N,U))if(ne.asyncDep&&!ne.asyncResolved){G(ne,N,U);return}else ne.next=N,ne.update();else N.el=k.el,ne.vnode=N},q=(k,N,U,ne,J,oe,ge)=>{const he=()=>{if(k.isMounted){let{next:ve,bu:we,u:x,parent:te,vnode:fe}=k;{const ut=yp(k);if(ut){ve&&(ve.el=fe.el,G(k,ve,ge)),ut.asyncDep.then(()=>{k.isUnmounted||he()});return}}let be=ve,Se;Cs(k,!1),ve?(ve.el=fe.el,G(k,ve,ge)):ve=fe,we&&ho(we),(Se=ve.props&&ve.props.onVnodeBeforeUpdate)&&hn(Se,te,ve,fe),Cs(k,!0);const Ve=Td(k),ze=k.subTree;k.subTree=Ve,D(ze,Ve,f(ze.el),xe(ze),k,J,oe),ve.el=Ve.el,be===null&&h_(k,Ve.el),x&&Yt(x,J),(Se=ve.props&&ve.props.onVnodeUpdated)&&Yt(()=>hn(Se,te,ve,fe),J)}else{let ve;const{el:we,props:x}=N,{bm:te,m:fe,parent:be,root:Se,type:Ve}=k,ze=Zi(N);Cs(k,!1),te&&ho(te),!ze&&(ve=x&&x.onVnodeBeforeMount)&&hn(ve,be,N),Cs(k,!0);{Se.ce&&Se.ce._injectChildStyle(Ve);const ut=k.subTree=Td(k);D(null,ut,U,ne,k,J,oe),N.el=ut.el}if(fe&&Yt(fe,J),!ze&&(ve=x&&x.onVnodeMounted)){const ut=N;Yt(()=>hn(ve,be,ut),J)}(N.shapeFlag&256||be&&Zi(be.vnode)&&be.vnode.shapeFlag&256)&&k.a&&Yt(k.a,J),k.isMounted=!0,N=U=ne=null}};k.scope.on();const ce=k.effect=new Pf(he);k.scope.off();const re=k.update=ce.run.bind(ce),Ie=k.job=ce.runIfDirty.bind(ce);Ie.i=k,Ie.id=k.uid,ce.scheduler=()=>wc(Ie),Cs(k,!0),re()},G=(k,N,U)=>{N.component=k;const ne=k.vnode.props;k.vnode=N,k.next=null,Yy(k,N.props,ne,U),Zy(k,N.children,U),ys(),fd(k),_s()},Q=(k,N,U,ne,J,oe,ge,he,ce=!1)=>{const re=k&&k.children,Ie=k?k.shapeFlag:0,ve=N.children,{patchFlag:we,shapeFlag:x}=N;if(we>0){if(we&128){ke(re,ve,U,ne,J,oe,ge,he,ce);return}else if(we&256){le(re,ve,U,ne,J,oe,ge,he,ce);return}}x&8?(Ie&16&&Te(re,J,oe),ve!==re&&h(U,ve)):Ie&16?x&16?ke(re,ve,U,ne,J,oe,ge,he,ce):Te(re,J,oe,!0):(Ie&8&&h(U,""),x&16&&E(ve,U,ne,J,oe,ge,he,ce))},le=(k,N,U,ne,J,oe,ge,he,ce)=>{k=k||fi,N=N||fi;const re=k.length,Ie=N.length,ve=Math.min(re,Ie);let we;for(we=0;we<ve;we++){const x=N[we]=ce?zn(N[we]):gn(N[we]);D(k[we],x,U,null,J,oe,ge,he,ce)}re>Ie?Te(k,J,oe,!0,!1,ve):E(N,U,ne,J,oe,ge,he,ce,ve)},ke=(k,N,U,ne,J,oe,ge,he,ce)=>{let re=0;const Ie=N.length;let ve=k.length-1,we=Ie-1;for(;re<=ve&&re<=we;){const x=k[re],te=N[re]=ce?zn(N[re]):gn(N[re]);if(Ms(x,te))D(x,te,U,null,J,oe,ge,he,ce);else break;re++}for(;re<=ve&&re<=we;){const x=k[ve],te=N[we]=ce?zn(N[we]):gn(N[we]);if(Ms(x,te))D(x,te,U,null,J,oe,ge,he,ce);else break;ve--,we--}if(re>ve){if(re<=we){const x=we+1,te=x<Ie?N[x].el:ne;for(;re<=we;)D(null,N[re]=ce?zn(N[re]):gn(N[re]),U,te,J,oe,ge,he,ce),re++}}else if(re>we)for(;re<=ve;)Fe(k[re],J,oe,!0),re++;else{const x=re,te=re,fe=new Map;for(re=te;re<=we;re++){const _t=N[re]=ce?zn(N[re]):gn(N[re]);_t.key!=null&&fe.set(_t.key,re)}let be,Se=0;const Ve=we-te+1;let ze=!1,ut=0;const Vt=new Array(Ve);for(re=0;re<Ve;re++)Vt[re]=0;for(re=x;re<=ve;re++){const _t=k[re];if(Se>=Ve){Fe(_t,J,oe,!0);continue}let en;if(_t.key!=null)en=fe.get(_t.key);else for(be=te;be<=we;be++)if(Vt[be-te]===0&&Ms(_t,N[be])){en=be;break}en===void 0?Fe(_t,J,oe,!0):(Vt[en-te]=re+1,en>=ut?ut=en:ze=!0,D(_t,N[en],U,null,J,oe,ge,he,ce),Se++)}const Ts=ze?s_(Vt):fi;for(be=Ts.length-1,re=Ve-1;re>=0;re--){const _t=te+re,en=N[_t],Lr=_t+1<Ie?N[_t+1].el:ne;Vt[re]===0?D(null,en,U,Lr,J,oe,ge,he,ce):ze&&(be<0||re!==Ts[be]?Ge(en,U,Lr,2):be--)}}},Ge=(k,N,U,ne,J=null)=>{const{el:oe,type:ge,transition:he,children:ce,shapeFlag:re}=k;if(re&6){Ge(k.component.subTree,N,U,ne);return}if(re&128){k.suspense.move(N,U,ne);return}if(re&64){ge.move(k,N,U,rt);return}if(ge===mt){s(oe,N,U);for(let ve=0;ve<ce.length;ve++)Ge(ce[ve],N,U,ne);s(k.anchor,N,U);return}if(ge===fo){V(k,N,U);return}if(ne!==2&&re&1&&he)if(ne===0)he.beforeEnter(oe),s(oe,N,U),Yt(()=>he.enter(oe),J);else{const{leave:ve,delayLeave:we,afterLeave:x}=he,te=()=>s(oe,N,U),fe=()=>{ve(oe,()=>{te(),x&&x()})};we?we(oe,te,fe):fe()}else s(oe,N,U)},Fe=(k,N,U,ne=!1,J=!1)=>{const{type:oe,props:ge,ref:he,children:ce,dynamicChildren:re,shapeFlag:Ie,patchFlag:ve,dirs:we,cacheIndex:x}=k;if(ve===-2&&(J=!1),he!=null&&So(he,null,U,k,!0),x!=null&&(N.renderCache[x]=void 0),Ie&256){N.ctx.deactivate(k);return}const te=Ie&1&&we,fe=!Zi(k);let be;if(fe&&(be=ge&&ge.onVnodeBeforeUnmount)&&hn(be,N,k),Ie&6)me(k.component,U,ne);else{if(Ie&128){k.suspense.unmount(U,ne);return}te&&Ss(k,null,N,"beforeUnmount"),Ie&64?k.type.remove(k,N,U,rt,ne):re&&!re.hasOnce&&(oe!==mt||ve>0&&ve&64)?Te(re,N,U,!1,!0):(oe===mt&&ve&384||!J&&Ie&16)&&Te(ce,N,U),ne&&ie(k)}(fe&&(be=ge&&ge.onVnodeUnmounted)||te)&&Yt(()=>{be&&hn(be,N,k),te&&Ss(k,null,N,"unmounted")},U)},ie=k=>{const{type:N,el:U,anchor:ne,transition:J}=k;if(N===mt){F(U,ne);return}if(N===fo){R(k);return}const oe=()=>{i(U),J&&!J.persisted&&J.afterLeave&&J.afterLeave()};if(k.shapeFlag&1&&J&&!J.persisted){const{leave:ge,delayLeave:he}=J,ce=()=>ge(U,oe);he?he(k.el,oe,ce):ce()}else oe()},F=(k,N)=>{let U;for(;k!==N;)U=m(k),i(k),k=U;i(N)},me=(k,N,U)=>{const{bum:ne,scope:J,job:oe,subTree:ge,um:he,m:ce,a:re}=k;Ed(ce),Ed(re),ne&&ho(ne),J.stop(),oe&&(oe.flags|=8,Fe(ge,k,N,U)),he&&Yt(he,N),Yt(()=>{k.isUnmounted=!0},N),N&&N.pendingBranch&&!N.isUnmounted&&k.asyncDep&&!k.asyncResolved&&k.suspenseId===N.pendingId&&(N.deps--,N.deps===0&&N.resolve())},Te=(k,N,U,ne=!1,J=!1,oe=0)=>{for(let ge=oe;ge<k.length;ge++)Fe(k[ge],N,U,ne,J)},xe=k=>{if(k.shapeFlag&6)return xe(k.component.subTree);if(k.shapeFlag&128)return k.suspense.next();const N=m(k.anchor||k.el),U=N&&N[wy];return U?m(U):N};let Xe=!1;const et=(k,N,U)=>{k==null?N._vnode&&Fe(N._vnode,null,null,!0):D(N._vnode||null,k,N,null,null,null,U),N._vnode=k,Xe||(Xe=!0,fd(),Wf(),Xe=!1)},rt={p:D,um:Fe,m:Ge,r:ie,mt:de,mc:E,pc:Q,pbc:_,n:xe,o:t};return{render:et,hydrate:void 0,createApp:qy(et)}}function sl({type:t,props:e},n){return n==="svg"&&t==="foreignObject"||n==="mathml"&&t==="annotation-xml"&&e&&e.encoding&&e.encoding.includes("html")?void 0:n}function Cs({effect:t,job:e},n){n?(t.flags|=32,e.flags|=4):(t.flags&=-33,e.flags&=-5)}function n_(t,e){return(!t||t&&!t.pendingBranch)&&e&&!e.persisted}function vp(t,e,n=!1){const s=t.children,i=e.children;if(Ce(s)&&Ce(i))for(let r=0;r<s.length;r++){const o=s[r];let l=i[r];l.shapeFlag&1&&!l.dynamicChildren&&((l.patchFlag<=0||l.patchFlag===32)&&(l=i[r]=zn(i[r]),l.el=o.el),!n&&l.patchFlag!==-2&&vp(o,l)),l.type===sa&&(l.el=o.el)}}function s_(t){const e=t.slice(),n=[0];let s,i,r,o,l;const c=t.length;for(s=0;s<c;s++){const u=t[s];if(u!==0){if(i=n[n.length-1],t[i]<u){e[s]=i,n.push(s);continue}for(r=0,o=n.length-1;r<o;)l=r+o>>1,t[n[l]]<u?r=l+1:o=l;u<t[n[r]]&&(r>0&&(e[s]=n[r-1]),n[r]=s)}}for(r=n.length,o=n[r-1];r-- >0;)n[r]=o,o=e[o];return n}function yp(t){const e=t.subTree.component;if(e)return e.asyncDep&&!e.asyncResolved?e:yp(e)}function Ed(t){if(t)for(let e=0;e<t.length;e++)t[e].flags|=8}const i_=Symbol.for("v-scx"),r_=()=>tr(i_);function on(t,e,n){return _p(t,e,n)}function _p(t,e,n=Ze){const{immediate:s,deep:i,flush:r,once:o}=n,l=kt({},n),c=e&&s||!e&&r!=="post";let u;if(vr){if(r==="sync"){const y=r_();u=y.__watcherHandles||(y.__watcherHandles=[])}else if(!c){const y=()=>{};return y.stop=mn,y.resume=mn,y.pause=mn,y}}const h=Ct;l.call=(y,C,D)=>un(y,h,C,D);let f=!1;r==="post"?l.scheduler=y=>{Yt(y,h&&h.suspense)}:r!=="sync"&&(f=!0,l.scheduler=(y,C)=>{C?y():wc(y)}),l.augmentJob=y=>{e&&(y.flags|=4),f&&(y.flags|=2,h&&(y.id=h.uid,y.i=h))};const m=yy(t,e,l);return vr&&(u?u.push(m):c&&m()),m}function o_(t,e,n){const s=this.proxy,i=pt(t)?t.includes(".")?Ep(s,t):()=>s[t]:t.bind(s,s);let r;Ne(e)?r=e:(r=e.handler,n=e);const o=Rr(this),l=_p(i,r.bind(s),n);return o(),l}function Ep(t,e){const n=e.split(".");return()=>{let s=t;for(let i=0;i<n.length&&s;i++)s=s[n[i]];return s}}const a_=(t,e)=>e==="modelValue"||e==="model-value"?t.modelModifiers:t[`${e}Modifiers`]||t[`${ts(e)}Modifiers`]||t[`${vs(e)}Modifiers`];function l_(t,e,...n){if(t.isUnmounted)return;const s=t.vnode.props||Ze;let i=n;const r=e.startsWith("update:"),o=r&&a_(s,e.slice(7));o&&(o.trim&&(i=n.map(h=>pt(h)?h.trim():h)),o.number&&(i=n.map(wl)));let l,c=s[l=Qa(e)]||s[l=Qa(ts(e))];!c&&r&&(c=s[l=Qa(vs(e))]),c&&un(c,t,6,i);const u=s[l+"Once"];if(u){if(!t.emitted)t.emitted={};else if(t.emitted[l])return;t.emitted[l]=!0,un(u,t,6,i)}}function Tp(t,e,n=!1){const s=e.emitsCache,i=s.get(t);if(i!==void 0)return i;const r=t.emits;let o={},l=!1;if(!Ne(t)){const c=u=>{const h=Tp(u,e,!0);h&&(l=!0,kt(o,h))};!n&&e.mixins.length&&e.mixins.forEach(c),t.extends&&c(t.extends),t.mixins&&t.mixins.forEach(c)}return!r&&!l?(it(t)&&s.set(t,null),null):(Ce(r)?r.forEach(c=>o[c]=null):kt(o,r),it(t)&&s.set(t,o),o)}function na(t,e){return!t||!zo(e)?!1:(e=e.slice(2).replace(/Once$/,""),Ye(t,e[0].toLowerCase()+e.slice(1))||Ye(t,vs(e))||Ye(t,e))}function Td(t){const{type:e,vnode:n,proxy:s,withProxy:i,propsOptions:[r],slots:o,attrs:l,emit:c,render:u,renderCache:h,props:f,data:m,setupState:y,ctx:C,inheritAttrs:D}=t,S=Io(t);let M,P;try{if(n.shapeFlag&4){const R=i||s,H=R;M=gn(u.call(H,R,h,f,y,m,C)),P=l}else{const R=e;M=gn(R.length>1?R(f,{attrs:l,slots:o,emit:c}):R(f,null)),P=e.props?l:c_(l)}}catch(R){nr.length=0,Zo(R,t,1),M=Ue(jt)}let V=M;if(P&&D!==!1){const R=Object.keys(P),{shapeFlag:H}=V;R.length&&H&7&&(r&&R.some(dc)&&(P=u_(P,r)),V=is(V,P,!1,!0))}return n.dirs&&(V=is(V,null,!1,!0),V.dirs=V.dirs?V.dirs.concat(n.dirs):n.dirs),n.transition&&gr(V,n.transition),M=V,Io(S),M}const c_=t=>{let e;for(const n in t)(n==="class"||n==="style"||zo(n))&&((e||(e={}))[n]=t[n]);return e},u_=(t,e)=>{const n={};for(const s in t)(!dc(s)||!(s.slice(9)in e))&&(n[s]=t[s]);return n};function d_(t,e,n){const{props:s,children:i,component:r}=t,{props:o,children:l,patchFlag:c}=e,u=r.emitsOptions;if(e.dirs||e.transition)return!0;if(n&&c>=0){if(c&1024)return!0;if(c&16)return s?bd(s,o,u):!!o;if(c&8){const h=e.dynamicProps;for(let f=0;f<h.length;f++){const m=h[f];if(o[m]!==s[m]&&!na(u,m))return!0}}}else return(i||l)&&(!l||!l.$stable)?!0:s===o?!1:s?o?bd(s,o,u):!0:!!o;return!1}function bd(t,e,n){const s=Object.keys(e);if(s.length!==Object.keys(t).length)return!0;for(let i=0;i<s.length;i++){const r=s[i];if(e[r]!==t[r]&&!na(n,r))return!0}return!1}function h_({vnode:t,parent:e},n){for(;e;){const s=e.subTree;if(s.suspense&&s.suspense.activeBranch===t&&(s.el=t.el),s===t)(t=e.vnode).el=n,e=e.parent;else break}}const bp=t=>t.__isSuspense;function f_(t,e){e&&e.pendingBranch?Ce(t)?e.effects.push(...t):e.effects.push(t):Ty(t)}const mt=Symbol.for("v-fgt"),sa=Symbol.for("v-txt"),jt=Symbol.for("v-cmt"),fo=Symbol.for("v-stc"),nr=[];let Xt=null;function B(t=!1){nr.push(Xt=t?null:[])}function p_(){nr.pop(),Xt=nr[nr.length-1]||null}let mr=1;function wd(t,e=!1){mr+=t,t<0&&Xt&&e&&(Xt.hasOnce=!0)}function wp(t){return t.dynamicChildren=mr>0?Xt||fi:null,p_(),mr>0&&Xt&&Xt.push(t),t}function K(t,e,n,s,i,r){return wp(g(t,e,n,s,i,r,!0))}function ss(t,e,n,s,i){return wp(Ue(t,e,n,s,i,!0))}function ko(t){return t?t.__v_isVNode===!0:!1}function Ms(t,e){return t.type===e.type&&t.key===e.key}const Ap=({key:t})=>t??null,po=({ref:t,ref_key:e,ref_for:n})=>(typeof t=="number"&&(t=""+t),t!=null?pt(t)||ht(t)||Ne(t)?{i:Kt,r:t,k:e,f:!!n}:t:null);function g(t,e=null,n=null,s=0,i=null,r=t===mt?0:1,o=!1,l=!1){const c={__v_isVNode:!0,__v_skip:!0,type:t,props:e,key:e&&Ap(e),ref:e&&po(e),scopeId:Yf,slotScopeIds:null,children:n,component:null,suspense:null,ssContent:null,ssFallback:null,dirs:null,transition:null,el:null,anchor:null,target:null,targetStart:null,targetAnchor:null,staticCount:0,shapeFlag:r,patchFlag:s,dynamicProps:i,dynamicChildren:null,appContext:null,ctx:Kt};return l?(Sc(c,n),r&128&&t.normalize(c)):n&&(c.shapeFlag|=pt(n)?8:16),mr>0&&!o&&Xt&&(c.patchFlag>0||r&6)&&c.patchFlag!==32&&Xt.push(c),c}const Ue=g_;function g_(t,e=null,n=null,s=0,i=null,r=!1){if((!t||t===Fy)&&(t=jt),ko(t)){const l=is(t,e,!0);return n&&Sc(l,n),mr>0&&!r&&Xt&&(l.shapeFlag&6?Xt[Xt.indexOf(t)]=l:Xt.push(l)),l.patchFlag=-2,l}if(S_(t)&&(t=t.__vccOpts),e){e=m_(e);let{class:l,style:c}=e;l&&!pt(l)&&(e.class=Oe(l)),it(c)&&(Ec(c)&&!Ce(c)&&(c=kt({},c)),e.style=qt(c))}const o=pt(t)?1:bp(t)?128:Xf(t)?64:it(t)?4:Ne(t)?2:0;return g(t,e,n,s,i,o,r,!0)}function m_(t){return t?Ec(t)||up(t)?kt({},t):t:null}function is(t,e,n=!1,s=!1){const{props:i,ref:r,patchFlag:o,children:l,transition:c}=t,u=e?v_(i||{},e):i,h={__v_isVNode:!0,__v_skip:!0,type:t.type,props:u,key:u&&Ap(u),ref:e&&e.ref?n&&r?Ce(r)?r.concat(po(e)):[r,po(e)]:po(e):r,scopeId:t.scopeId,slotScopeIds:t.slotScopeIds,children:l,target:t.target,targetStart:t.targetStart,targetAnchor:t.targetAnchor,staticCount:t.staticCount,shapeFlag:t.shapeFlag,patchFlag:e&&t.type!==mt?o===-1?16:o|16:o,dynamicProps:t.dynamicProps,dynamicChildren:t.dynamicChildren,appContext:t.appContext,dirs:t.dirs,transition:c,component:t.component,suspense:t.suspense,ssContent:t.ssContent&&is(t.ssContent),ssFallback:t.ssFallback&&is(t.ssFallback),el:t.el,anchor:t.anchor,ctx:t.ctx,ce:t.ce};return c&&s&&gr(h,c.clone(h)),h}function ft(t=" ",e=0){return Ue(sa,null,t,e)}function Ic(t,e){const n=Ue(fo,null,t);return n.staticCount=e,n}function X(t="",e=!1){return e?(B(),ss(jt,null,t)):Ue(jt,null,t)}function gn(t){return t==null||typeof t=="boolean"?Ue(jt):Ce(t)?Ue(mt,null,t.slice()):ko(t)?zn(t):Ue(sa,null,String(t))}function zn(t){return t.el===null&&t.patchFlag!==-1||t.memo?t:is(t)}function Sc(t,e){let n=0;const{shapeFlag:s}=t;if(e==null)e=null;else if(Ce(e))n=16;else if(typeof e=="object")if(s&65){const i=e.default;i&&(i._c&&(i._d=!1),Sc(t,i()),i._c&&(i._d=!0));return}else{n=32;const i=e._;!i&&!up(e)?e._ctx=Kt:i===3&&Kt&&(Kt.slots._===1?e._=1:(e._=2,t.patchFlag|=1024))}else Ne(e)?(e={default:e,_ctx:Kt},n=32):(e=String(e),s&64?(n=16,e=[ft(e)]):n=8);t.children=e,t.shapeFlag|=n}function v_(...t){const e={};for(let n=0;n<t.length;n++){const s=t[n];for(const i in s)if(i==="class")e.class!==s.class&&(e.class=Oe([e.class,s.class]));else if(i==="style")e.style=qt([e.style,s.style]);else if(zo(i)){const r=e[i],o=s[i];o&&r!==o&&!(Ce(r)&&r.includes(o))&&(e[i]=r?[].concat(r,o):o)}else i!==""&&(e[i]=s[i])}return e}function hn(t,e,n,s=null){un(t,e,7,[n,s])}const y_=ap();let __=0;function E_(t,e,n){const s=t.type,i=(e?e.appContext:t.appContext)||y_,r={uid:__++,vnode:t,type:s,parent:e,appContext:i,root:null,next:null,subTree:null,effect:null,update:null,job:null,scope:new Sf(!0),render:null,proxy:null,exposed:null,exposeProxy:null,withProxy:null,provides:e?e.provides:Object.create(i.provides),ids:e?e.ids:["",0,0],accessCache:null,renderCache:[],components:null,directives:null,propsOptions:hp(s,i),emitsOptions:Tp(s,i),emit:null,emitted:null,propsDefaults:Ze,inheritAttrs:s.inheritAttrs,ctx:Ze,data:Ze,props:Ze,attrs:Ze,slots:Ze,refs:Ze,setupState:Ze,setupContext:null,suspense:n,suspenseId:n?n.pendingId:0,asyncDep:null,asyncResolved:!1,isMounted:!1,isUnmounted:!1,isDeactivated:!1,bc:null,c:null,bm:null,m:null,bu:null,u:null,um:null,bum:null,da:null,a:null,rtg:null,rtc:null,ec:null,sp:null};return r.ctx={_:r},r.root=e?e.root:r,r.emit=l_.bind(null,r),t.ce&&t.ce(r),r}let Ct=null;const T_=()=>Ct||Kt;let Po,Ol;{const t=Xo(),e=(n,s)=>{let i;return(i=t[n])||(i=t[n]=[]),i.push(s),r=>{i.length>1?i.forEach(o=>o(r)):i[0](r)}};Po=e("__VUE_INSTANCE_SETTERS__",n=>Ct=n),Ol=e("__VUE_SSR_SETTERS__",n=>vr=n)}const Rr=t=>{const e=Ct;return Po(t),t.scope.on(),()=>{t.scope.off(),Po(e)}},Ad=()=>{Ct&&Ct.scope.off(),Po(null)};function Ip(t){return t.vnode.shapeFlag&4}let vr=!1;function b_(t,e=!1,n=!1){e&&Ol(e);const{props:s,children:i}=t.vnode,r=Ip(t);zy(t,s,r,e),Jy(t,i,n);const o=r?w_(t,e):void 0;return e&&Ol(!1),o}function w_(t,e){const n=t.type;t.accessCache=Object.create(null),t.proxy=new Proxy(t.ctx,$y);const{setup:s}=n;if(s){ys();const i=t.setupContext=s.length>1?I_(t):null,r=Rr(t),o=kr(s,t,0,[t.props,i]),l=yf(o);if(_s(),r(),(l||t.sp)&&!Zi(t)&&sp(t),l){if(o.then(Ad,Ad),e)return o.then(c=>{Id(t,c)}).catch(c=>{Zo(c,t,0)});t.asyncDep=o}else Id(t,o)}else Sp(t)}function Id(t,e,n){Ne(e)?t.type.__ssrInlineRender?t.ssrRender=e:t.render=e:it(e)&&(t.setupState=Kf(e)),Sp(t)}function Sp(t,e,n){const s=t.type;t.render||(t.render=s.render||mn);{const i=Rr(t);ys();try{Ly(t)}finally{_s(),i()}}}const A_={get(t,e){return Ot(t,"get",""),t[e]}};function I_(t){const e=n=>{t.exposed=n||{}};return{attrs:new Proxy(t.attrs,A_),slots:t.slots,emit:t.emit,expose:e}}function ia(t){return t.exposed?t.exposeProxy||(t.exposeProxy=new Proxy(Kf(Tc(t.exposed)),{get(e,n){if(n in e)return e[n];if(n in er)return er[n](t)},has(e,n){return n in e||n in er}})):t.proxy}function S_(t){return Ne(t)&&"__vccOpts"in t}const Le=(t,e)=>my(t,e,vr);function C_(t,e,n){const s=arguments.length;return s===2?it(e)&&!Ce(e)?ko(e)?Ue(t,null,[e]):Ue(t,e):Ue(t,null,e):(s>3?n=Array.prototype.slice.call(arguments,2):s===3&&ko(n)&&(n=[n]),Ue(t,e,n))}const k_="3.5.13";/**
* @vue/runtime-dom v3.5.13
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**/let Nl;const Sd=typeof window<"u"&&window.trustedTypes;if(Sd)try{Nl=Sd.createPolicy("vue",{createHTML:t=>t})}catch{}const Cp=Nl?t=>Nl.createHTML(t):t=>t,P_="http://www.w3.org/2000/svg",R_="http://www.w3.org/1998/Math/MathML",Cn=typeof document<"u"?document:null,Cd=Cn&&Cn.createElement("template"),D_={insert:(t,e,n)=>{e.insertBefore(t,n||null)},remove:t=>{const e=t.parentNode;e&&e.removeChild(t)},createElement:(t,e,n,s)=>{const i=e==="svg"?Cn.createElementNS(P_,t):e==="mathml"?Cn.createElementNS(R_,t):n?Cn.createElement(t,{is:n}):Cn.createElement(t);return t==="select"&&s&&s.multiple!=null&&i.setAttribute("multiple",s.multiple),i},createText:t=>Cn.createTextNode(t),createComment:t=>Cn.createComment(t),setText:(t,e)=>{t.nodeValue=e},setElementText:(t,e)=>{t.textContent=e},parentNode:t=>t.parentNode,nextSibling:t=>t.nextSibling,querySelector:t=>Cn.querySelector(t),setScopeId(t,e){t.setAttribute(e,"")},insertStaticContent(t,e,n,s,i,r){const o=n?n.previousSibling:e.lastChild;if(i&&(i===r||i.nextSibling))for(;e.insertBefore(i.cloneNode(!0),n),!(i===r||!(i=i.nextSibling)););else{Cd.innerHTML=Cp(s==="svg"?`<svg>${t}</svg>`:s==="mathml"?`<math>${t}</math>`:t);const l=Cd.content;if(s==="svg"||s==="mathml"){const c=l.firstChild;for(;c.firstChild;)l.appendChild(c.firstChild);l.removeChild(c)}e.insertBefore(l,n)}return[o?o.nextSibling:e.firstChild,n?n.previousSibling:e.lastChild]}},Kn="transition",qi="animation",yr=Symbol("_vtc"),kp={name:String,type:String,css:{type:Boolean,default:!0},duration:[String,Number,Object],enterFromClass:String,enterActiveClass:String,enterToClass:String,appearFromClass:String,appearActiveClass:String,appearToClass:String,leaveFromClass:String,leaveActiveClass:String,leaveToClass:String},M_=kt({},Jf,kp),O_=t=>(t.displayName="Transition",t.props=M_,t),N_=O_((t,{slots:e})=>C_(Sy,x_(t),e)),ks=(t,e=[])=>{Ce(t)?t.forEach(n=>n(...e)):t&&t(...e)},kd=t=>t?Ce(t)?t.some(e=>e.length>1):t.length>1:!1;function x_(t){const e={};for(const b in t)b in kp||(e[b]=t[b]);if(t.css===!1)return e;const{name:n="v",type:s,duration:i,enterFromClass:r=`${n}-enter-from`,enterActiveClass:o=`${n}-enter-active`,enterToClass:l=`${n}-enter-to`,appearFromClass:c=r,appearActiveClass:u=o,appearToClass:h=l,leaveFromClass:f=`${n}-leave-from`,leaveActiveClass:m=`${n}-leave-active`,leaveToClass:y=`${n}-leave-to`}=t,C=V_(i),D=C&&C[0],S=C&&C[1],{onBeforeEnter:M,onEnter:P,onEnterCancelled:V,onLeave:R,onLeaveCancelled:H,onBeforeAppear:O=M,onAppear:I=P,onAppearCancelled:E=V}=e,v=(b,A,de,W)=>{b._enterCancelled=W,Ps(b,A?h:l),Ps(b,A?u:o),de&&de()},_=(b,A)=>{b._isLeaving=!1,Ps(b,f),Ps(b,y),Ps(b,m),A&&A()},T=b=>(A,de)=>{const W=b?I:P,q=()=>v(A,b,de);ks(W,[A,q]),Pd(()=>{Ps(A,b?c:r),In(A,b?h:l),kd(W)||Rd(A,s,D,q)})};return kt(e,{onBeforeEnter(b){ks(M,[b]),In(b,r),In(b,o)},onBeforeAppear(b){ks(O,[b]),In(b,c),In(b,u)},onEnter:T(!1),onAppear:T(!0),onLeave(b,A){b._isLeaving=!0;const de=()=>_(b,A);In(b,f),b._enterCancelled?(In(b,m),Od()):(Od(),In(b,m)),Pd(()=>{b._isLeaving&&(Ps(b,f),In(b,y),kd(R)||Rd(b,s,S,de))}),ks(R,[b,de])},onEnterCancelled(b){v(b,!1,void 0,!0),ks(V,[b])},onAppearCancelled(b){v(b,!0,void 0,!0),ks(E,[b])},onLeaveCancelled(b){_(b),ks(H,[b])}})}function V_(t){if(t==null)return null;if(it(t))return[il(t.enter),il(t.leave)];{const e=il(t);return[e,e]}}function il(t){return xv(t)}function In(t,e){e.split(/\s+/).forEach(n=>n&&t.classList.add(n)),(t[yr]||(t[yr]=new Set)).add(e)}function Ps(t,e){e.split(/\s+/).forEach(s=>s&&t.classList.remove(s));const n=t[yr];n&&(n.delete(e),n.size||(t[yr]=void 0))}function Pd(t){requestAnimationFrame(()=>{requestAnimationFrame(t)})}let F_=0;function Rd(t,e,n,s){const i=t._endId=++F_,r=()=>{i===t._endId&&s()};if(n!=null)return setTimeout(r,n);const{type:o,timeout:l,propCount:c}=$_(t,e);if(!o)return s();const u=o+"end";let h=0;const f=()=>{t.removeEventListener(u,m),r()},m=y=>{y.target===t&&++h>=c&&f()};setTimeout(()=>{h<c&&f()},l+1),t.addEventListener(u,m)}function $_(t,e){const n=window.getComputedStyle(t),s=C=>(n[C]||"").split(", "),i=s(`${Kn}Delay`),r=s(`${Kn}Duration`),o=Dd(i,r),l=s(`${qi}Delay`),c=s(`${qi}Duration`),u=Dd(l,c);let h=null,f=0,m=0;e===Kn?o>0&&(h=Kn,f=o,m=r.length):e===qi?u>0&&(h=qi,f=u,m=c.length):(f=Math.max(o,u),h=f>0?o>u?Kn:qi:null,m=h?h===Kn?r.length:c.length:0);const y=h===Kn&&/\b(transform|all)(,|$)/.test(s(`${Kn}Property`).toString());return{type:h,timeout:f,propCount:m,hasTransform:y}}function Dd(t,e){for(;t.length<e.length;)t=t.concat(t);return Math.max(...e.map((n,s)=>Md(n)+Md(t[s])))}function Md(t){return t==="auto"?0:Number(t.slice(0,-1).replace(",","."))*1e3}function Od(){return document.body.offsetHeight}function L_(t,e,n){const s=t[yr];s&&(e=(e?[e,...s]:[...s]).join(" ")),e==null?t.removeAttribute("class"):n?t.setAttribute("class",e):t.className=e}const Nd=Symbol("_vod"),B_=Symbol("_vsh"),U_=Symbol(""),H_=/(^|;)\s*display\s*:/;function j_(t,e,n){const s=t.style,i=pt(n);let r=!1;if(n&&!i){if(e)if(pt(e))for(const o of e.split(";")){const l=o.slice(0,o.indexOf(":")).trim();n[l]==null&&go(s,l,"")}else for(const o in e)n[o]==null&&go(s,o,"");for(const o in n)o==="display"&&(r=!0),go(s,o,n[o])}else if(i){if(e!==n){const o=s[U_];o&&(n+=";"+o),s.cssText=n,r=H_.test(n)}}else e&&t.removeAttribute("style");Nd in t&&(t[Nd]=r?s.display:"",t[B_]&&(s.display="none"))}const xd=/\s*!important$/;function go(t,e,n){if(Ce(n))n.forEach(s=>go(t,e,s));else if(n==null&&(n=""),e.startsWith("--"))t.setProperty(e,n);else{const s=K_(t,e);xd.test(n)?t.setProperty(vs(s),n.replace(xd,""),"important"):t[s]=n}}const Vd=["Webkit","Moz","ms"],rl={};function K_(t,e){const n=rl[e];if(n)return n;let s=ts(e);if(s!=="filter"&&s in t)return rl[e]=s;s=Tf(s);for(let i=0;i<Vd.length;i++){const r=Vd[i]+s;if(r in t)return rl[e]=r}return e}const Fd="http://www.w3.org/1999/xlink";function $d(t,e,n,s,i,r=Uv(e)){s&&e.startsWith("xlink:")?n==null?t.removeAttributeNS(Fd,e.slice(6,e.length)):t.setAttributeNS(Fd,e,n):n==null||r&&!wf(n)?t.removeAttribute(e):t.setAttribute(e,r?"":ms(n)?String(n):n)}function Ld(t,e,n,s,i){if(e==="innerHTML"||e==="textContent"){n!=null&&(t[e]=e==="innerHTML"?Cp(n):n);return}const r=t.tagName;if(e==="value"&&r!=="PROGRESS"&&!r.includes("-")){const l=r==="OPTION"?t.getAttribute("value")||"":t.value,c=n==null?t.type==="checkbox"?"on":"":String(n);(l!==c||!("_value"in t))&&(t.value=c),n==null&&t.removeAttribute(e),t._value=n;return}let o=!1;if(n===""||n==null){const l=typeof t[e];l==="boolean"?n=wf(n):n==null&&l==="string"?(n="",o=!0):l==="number"&&(n=0,o=!0)}try{t[e]=n}catch{}o&&t.removeAttribute(i||e)}function ai(t,e,n,s){t.addEventListener(e,n,s)}function q_(t,e,n,s){t.removeEventListener(e,n,s)}const Bd=Symbol("_vei");function G_(t,e,n,s,i=null){const r=t[Bd]||(t[Bd]={}),o=r[e];if(s&&o)o.value=s;else{const[l,c]=W_(e);if(s){const u=r[e]=Q_(s,i);ai(t,l,u,c)}else o&&(q_(t,l,o,c),r[e]=void 0)}}const Ud=/(?:Once|Passive|Capture)$/;function W_(t){let e;if(Ud.test(t)){e={};let s;for(;s=t.match(Ud);)t=t.slice(0,t.length-s[0].length),e[s[0].toLowerCase()]=!0}return[t[2]===":"?t.slice(3):vs(t.slice(2)),e]}let ol=0;const z_=Promise.resolve(),Y_=()=>ol||(z_.then(()=>ol=0),ol=Date.now());function Q_(t,e){const n=s=>{if(!s._vts)s._vts=Date.now();else if(s._vts<=n.attached)return;un(X_(s,n.value),e,5,[s])};return n.value=t,n.attached=Y_(),n}function X_(t,e){if(Ce(e)){const n=t.stopImmediatePropagation;return t.stopImmediatePropagation=()=>{n.call(t),t._stopped=!0},e.map(s=>i=>!i._stopped&&s&&s(i))}else return e}const Hd=t=>t.charCodeAt(0)===111&&t.charCodeAt(1)===110&&t.charCodeAt(2)>96&&t.charCodeAt(2)<123,J_=(t,e,n,s,i,r)=>{const o=i==="svg";e==="class"?L_(t,s,o):e==="style"?j_(t,n,s):zo(e)?dc(e)||G_(t,e,n,s,r):(e[0]==="."?(e=e.slice(1),!0):e[0]==="^"?(e=e.slice(1),!1):Z_(t,e,s,o))?(Ld(t,e,s),!t.tagName.includes("-")&&(e==="value"||e==="checked"||e==="selected")&&$d(t,e,s,o,r,e!=="value")):t._isVueCE&&(/[A-Z]/.test(e)||!pt(s))?Ld(t,ts(e),s,r,e):(e==="true-value"?t._trueValue=s:e==="false-value"&&(t._falseValue=s),$d(t,e,s,o))};function Z_(t,e,n,s){if(s)return!!(e==="innerHTML"||e==="textContent"||e in t&&Hd(e)&&Ne(n));if(e==="spellcheck"||e==="draggable"||e==="translate"||e==="form"||e==="list"&&t.tagName==="INPUT"||e==="type"&&t.tagName==="TEXTAREA")return!1;if(e==="width"||e==="height"){const i=t.tagName;if(i==="IMG"||i==="VIDEO"||i==="CANVAS"||i==="SOURCE")return!1}return Hd(e)&&pt(n)?!1:e in t}const jd=t=>{const e=t.props["onUpdate:modelValue"]||!1;return Ce(e)?n=>ho(e,n):e};function e0(t){t.target.composing=!0}function Kd(t){const e=t.target;e.composing&&(e.composing=!1,e.dispatchEvent(new Event("input")))}const al=Symbol("_assign"),t0={created(t,{modifiers:{lazy:e,trim:n,number:s}},i){t[al]=jd(i);const r=s||i.props&&i.props.type==="number";ai(t,e?"change":"input",o=>{if(o.target.composing)return;let l=t.value;n&&(l=l.trim()),r&&(l=wl(l)),t[al](l)}),n&&ai(t,"change",()=>{t.value=t.value.trim()}),e||(ai(t,"compositionstart",e0),ai(t,"compositionend",Kd),ai(t,"change",Kd))},mounted(t,{value:e}){t.value=e??""},beforeUpdate(t,{value:e,oldValue:n,modifiers:{lazy:s,trim:i,number:r}},o){if(t[al]=jd(o),t.composing)return;const l=(r||t.type==="number")&&!/^0\d/.test(t.value)?wl(t.value):t.value,c=e??"";l!==c&&(document.activeElement===t&&t.type!=="range"&&(s&&e===n||i&&t.value.trim()===c)||(t.value=c))}},n0=["ctrl","shift","alt","meta"],s0={stop:t=>t.stopPropagation(),prevent:t=>t.preventDefault(),self:t=>t.target!==t.currentTarget,ctrl:t=>!t.ctrlKey,shift:t=>!t.shiftKey,alt:t=>!t.altKey,meta:t=>!t.metaKey,left:t=>"button"in t&&t.button!==0,middle:t=>"button"in t&&t.button!==1,right:t=>"button"in t&&t.button!==2,exact:(t,e)=>n0.some(n=>t[`${n}Key`]&&!e.includes(n))},sr=(t,e)=>{const n=t._withMods||(t._withMods={}),s=e.join(".");return n[s]||(n[s]=(i,...r)=>{for(let o=0;o<e.length;o++){const l=s0[e[o]];if(l&&l(i,e))return}return t(i,...r)})},i0={esc:"escape",space:" ",up:"arrow-up",left:"arrow-left",right:"arrow-right",down:"arrow-down",delete:"backspace"},r0=(t,e)=>{const n=t._withKeys||(t._withKeys={}),s=e.join(".");return n[s]||(n[s]=i=>{if(!("key"in i))return;const r=vs(i.key);if(e.some(o=>o===r||i0[o]===r))return t(i)})},o0=kt({patchProp:J_},D_);let qd;function a0(){return qd||(qd=e_(o0))}const l0=(...t)=>{const e=a0().createApp(...t),{mount:n}=e;return e.mount=s=>{const i=u0(s);if(!i)return;const r=e._component;!Ne(r)&&!r.render&&!r.template&&(r.template=i.innerHTML),i.nodeType===1&&(i.textContent="");const o=n(i,!1,c0(i));return i instanceof Element&&(i.removeAttribute("v-cloak"),i.setAttribute("data-v-app","")),o},e};function c0(t){if(t instanceof SVGElement)return"svg";if(typeof MathMLElement=="function"&&t instanceof MathMLElement)return"mathml"}function u0(t){return pt(t)?document.querySelector(t):t}/*!
 * pinia v3.0.1
 * (c) 2025 Eduardo San Martin Morote
 * @license MIT
 */let Pp;const ra=t=>Pp=t,Rp=Symbol();function xl(t){return t&&typeof t=="object"&&Object.prototype.toString.call(t)==="[object Object]"&&typeof t.toJSON!="function"}var ir;(function(t){t.direct="direct",t.patchObject="patch object",t.patchFunction="patch function"})(ir||(ir={}));function d0(){const t=Cf(!0),e=t.run(()=>ue({}));let n=[],s=[];const i=Tc({install(r){ra(i),i._a=r,r.provide(Rp,i),r.config.globalProperties.$pinia=i,s.forEach(o=>n.push(o)),s=[]},use(r){return this._a?n.push(r):s.push(r),this},_p:n,_a:null,_e:t,_s:new Map,state:e});return i}const Dp=()=>{};function Gd(t,e,n,s=Dp){t.push(e);const i=()=>{const r=t.indexOf(e);r>-1&&(t.splice(r,1),s())};return!n&&kf()&&Hv(i),i}function ri(t,...e){t.slice().forEach(n=>{n(...e)})}const h0=t=>t(),Wd=Symbol(),ll=Symbol();function Vl(t,e){t instanceof Map&&e instanceof Map?e.forEach((n,s)=>t.set(s,n)):t instanceof Set&&e instanceof Set&&e.forEach(t.add,t);for(const n in e){if(!e.hasOwnProperty(n))continue;const s=e[n],i=t[n];xl(i)&&xl(s)&&t.hasOwnProperty(n)&&!ht(s)&&!Xn(s)?t[n]=Vl(i,s):t[n]=s}return t}const f0=Symbol();function p0(t){return!xl(t)||!t.hasOwnProperty(f0)}const{assign:qn}=Object;function g0(t){return!!(ht(t)&&t.effect)}function m0(t,e,n,s){const{state:i,actions:r,getters:o}=e,l=n.state.value[t];let c;function u(){l||(n.state.value[t]=i?i():{});const h=hy(n.state.value[t]);return qn(h,r,Object.keys(o||{}).reduce((f,m)=>(f[m]=Tc(Le(()=>{ra(n);const y=n._s.get(t);return o[m].call(y,y)})),f),{}))}return c=Mp(t,u,e,n,s,!0),c}function Mp(t,e,n={},s,i,r){let o;const l=qn({actions:{}},n),c={deep:!0};let u,h,f=[],m=[],y;const C=s.state.value[t];!r&&!C&&(s.state.value[t]={}),ue({});let D;function S(E){let v;u=h=!1,typeof E=="function"?(E(s.state.value[t]),v={type:ir.patchFunction,storeId:t,events:y}):(Vl(s.state.value[t],E),v={type:ir.patchObject,payload:E,storeId:t,events:y});const _=D=Symbol();bc().then(()=>{D===_&&(u=!0)}),h=!0,ri(f,v,s.state.value[t])}const M=r?function(){const{state:v}=n,_=v?v():{};this.$patch(T=>{qn(T,_)})}:Dp;function P(){o.stop(),f=[],m=[],s._s.delete(t)}const V=(E,v="")=>{if(Wd in E)return E[ll]=v,E;const _=function(){ra(s);const T=Array.from(arguments),b=[],A=[];function de(G){b.push(G)}function W(G){A.push(G)}ri(m,{args:T,name:_[ll],store:H,after:de,onError:W});let q;try{q=E.apply(this&&this.$id===t?this:H,T)}catch(G){throw ri(A,G),G}return q instanceof Promise?q.then(G=>(ri(b,G),G)).catch(G=>(ri(A,G),Promise.reject(G))):(ri(b,q),q)};return _[Wd]=!0,_[ll]=v,_},R={_p:s,$id:t,$onAction:Gd.bind(null,m),$patch:S,$reset:M,$subscribe(E,v={}){const _=Gd(f,E,v.detached,()=>T()),T=o.run(()=>on(()=>s.state.value[t],b=>{(v.flush==="sync"?h:u)&&E({storeId:t,type:ir.direct,events:y},b)},qn({},c,v)));return _},$dispose:P},H=vi(R);s._s.set(t,H);const I=(s._a&&s._a.runWithContext||h0)(()=>s._e.run(()=>(o=Cf()).run(()=>e({action:V}))));for(const E in I){const v=I[E];if(ht(v)&&!g0(v)||Xn(v))r||(C&&p0(v)&&(ht(v)?v.value=C[E]:Vl(v,C[E])),s.state.value[t][E]=v);else if(typeof v=="function"){const _=V(v,E);I[E]=_,l.actions[E]=v}}return qn(H,I),qn(qe(H),I),Object.defineProperty(H,"$state",{get:()=>s.state.value[t],set:E=>{S(v=>{qn(v,E)})}}),s._p.forEach(E=>{qn(H,o.run(()=>E({store:H,app:s._a,pinia:s,options:l})))}),C&&r&&n.hydrate&&n.hydrate(H.$state,C),u=!0,h=!0,H}/*! #__NO_SIDE_EFFECTS__ */function Dr(t,e,n){let s;const i=typeof e=="function";s=i?n:e;function r(o,l){const c=Wy();return o=o||(c?tr(Rp,null):null),o&&ra(o),o=Pp,o._s.has(t)||(i?Mp(t,e,s,o):m0(t,s,o)),o._s.get(t)}return r.$id=t,r}const v0="/assets/muaythai_idle-C42uzgBq.webp",y0="modulepreload",_0=function(t){return"/"+t},zd={},St=function(e,n,s){let i=Promise.resolve();if(n&&n.length>0){document.getElementsByTagName("link");const o=document.querySelector("meta[property=csp-nonce]"),l=(o==null?void 0:o.nonce)||(o==null?void 0:o.getAttribute("nonce"));i=Promise.allSettled(n.map(c=>{if(c=_0(c),c in zd)return;zd[c]=!0;const u=c.endsWith(".css"),h=u?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${c}"]${h}`))return;const f=document.createElement("link");if(f.rel=u?"stylesheet":y0,u||(f.as="script"),f.crossOrigin="",f.href=c,l&&f.setAttribute("nonce",l),document.head.appendChild(f),u)return new Promise((m,y)=>{f.addEventListener("load",m),f.addEventListener("error",()=>y(new Error(`Unable to preload CSS for ${c}`)))})}))}function r(o){const l=new Event("vite:preloadError",{cancelable:!0});if(l.payload=o,window.dispatchEvent(l),!l.defaultPrevented)throw o}return i.then(o=>{for(const l of o||[])l.status==="rejected"&&r(l.reason);return e().catch(r)})},mo=[{name:"Quick Jab",description:"Fast but weak attack boost.",strength:4,agility:4,endurance:0,cost:15,tier:"Small"},{name:"Low Kick",description:"Minor damage but slows opponent slightly.",strength:6,agility:-2,endurance:0,cost:15,tier:"Small"},{name:"Sharp Elbow",description:"Small attack boost, slightly lowers agility.",strength:5,agility:-2,endurance:0,cost:15,tier:"Small"},{name:"Knee Guard",description:"Adds minor defense but reduces attack.",strength:-4,agility:0,endurance:8,cost:15,tier:"Small"},{name:"Side Step",description:"Improves dodging ability slightly.",strength:-2,agility:8,endurance:0,cost:15,tier:"Small"},{name:"Flying Knee",description:"High damage but reduces agility.",strength:12,agility:-8,endurance:0,cost:20,tier:"Medium"},{name:"Elusive Dodge",description:"High evasion boost, minor attack loss.",strength:-4,agility:15,endurance:0,cost:20,tier:"Medium"},{name:"Iron Chin",description:"Increased defense, slower movement.",strength:0,agility:-8,endurance:15,cost:20,tier:"Medium"},{name:"Spinning Kick",description:"High damage but loses endurance.",strength:12,agility:4,endurance:-8,cost:20,tier:"Medium"},{name:"Leg Sweep",description:"Trips opponent, making them slower.",strength:8,agility:-4,endurance:0,cost:20,tier:"Medium"},{name:"Counter Hook",description:"Deals high damage after dodging.",strength:8,agility:8,endurance:-4,cost:25,tier:"Big"},{name:"Tiger Step",description:"Makes fighter extremely fast.",strength:-4,agility:15,endurance:-4,cost:25,tier:"Big"},{name:"Footwork Mastery",description:"Extreme speed boost, weakens attack.",strength:-8,agility:15,endurance:0,cost:25,tier:"Big"},{name:"Steel Guard",description:"Max defense but reduces speed.",strength:-8,agility:-8,endurance:15,cost:25,tier:"Big"},{name:"Turtle Shell",description:"High defense but makes player slow.",strength:-8,agility:-8,endurance:15,cost:25,tier:"Big"},{name:"Power Elbow",description:"Moderate attack boost, minor endurance drain.",strength:12,agility:0,endurance:-4,cost:25,tier:"Big"},{name:"Muay Thai Fury",description:"High-risk, high-reward damage boost.",strength:15,agility:8,endurance:-8,cost:30,tier:"Ultimate"},{name:"Zen Focus",description:"Balanced agility & endurance boost.",strength:0,agility:15,endurance:15,cost:30,tier:"Ultimate"},{name:"Lightning Reflex",description:"Insane agility boost but loses endurance.",strength:0,agility:15,endurance:-8,cost:30,tier:"Ultimate"},{name:"Endless Stamina",description:"Max endurance boost, minor agility loss.",strength:0,agility:-4,endurance:15,cost:30,tier:"Ultimate"},{name:"Dragon Kick",description:"Powerful kick, slightly reduces speed.",strength:15,agility:-4,endurance:0,cost:30,tier:"Ultimate"},{name:"Heavenly Guard",description:"Blocks strong attacks with high endurance.",strength:-4,agility:-4,endurance:15,cost:30,tier:"Ultimate"},{name:"Phantom Strike",description:"Blazing fast but weak strikes.",strength:8,agility:15,endurance:-4,cost:30,tier:"Ultimate"},{name:"Titan's Grip",description:"Enhances clinch power, slightly reduces agility.",strength:15,agility:-4,endurance:0,cost:30,tier:"Ultimate"},{name:"Warrior's Endurance",description:"Maximizes endurance, slightly lowers attack.",strength:-4,agility:0,endurance:15,cost:30,tier:"Ultimate"}],Ro="muayThaiIdleFightSecretKey20250311";function Op(t){try{const e=JSON.stringify(t);let n="";for(let s=0;s<e.length;s++){const i=e.charCodeAt(s)^Ro.charCodeAt(s%Ro.length);n+=String.fromCharCode(i)}return btoa(n)}catch(e){return console.error("Error encrypting data:",e),JSON.stringify(t)}}function Np(t){try{if(!t.match(/^[a-zA-Z0-9+/]*={0,2}$/))return JSON.parse(t);const e=atob(t);let n="";for(let s=0;s<e.length;s++){const i=e.charCodeAt(s)^Ro.charCodeAt(s%Ro.length);n+=String.fromCharCode(i)}return JSON.parse(n)}catch(e){return console.error("Error decrypting data:",e),null}}const Yd=Object.freeze(Object.defineProperty({__proto__:null,decryptData:Np,encryptData:Op},Symbol.toStringTag,{value:"Module"})),E0=t=>{if(typeof t!="object")return t;let e=0;const n=JSON.stringify(t);for(let s=0;s<n.length;s++){const i=n.charCodeAt(s);e=(e<<5)-e+i,e=e&e}return{...t,_integrity:e.toString(36)}},T0=t=>{if(!t||typeof t!="object"||!t._integrity)return!1;const{_integrity:e,...n}=t;let s=0;const i=JSON.stringify(n);for(let r=0;r<i.length;r++){const o=i.charCodeAt(r);s=(s<<5)-s+o,s=s&s}return e===s.toString(36)},Do=t=>Array.from(t).reverse().join("")+"."+t;function oa(t,e){try{const n=E0(e),s=Op(n),i=Do(`muayThai_${t}`);localStorage.setItem(i,s)}catch(n){console.error(`Error saving game data for ${t}:`,n)}}function Cc(t){try{const e=localStorage.getItem(`muayThai_${t}`);if(e)try{const l=JSON.parse(e);return oa(t,l),localStorage.removeItem(`muayThai_${t}`),l}catch{}const n=Do(`muayThai_${t}`),s=localStorage.getItem(n);if(!s)return null;const i=Np(s);if(!T0(i))return console.warn(`Integrity check failed for ${t}. Data may have been tampered with.`),null;const{_integrity:r,...o}=i;return o}catch(e){return console.error(`Error loading game data for ${t}:`,e),null}}function b0(){try{const t=Object.keys(localStorage);for(const s of t)s.startsWith("muayThai_")&&localStorage.removeItem(s),s.includes(".muayThai_")&&localStorage.removeItem(s);const e=["playerID","playerNickname","pendingTraining"];for(const s of e)localStorage.removeItem(s),localStorage.removeItem(Do(s));const n=["lastLeaderboardSync","lastReportedPower"];for(const s of n)localStorage.removeItem(s),localStorage.removeItem(Do(s));console.log("All game data cleared from localStorage")}catch(t){console.error("Error clearing game data:",t)}}const w0=()=>{};var Qd={};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const xp=function(t){const e=[];let n=0;for(let s=0;s<t.length;s++){let i=t.charCodeAt(s);i<128?e[n++]=i:i<2048?(e[n++]=i>>6|192,e[n++]=i&63|128):(i&64512)===55296&&s+1<t.length&&(t.charCodeAt(s+1)&64512)===56320?(i=65536+((i&1023)<<10)+(t.charCodeAt(++s)&1023),e[n++]=i>>18|240,e[n++]=i>>12&63|128,e[n++]=i>>6&63|128,e[n++]=i&63|128):(e[n++]=i>>12|224,e[n++]=i>>6&63|128,e[n++]=i&63|128)}return e},A0=function(t){const e=[];let n=0,s=0;for(;n<t.length;){const i=t[n++];if(i<128)e[s++]=String.fromCharCode(i);else if(i>191&&i<224){const r=t[n++];e[s++]=String.fromCharCode((i&31)<<6|r&63)}else if(i>239&&i<365){const r=t[n++],o=t[n++],l=t[n++],c=((i&7)<<18|(r&63)<<12|(o&63)<<6|l&63)-65536;e[s++]=String.fromCharCode(55296+(c>>10)),e[s++]=String.fromCharCode(56320+(c&1023))}else{const r=t[n++],o=t[n++];e[s++]=String.fromCharCode((i&15)<<12|(r&63)<<6|o&63)}}return e.join("")},Vp={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(t,e){if(!Array.isArray(t))throw Error("encodeByteArray takes an array as a parameter");this.init_();const n=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,s=[];for(let i=0;i<t.length;i+=3){const r=t[i],o=i+1<t.length,l=o?t[i+1]:0,c=i+2<t.length,u=c?t[i+2]:0,h=r>>2,f=(r&3)<<4|l>>4;let m=(l&15)<<2|u>>6,y=u&63;c||(y=64,o||(m=64)),s.push(n[h],n[f],n[m],n[y])}return s.join("")},encodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(t):this.encodeByteArray(xp(t),e)},decodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(t):A0(this.decodeStringToByteArray(t,e))},decodeStringToByteArray(t,e){this.init_();const n=e?this.charToByteMapWebSafe_:this.charToByteMap_,s=[];for(let i=0;i<t.length;){const r=n[t.charAt(i++)],l=i<t.length?n[t.charAt(i)]:0;++i;const u=i<t.length?n[t.charAt(i)]:64;++i;const f=i<t.length?n[t.charAt(i)]:64;if(++i,r==null||l==null||u==null||f==null)throw new I0;const m=r<<2|l>>4;if(s.push(m),u!==64){const y=l<<4&240|u>>2;if(s.push(y),f!==64){const C=u<<6&192|f;s.push(C)}}}return s},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let t=0;t<this.ENCODED_VALS.length;t++)this.byteToCharMap_[t]=this.ENCODED_VALS.charAt(t),this.charToByteMap_[this.byteToCharMap_[t]]=t,this.byteToCharMapWebSafe_[t]=this.ENCODED_VALS_WEBSAFE.charAt(t),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[t]]=t,t>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(t)]=t,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(t)]=t)}}};class I0 extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const S0=function(t){const e=xp(t);return Vp.encodeByteArray(e,!0)},Mo=function(t){return S0(t).replace(/\./g,"")},C0=function(t){try{return Vp.decodeString(t,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function k0(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const P0=()=>k0().__FIREBASE_DEFAULTS__,R0=()=>{if(typeof process>"u"||typeof Qd>"u")return;const t=Qd.__FIREBASE_DEFAULTS__;if(t)return JSON.parse(t)},D0=()=>{if(typeof document>"u")return;let t;try{t=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=t&&C0(t[1]);return e&&JSON.parse(e)},kc=()=>{try{return w0()||P0()||R0()||D0()}catch(t){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${t}`);return}},M0=t=>{var e,n;return(n=(e=kc())===null||e===void 0?void 0:e.emulatorHosts)===null||n===void 0?void 0:n[t]},O0=t=>{const e=M0(t);if(!e)return;const n=e.lastIndexOf(":");if(n<=0||n+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);const s=parseInt(e.substring(n+1),10);return e[0]==="["?[e.substring(1,n-1),s]:[e.substring(0,n),s]},Fp=()=>{var t;return(t=kc())===null||t===void 0?void 0:t.config};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class N0{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,n)=>{this.resolve=e,this.reject=n})}wrapCallback(e){return(n,s)=>{n?this.reject(n):this.resolve(s),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(n):e(n,s))}}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function x0(t,e){if(t.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const n={alg:"none",type:"JWT"},s=e||"demo-project",i=t.iat||0,r=t.sub||t.user_id;if(!r)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const o=Object.assign({iss:`https://secuabcderetoken.goaebd233ogle.com/${s}`,aud:s,iat:i,exp:i+3600,auth_time:i,sub:r,user_id:r,firebase:{sign_in_provider:"custom",identities:{}}},t);return[Mo(JSON.stringify(n)),Mo(JSON.stringify(o)),""].join(".")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function V0(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function F0(){var t;const e=(t=kc())===null||t===void 0?void 0:t.forceEnvironment;if(e==="node")return!0;if(e==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function $0(){const t=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof t=="object"&&t.id!==void 0}function L0(){return!F0()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function $p(){try{return typeof indexedDB=="object"}catch{return!1}}function Lp(){return new Promise((t,e)=>{try{let n=!0;const s="validate-browser-context-for-indexeddb-analytics-module",i=self.indexedDB.open(s);i.onsuccess=()=>{i.result.close(),n||self.indexedDB.deleteDatabase(s),t(!0)},i.onupgradeneeded=()=>{n=!1},i.onerror=()=>{var r;e(((r=i.error)===null||r===void 0?void 0:r.message)||"")}}catch(n){e(n)}})}function B0(){return!(typeof navigator>"u"||!navigator.cookieEnabled)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const U0="FirebaseError";class Es extends Error{constructor(e,n,s){super(n),this.code=e,this.customData=s,this.name=U0,Object.setPrototypeOf(this,Es.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,aa.prototype.create)}}class aa{constructor(e,n,s){this.service=e,this.serviceName=n,this.errors=s}create(e,...n){const s=n[0]||{},i=`${this.service}/${e}`,r=this.errors[e],o=r?H0(r,s):"Error",l=`${this.serviceName}: ${o} (${i}).`;return new Es(i,l,s)}}function H0(t,e){return t.replace(j0,(n,s)=>{const i=e[s];return i!=null?String(i):`<${s}?>`})}const j0=/\{\$([^}]+)}/g;function _r(t,e){if(t===e)return!0;const n=Object.keys(t),s=Object.keys(e);for(const i of n){if(!s.includes(i))return!1;const r=t[i],o=e[i];if(Xd(r)&&Xd(o)){if(!_r(r,o))return!1}else if(r!==o)return!1}for(const i of s)if(!n.includes(i))return!1;return!0}function Xd(t){return t!==null&&typeof t=="object"}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const K0=1e3,q0=2,G0=4*60*60*1e3,W0=.5;function Jd(t,e=K0,n=q0){const s=e*Math.pow(n,t),i=Math.round(W0*s*(Math.random()-.5)*2);return Math.min(G0,s+i)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function rs(t){return t&&t._delegate?t._delegate:t}class On{constructor(e,n,s){this.name=e,this.instanceFactory=n,this.type=s,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ds="[DEFAULT]";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class z0{constructor(e,n){this.name=e,this.container=n,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const n=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(n)){const s=new N0;if(this.instancesDeferred.set(n,s),this.isInitialized(n)||this.shouldAutoInitialize())try{const i=this.getOrInitializeService({instanceIdentifier:n});i&&s.resolve(i)}catch{}}return this.instancesDeferred.get(n).promise}getImmediate(e){var n;const s=this.normalizeInstanceIdentifier(e==null?void 0:e.identifier),i=(n=e==null?void 0:e.optional)!==null&&n!==void 0?n:!1;if(this.isInitialized(s)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:s})}catch(r){if(i)return null;throw r}else{if(i)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(Q0(e))try{this.getOrInitializeService({instanceIdentifier:Ds})}catch{}for(const[n,s]of this.instancesDeferred.entries()){const i=this.normalizeInstanceIdentifier(n);try{const r=this.getOrInitializeService({instanceIdentifier:i});s.resolve(r)}catch{}}}}clearInstance(e=Ds){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(n=>"INTERNAL"in n).map(n=>n.INTERNAL.delete()),...e.filter(n=>"_delete"in n).map(n=>n._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=Ds){return this.instances.has(e)}getOptions(e=Ds){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:n={}}=e,s=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(s))throw Error(`${this.name}(${s}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const i=this.getOrInitializeService({instanceIdentifier:s,options:n});for(const[r,o]of this.instancesDeferred.entries()){const l=this.normalizeInstanceIdentifier(r);s===l&&o.resolve(i)}return i}onInit(e,n){var s;const i=this.normalizeInstanceIdentifier(n),r=(s=this.onInitCallbacks.get(i))!==null&&s!==void 0?s:new Set;r.add(e),this.onInitCallbacks.set(i,r);const o=this.instances.get(i);return o&&e(o,i),()=>{r.delete(e)}}invokeOnInitCallbacks(e,n){const s=this.onInitCallbacks.get(n);if(s)for(const i of s)try{i(e,n)}catch{}}getOrInitializeService({instanceIdentifier:e,options:n={}}){let s=this.instances.get(e);if(!s&&this.component&&(s=this.component.instanceFactory(this.container,{instanceIdentifier:Y0(e),options:n}),this.instances.set(e,s),this.instancesOptions.set(e,n),this.invokeOnInitCallbacks(s,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,s)}catch{}return s||null}normalizeInstanceIdentifier(e=Ds){return this.component?this.component.multipleInstances?e:Ds:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function Y0(t){return t===Ds?void 0:t}function Q0(t){return t.instantiationMode==="EAGER"}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class X0{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const n=this.getProvider(e.name);if(n.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);n.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const n=new z0(e,this);return this.providers.set(e,n),n}getProviders(){return Array.from(this.providers.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Ke;(function(t){t[t.DEBUG=0]="DEBUG",t[t.VERBOSE=1]="VERBOSE",t[t.INFO=2]="INFO",t[t.WARN=3]="WARN",t[t.ERROR=4]="ERROR",t[t.SILENT=5]="SILENT"})(Ke||(Ke={}));const J0={debug:Ke.DEBUG,verbose:Ke.VERBOSE,info:Ke.INFO,warn:Ke.WARN,error:Ke.ERROR,silent:Ke.SILENT},Z0=Ke.INFO,eE={[Ke.DEBUG]:"log",[Ke.VERBOSE]:"log",[Ke.INFO]:"info",[Ke.WARN]:"warn",[Ke.ERROR]:"error"},tE=(t,e,...n)=>{if(e<t.logLevel)return;const s=new Date().toISOString(),i=eE[e];if(i)console[i](`[${s}]  ${t.name}:`,...n);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};class Pc{constructor(e){this.name=e,this._logLevel=Z0,this._logHandler=tE,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in Ke))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?J0[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,Ke.DEBUG,...e),this._logHandler(this,Ke.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,Ke.VERBOSE,...e),this._logHandler(this,Ke.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,Ke.INFO,...e),this._logHandler(this,Ke.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,Ke.WARN,...e),this._logHandler(this,Ke.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,Ke.ERROR,...e),this._logHandler(this,Ke.ERROR,...e)}}const nE=(t,e)=>e.some(n=>t instanceof n);let Zd,eh;function sE(){return Zd||(Zd=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function iE(){return eh||(eh=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const Bp=new WeakMap,Fl=new WeakMap,Up=new WeakMap,cl=new WeakMap,Rc=new WeakMap;function rE(t){const e=new Promise((n,s)=>{const i=()=>{t.removeEventListener("success",r),t.removeEventListener("error",o)},r=()=>{n(Jn(t.result)),i()},o=()=>{s(t.error),i()};t.addEventListener("success",r),t.addEventListener("error",o)});return e.then(n=>{n instanceof IDBCursor&&Bp.set(n,t)}).catch(()=>{}),Rc.set(e,t),e}function oE(t){if(Fl.has(t))return;const e=new Promise((n,s)=>{const i=()=>{t.removeEventListener("complete",r),t.removeEventListener("error",o),t.removeEventListener("abort",o)},r=()=>{n(),i()},o=()=>{s(t.error||new DOMException("AbortError","AbortError")),i()};t.addEventListener("complete",r),t.addEventListener("error",o),t.addEventListener("abort",o)});Fl.set(t,e)}let $l={get(t,e,n){if(t instanceof IDBTransaction){if(e==="done")return Fl.get(t);if(e==="objectStoreNames")return t.objectStoreNames||Up.get(t);if(e==="store")return n.objectStoreNames[1]?void 0:n.objectStore(n.objectStoreNames[0])}return Jn(t[e])},set(t,e,n){return t[e]=n,!0},has(t,e){return t instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in t}};function aE(t){$l=t($l)}function lE(t){return t===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...n){const s=t.call(ul(this),e,...n);return Up.set(s,e.sort?e.sort():[e]),Jn(s)}:iE().includes(t)?function(...e){return t.apply(ul(this),e),Jn(Bp.get(this))}:function(...e){return Jn(t.apply(ul(this),e))}}function cE(t){return typeof t=="function"?lE(t):(t instanceof IDBTransaction&&oE(t),nE(t,sE())?new Proxy(t,$l):t)}function Jn(t){if(t instanceof IDBRequest)return rE(t);if(cl.has(t))return cl.get(t);const e=cE(t);return e!==t&&(cl.set(t,e),Rc.set(e,t)),e}const ul=t=>Rc.get(t);function Hp(t,e,{blocked:n,upgrade:s,blocking:i,terminated:r}={}){const o=indexedDB.open(t,e),l=Jn(o);return s&&o.addEventListener("upgradeneeded",c=>{s(Jn(o.result),c.oldVersion,c.newVersion,Jn(o.transaction),c)}),n&&o.addEventListener("blocked",c=>n(c.oldVersion,c.newVersion,c)),l.then(c=>{r&&c.addEventListener("close",()=>r()),i&&c.addEventListener("versionchange",u=>i(u.oldVersion,u.newVersion,u))}).catch(()=>{}),l}const uE=["get","getKey","getAll","getAllKeys","count"],dE=["put","add","delete","clear"],dl=new Map;function th(t,e){if(!(t instanceof IDBDatabase&&!(e in t)&&typeof e=="string"))return;if(dl.get(e))return dl.get(e);const n=e.replace(/FromIndex$/,""),s=e!==n,i=dE.includes(n);if(!(n in(s?IDBIndex:IDBObjectStore).prototype)||!(i||uE.includes(n)))return;const r=async function(o,...l){const c=this.transaction(o,i?"readwrite":"readonly");let u=c.store;return s&&(u=u.index(l.shift())),(await Promise.all([u[n](...l),i&&c.done]))[0]};return dl.set(e,r),r}aE(t=>({...t,get:(e,n,s)=>th(e,n)||t.get(e,n,s),has:(e,n)=>!!th(e,n)||t.has(e,n)}));/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hE{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(n=>{if(fE(n)){const s=n.getImmediate();return`${s.library}/${s.version}`}else return null}).filter(n=>n).join(" ")}}function fE(t){const e=t.getComponent();return(e==null?void 0:e.type)==="VERSION"}const Ll="@firebase/app",nh="0.11.2";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Nn=new Pc("@firebase/app"),pE="@firebase/app-compat",gE="@firebase/analytics-compat",mE="@firebase/analytics",vE="@firebase/app-check-compat",yE="@firebase/app-check",_E="@firebase/auth",EE="@firebase/auth-compat",TE="@firebase/database",bE="@firebase/data-connect",wE="@firebase/database-compat",AE="@firebase/functions",IE="@firebase/functions-compat",SE="@firebase/installations",CE="@firebase/installations-compat",kE="@firebase/messaging",PE="@firebase/messaging-compat",RE="@firebase/performance",DE="@firebase/performance-compat",ME="@firebase/remote-config",OE="@firebase/remote-config-compat",NE="@firebase/storage",xE="@firebase/storage-compat",VE="@firebase/firestore",FE="@firebase/vertexai",$E="@firebase/firestore-compat",LE="firebase",BE="11.4.0";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Bl="[DEFAULT]",UE={[Ll]:"fire-core",[pE]:"fire-core-compat",[mE]:"fire-analytics",[gE]:"fire-analytics-compat",[yE]:"fire-app-check",[vE]:"fire-app-check-compat",[_E]:"fire-auth",[EE]:"fire-auth-compat",[TE]:"fire-rtdb",[bE]:"fire-data-connect",[wE]:"fire-rtdb-compat",[AE]:"fire-fn",[IE]:"fire-fn-compat",[SE]:"fire-iid",[CE]:"fire-iid-compat",[kE]:"fire-fcm",[PE]:"fire-fcm-compat",[RE]:"fire-perf",[DE]:"fire-perf-compat",[ME]:"fire-rc",[OE]:"fire-rc-compat",[NE]:"fire-gcs",[xE]:"fire-gcs-compat",[VE]:"fire-fst",[$E]:"fire-fst-compat",[FE]:"fire-vertex","fire-js":"fire-js",[LE]:"fire-js-all"};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Oo=new Map,HE=new Map,Ul=new Map;function sh(t,e){try{t.container.addComponent(e)}catch(n){Nn.debug(`Component ${e.name} failed to register with FirebaseApp ${t.name}`,n)}}function os(t){const e=t.name;if(Ul.has(e))return Nn.debug(`There were multiple attempts to register component ${e}.`),!1;Ul.set(e,t);for(const n of Oo.values())sh(n,t);for(const n of HE.values())sh(n,t);return!0}function Mr(t,e){const n=t.container.getProvider("heartbeat").getImmediate({optional:!0});return n&&n.triggerHeartbeat(),t.container.getProvider(e)}function jE(t){return t==null?!1:t.settings!==void 0}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const KE={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},Zn=new aa("app","Firebase",KE);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qE{constructor(e,n,s){this._isDeleted=!1,this._options=Object.assign({},e),this._config=Object.assign({},n),this._name=n.name,this._automaticDataCollectionEnabled=n.automaticDataCollectionEnabled,this._container=s,this.container.addComponent(new On("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw Zn.create("app-deleted",{appName:this._name})}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const GE=BE;function jp(t,e={}){let n=t;typeof e!="object"&&(e={name:e});const s=Object.assign({name:Bl,automaticDataCollectionEnabled:!1},e),i=s.name;if(typeof i!="string"||!i)throw Zn.create("bad-app-name",{appName:String(i)});if(n||(n=Fp()),!n)throw Zn.create("no-options");const r=Oo.get(i);if(r){if(_r(n,r.options)&&_r(s,r.config))return r;throw Zn.create("duplicate-app",{appName:i})}const o=new X0(i);for(const c of Ul.values())o.addComponent(c);const l=new qE(n,s,o);return Oo.set(i,l),l}function Kp(t=Bl){const e=Oo.get(t);if(!e&&t===Bl&&Fp())return jp();if(!e)throw Zn.create("no-app",{appName:t});return e}function vn(t,e,n){var s;let i=(s=UE[t])!==null&&s!==void 0?s:t;n&&(i+=`-${n}`);const r=i.match(/\s|\//),o=e.match(/\s|\//);if(r||o){const l=[`Unable to register library "${i}" with version "${e}":`];r&&l.push(`library name "${i}" contains illegal characters (whitespace or "/")`),r&&o&&l.push("and"),o&&l.push(`version name "${e}" contains illegal characters (whitespace or "/")`),Nn.warn(l.join(" "));return}os(new On(`${i}-version`,()=>({library:i,version:e}),"VERSION"))}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const WE="firebase-heartbeat-database",zE=1,Er="firebase-heartbeat-store";let hl=null;function qp(){return hl||(hl=Hp(WE,zE,{upgrade:(t,e)=>{switch(e){case 0:try{t.createObjectStore(Er)}catch(n){console.warn(n)}}}}).catch(t=>{throw Zn.create("idb-open",{originalErrorMessage:t.message})})),hl}async function YE(t){try{const n=(await qp()).transaction(Er),s=await n.objectStore(Er).get(Gp(t));return await n.done,s}catch(e){if(e instanceof Es)Nn.warn(e.message);else{const n=Zn.create("idb-get",{originalErrorMessage:e==null?void 0:e.message});Nn.warn(n.message)}}}async function ih(t,e){try{const s=(await qp()).transaction(Er,"readwrite");await s.objectStore(Er).put(e,Gp(t)),await s.done}catch(n){if(n instanceof Es)Nn.warn(n.message);else{const s=Zn.create("idb-set",{originalErrorMessage:n==null?void 0:n.message});Nn.warn(s.message)}}}function Gp(t){return`${t.name}!${t.options.appId}`}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const QE=1024,XE=30;class JE{constructor(e){this.container=e,this._heartbeatsCache=null;const n=this.container.getProvider("app").getImmediate();this._storage=new eT(n),this._heartbeatsCachePromise=this._storage.read().then(s=>(this._heartbeatsCache=s,s))}async triggerHeartbeat(){var e,n;try{const i=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),r=rh();if(((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,((n=this._heartbeatsCache)===null||n===void 0?void 0:n.heartbeats)==null)||this._heartbeatsCache.lastSentHeartbeatDate===r||this._heartbeatsCache.heartbeats.some(o=>o.date===r))return;if(this._heartbeatsCache.heartbeats.push({date:r,agent:i}),this._heartbeatsCache.heartbeats.length>XE){const o=tT(this._heartbeatsCache.heartbeats);this._heartbeatsCache.heartbeats.splice(o,1)}return this._storage.overwrite(this._heartbeatsCache)}catch(s){Nn.warn(s)}}async getHeartbeatsHeader(){var e;try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null||this._heartbeatsCache.heartbeats.length===0)return"";const n=rh(),{heartbeatsToSend:s,unsentEntries:i}=ZE(this._heartbeatsCache.heartbeats),r=Mo(JSON.stringify({version:2,heartbeats:s}));return this._heartbeatsCache.lastSentHeartbeatDate=n,i.length>0?(this._heartbeatsCache.heartbeats=i,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),r}catch(n){return Nn.warn(n),""}}}function rh(){return new Date().toISOString().substring(0,10)}function ZE(t,e=QE){const n=[];let s=t.slice();for(const i of t){const r=n.find(o=>o.agent===i.agent);if(r){if(r.dates.push(i.date),oh(n)>e){r.dates.pop();break}}else if(n.push({agent:i.agent,dates:[i.date]}),oh(n)>e){n.pop();break}s=s.slice(1)}return{heartbeatsToSend:n,unsentEntries:s}}class eT{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return $p()?Lp().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const n=await YE(this.app);return n!=null&&n.heartbeats?n:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(e){var n;if(await this._canUseIndexedDBPromise){const i=await this.read();return ih(this.app,{lastSentHeartbeatDate:(n=e.lastSentHeartbeatDate)!==null&&n!==void 0?n:i.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){var n;if(await this._canUseIndexedDBPromise){const i=await this.read();return ih(this.app,{lastSentHeartbeatDate:(n=e.lastSentHeartbeatDate)!==null&&n!==void 0?n:i.lastSentHeartbeatDate,heartbeats:[...i.heartbeats,...e.heartbeats]})}else return}}function oh(t){return Mo(JSON.stringify({version:2,heartbeats:t})).length}function tT(t){if(t.length===0)return-1;let e=0,n=t[0].date;for(let s=1;s<t.length;s++)t[s].date<n&&(n=t[s].date,e=s);return e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function nT(t){os(new On("platform-logger",e=>new hE(e),"PRIVATE")),os(new On("heartbeat",e=>new JE(e),"PRIVATE")),vn(Ll,nh,t),vn(Ll,nh,"esm2017"),vn("fire-js","")}nT("");var sT="firebase",iT="11.4.0";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */vn(sT,iT,"app");const Wp="@firebase/installations",Dc="0.6.13";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const zp=1e4,Yp=`w:${Dc}`,Qp="FIS_v2",rT="https://firebaseinstallations.goolwkejwo232323gleapis.com/v1",oT=60*60*1e3,aT="installations",lT="Installations";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const cT={"missing-app-config-values":'Missing App configuration value: "{$valueName}"',"not-registered":"Firebase Installation is not registered.","installation-not-found":"Firebase Installation not found.","request-failed":'{$requestName} request failed with error "{$serverCode} {$serverStatus}: {$serverMessage}"',"app-offline":"Could not process request. Application offline.","delete-pending-registration":"Can't delete installation while there is a pending registration request."},Bs=new aa(aT,lT,cT);function Xp(t){return t instanceof Es&&t.code.includes("request-failed")}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Jp({projectId:t}){return`${rT}/projects/${t}/installations`}function Zp(t){return{token:t.token,requestStatus:2,expiresIn:dT(t.expiresIn),creationTime:Date.now()}}async function eg(t,e){const s=(await e.json()).error;return Bs.create("request-failed",{requestName:t,serverCode:s.code,serverMessage:s.message,serverStatus:s.status})}function tg({apiKey:t}){return new Headers({"Content-Type":"application/json",Accept:"application/json","x-goog-api-key":t})}function uT(t,{refreshToken:e}){const n=tg(t);return n.append("Authorization",hT(e)),n}async function ng(t){const e=await t();return e.status>=500&&e.status<600?t():e}function dT(t){return Number(t.replace("s","000"))}function hT(t){return`${Qp} ${t}`}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function fT({appConfig:t,heartbeatServiceProvider:e},{fid:n}){const s=Jp(t),i=tg(t),r=e.getImmediate({optional:!0});if(r){const u=await r.getHeartbeatsHeader();u&&i.append("x-firebase-client",u)}const o={fid:n,authVersion:Qp,appId:t.appId,sdkVersion:Yp},l={method:"POST",headers:i,body:JSON.stringify(o)},c=await ng(()=>fetch(s,l));if(c.ok){const u=await c.json();return{fid:u.fid||n,registrationStatus:2,refreshToken:u.refreshToken,authToken:Zp(u.authToken)}}else throw await eg("Create Installation",c)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function sg(t){return new Promise(e=>{setTimeout(e,t)})}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function pT(t){return btoa(String.fromCharCode(...t)).replace(/\+/g,"-").replace(/\//g,"_")}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const gT=/^[cdef][\w-]{21}$/,Hl="";function mT(){try{const t=new Uint8Array(17);(self.crypto||self.msCrypto).getRandomValues(t),t[0]=112+t[0]%16;const n=vT(t);return gT.test(n)?n:Hl}catch{return Hl}}function vT(t){return pT(t).substr(0,22)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function la(t){return`${t.appName}!${t.appId}`}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ig=new Map;function rg(t,e){const n=la(t);og(n,e),yT(n,e)}function og(t,e){const n=ig.get(t);if(n)for(const s of n)s(e)}function yT(t,e){const n=_T();n&&n.postMessage({key:t,fid:e}),ET()}let Os=null;function _T(){return!Os&&"BroadcastChannel"in self&&(Os=new BroadcastChannel("[Firebase] FID Change"),Os.onmessage=t=>{og(t.data.key,t.data.fid)}),Os}function ET(){ig.size===0&&Os&&(Os.close(),Os=null)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const TT="firebase-installations-database",bT=1,Us="firebase-installations-store";let fl=null;function Mc(){return fl||(fl=Hp(TT,bT,{upgrade:(t,e)=>{switch(e){case 0:t.createObjectStore(Us)}}})),fl}async function No(t,e){const n=la(t),i=(await Mc()).transaction(Us,"readwrite"),r=i.objectStore(Us),o=await r.get(n);return await r.put(e,n),await i.done,(!o||o.fid!==e.fid)&&rg(t,e.fid),e}async function ag(t){const e=la(t),s=(await Mc()).transaction(Us,"readwrite");await s.objectStore(Us).delete(e),await s.done}async function ca(t,e){const n=la(t),i=(await Mc()).transaction(Us,"readwrite"),r=i.objectStore(Us),o=await r.get(n),l=e(o);return l===void 0?await r.delete(n):await r.put(l,n),await i.done,l&&(!o||o.fid!==l.fid)&&rg(t,l.fid),l}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Oc(t){let e;const n=await ca(t.appConfig,s=>{const i=wT(s),r=AT(t,i);return e=r.registrationPromise,r.installationEntry});return n.fid===Hl?{installationEntry:await e}:{installationEntry:n,registrationPromise:e}}function wT(t){const e=t||{fid:mT(),registrationStatus:0};return lg(e)}function AT(t,e){if(e.registrationStatus===0){if(!navigator.onLine){const i=Promise.reject(Bs.create("app-offline"));return{installationEntry:e,registrationPromise:i}}const n={fid:e.fid,registrationStatus:1,registrationTime:Date.now()},s=IT(t,n);return{installationEntry:n,registrationPromise:s}}else return e.registrationStatus===1?{installationEntry:e,registrationPromise:ST(t)}:{installationEntry:e}}async function IT(t,e){try{const n=await fT(t,e);return No(t.appConfig,n)}catch(n){throw Xp(n)&&n.customData.serverCode===409?await ag(t.appConfig):await No(t.appConfig,{fid:e.fid,registrationStatus:0}),n}}async function ST(t){let e=await ah(t.appConfig);for(;e.registrationStatus===1;)await sg(100),e=await ah(t.appConfig);if(e.registrationStatus===0){const{installationEntry:n,registrationPromise:s}=await Oc(t);return s||n}return e}function ah(t){return ca(t,e=>{if(!e)throw Bs.create("installation-not-found");return lg(e)})}function lg(t){return CT(t)?{fid:t.fid,registrationStatus:0}:t}function CT(t){return t.registrationStatus===1&&t.registrationTime+zp<Date.now()}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function kT({appConfig:t,heartbeatServiceProvider:e},n){const s=PT(t,n),i=uT(t,n),r=e.getImmediate({optional:!0});if(r){const u=await r.getHeartbeatsHeader();u&&i.append("x-firebase-client",u)}const o={installation:{sdkVersion:Yp,appId:t.appId}},l={method:"POST",headers:i,body:JSON.stringify(o)},c=await ng(()=>fetch(s,l));if(c.ok){const u=await c.json();return Zp(u)}else throw await eg("Generate Auth Token",c)}function PT(t,{fid:e}){return`${Jp(t)}/${e}/authTokens:generate`}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Nc(t,e=!1){let n;const s=await ca(t.appConfig,r=>{if(!cg(r))throw Bs.create("not-registered");const o=r.authToken;if(!e&&MT(o))return r;if(o.requestStatus===1)return n=RT(t,e),r;{if(!navigator.onLine)throw Bs.create("app-offline");const l=NT(r);return n=DT(t,l),l}});return n?await n:s.authToken}async function RT(t,e){let n=await lh(t.appConfig);for(;n.authToken.requestStatus===1;)await sg(100),n=await lh(t.appConfig);const s=n.authToken;return s.requestStatus===0?Nc(t,e):s}function lh(t){return ca(t,e=>{if(!cg(e))throw Bs.create("not-registered");const n=e.authToken;return xT(n)?Object.assign(Object.assign({},e),{authToken:{requestStatus:0}}):e})}async function DT(t,e){try{const n=await kT(t,e),s=Object.assign(Object.assign({},e),{authToken:n});return await No(t.appConfig,s),n}catch(n){if(Xp(n)&&(n.customData.serverCode===401||n.customData.serverCode===404))await ag(t.appConfig);else{const s=Object.assign(Object.assign({},e),{authToken:{requestStatus:0}});await No(t.appConfig,s)}throw n}}function cg(t){return t!==void 0&&t.registrationStatus===2}function MT(t){return t.requestStatus===2&&!OT(t)}function OT(t){const e=Date.now();return e<t.creationTime||t.creationTime+t.expiresIn<e+oT}function NT(t){const e={requestStatus:1,requestTime:Date.now()};return Object.assign(Object.assign({},t),{authToken:e})}function xT(t){return t.requestStatus===1&&t.requestTime+zp<Date.now()}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function VT(t){const e=t,{installationEntry:n,registrationPromise:s}=await Oc(e);return s?s.catch(console.error):Nc(e).catch(console.error),n.fid}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function FT(t,e=!1){const n=t;return await $T(n),(await Nc(n,e)).token}async function $T(t){const{registrationPromise:e}=await Oc(t);e&&await e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function LT(t){if(!t||!t.options)throw pl("App Configuration");if(!t.name)throw pl("App Name");const e=["projectId","apiKey","appId"];for(const n of e)if(!t.options[n])throw pl(n);return{appName:t.name,projectId:t.options.projectId,apiKey:t.options.apiKey,appId:t.options.appId}}function pl(t){return Bs.create("missing-app-config-values",{valueName:t})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ug="installations",BT="installations-internal",UT=t=>{const e=t.getProvider("app").getImmediate(),n=LT(e),s=Mr(e,"heartbeat");return{app:e,appConfig:n,heartbeatServiceProvider:s,_delete:()=>Promise.resolve()}},HT=t=>{const e=t.getProvider("app").getImmediate(),n=Mr(e,ug).getImmediate();return{getId:()=>VT(n),getToken:i=>FT(n,i)}};function jT(){os(new On(ug,UT,"PUBLIC")),os(new On(BT,HT,"PRIVATE"))}jT();vn(Wp,Dc);vn(Wp,Dc,"esm2017");/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const xo="analytics",KT="firebase_id",qT="origin",GT=60*1e3,WT="https://firebase.goog4o232o323223leapis.com/v1alpha/projects/-/apps/{app-id}/webConfig",xc="https://www.googletagm2eoi23j2l3asdfafanager.com/gtag/js";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Gt=new Pc("@firebase/analytics");/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const zT={"already-exists":"A Firebase Analytics instance with the appId {$id}  already exists. Only one Firebase Analytics instance can be created for each appId.","already-initialized":"initializeAnalytics() cannot be called again with different options than those it was initially called with. It can be called again with the same options to return the existing instance, or getAnalytics() can be used to get a reference to the already-initialized instance.","already-initialized-settings":"Firebase Analytics has already been initialized.settings() must be called before initializing any Analytics instanceor it will have no effect.","interop-component-reg-failed":"Firebase Analytics Interop Component failed to instantiate: {$reason}","invalid-analytics-context":"Firebase Analytics is not supported in this environment. Wrap initialization of analytics in analytics.isSupported() to prevent initialization in unsupported environments. Details: {$errorInfo}","indexeddb-unavailable":"IndexedDB unavailable or restricted in this environment. Wrap initialization of analytics in analytics.isSupported() to prevent initialization in unsupported environments. Details: {$errorInfo}","fetch-throttle":"The config fetch request timed out while in an exponential backoff state. Unix timestamp in milliseconds when fetch request throttling ends: {$throttleEndTimeMillis}.","config-fetch-failed":"Dynamic config fetch failed: [{$httpStatus}] {$responseMessage}","no-api-key":'The "apiKey" field is empty in the local Firebase config. Firebase Analytics requires this field tocontain a valid API key.',"no-app-id":'The "appId" field is empty in the local Firebase config. Firebase Analytics requires this field tocontain a valid app ID.',"no-client-id":'The "client_id" field is empty.',"invalid-gtag-resource":"Trusted Types detected an invalid gtag resource: {$gtagURL}."},Jt=new aa("analytics","Analytics",zT);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function YT(t){if(!t.startsWith(xc)){const e=Jt.create("invalid-gtag-resource",{gtagURL:t});return Gt.warn(e.message),""}return t}function dg(t){return Promise.all(t.map(e=>e.catch(n=>n)))}function QT(t,e){let n;return window.trustedTypes&&(n=window.trustedTypes.createPolicy(t,e)),n}function XT(t,e){const n=QT("firebase-js-sdk-policy",{createScriptURL:YT}),s=document.createElement("script"),i=`${xc}?l=${t}&id=${e}`;s.src=n?n==null?void 0:n.createScriptURL(i):i,s.async=!0,document.head.appendChild(s)}function JT(t){let e=[];return Array.isArray(window[t])?e=window[t]:window[t]=e,e}async function ZT(t,e,n,s,i,r){const o=s[i];try{if(o)await e[o];else{const c=(await dg(n)).find(u=>u.measurementId===i);c&&await e[c.appId]}}catch(l){Gt.error(l)}t("config",i,r)}async function eb(t,e,n,s,i){try{let r=[];if(i&&i.send_to){let o=i.send_to;Array.isArray(o)||(o=[o]);const l=await dg(n);for(const c of o){const u=l.find(f=>f.measurementId===c),h=u&&e[u.appId];if(h)r.push(h);else{r=[];break}}}r.length===0&&(r=Object.values(e)),await Promise.all(r),t("event",s,i||{})}catch(r){Gt.error(r)}}function tb(t,e,n,s){async function i(r,...o){try{if(r==="event"){const[l,c]=o;await eb(t,e,n,l,c)}else if(r==="config"){const[l,c]=o;await ZT(t,e,n,s,l,c)}else if(r==="consent"){const[l,c]=o;t("consent",l,c)}else if(r==="get"){const[l,c,u]=o;t("get",l,c,u)}else if(r==="set"){const[l]=o;t("set",l)}else t(r,...o)}catch(l){Gt.error(l)}}return i}function nb(t,e,n,s,i){let r=function(...o){window[s].push(arguments)};return window[i]&&typeof window[i]=="function"&&(r=window[i]),window[i]=tb(r,t,e,n),{gtagCore:r,wrappedGtag:window[i]}}function sb(t){const e=window.document.getElementsByTagName("script");for(const n of Object.values(e))if(n.src&&n.src.includes(xc)&&n.src.includes(t))return n;return null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ib=30,rb=1e3;class ob{constructor(e={},n=rb){this.throttleMetadata=e,this.intervalMillis=n}getThrottleMetadata(e){return this.throttleMetadata[e]}setThrottleMetadata(e,n){this.throttleMetadata[e]=n}deleteThrottleMetadata(e){delete this.throttleMetadata[e]}}const hg=new ob;function ab(t){return new Headers({Accept:"application/json","x-goog-api-key":t})}async function lb(t){var e;const{appId:n,apiKey:s}=t,i={method:"GET",headers:ab(s)},r=WT.replace("{app-id}",n),o=await fetch(r,i);if(o.status!==200&&o.status!==304){let l="";try{const c=await o.json();!((e=c.error)===null||e===void 0)&&e.message&&(l=c.error.message)}catch{}throw Jt.create("config-fetch-failed",{httpStatus:o.status,responseMessage:l})}return o.json()}async function cb(t,e=hg,n){const{appId:s,apiKey:i,measurementId:r}=t.options;if(!s)throw Jt.create("no-app-id");if(!i){if(r)return{measurementId:r,appId:s};throw Jt.create("no-api-key")}const o=e.getThrottleMetadata(s)||{backoffCount:0,throttleEndTimeMillis:Date.now()},l=new hb;return setTimeout(async()=>{l.abort()},GT),fg({appId:s,apiKey:i,measurementId:r},o,l,e)}async function fg(t,{throttleEndTimeMillis:e,backoffCount:n},s,i=hg){var r;const{appId:o,measurementId:l}=t;try{await ub(s,e)}catch(c){if(l)return Gt.warn(`Timed out fetching this Firebase app's measurement ID from the server. Falling back to the measurement ID ${l} provided in the "measurementId" field in the local Firebase config. [${c==null?void 0:c.message}]`),{appId:o,measurementId:l};throw c}try{const c=await lb(t);return i.deleteThrottleMetadata(o),c}catch(c){const u=c;if(!db(u)){if(i.deleteThrottleMetadata(o),l)return Gt.warn(`Failed to fetch this Firebase app's measurement ID from the server. Falling back to the measurement ID ${l} provided in the "measurementId" field in the local Firebase config. [${u==null?void 0:u.message}]`),{appId:o,measurementId:l};throw c}const h=Number((r=u==null?void 0:u.customData)===null||r===void 0?void 0:r.httpStatus)===503?Jd(n,i.intervalMillis,ib):Jd(n,i.intervalMillis),f={throttleEndTimeMillis:Date.now()+h,backoffCount:n+1};return i.setThrottleMetadata(o,f),Gt.debug(`Calling attemptFetch again in ${h} millis`),fg(t,f,s,i)}}function ub(t,e){return new Promise((n,s)=>{const i=Math.max(e-Date.now(),0),r=setTimeout(n,i);t.addEventListener(()=>{clearTimeout(r),s(Jt.create("fetch-throttle",{throttleEndTimeMillis:e}))})})}function db(t){if(!(t instanceof Es)||!t.customData)return!1;const e=Number(t.customData.httpStatus);return e===429||e===500||e===503||e===504}class hb{constructor(){this.listeners=[]}addEventListener(e){this.listeners.push(e)}abort(){this.listeners.forEach(e=>e())}}async function fb(t,e,n,s,i){if(i&&i.global){t("event",n,s);return}else{const r=await e,o=Object.assign(Object.assign({},s),{send_to:r});t("event",n,o)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function pb(){if($p())try{await Lp()}catch(t){return Gt.warn(Jt.create("indexeddb-unavailable",{errorInfo:t==null?void 0:t.toString()}).message),!1}else return Gt.warn(Jt.create("indexeddb-unavailable",{errorInfo:"IndexedDB is not available in this environment."}).message),!1;return!0}async function gb(t,e,n,s,i,r,o){var l;const c=cb(t);c.then(y=>{n[y.measurementId]=y.appId,t.options.measurementId&&y.measurementId!==t.options.measurementId&&Gt.warn(`The measurement ID in the local Firebase config (${t.options.measurementId}) does not match the measurement ID fetched from the server (${y.measurementId}). To ensure analytics events are always sent to the correct Analytics property, update the measurement ID field in the local config or remove it from the local config.`)}).catch(y=>Gt.error(y)),e.push(c);const u=pb().then(y=>{if(y)return s.getId()}),[h,f]=await Promise.all([c,u]);sb(r)||XT(r,h.measurementId),i("js",new Date);const m=(l=o==null?void 0:o.config)!==null&&l!==void 0?l:{};return m[qT]="firebase",m.update=!0,f!=null&&(m[KT]=f),i("config",h.measurementId,m),h.measurementId}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mb{constructor(e){this.app=e}_delete(){return delete rr[this.app.options.appId],Promise.resolve()}}let rr={},ch=[];const uh={};let gl="dataLayer",vb="gtag",dh,pg,hh=!1;function yb(){const t=[];if($0()&&t.push("This is a browser extension environment."),B0()||t.push("Cookies are not available."),t.length>0){const e=t.map((s,i)=>`(${i+1}) ${s}`).join(" "),n=Jt.create("invalid-analytics-context",{errorInfo:e});Gt.warn(n.message)}}function _b(t,e,n){yb();const s=t.options.appId;if(!s)throw Jt.create("no-app-id");if(!t.options.apiKey)if(t.options.measurementId)Gt.warn(`The "apiKey" field is empty in the local Firebase config. This is needed to fetch the latest measurement ID for this Firebase app. Falling back to the measurement ID ${t.options.measurementId} provided in the "measurementId" field in the local Firebase config.`);else throw Jt.create("no-api-key");if(rr[s]!=null)throw Jt.create("already-exists",{id:s});if(!hh){JT(gl);const{wrappedGtag:r,gtagCore:o}=nb(rr,ch,uh,gl,vb);pg=r,dh=o,hh=!0}return rr[s]=gb(t,ch,uh,e,dh,gl,n),new mb(t)}function Eb(t=Kp()){t=rs(t);const e=Mr(t,xo);return e.isInitialized()?e.getImmediate():Tb(t)}function Tb(t,e={}){const n=Mr(t,xo);if(n.isInitialized()){const i=n.getImmediate();if(_r(e,n.getOptions()))return i;throw Jt.create("already-initialized")}return n.initialize({options:e})}function gg(t,e,n,s){t=rs(t),fb(pg,rr[t.app.options.appId],e,n,s).catch(i=>Gt.error(i))}const fh="@firebase/analytics",ph="0.10.12";function bb(){os(new On(xo,(e,{options:n})=>{const s=e.getProvider("app").getImmediate(),i=e.getProvider("installations-internal").getImmediate();return _b(s,i,n)},"PUBLIC")),os(new On("analytics-internal",t,"PRIVATE")),vn(fh,ph),vn(fh,ph,"esm2017");function t(e){try{const n=e.getProvider(xo).getImmediate();return{logEvent:(s,i,r)=>gg(n,s,i,r)}}catch(n){throw Jt.create("interop-component-reg-failed",{reason:n})}}}bb();var gh=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var es,mg;(function(){var t;/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/function e(I,E){function v(){}v.prototype=E.prototype,I.D=E.prototype,I.prototype=new v,I.prototype.constructor=I,I.C=function(_,T,b){for(var A=Array(arguments.length-2),de=2;de<arguments.length;de++)A[de-2]=arguments[de];return E.prototype[T].apply(_,A)}}function n(){this.blockSize=-1}function s(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.B=Array(this.blockSize),this.o=this.h=0,this.s()}e(s,n),s.prototype.s=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function i(I,E,v){v||(v=0);var _=Array(16);if(typeof E=="string")for(var T=0;16>T;++T)_[T]=E.charCodeAt(v++)|E.charCodeAt(v++)<<8|E.charCodeAt(v++)<<16|E.charCodeAt(v++)<<24;else for(T=0;16>T;++T)_[T]=E[v++]|E[v++]<<8|E[v++]<<16|E[v++]<<24;E=I.g[0],v=I.g[1],T=I.g[2];var b=I.g[3],A=E+(b^v&(T^b))+_[0]+3614090360&4294967295;E=v+(A<<7&4294967295|A>>>25),A=b+(T^E&(v^T))+_[1]+3905402710&4294967295,b=E+(A<<12&4294967295|A>>>20),A=T+(v^b&(E^v))+_[2]+606105819&4294967295,T=b+(A<<17&4294967295|A>>>15),A=v+(E^T&(b^E))+_[3]+3250441966&4294967295,v=T+(A<<22&4294967295|A>>>10),A=E+(b^v&(T^b))+_[4]+4118548399&4294967295,E=v+(A<<7&4294967295|A>>>25),A=b+(T^E&(v^T))+_[5]+1200080426&4294967295,b=E+(A<<12&4294967295|A>>>20),A=T+(v^b&(E^v))+_[6]+2821735955&4294967295,T=b+(A<<17&4294967295|A>>>15),A=v+(E^T&(b^E))+_[7]+4249261313&4294967295,v=T+(A<<22&4294967295|A>>>10),A=E+(b^v&(T^b))+_[8]+1770035416&4294967295,E=v+(A<<7&4294967295|A>>>25),A=b+(T^E&(v^T))+_[9]+2336552879&4294967295,b=E+(A<<12&4294967295|A>>>20),A=T+(v^b&(E^v))+_[10]+4294925233&4294967295,T=b+(A<<17&4294967295|A>>>15),A=v+(E^T&(b^E))+_[11]+2304563134&4294967295,v=T+(A<<22&4294967295|A>>>10),A=E+(b^v&(T^b))+_[12]+1804603682&4294967295,E=v+(A<<7&4294967295|A>>>25),A=b+(T^E&(v^T))+_[13]+4254626195&4294967295,b=E+(A<<12&4294967295|A>>>20),A=T+(v^b&(E^v))+_[14]+2792965006&4294967295,T=b+(A<<17&4294967295|A>>>15),A=v+(E^T&(b^E))+_[15]+1236535329&4294967295,v=T+(A<<22&4294967295|A>>>10),A=E+(T^b&(v^T))+_[1]+4129170786&4294967295,E=v+(A<<5&4294967295|A>>>27),A=b+(v^T&(E^v))+_[6]+3225465664&4294967295,b=E+(A<<9&4294967295|A>>>23),A=T+(E^v&(b^E))+_[11]+643717713&4294967295,T=b+(A<<14&4294967295|A>>>18),A=v+(b^E&(T^b))+_[0]+3921069994&4294967295,v=T+(A<<20&4294967295|A>>>12),A=E+(T^b&(v^T))+_[5]+3593408605&4294967295,E=v+(A<<5&4294967295|A>>>27),A=b+(v^T&(E^v))+_[10]+38016083&4294967295,b=E+(A<<9&4294967295|A>>>23),A=T+(E^v&(b^E))+_[15]+3634488961&4294967295,T=b+(A<<14&4294967295|A>>>18),A=v+(b^E&(T^b))+_[4]+3889429448&4294967295,v=T+(A<<20&4294967295|A>>>12),A=E+(T^b&(v^T))+_[9]+568446438&4294967295,E=v+(A<<5&4294967295|A>>>27),A=b+(v^T&(E^v))+_[14]+3275163606&4294967295,b=E+(A<<9&4294967295|A>>>23),A=T+(E^v&(b^E))+_[3]+4107603335&4294967295,T=b+(A<<14&4294967295|A>>>18),A=v+(b^E&(T^b))+_[8]+1163531501&4294967295,v=T+(A<<20&4294967295|A>>>12),A=E+(T^b&(v^T))+_[13]+2850285829&4294967295,E=v+(A<<5&4294967295|A>>>27),A=b+(v^T&(E^v))+_[2]+4243563512&4294967295,b=E+(A<<9&4294967295|A>>>23),A=T+(E^v&(b^E))+_[7]+1735328473&4294967295,T=b+(A<<14&4294967295|A>>>18),A=v+(b^E&(T^b))+_[12]+2368359562&4294967295,v=T+(A<<20&4294967295|A>>>12),A=E+(v^T^b)+_[5]+4294588738&4294967295,E=v+(A<<4&4294967295|A>>>28),A=b+(E^v^T)+_[8]+2272392833&4294967295,b=E+(A<<11&4294967295|A>>>21),A=T+(b^E^v)+_[11]+1839030562&4294967295,T=b+(A<<16&4294967295|A>>>16),A=v+(T^b^E)+_[14]+4259657740&4294967295,v=T+(A<<23&4294967295|A>>>9),A=E+(v^T^b)+_[1]+2763975236&4294967295,E=v+(A<<4&4294967295|A>>>28),A=b+(E^v^T)+_[4]+1272893353&4294967295,b=E+(A<<11&4294967295|A>>>21),A=T+(b^E^v)+_[7]+4139469664&4294967295,T=b+(A<<16&4294967295|A>>>16),A=v+(T^b^E)+_[10]+3200236656&4294967295,v=T+(A<<23&4294967295|A>>>9),A=E+(v^T^b)+_[13]+681279174&4294967295,E=v+(A<<4&4294967295|A>>>28),A=b+(E^v^T)+_[0]+3936430074&4294967295,b=E+(A<<11&4294967295|A>>>21),A=T+(b^E^v)+_[3]+3572445317&4294967295,T=b+(A<<16&4294967295|A>>>16),A=v+(T^b^E)+_[6]+76029189&4294967295,v=T+(A<<23&4294967295|A>>>9),A=E+(v^T^b)+_[9]+3654602809&4294967295,E=v+(A<<4&4294967295|A>>>28),A=b+(E^v^T)+_[12]+3873151461&4294967295,b=E+(A<<11&4294967295|A>>>21),A=T+(b^E^v)+_[15]+530742520&4294967295,T=b+(A<<16&4294967295|A>>>16),A=v+(T^b^E)+_[2]+3299628645&4294967295,v=T+(A<<23&4294967295|A>>>9),A=E+(T^(v|~b))+_[0]+4096336452&4294967295,E=v+(A<<6&4294967295|A>>>26),A=b+(v^(E|~T))+_[7]+1126891415&4294967295,b=E+(A<<10&4294967295|A>>>22),A=T+(E^(b|~v))+_[14]+2878612391&4294967295,T=b+(A<<15&4294967295|A>>>17),A=v+(b^(T|~E))+_[5]+4237533241&4294967295,v=T+(A<<21&4294967295|A>>>11),A=E+(T^(v|~b))+_[12]+1700485571&4294967295,E=v+(A<<6&4294967295|A>>>26),A=b+(v^(E|~T))+_[3]+2399980690&4294967295,b=E+(A<<10&4294967295|A>>>22),A=T+(E^(b|~v))+_[10]+4293915773&4294967295,T=b+(A<<15&4294967295|A>>>17),A=v+(b^(T|~E))+_[1]+2240044497&4294967295,v=T+(A<<21&4294967295|A>>>11),A=E+(T^(v|~b))+_[8]+1873313359&4294967295,E=v+(A<<6&4294967295|A>>>26),A=b+(v^(E|~T))+_[15]+4264355552&4294967295,b=E+(A<<10&4294967295|A>>>22),A=T+(E^(b|~v))+_[6]+2734768916&4294967295,T=b+(A<<15&4294967295|A>>>17),A=v+(b^(T|~E))+_[13]+1309151649&4294967295,v=T+(A<<21&4294967295|A>>>11),A=E+(T^(v|~b))+_[4]+4149444226&4294967295,E=v+(A<<6&4294967295|A>>>26),A=b+(v^(E|~T))+_[11]+3174756917&4294967295,b=E+(A<<10&4294967295|A>>>22),A=T+(E^(b|~v))+_[2]+718787259&4294967295,T=b+(A<<15&4294967295|A>>>17),A=v+(b^(T|~E))+_[9]+3951481745&4294967295,I.g[0]=I.g[0]+E&4294967295,I.g[1]=I.g[1]+(T+(A<<21&4294967295|A>>>11))&4294967295,I.g[2]=I.g[2]+T&4294967295,I.g[3]=I.g[3]+b&4294967295}s.prototype.u=function(I,E){E===void 0&&(E=I.length);for(var v=E-this.blockSize,_=this.B,T=this.h,b=0;b<E;){if(T==0)for(;b<=v;)i(this,I,b),b+=this.blockSize;if(typeof I=="string"){for(;b<E;)if(_[T++]=I.charCodeAt(b++),T==this.blockSize){i(this,_),T=0;break}}else for(;b<E;)if(_[T++]=I[b++],T==this.blockSize){i(this,_),T=0;break}}this.h=T,this.o+=E},s.prototype.v=function(){var I=Array((56>this.h?this.blockSize:2*this.blockSize)-this.h);I[0]=128;for(var E=1;E<I.length-8;++E)I[E]=0;var v=8*this.o;for(E=I.length-8;E<I.length;++E)I[E]=v&255,v/=256;for(this.u(I),I=Array(16),E=v=0;4>E;++E)for(var _=0;32>_;_+=8)I[v++]=this.g[E]>>>_&255;return I};function r(I,E){var v=l;return Object.prototype.hasOwnProperty.call(v,I)?v[I]:v[I]=E(I)}function o(I,E){this.h=E;for(var v=[],_=!0,T=I.length-1;0<=T;T--){var b=I[T]|0;_&&b==E||(v[T]=b,_=!1)}this.g=v}var l={};function c(I){return-128<=I&&128>I?r(I,function(E){return new o([E|0],0>E?-1:0)}):new o([I|0],0>I?-1:0)}function u(I){if(isNaN(I)||!isFinite(I))return f;if(0>I)return S(u(-I));for(var E=[],v=1,_=0;I>=v;_++)E[_]=I/v|0,v*=4294967296;return new o(E,0)}function h(I,E){if(I.length==0)throw Error("number format error: empty string");if(E=E||10,2>E||36<E)throw Error("radix out of range: "+E);if(I.charAt(0)=="-")return S(h(I.substring(1),E));if(0<=I.indexOf("-"))throw Error('number format error: interior "-" character');for(var v=u(Math.pow(E,8)),_=f,T=0;T<I.length;T+=8){var b=Math.min(8,I.length-T),A=parseInt(I.substring(T,T+b),E);8>b?(b=u(Math.pow(E,b)),_=_.j(b).add(u(A))):(_=_.j(v),_=_.add(u(A)))}return _}var f=c(0),m=c(1),y=c(16777216);t=o.prototype,t.m=function(){if(D(this))return-S(this).m();for(var I=0,E=1,v=0;v<this.g.length;v++){var _=this.i(v);I+=(0<=_?_:4294967296+_)*E,E*=4294967296}return I},t.toString=function(I){if(I=I||10,2>I||36<I)throw Error("radix out of range: "+I);if(C(this))return"0";if(D(this))return"-"+S(this).toString(I);for(var E=u(Math.pow(I,6)),v=this,_="";;){var T=R(v,E).g;v=M(v,T.j(E));var b=((0<v.g.length?v.g[0]:v.h)>>>0).toString(I);if(v=T,C(v))return b+_;for(;6>b.length;)b="0"+b;_=b+_}},t.i=function(I){return 0>I?0:I<this.g.length?this.g[I]:this.h};function C(I){if(I.h!=0)return!1;for(var E=0;E<I.g.length;E++)if(I.g[E]!=0)return!1;return!0}function D(I){return I.h==-1}t.l=function(I){return I=M(this,I),D(I)?-1:C(I)?0:1};function S(I){for(var E=I.g.length,v=[],_=0;_<E;_++)v[_]=~I.g[_];return new o(v,~I.h).add(m)}t.abs=function(){return D(this)?S(this):this},t.add=function(I){for(var E=Math.max(this.g.length,I.g.length),v=[],_=0,T=0;T<=E;T++){var b=_+(this.i(T)&65535)+(I.i(T)&65535),A=(b>>>16)+(this.i(T)>>>16)+(I.i(T)>>>16);_=A>>>16,b&=65535,A&=65535,v[T]=A<<16|b}return new o(v,v[v.length-1]&-2147483648?-1:0)};function M(I,E){return I.add(S(E))}t.j=function(I){if(C(this)||C(I))return f;if(D(this))return D(I)?S(this).j(S(I)):S(S(this).j(I));if(D(I))return S(this.j(S(I)));if(0>this.l(y)&&0>I.l(y))return u(this.m()*I.m());for(var E=this.g.length+I.g.length,v=[],_=0;_<2*E;_++)v[_]=0;for(_=0;_<this.g.length;_++)for(var T=0;T<I.g.length;T++){var b=this.i(_)>>>16,A=this.i(_)&65535,de=I.i(T)>>>16,W=I.i(T)&65535;v[2*_+2*T]+=A*W,P(v,2*_+2*T),v[2*_+2*T+1]+=b*W,P(v,2*_+2*T+1),v[2*_+2*T+1]+=A*de,P(v,2*_+2*T+1),v[2*_+2*T+2]+=b*de,P(v,2*_+2*T+2)}for(_=0;_<E;_++)v[_]=v[2*_+1]<<16|v[2*_];for(_=E;_<2*E;_++)v[_]=0;return new o(v,0)};function P(I,E){for(;(I[E]&65535)!=I[E];)I[E+1]+=I[E]>>>16,I[E]&=65535,E++}function V(I,E){this.g=I,this.h=E}function R(I,E){if(C(E))throw Error("division by zero");if(C(I))return new V(f,f);if(D(I))return E=R(S(I),E),new V(S(E.g),S(E.h));if(D(E))return E=R(I,S(E)),new V(S(E.g),E.h);if(30<I.g.length){if(D(I)||D(E))throw Error("slowDivide_ only works with positive integers.");for(var v=m,_=E;0>=_.l(I);)v=H(v),_=H(_);var T=O(v,1),b=O(_,1);for(_=O(_,2),v=O(v,2);!C(_);){var A=b.add(_);0>=A.l(I)&&(T=T.add(v),b=A),_=O(_,1),v=O(v,1)}return E=M(I,T.j(E)),new V(T,E)}for(T=f;0<=I.l(E);){for(v=Math.max(1,Math.floor(I.m()/E.m())),_=Math.ceil(Math.log(v)/Math.LN2),_=48>=_?1:Math.pow(2,_-48),b=u(v),A=b.j(E);D(A)||0<A.l(I);)v-=_,b=u(v),A=b.j(E);C(b)&&(b=m),T=T.add(b),I=M(I,A)}return new V(T,I)}t.A=function(I){return R(this,I).h},t.and=function(I){for(var E=Math.max(this.g.length,I.g.length),v=[],_=0;_<E;_++)v[_]=this.i(_)&I.i(_);return new o(v,this.h&I.h)},t.or=function(I){for(var E=Math.max(this.g.length,I.g.length),v=[],_=0;_<E;_++)v[_]=this.i(_)|I.i(_);return new o(v,this.h|I.h)},t.xor=function(I){for(var E=Math.max(this.g.length,I.g.length),v=[],_=0;_<E;_++)v[_]=this.i(_)^I.i(_);return new o(v,this.h^I.h)};function H(I){for(var E=I.g.length+1,v=[],_=0;_<E;_++)v[_]=I.i(_)<<1|I.i(_-1)>>>31;return new o(v,I.h)}function O(I,E){var v=E>>5;E%=32;for(var _=I.g.length-v,T=[],b=0;b<_;b++)T[b]=0<E?I.i(b+v)>>>E|I.i(b+v+1)<<32-E:I.i(b+v);return new o(T,I.h)}s.prototype.digest=s.prototype.v,s.prototype.reset=s.prototype.s,s.prototype.update=s.prototype.u,mg=s,o.prototype.add=o.prototype.add,o.prototype.multiply=o.prototype.j,o.prototype.modulo=o.prototype.A,o.prototype.compare=o.prototype.l,o.prototype.toNumber=o.prototype.m,o.prototype.toString=o.prototype.toString,o.prototype.getBits=o.prototype.i,o.fromNumber=u,o.fromString=h,es=o}).apply(typeof gh<"u"?gh:typeof self<"u"?self:typeof window<"u"?window:{});var ro=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var vg,Wi,yg,vo,jl,_g,Eg,Tg;(function(){var t,e=typeof Object.defineProperties=="function"?Object.defineProperty:function(a,d,p){return a==Array.prototype||a==Object.prototype||(a[d]=p.value),a};function n(a){a=[typeof globalThis=="object"&&globalThis,a,typeof window=="object"&&window,typeof self=="object"&&self,typeof ro=="object"&&ro];for(var d=0;d<a.length;++d){var p=a[d];if(p&&p.Math==Math)return p}throw Error("Cannot find global object")}var s=n(this);function i(a,d){if(d)e:{var p=s;a=a.split(".");for(var w=0;w<a.length-1;w++){var $=a[w];if(!($ in p))break e;p=p[$]}a=a[a.length-1],w=p[a],d=d(w),d!=w&&d!=null&&e(p,a,{configurable:!0,writable:!0,value:d})}}function r(a,d){a instanceof String&&(a+="");var p=0,w=!1,$={next:function(){if(!w&&p<a.length){var j=p++;return{value:d(j,a[j]),done:!1}}return w=!0,{done:!0,value:void 0}}};return $[Symbol.iterator]=function(){return $},$}i("Array.prototype.values",function(a){return a||function(){return r(this,function(d,p){return p})}});/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/var o=o||{},l=this||self;function c(a){var d=typeof a;return d=d!="object"?d:a?Array.isArray(a)?"array":d:"null",d=="array"||d=="object"&&typeof a.length=="number"}function u(a){var d=typeof a;return d=="object"&&a!=null||d=="function"}function h(a,d,p){return a.call.apply(a.bind,arguments)}function f(a,d,p){if(!a)throw Error();if(2<arguments.length){var w=Array.prototype.slice.call(arguments,2);return function(){var $=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply($,w),a.apply(d,$)}}return function(){return a.apply(d,arguments)}}function m(a,d,p){return m=Function.prototype.bind&&Function.prototype.bind.toString().indexOf("native code")!=-1?h:f,m.apply(null,arguments)}function y(a,d){var p=Array.prototype.slice.call(arguments,1);return function(){var w=p.slice();return w.push.apply(w,arguments),a.apply(this,w)}}function C(a,d){function p(){}p.prototype=d.prototype,a.aa=d.prototype,a.prototype=new p,a.prototype.constructor=a,a.Qb=function(w,$,j){for(var pe=Array(arguments.length-2),Je=2;Je<arguments.length;Je++)pe[Je-2]=arguments[Je];return d.prototype[$].apply(w,pe)}}function D(a){const d=a.length;if(0<d){const p=Array(d);for(let w=0;w<d;w++)p[w]=a[w];return p}return[]}function S(a,d){for(let p=1;p<arguments.length;p++){const w=arguments[p];if(c(w)){const $=a.length||0,j=w.length||0;a.length=$+j;for(let pe=0;pe<j;pe++)a[$+pe]=w[pe]}else a.push(w)}}class M{constructor(d,p){this.i=d,this.j=p,this.h=0,this.g=null}get(){let d;return 0<this.h?(this.h--,d=this.g,this.g=d.next,d.next=null):d=this.i(),d}}function P(a){return/^[\s\xa0]*$/.test(a)}function V(){var a=l.navigator;return a&&(a=a.userAgent)?a:""}function R(a){return R[" "](a),a}R[" "]=function(){};var H=V().indexOf("Gecko")!=-1&&!(V().toLowerCase().indexOf("webkit")!=-1&&V().indexOf("Edge")==-1)&&!(V().indexOf("Trident")!=-1||V().indexOf("MSIE")!=-1)&&V().indexOf("Edge")==-1;function O(a,d,p){for(const w in a)d.call(p,a[w],w,a)}function I(a,d){for(const p in a)d.call(void 0,a[p],p,a)}function E(a){const d={};for(const p in a)d[p]=a[p];return d}const v="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function _(a,d){let p,w;for(let $=1;$<arguments.length;$++){w=arguments[$];for(p in w)a[p]=w[p];for(let j=0;j<v.length;j++)p=v[j],Object.prototype.hasOwnProperty.call(w,p)&&(a[p]=w[p])}}function T(a){var d=1;a=a.split(":");const p=[];for(;0<d&&a.length;)p.push(a.shift()),d--;return a.length&&p.push(a.join(":")),p}function b(a){l.setTimeout(()=>{throw a},0)}function A(){var a=le;let d=null;return a.g&&(d=a.g,a.g=a.g.next,a.g||(a.h=null),d.next=null),d}class de{constructor(){this.h=this.g=null}add(d,p){const w=W.get();w.set(d,p),this.h?this.h.next=w:this.g=w,this.h=w}}var W=new M(()=>new q,a=>a.reset());class q{constructor(){this.next=this.g=this.h=null}set(d,p){this.h=d,this.g=p,this.next=null}reset(){this.next=this.g=this.h=null}}let G,Q=!1,le=new de,ke=()=>{const a=l.Promise.resolve(void 0);G=()=>{a.then(Ge)}};var Ge=()=>{for(var a;a=A();){try{a.h.call(a.g)}catch(p){b(p)}var d=W;d.j(a),100>d.h&&(d.h++,a.next=d.g,d.g=a)}Q=!1};function Fe(){this.s=this.s,this.C=this.C}Fe.prototype.s=!1,Fe.prototype.ma=function(){this.s||(this.s=!0,this.N())},Fe.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function ie(a,d){this.type=a,this.g=this.target=d,this.defaultPrevented=!1}ie.prototype.h=function(){this.defaultPrevented=!0};var F=function(){if(!l.addEventListener||!Object.defineProperty)return!1;var a=!1,d=Object.defineProperty({},"passive",{get:function(){a=!0}});try{const p=()=>{};l.addEventListener("test",p,d),l.removeEventListener("test",p,d)}catch{}return a}();function me(a,d){if(ie.call(this,a?a.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,a){var p=this.type=a.type,w=a.changedTouches&&a.changedTouches.length?a.changedTouches[0]:null;if(this.target=a.target||a.srcElement,this.g=d,d=a.relatedTarget){if(H){e:{try{R(d.nodeName);var $=!0;break e}catch{}$=!1}$||(d=null)}}else p=="mouseover"?d=a.fromElement:p=="mouseout"&&(d=a.toElement);this.relatedTarget=d,w?(this.clientX=w.clientX!==void 0?w.clientX:w.pageX,this.clientY=w.clientY!==void 0?w.clientY:w.pageY,this.screenX=w.screenX||0,this.screenY=w.screenY||0):(this.clientX=a.clientX!==void 0?a.clientX:a.pageX,this.clientY=a.clientY!==void 0?a.clientY:a.pageY,this.screenX=a.screenX||0,this.screenY=a.screenY||0),this.button=a.button,this.key=a.key||"",this.ctrlKey=a.ctrlKey,this.altKey=a.altKey,this.shiftKey=a.shiftKey,this.metaKey=a.metaKey,this.pointerId=a.pointerId||0,this.pointerType=typeof a.pointerType=="string"?a.pointerType:Te[a.pointerType]||"",this.state=a.state,this.i=a,a.defaultPrevented&&me.aa.h.call(this)}}C(me,ie);var Te={2:"touch",3:"pen",4:"mouse"};me.prototype.h=function(){me.aa.h.call(this);var a=this.i;a.preventDefault?a.preventDefault():a.returnValue=!1};var xe="closure_listenable_"+(1e6*Math.random()|0),Xe=0;function et(a,d,p,w,$){this.listener=a,this.proxy=null,this.src=d,this.type=p,this.capture=!!w,this.ha=$,this.key=++Xe,this.da=this.fa=!1}function rt(a){a.da=!0,a.listener=null,a.proxy=null,a.src=null,a.ha=null}function Re(a){this.src=a,this.g={},this.h=0}Re.prototype.add=function(a,d,p,w,$){var j=a.toString();a=this.g[j],a||(a=this.g[j]=[],this.h++);var pe=N(a,d,w,$);return-1<pe?(d=a[pe],p||(d.fa=!1)):(d=new et(d,this.src,j,!!w,$),d.fa=p,a.push(d)),d};function k(a,d){var p=d.type;if(p in a.g){var w=a.g[p],$=Array.prototype.indexOf.call(w,d,void 0),j;(j=0<=$)&&Array.prototype.splice.call(w,$,1),j&&(rt(d),a.g[p].length==0&&(delete a.g[p],a.h--))}}function N(a,d,p,w){for(var $=0;$<a.length;++$){var j=a[$];if(!j.da&&j.listener==d&&j.capture==!!p&&j.ha==w)return $}return-1}var U="closure_lm_"+(1e6*Math.random()|0),ne={};function J(a,d,p,w,$){if(Array.isArray(d)){for(var j=0;j<d.length;j++)J(a,d[j],p,w,$);return null}return p=x(p),a&&a[xe]?a.K(d,p,u(w)?!!w.capture:!1,$):oe(a,d,p,!1,w,$)}function oe(a,d,p,w,$,j){if(!d)throw Error("Invalid event type");var pe=u($)?!!$.capture:!!$,Je=ve(a);if(Je||(a[U]=Je=new Re(a)),p=Je.add(d,p,w,pe,j),p.proxy)return p;if(w=ge(),p.proxy=w,w.src=a,w.listener=p,a.addEventListener)F||($=pe),$===void 0&&($=!1),a.addEventListener(d.toString(),w,$);else if(a.attachEvent)a.attachEvent(re(d.toString()),w);else if(a.addListener&&a.removeListener)a.addListener(w);else throw Error("addEventListener and attachEvent are unavailable.");return p}function ge(){function a(p){return d.call(a.src,a.listener,p)}const d=Ie;return a}function he(a,d,p,w,$){if(Array.isArray(d))for(var j=0;j<d.length;j++)he(a,d[j],p,w,$);else w=u(w)?!!w.capture:!!w,p=x(p),a&&a[xe]?(a=a.i,d=String(d).toString(),d in a.g&&(j=a.g[d],p=N(j,p,w,$),-1<p&&(rt(j[p]),Array.prototype.splice.call(j,p,1),j.length==0&&(delete a.g[d],a.h--)))):a&&(a=ve(a))&&(d=a.g[d.toString()],a=-1,d&&(a=N(d,p,w,$)),(p=-1<a?d[a]:null)&&ce(p))}function ce(a){if(typeof a!="number"&&a&&!a.da){var d=a.src;if(d&&d[xe])k(d.i,a);else{var p=a.type,w=a.proxy;d.removeEventListener?d.removeEventListener(p,w,a.capture):d.detachEvent?d.detachEvent(re(p),w):d.addListener&&d.removeListener&&d.removeListener(w),(p=ve(d))?(k(p,a),p.h==0&&(p.src=null,d[U]=null)):rt(a)}}}function re(a){return a in ne?ne[a]:ne[a]="on"+a}function Ie(a,d){if(a.da)a=!0;else{d=new me(d,this);var p=a.listener,w=a.ha||a.src;a.fa&&ce(a),a=p.call(w,d)}return a}function ve(a){return a=a[U],a instanceof Re?a:null}var we="__closure_events_fn_"+(1e9*Math.random()>>>0);function x(a){return typeof a=="function"?a:(a[we]||(a[we]=function(d){return a.handleEvent(d)}),a[we])}function te(){Fe.call(this),this.i=new Re(this),this.M=this,this.F=null}C(te,Fe),te.prototype[xe]=!0,te.prototype.removeEventListener=function(a,d,p,w){he(this,a,d,p,w)};function fe(a,d){var p,w=a.F;if(w)for(p=[];w;w=w.F)p.push(w);if(a=a.M,w=d.type||d,typeof d=="string")d=new ie(d,a);else if(d instanceof ie)d.target=d.target||a;else{var $=d;d=new ie(w,a),_(d,$)}if($=!0,p)for(var j=p.length-1;0<=j;j--){var pe=d.g=p[j];$=be(pe,w,!0,d)&&$}if(pe=d.g=a,$=be(pe,w,!0,d)&&$,$=be(pe,w,!1,d)&&$,p)for(j=0;j<p.length;j++)pe=d.g=p[j],$=be(pe,w,!1,d)&&$}te.prototype.N=function(){if(te.aa.N.call(this),this.i){var a=this.i,d;for(d in a.g){for(var p=a.g[d],w=0;w<p.length;w++)rt(p[w]);delete a.g[d],a.h--}}this.F=null},te.prototype.K=function(a,d,p,w){return this.i.add(String(a),d,!1,p,w)},te.prototype.L=function(a,d,p,w){return this.i.add(String(a),d,!0,p,w)};function be(a,d,p,w){if(d=a.i.g[String(d)],!d)return!0;d=d.concat();for(var $=!0,j=0;j<d.length;++j){var pe=d[j];if(pe&&!pe.da&&pe.capture==p){var Je=pe.listener,At=pe.ha||pe.src;pe.fa&&k(a.i,pe),$=Je.call(At,w)!==!1&&$}}return $&&!w.defaultPrevented}function Se(a,d,p){if(typeof a=="function")p&&(a=m(a,p));else if(a&&typeof a.handleEvent=="function")a=m(a.handleEvent,a);else throw Error("Invalid listener argument");return 2147483647<Number(d)?-1:l.setTimeout(a,d||0)}function Ve(a){a.g=Se(()=>{a.g=null,a.i&&(a.i=!1,Ve(a))},a.l);const d=a.h;a.h=null,a.m.apply(null,d)}class ze extends Fe{constructor(d,p){super(),this.m=d,this.l=p,this.h=null,this.i=!1,this.g=null}j(d){this.h=arguments,this.g?this.i=!0:Ve(this)}N(){super.N(),this.g&&(l.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function ut(a){Fe.call(this),this.h=a,this.g={}}C(ut,Fe);var Vt=[];function Ts(a){O(a.g,function(d,p){this.g.hasOwnProperty(p)&&ce(d)},a),a.g={}}ut.prototype.N=function(){ut.aa.N.call(this),Ts(this)},ut.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var _t=l.JSON.stringify,en=l.JSON.parse,Lr=class{stringify(a){return l.JSON.stringify(a,void 0)}parse(a){return l.JSON.parse(a,void 0)}};function xa(){}xa.prototype.h=null;function _u(a){return a.h||(a.h=a.i())}function Eu(){}var Mi={OPEN:"a",kb:"b",Ja:"c",wb:"d"};function Va(){ie.call(this,"d")}C(Va,ie);function Fa(){ie.call(this,"c")}C(Fa,ie);var bs={},Tu=null;function Br(){return Tu=Tu||new te}bs.La="serverreachability";function bu(a){ie.call(this,bs.La,a)}C(bu,ie);function Oi(a){const d=Br();fe(d,new bu(d))}bs.STAT_EVENT="statevent";function wu(a,d){ie.call(this,bs.STAT_EVENT,a),this.stat=d}C(wu,ie);function Ft(a){const d=Br();fe(d,new wu(d,a))}bs.Ma="timingevent";function Au(a,d){ie.call(this,bs.Ma,a),this.size=d}C(Au,ie);function Ni(a,d){if(typeof a!="function")throw Error("Fn must not be null and must be a function");return l.setTimeout(function(){a()},d)}function xi(){this.g=!0}xi.prototype.xa=function(){this.g=!1};function av(a,d,p,w,$,j){a.info(function(){if(a.g)if(j)for(var pe="",Je=j.split("&"),At=0;At<Je.length;At++){var We=Je[At].split("=");if(1<We.length){var Pt=We[0];We=We[1];var Rt=Pt.split("_");pe=2<=Rt.length&&Rt[1]=="type"?pe+(Pt+"="+We+"&"):pe+(Pt+"=redacted&")}}else pe=null;else pe=j;return"XMLHTTP REQ ("+w+") [attempt "+$+"]: "+d+`
`+p+`
`+pe})}function lv(a,d,p,w,$,j,pe){a.info(function(){return"XMLHTTP RESP ("+w+") [ attempt "+$+"]: "+d+`
`+p+`
`+j+" "+pe})}function ei(a,d,p,w){a.info(function(){return"XMLHTTP TEXT ("+d+"): "+uv(a,p)+(w?" "+w:"")})}function cv(a,d){a.info(function(){return"TIMEOUT: "+d})}xi.prototype.info=function(){};function uv(a,d){if(!a.g)return d;if(!d)return null;try{var p=JSON.parse(d);if(p){for(a=0;a<p.length;a++)if(Array.isArray(p[a])){var w=p[a];if(!(2>w.length)){var $=w[1];if(Array.isArray($)&&!(1>$.length)){var j=$[0];if(j!="noop"&&j!="stop"&&j!="close")for(var pe=1;pe<$.length;pe++)$[pe]=""}}}}return _t(p)}catch{return d}}var Ur={NO_ERROR:0,gb:1,tb:2,sb:3,nb:4,rb:5,ub:6,Ia:7,TIMEOUT:8,xb:9},Iu={lb:"complete",Hb:"success",Ja:"error",Ia:"abort",zb:"ready",Ab:"readystatechange",TIMEOUT:"timeout",vb:"incrementaldata",yb:"progress",ob:"downloadprogress",Pb:"uploadprogress"},$a;function Hr(){}C(Hr,xa),Hr.prototype.g=function(){return new XMLHttpRequest},Hr.prototype.i=function(){return{}},$a=new Hr;function Un(a,d,p,w){this.j=a,this.i=d,this.l=p,this.R=w||1,this.U=new ut(this),this.I=45e3,this.H=null,this.o=!1,this.m=this.A=this.v=this.L=this.F=this.S=this.B=null,this.D=[],this.g=null,this.C=0,this.s=this.u=null,this.X=-1,this.J=!1,this.O=0,this.M=null,this.W=this.K=this.T=this.P=!1,this.h=new Su}function Su(){this.i=null,this.g="",this.h=!1}var Cu={},La={};function Ba(a,d,p){a.L=1,a.v=Gr(bn(d)),a.m=p,a.P=!0,ku(a,null)}function ku(a,d){a.F=Date.now(),jr(a),a.A=bn(a.v);var p=a.A,w=a.R;Array.isArray(w)||(w=[String(w)]),Hu(p.i,"t",w),a.C=0,p=a.j.J,a.h=new Su,a.g=od(a.j,p?d:null,!a.m),0<a.O&&(a.M=new ze(m(a.Y,a,a.g),a.O)),d=a.U,p=a.g,w=a.ca;var $="readystatechange";Array.isArray($)||($&&(Vt[0]=$.toString()),$=Vt);for(var j=0;j<$.length;j++){var pe=J(p,$[j],w||d.handleEvent,!1,d.h||d);if(!pe)break;d.g[pe.key]=pe}d=a.H?E(a.H):{},a.m?(a.u||(a.u="POST"),d["Content-Type"]="application/x-www-form-urlencoded",a.g.ea(a.A,a.u,a.m,d)):(a.u="GET",a.g.ea(a.A,a.u,null,d)),Oi(),av(a.i,a.u,a.A,a.l,a.R,a.m)}Un.prototype.ca=function(a){a=a.target;const d=this.M;d&&wn(a)==3?d.j():this.Y(a)},Un.prototype.Y=function(a){try{if(a==this.g)e:{const Rt=wn(this.g);var d=this.g.Ba();const si=this.g.Z();if(!(3>Rt)&&(Rt!=3||this.g&&(this.h.h||this.g.oa()||Yu(this.g)))){this.J||Rt!=4||d==7||(d==8||0>=si?Oi(3):Oi(2)),Ua(this);var p=this.g.Z();this.X=p;t:if(Pu(this)){var w=Yu(this.g);a="";var $=w.length,j=wn(this.g)==4;if(!this.h.i){if(typeof TextDecoder>"u"){ws(this),Vi(this);var pe="";break t}this.h.i=new l.TextDecoder}for(d=0;d<$;d++)this.h.h=!0,a+=this.h.i.decode(w[d],{stream:!(j&&d==$-1)});w.length=0,this.h.g+=a,this.C=0,pe=this.h.g}else pe=this.g.oa();if(this.o=p==200,lv(this.i,this.u,this.A,this.l,this.R,Rt,p),this.o){if(this.T&&!this.K){t:{if(this.g){var Je,At=this.g;if((Je=At.g?At.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!P(Je)){var We=Je;break t}}We=null}if(p=We)ei(this.i,this.l,p,"Initial handshake response via X-HTTP-Initial-Response"),this.K=!0,Ha(this,p);else{this.o=!1,this.s=3,Ft(12),ws(this),Vi(this);break e}}if(this.P){p=!0;let an;for(;!this.J&&this.C<pe.length;)if(an=dv(this,pe),an==La){Rt==4&&(this.s=4,Ft(14),p=!1),ei(this.i,this.l,null,"[Incomplete Response]");break}else if(an==Cu){this.s=4,Ft(15),ei(this.i,this.l,pe,"[Invalid Chunk]"),p=!1;break}else ei(this.i,this.l,an,null),Ha(this,an);if(Pu(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),Rt!=4||pe.length!=0||this.h.h||(this.s=1,Ft(16),p=!1),this.o=this.o&&p,!p)ei(this.i,this.l,pe,"[Invalid Chunked Response]"),ws(this),Vi(this);else if(0<pe.length&&!this.W){this.W=!0;var Pt=this.j;Pt.g==this&&Pt.ba&&!Pt.M&&(Pt.j.info("Great, no buffering proxy detected. Bytes received: "+pe.length),za(Pt),Pt.M=!0,Ft(11))}}else ei(this.i,this.l,pe,null),Ha(this,pe);Rt==4&&ws(this),this.o&&!this.J&&(Rt==4?nd(this.j,this):(this.o=!1,jr(this)))}else kv(this.g),p==400&&0<pe.indexOf("Unknown SID")?(this.s=3,Ft(12)):(this.s=0,Ft(13)),ws(this),Vi(this)}}}catch{}finally{}};function Pu(a){return a.g?a.u=="GET"&&a.L!=2&&a.j.Ca:!1}function dv(a,d){var p=a.C,w=d.indexOf(`
`,p);return w==-1?La:(p=Number(d.substring(p,w)),isNaN(p)?Cu:(w+=1,w+p>d.length?La:(d=d.slice(w,w+p),a.C=w+p,d)))}Un.prototype.cancel=function(){this.J=!0,ws(this)};function jr(a){a.S=Date.now()+a.I,Ru(a,a.I)}function Ru(a,d){if(a.B!=null)throw Error("WatchDog timer not null");a.B=Ni(m(a.ba,a),d)}function Ua(a){a.B&&(l.clearTimeout(a.B),a.B=null)}Un.prototype.ba=function(){this.B=null;const a=Date.now();0<=a-this.S?(cv(this.i,this.A),this.L!=2&&(Oi(),Ft(17)),ws(this),this.s=2,Vi(this)):Ru(this,this.S-a)};function Vi(a){a.j.G==0||a.J||nd(a.j,a)}function ws(a){Ua(a);var d=a.M;d&&typeof d.ma=="function"&&d.ma(),a.M=null,Ts(a.U),a.g&&(d=a.g,a.g=null,d.abort(),d.ma())}function Ha(a,d){try{var p=a.j;if(p.G!=0&&(p.g==a||ja(p.h,a))){if(!a.K&&ja(p.h,a)&&p.G==3){try{var w=p.Da.g.parse(d)}catch{w=null}if(Array.isArray(w)&&w.length==3){var $=w;if($[0]==0){e:if(!p.u){if(p.g)if(p.g.F+3e3<a.F)Jr(p),Qr(p);else break e;Wa(p),Ft(18)}}else p.za=$[1],0<p.za-p.T&&37500>$[2]&&p.F&&p.v==0&&!p.C&&(p.C=Ni(m(p.Za,p),6e3));if(1>=Ou(p.h)&&p.ca){try{p.ca()}catch{}p.ca=void 0}}else Is(p,11)}else if((a.K||p.g==a)&&Jr(p),!P(d))for($=p.Da.g.parse(d),d=0;d<$.length;d++){let We=$[d];if(p.T=We[0],We=We[1],p.G==2)if(We[0]=="c"){p.K=We[1],p.ia=We[2];const Pt=We[3];Pt!=null&&(p.la=Pt,p.j.info("VER="+p.la));const Rt=We[4];Rt!=null&&(p.Aa=Rt,p.j.info("SVER="+p.Aa));const si=We[5];si!=null&&typeof si=="number"&&0<si&&(w=1.5*si,p.L=w,p.j.info("backChannelRequestTimeoutMs_="+w)),w=p;const an=a.g;if(an){const eo=an.g?an.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(eo){var j=w.h;j.g||eo.indexOf("spdy")==-1&&eo.indexOf("quic")==-1&&eo.indexOf("h2")==-1||(j.j=j.l,j.g=new Set,j.h&&(Ka(j,j.h),j.h=null))}if(w.D){const Ya=an.g?an.g.getResponseHeader("X-HTTP-Session-Id"):null;Ya&&(w.ya=Ya,nt(w.I,w.D,Ya))}}p.G=3,p.l&&p.l.ua(),p.ba&&(p.R=Date.now()-a.F,p.j.info("Handshake RTT: "+p.R+"ms")),w=p;var pe=a;if(w.qa=rd(w,w.J?w.ia:null,w.W),pe.K){Nu(w.h,pe);var Je=pe,At=w.L;At&&(Je.I=At),Je.B&&(Ua(Je),jr(Je)),w.g=pe}else ed(w);0<p.i.length&&Xr(p)}else We[0]!="stop"&&We[0]!="close"||Is(p,7);else p.G==3&&(We[0]=="stop"||We[0]=="close"?We[0]=="stop"?Is(p,7):Ga(p):We[0]!="noop"&&p.l&&p.l.ta(We),p.v=0)}}Oi(4)}catch{}}var hv=class{constructor(a,d){this.g=a,this.map=d}};function Du(a){this.l=a||10,l.PerformanceNavigationTiming?(a=l.performance.getEntriesByType("navigation"),a=0<a.length&&(a[0].nextHopProtocol=="hq"||a[0].nextHopProtocol=="h2")):a=!!(l.chrome&&l.chrome.loadTimes&&l.chrome.loadTimes()&&l.chrome.loadTimes().wasFetchedViaSpdy),this.j=a?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}function Mu(a){return a.h?!0:a.g?a.g.size>=a.j:!1}function Ou(a){return a.h?1:a.g?a.g.size:0}function ja(a,d){return a.h?a.h==d:a.g?a.g.has(d):!1}function Ka(a,d){a.g?a.g.add(d):a.h=d}function Nu(a,d){a.h&&a.h==d?a.h=null:a.g&&a.g.has(d)&&a.g.delete(d)}Du.prototype.cancel=function(){if(this.i=xu(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const a of this.g.values())a.cancel();this.g.clear()}};function xu(a){if(a.h!=null)return a.i.concat(a.h.D);if(a.g!=null&&a.g.size!==0){let d=a.i;for(const p of a.g.values())d=d.concat(p.D);return d}return D(a.i)}function fv(a){if(a.V&&typeof a.V=="function")return a.V();if(typeof Map<"u"&&a instanceof Map||typeof Set<"u"&&a instanceof Set)return Array.from(a.values());if(typeof a=="string")return a.split("");if(c(a)){for(var d=[],p=a.length,w=0;w<p;w++)d.push(a[w]);return d}d=[],p=0;for(w in a)d[p++]=a[w];return d}function pv(a){if(a.na&&typeof a.na=="function")return a.na();if(!a.V||typeof a.V!="function"){if(typeof Map<"u"&&a instanceof Map)return Array.from(a.keys());if(!(typeof Set<"u"&&a instanceof Set)){if(c(a)||typeof a=="string"){var d=[];a=a.length;for(var p=0;p<a;p++)d.push(p);return d}d=[],p=0;for(const w in a)d[p++]=w;return d}}}function Vu(a,d){if(a.forEach&&typeof a.forEach=="function")a.forEach(d,void 0);else if(c(a)||typeof a=="string")Array.prototype.forEach.call(a,d,void 0);else for(var p=pv(a),w=fv(a),$=w.length,j=0;j<$;j++)d.call(void 0,w[j],p&&p[j],a)}var Fu=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function gv(a,d){if(a){a=a.split("&");for(var p=0;p<a.length;p++){var w=a[p].indexOf("="),$=null;if(0<=w){var j=a[p].substring(0,w);$=a[p].substring(w+1)}else j=a[p];d(j,$?decodeURIComponent($.replace(/\+/g," ")):"")}}}function As(a){if(this.g=this.o=this.j="",this.s=null,this.m=this.l="",this.h=!1,a instanceof As){this.h=a.h,Kr(this,a.j),this.o=a.o,this.g=a.g,qr(this,a.s),this.l=a.l;var d=a.i,p=new Li;p.i=d.i,d.g&&(p.g=new Map(d.g),p.h=d.h),$u(this,p),this.m=a.m}else a&&(d=String(a).match(Fu))?(this.h=!1,Kr(this,d[1]||"",!0),this.o=Fi(d[2]||""),this.g=Fi(d[3]||"",!0),qr(this,d[4]),this.l=Fi(d[5]||"",!0),$u(this,d[6]||"",!0),this.m=Fi(d[7]||"")):(this.h=!1,this.i=new Li(null,this.h))}As.prototype.toString=function(){var a=[],d=this.j;d&&a.push($i(d,Lu,!0),":");var p=this.g;return(p||d=="file")&&(a.push("//"),(d=this.o)&&a.push($i(d,Lu,!0),"@"),a.push(encodeURIComponent(String(p)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),p=this.s,p!=null&&a.push(":",String(p))),(p=this.l)&&(this.g&&p.charAt(0)!="/"&&a.push("/"),a.push($i(p,p.charAt(0)=="/"?yv:vv,!0))),(p=this.i.toString())&&a.push("?",p),(p=this.m)&&a.push("#",$i(p,Ev)),a.join("")};function bn(a){return new As(a)}function Kr(a,d,p){a.j=p?Fi(d,!0):d,a.j&&(a.j=a.j.replace(/:$/,""))}function qr(a,d){if(d){if(d=Number(d),isNaN(d)||0>d)throw Error("Bad port number "+d);a.s=d}else a.s=null}function $u(a,d,p){d instanceof Li?(a.i=d,Tv(a.i,a.h)):(p||(d=$i(d,_v)),a.i=new Li(d,a.h))}function nt(a,d,p){a.i.set(d,p)}function Gr(a){return nt(a,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),a}function Fi(a,d){return a?d?decodeURI(a.replace(/%25/g,"%2525")):decodeURIComponent(a):""}function $i(a,d,p){return typeof a=="string"?(a=encodeURI(a).replace(d,mv),p&&(a=a.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),a):null}function mv(a){return a=a.charCodeAt(0),"%"+(a>>4&15).toString(16)+(a&15).toString(16)}var Lu=/[#\/\?@]/g,vv=/[#\?:]/g,yv=/[#\?]/g,_v=/[#\?@]/g,Ev=/#/g;function Li(a,d){this.h=this.g=null,this.i=a||null,this.j=!!d}function Hn(a){a.g||(a.g=new Map,a.h=0,a.i&&gv(a.i,function(d,p){a.add(decodeURIComponent(d.replace(/\+/g," ")),p)}))}t=Li.prototype,t.add=function(a,d){Hn(this),this.i=null,a=ti(this,a);var p=this.g.get(a);return p||this.g.set(a,p=[]),p.push(d),this.h+=1,this};function Bu(a,d){Hn(a),d=ti(a,d),a.g.has(d)&&(a.i=null,a.h-=a.g.get(d).length,a.g.delete(d))}function Uu(a,d){return Hn(a),d=ti(a,d),a.g.has(d)}t.forEach=function(a,d){Hn(this),this.g.forEach(function(p,w){p.forEach(function($){a.call(d,$,w,this)},this)},this)},t.na=function(){Hn(this);const a=Array.from(this.g.values()),d=Array.from(this.g.keys()),p=[];for(let w=0;w<d.length;w++){const $=a[w];for(let j=0;j<$.length;j++)p.push(d[w])}return p},t.V=function(a){Hn(this);let d=[];if(typeof a=="string")Uu(this,a)&&(d=d.concat(this.g.get(ti(this,a))));else{a=Array.from(this.g.values());for(let p=0;p<a.length;p++)d=d.concat(a[p])}return d},t.set=function(a,d){return Hn(this),this.i=null,a=ti(this,a),Uu(this,a)&&(this.h-=this.g.get(a).length),this.g.set(a,[d]),this.h+=1,this},t.get=function(a,d){return a?(a=this.V(a),0<a.length?String(a[0]):d):d};function Hu(a,d,p){Bu(a,d),0<p.length&&(a.i=null,a.g.set(ti(a,d),D(p)),a.h+=p.length)}t.toString=function(){if(this.i)return this.i;if(!this.g)return"";const a=[],d=Array.from(this.g.keys());for(var p=0;p<d.length;p++){var w=d[p];const j=encodeURIComponent(String(w)),pe=this.V(w);for(w=0;w<pe.length;w++){var $=j;pe[w]!==""&&($+="="+encodeURIComponent(String(pe[w]))),a.push($)}}return this.i=a.join("&")};function ti(a,d){return d=String(d),a.j&&(d=d.toLowerCase()),d}function Tv(a,d){d&&!a.j&&(Hn(a),a.i=null,a.g.forEach(function(p,w){var $=w.toLowerCase();w!=$&&(Bu(this,w),Hu(this,$,p))},a)),a.j=d}function bv(a,d){const p=new xi;if(l.Image){const w=new Image;w.onload=y(jn,p,"TestLoadImage: loaded",!0,d,w),w.onerror=y(jn,p,"TestLoadImage: error",!1,d,w),w.onabort=y(jn,p,"TestLoadImage: abort",!1,d,w),w.ontimeout=y(jn,p,"TestLoadImage: timeout",!1,d,w),l.setTimeout(function(){w.ontimeout&&w.ontimeout()},1e4),w.src=a}else d(!1)}function wv(a,d){const p=new xi,w=new AbortController,$=setTimeout(()=>{w.abort(),jn(p,"TestPingServer: timeout",!1,d)},1e4);fetch(a,{signal:w.signal}).then(j=>{clearTimeout($),j.ok?jn(p,"TestPingServer: ok",!0,d):jn(p,"TestPingServer: server error",!1,d)}).catch(()=>{clearTimeout($),jn(p,"TestPingServer: error",!1,d)})}function jn(a,d,p,w,$){try{$&&($.onload=null,$.onerror=null,$.onabort=null,$.ontimeout=null),w(p)}catch{}}function Av(){this.g=new Lr}function Iv(a,d,p){const w=p||"";try{Vu(a,function($,j){let pe=$;u($)&&(pe=_t($)),d.push(w+j+"="+encodeURIComponent(pe))})}catch($){throw d.push(w+"type="+encodeURIComponent("_badmap")),$}}function Wr(a){this.l=a.Ub||null,this.j=a.eb||!1}C(Wr,xa),Wr.prototype.g=function(){return new zr(this.l,this.j)},Wr.prototype.i=function(a){return function(){return a}}({});function zr(a,d){te.call(this),this.D=a,this.o=d,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.u=new Headers,this.h=null,this.B="GET",this.A="",this.g=!1,this.v=this.j=this.l=null}C(zr,te),t=zr.prototype,t.open=function(a,d){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.B=a,this.A=d,this.readyState=1,Ui(this)},t.send=function(a){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");this.g=!0;const d={headers:this.u,method:this.B,credentials:this.m,cache:void 0};a&&(d.body=a),(this.D||l).fetch(new Request(this.A,d)).then(this.Sa.bind(this),this.ga.bind(this))},t.abort=function(){this.response=this.responseText="",this.u=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),1<=this.readyState&&this.g&&this.readyState!=4&&(this.g=!1,Bi(this)),this.readyState=0},t.Sa=function(a){if(this.g&&(this.l=a,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=a.headers,this.readyState=2,Ui(this)),this.g&&(this.readyState=3,Ui(this),this.g)))if(this.responseType==="arraybuffer")a.arrayBuffer().then(this.Qa.bind(this),this.ga.bind(this));else if(typeof l.ReadableStream<"u"&&"body"in a){if(this.j=a.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.v=new TextDecoder;ju(this)}else a.text().then(this.Ra.bind(this),this.ga.bind(this))};function ju(a){a.j.read().then(a.Pa.bind(a)).catch(a.ga.bind(a))}t.Pa=function(a){if(this.g){if(this.o&&a.value)this.response.push(a.value);else if(!this.o){var d=a.value?a.value:new Uint8Array(0);(d=this.v.decode(d,{stream:!a.done}))&&(this.response=this.responseText+=d)}a.done?Bi(this):Ui(this),this.readyState==3&&ju(this)}},t.Ra=function(a){this.g&&(this.response=this.responseText=a,Bi(this))},t.Qa=function(a){this.g&&(this.response=a,Bi(this))},t.ga=function(){this.g&&Bi(this)};function Bi(a){a.readyState=4,a.l=null,a.j=null,a.v=null,Ui(a)}t.setRequestHeader=function(a,d){this.u.append(a,d)},t.getResponseHeader=function(a){return this.h&&this.h.get(a.toLowerCase())||""},t.getAllResponseHeaders=function(){if(!this.h)return"";const a=[],d=this.h.entries();for(var p=d.next();!p.done;)p=p.value,a.push(p[0]+": "+p[1]),p=d.next();return a.join(`\r
`)};function Ui(a){a.onreadystatechange&&a.onreadystatechange.call(a)}Object.defineProperty(zr.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(a){this.m=a?"include":"same-origin"}});function Ku(a){let d="";return O(a,function(p,w){d+=w,d+=":",d+=p,d+=`\r
`}),d}function qa(a,d,p){e:{for(w in p){var w=!1;break e}w=!0}w||(p=Ku(p),typeof a=="string"?p!=null&&encodeURIComponent(String(p)):nt(a,d,p))}function lt(a){te.call(this),this.headers=new Map,this.o=a||null,this.h=!1,this.v=this.g=null,this.D="",this.m=0,this.l="",this.j=this.B=this.u=this.A=!1,this.I=null,this.H="",this.J=!1}C(lt,te);var Sv=/^https?$/i,Cv=["POST","PUT"];t=lt.prototype,t.Ha=function(a){this.J=a},t.ea=function(a,d,p,w){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+a);d=d?d.toUpperCase():"GET",this.D=a,this.l="",this.m=0,this.A=!1,this.h=!0,this.g=this.o?this.o.g():$a.g(),this.v=this.o?_u(this.o):_u($a),this.g.onreadystatechange=m(this.Ea,this);try{this.B=!0,this.g.open(d,String(a),!0),this.B=!1}catch(j){qu(this,j);return}if(a=p||"",p=new Map(this.headers),w)if(Object.getPrototypeOf(w)===Object.prototype)for(var $ in w)p.set($,w[$]);else if(typeof w.keys=="function"&&typeof w.get=="function")for(const j of w.keys())p.set(j,w.get(j));else throw Error("Unknown input type for opt_headers: "+String(w));w=Array.from(p.keys()).find(j=>j.toLowerCase()=="content-type"),$=l.FormData&&a instanceof l.FormData,!(0<=Array.prototype.indexOf.call(Cv,d,void 0))||w||$||p.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[j,pe]of p)this.g.setRequestHeader(j,pe);this.H&&(this.g.responseType=this.H),"withCredentials"in this.g&&this.g.withCredentials!==this.J&&(this.g.withCredentials=this.J);try{zu(this),this.u=!0,this.g.send(a),this.u=!1}catch(j){qu(this,j)}};function qu(a,d){a.h=!1,a.g&&(a.j=!0,a.g.abort(),a.j=!1),a.l=d,a.m=5,Gu(a),Yr(a)}function Gu(a){a.A||(a.A=!0,fe(a,"complete"),fe(a,"error"))}t.abort=function(a){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.m=a||7,fe(this,"complete"),fe(this,"abort"),Yr(this))},t.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),Yr(this,!0)),lt.aa.N.call(this)},t.Ea=function(){this.s||(this.B||this.u||this.j?Wu(this):this.bb())},t.bb=function(){Wu(this)};function Wu(a){if(a.h&&typeof o<"u"&&(!a.v[1]||wn(a)!=4||a.Z()!=2)){if(a.u&&wn(a)==4)Se(a.Ea,0,a);else if(fe(a,"readystatechange"),wn(a)==4){a.h=!1;try{const pe=a.Z();e:switch(pe){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var d=!0;break e;default:d=!1}var p;if(!(p=d)){var w;if(w=pe===0){var $=String(a.D).match(Fu)[1]||null;!$&&l.self&&l.self.location&&($=l.self.location.protocol.slice(0,-1)),w=!Sv.test($?$.toLowerCase():"")}p=w}if(p)fe(a,"complete"),fe(a,"success");else{a.m=6;try{var j=2<wn(a)?a.g.statusText:""}catch{j=""}a.l=j+" ["+a.Z()+"]",Gu(a)}}finally{Yr(a)}}}}function Yr(a,d){if(a.g){zu(a);const p=a.g,w=a.v[0]?()=>{}:null;a.g=null,a.v=null,d||fe(a,"ready");try{p.onreadystatechange=w}catch{}}}function zu(a){a.I&&(l.clearTimeout(a.I),a.I=null)}t.isActive=function(){return!!this.g};function wn(a){return a.g?a.g.readyState:0}t.Z=function(){try{return 2<wn(this)?this.g.status:-1}catch{return-1}},t.oa=function(){try{return this.g?this.g.responseText:""}catch{return""}},t.Oa=function(a){if(this.g){var d=this.g.responseText;return a&&d.indexOf(a)==0&&(d=d.substring(a.length)),en(d)}};function Yu(a){try{if(!a.g)return null;if("response"in a.g)return a.g.response;switch(a.H){case"":case"text":return a.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in a.g)return a.g.mozResponseArrayBuffer}return null}catch{return null}}function kv(a){const d={};a=(a.g&&2<=wn(a)&&a.g.getAllResponseHeaders()||"").split(`\r
`);for(let w=0;w<a.length;w++){if(P(a[w]))continue;var p=T(a[w]);const $=p[0];if(p=p[1],typeof p!="string")continue;p=p.trim();const j=d[$]||[];d[$]=j,j.push(p)}I(d,function(w){return w.join(", ")})}t.Ba=function(){return this.m},t.Ka=function(){return typeof this.l=="string"?this.l:String(this.l)};function Hi(a,d,p){return p&&p.internalChannelParams&&p.internalChannelParams[a]||d}function Qu(a){this.Aa=0,this.i=[],this.j=new xi,this.ia=this.qa=this.I=this.W=this.g=this.ya=this.D=this.H=this.m=this.S=this.o=null,this.Ya=this.U=0,this.Va=Hi("failFast",!1,a),this.F=this.C=this.u=this.s=this.l=null,this.X=!0,this.za=this.T=-1,this.Y=this.v=this.B=0,this.Ta=Hi("baseRetryDelayMs",5e3,a),this.cb=Hi("retryDelaySeedMs",1e4,a),this.Wa=Hi("forwardChannelMaxRetries",2,a),this.wa=Hi("forwardChannelRequestTimeoutMs",2e4,a),this.pa=a&&a.xmlHttpFactory||void 0,this.Xa=a&&a.Tb||void 0,this.Ca=a&&a.useFetchStreams||!1,this.L=void 0,this.J=a&&a.supportsCrossDomainXhr||!1,this.K="",this.h=new Du(a&&a.concurrentRequestLimit),this.Da=new Av,this.P=a&&a.fastHandshake||!1,this.O=a&&a.encodeInitMessageHeaders||!1,this.P&&this.O&&(this.O=!1),this.Ua=a&&a.Rb||!1,a&&a.xa&&this.j.xa(),a&&a.forceLongPolling&&(this.X=!1),this.ba=!this.P&&this.X&&a&&a.detectBufferingProxy||!1,this.ja=void 0,a&&a.longPollingTimeout&&0<a.longPollingTimeout&&(this.ja=a.longPollingTimeout),this.ca=void 0,this.R=0,this.M=!1,this.ka=this.A=null}t=Qu.prototype,t.la=8,t.G=1,t.connect=function(a,d,p,w){Ft(0),this.W=a,this.H=d||{},p&&w!==void 0&&(this.H.OSID=p,this.H.OAID=w),this.F=this.X,this.I=rd(this,null,this.W),Xr(this)};function Ga(a){if(Xu(a),a.G==3){var d=a.U++,p=bn(a.I);if(nt(p,"SID",a.K),nt(p,"RID",d),nt(p,"TYPE","terminate"),ji(a,p),d=new Un(a,a.j,d),d.L=2,d.v=Gr(bn(p)),p=!1,l.navigator&&l.navigator.sendBeacon)try{p=l.navigator.sendBeacon(d.v.toString(),"")}catch{}!p&&l.Image&&(new Image().src=d.v,p=!0),p||(d.g=od(d.j,null),d.g.ea(d.v)),d.F=Date.now(),jr(d)}id(a)}function Qr(a){a.g&&(za(a),a.g.cancel(),a.g=null)}function Xu(a){Qr(a),a.u&&(l.clearTimeout(a.u),a.u=null),Jr(a),a.h.cancel(),a.s&&(typeof a.s=="number"&&l.clearTimeout(a.s),a.s=null)}function Xr(a){if(!Mu(a.h)&&!a.s){a.s=!0;var d=a.Ga;G||ke(),Q||(G(),Q=!0),le.add(d,a),a.B=0}}function Pv(a,d){return Ou(a.h)>=a.h.j-(a.s?1:0)?!1:a.s?(a.i=d.D.concat(a.i),!0):a.G==1||a.G==2||a.B>=(a.Va?0:a.Wa)?!1:(a.s=Ni(m(a.Ga,a,d),sd(a,a.B)),a.B++,!0)}t.Ga=function(a){if(this.s)if(this.s=null,this.G==1){if(!a){this.U=Math.floor(1e5*Math.random()),a=this.U++;const $=new Un(this,this.j,a);let j=this.o;if(this.S&&(j?(j=E(j),_(j,this.S)):j=this.S),this.m!==null||this.O||($.H=j,j=null),this.P)e:{for(var d=0,p=0;p<this.i.length;p++){t:{var w=this.i[p];if("__data__"in w.map&&(w=w.map.__data__,typeof w=="string")){w=w.length;break t}w=void 0}if(w===void 0)break;if(d+=w,4096<d){d=p;break e}if(d===4096||p===this.i.length-1){d=p+1;break e}}d=1e3}else d=1e3;d=Zu(this,$,d),p=bn(this.I),nt(p,"RID",a),nt(p,"CVER",22),this.D&&nt(p,"X-HTTP-Session-Id",this.D),ji(this,p),j&&(this.O?d="headers="+encodeURIComponent(String(Ku(j)))+"&"+d:this.m&&qa(p,this.m,j)),Ka(this.h,$),this.Ua&&nt(p,"TYPE","init"),this.P?(nt(p,"$req",d),nt(p,"SID","null"),$.T=!0,Ba($,p,null)):Ba($,p,d),this.G=2}}else this.G==3&&(a?Ju(this,a):this.i.length==0||Mu(this.h)||Ju(this))};function Ju(a,d){var p;d?p=d.l:p=a.U++;const w=bn(a.I);nt(w,"SID",a.K),nt(w,"RID",p),nt(w,"AID",a.T),ji(a,w),a.m&&a.o&&qa(w,a.m,a.o),p=new Un(a,a.j,p,a.B+1),a.m===null&&(p.H=a.o),d&&(a.i=d.D.concat(a.i)),d=Zu(a,p,1e3),p.I=Math.round(.5*a.wa)+Math.round(.5*a.wa*Math.random()),Ka(a.h,p),Ba(p,w,d)}function ji(a,d){a.H&&O(a.H,function(p,w){nt(d,w,p)}),a.l&&Vu({},function(p,w){nt(d,w,p)})}function Zu(a,d,p){p=Math.min(a.i.length,p);var w=a.l?m(a.l.Na,a.l,a):null;e:{var $=a.i;let j=-1;for(;;){const pe=["count="+p];j==-1?0<p?(j=$[0].g,pe.push("ofs="+j)):j=0:pe.push("ofs="+j);let Je=!0;for(let At=0;At<p;At++){let We=$[At].g;const Pt=$[At].map;if(We-=j,0>We)j=Math.max(0,$[At].g-100),Je=!1;else try{Iv(Pt,pe,"req"+We+"_")}catch{w&&w(Pt)}}if(Je){w=pe.join("&");break e}}}return a=a.i.splice(0,p),d.D=a,w}function ed(a){if(!a.g&&!a.u){a.Y=1;var d=a.Fa;G||ke(),Q||(G(),Q=!0),le.add(d,a),a.v=0}}function Wa(a){return a.g||a.u||3<=a.v?!1:(a.Y++,a.u=Ni(m(a.Fa,a),sd(a,a.v)),a.v++,!0)}t.Fa=function(){if(this.u=null,td(this),this.ba&&!(this.M||this.g==null||0>=this.R)){var a=2*this.R;this.j.info("BP detection timer enabled: "+a),this.A=Ni(m(this.ab,this),a)}},t.ab=function(){this.A&&(this.A=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.M=!0,Ft(10),Qr(this),td(this))};function za(a){a.A!=null&&(l.clearTimeout(a.A),a.A=null)}function td(a){a.g=new Un(a,a.j,"rpc",a.Y),a.m===null&&(a.g.H=a.o),a.g.O=0;var d=bn(a.qa);nt(d,"RID","rpc"),nt(d,"SID",a.K),nt(d,"AID",a.T),nt(d,"CI",a.F?"0":"1"),!a.F&&a.ja&&nt(d,"TO",a.ja),nt(d,"TYPE","xmlhttp"),ji(a,d),a.m&&a.o&&qa(d,a.m,a.o),a.L&&(a.g.I=a.L);var p=a.g;a=a.ia,p.L=1,p.v=Gr(bn(d)),p.m=null,p.P=!0,ku(p,a)}t.Za=function(){this.C!=null&&(this.C=null,Qr(this),Wa(this),Ft(19))};function Jr(a){a.C!=null&&(l.clearTimeout(a.C),a.C=null)}function nd(a,d){var p=null;if(a.g==d){Jr(a),za(a),a.g=null;var w=2}else if(ja(a.h,d))p=d.D,Nu(a.h,d),w=1;else return;if(a.G!=0){if(d.o)if(w==1){p=d.m?d.m.length:0,d=Date.now()-d.F;var $=a.B;w=Br(),fe(w,new Au(w,p)),Xr(a)}else ed(a);else if($=d.s,$==3||$==0&&0<d.X||!(w==1&&Pv(a,d)||w==2&&Wa(a)))switch(p&&0<p.length&&(d=a.h,d.i=d.i.concat(p)),$){case 1:Is(a,5);break;case 4:Is(a,10);break;case 3:Is(a,6);break;default:Is(a,2)}}}function sd(a,d){let p=a.Ta+Math.floor(Math.random()*a.cb);return a.isActive()||(p*=2),p*d}function Is(a,d){if(a.j.info("Error code "+d),d==2){var p=m(a.fb,a),w=a.Xa;const $=!w;w=new As(w||"//www.googwweweweaele.com/images/cleardot.gif"),l.location&&l.location.protocol=="http"||Kr(w,"https"),Gr(w),$?bv(w.toString(),p):wv(w.toString(),p)}else Ft(2);a.G=0,a.l&&a.l.sa(d),id(a),Xu(a)}t.fb=function(a){a?(this.j.info("Successfully pinged google.com"),Ft(2)):(this.j.info("Failed to ping google.com"),Ft(1))};function id(a){if(a.G=0,a.ka=[],a.l){const d=xu(a.h);(d.length!=0||a.i.length!=0)&&(S(a.ka,d),S(a.ka,a.i),a.h.i.length=0,D(a.i),a.i.length=0),a.l.ra()}}function rd(a,d,p){var w=p instanceof As?bn(p):new As(p);if(w.g!="")d&&(w.g=d+"."+w.g),qr(w,w.s);else{var $=l.location;w=$.protocol,d=d?d+"."+$.hostname:$.hostname,$=+$.port;var j=new As(null);w&&Kr(j,w),d&&(j.g=d),$&&qr(j,$),p&&(j.l=p),w=j}return p=a.D,d=a.ya,p&&d&&nt(w,p,d),nt(w,"VER",a.la),ji(a,w),w}function od(a,d,p){if(d&&!a.J)throw Error("Can't create secondary domain capable XhrIo object.");return d=a.Ca&&!a.pa?new lt(new Wr({eb:p})):new lt(a.pa),d.Ha(a.J),d}t.isActive=function(){return!!this.l&&this.l.isActive(this)};function ad(){}t=ad.prototype,t.ua=function(){},t.ta=function(){},t.sa=function(){},t.ra=function(){},t.isActive=function(){return!0},t.Na=function(){};function Zr(){}Zr.prototype.g=function(a,d){return new zt(a,d)};function zt(a,d){te.call(this),this.g=new Qu(d),this.l=a,this.h=d&&d.messageUrlParams||null,a=d&&d.messageHeaders||null,d&&d.clientProtocolHeaderRequired&&(a?a["X-Client-Protocol"]="webchannel":a={"X-Client-Protocol":"webchannel"}),this.g.o=a,a=d&&d.initMessageHeaders||null,d&&d.messageContentType&&(a?a["X-WebChannel-Content-Type"]=d.messageContentType:a={"X-WebChannel-Content-Type":d.messageContentType}),d&&d.va&&(a?a["X-WebChannel-Client-Profile"]=d.va:a={"X-WebChannel-Client-Profile":d.va}),this.g.S=a,(a=d&&d.Sb)&&!P(a)&&(this.g.m=a),this.v=d&&d.supportsCrossDomainXhr||!1,this.u=d&&d.sendRawJson||!1,(d=d&&d.httpSessionIdParam)&&!P(d)&&(this.g.D=d,a=this.h,a!==null&&d in a&&(a=this.h,d in a&&delete a[d])),this.j=new ni(this)}C(zt,te),zt.prototype.m=function(){this.g.l=this.j,this.v&&(this.g.J=!0),this.g.connect(this.l,this.h||void 0)},zt.prototype.close=function(){Ga(this.g)},zt.prototype.o=function(a){var d=this.g;if(typeof a=="string"){var p={};p.__data__=a,a=p}else this.u&&(p={},p.__data__=_t(a),a=p);d.i.push(new hv(d.Ya++,a)),d.G==3&&Xr(d)},zt.prototype.N=function(){this.g.l=null,delete this.j,Ga(this.g),delete this.g,zt.aa.N.call(this)};function ld(a){Va.call(this),a.__headers__&&(this.headers=a.__headers__,this.statusCode=a.__status__,delete a.__headers__,delete a.__status__);var d=a.__sm__;if(d){e:{for(const p in d){a=p;break e}a=void 0}(this.i=a)&&(a=this.i,d=d!==null&&a in d?d[a]:void 0),this.data=d}else this.data=a}C(ld,Va);function cd(){Fa.call(this),this.status=1}C(cd,Fa);function ni(a){this.g=a}C(ni,ad),ni.prototype.ua=function(){fe(this.g,"a")},ni.prototype.ta=function(a){fe(this.g,new ld(a))},ni.prototype.sa=function(a){fe(this.g,new cd)},ni.prototype.ra=function(){fe(this.g,"b")},Zr.prototype.createWebChannel=Zr.prototype.g,zt.prototype.send=zt.prototype.o,zt.prototype.open=zt.prototype.m,zt.prototype.close=zt.prototype.close,Tg=function(){return new Zr},Eg=function(){return Br()},_g=bs,jl={mb:0,pb:1,qb:2,Jb:3,Ob:4,Lb:5,Mb:6,Kb:7,Ib:8,Nb:9,PROXY:10,NOPROXY:11,Gb:12,Cb:13,Db:14,Bb:15,Eb:16,Fb:17,ib:18,hb:19,jb:20},Ur.NO_ERROR=0,Ur.TIMEOUT=8,Ur.HTTP_ERROR=6,vo=Ur,Iu.COMPLETE="complete",yg=Iu,Eu.EventType=Mi,Mi.OPEN="a",Mi.CLOSE="b",Mi.ERROR="c",Mi.MESSAGE="d",te.prototype.listen=te.prototype.K,Wi=Eu,lt.prototype.listenOnce=lt.prototype.L,lt.prototype.getLastError=lt.prototype.Ka,lt.prototype.getLastErrorCode=lt.prototype.Ba,lt.prototype.getStatus=lt.prototype.Z,lt.prototype.getResponseJson=lt.prototype.Oa,lt.prototype.getResponseText=lt.prototype.oa,lt.prototype.send=lt.prototype.ea,lt.prototype.setWithCredentials=lt.prototype.Ha,vg=lt}).apply(typeof ro<"u"?ro:typeof self<"u"?self:typeof window<"u"?window:{});const mh="@firebase/firestore",vh="4.7.9";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Mt{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}Mt.UNAUTHENTICATED=new Mt(null),Mt.GOOGLE_CREDENTIALS=new Mt("google-credentials-uid"),Mt.FIRST_PARTY=new Mt("first-party-uid"),Mt.MOCK_USER=new Mt("mock-user");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Ii="11.4.0";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Hs=new Pc("@firebase/firestore");function li(){return Hs.logLevel}function Ee(t,...e){if(Hs.logLevel<=Ke.DEBUG){const n=e.map(Vc);Hs.debug(`Firestore (${Ii}): ${t}`,...n)}}function xn(t,...e){if(Hs.logLevel<=Ke.ERROR){const n=e.map(Vc);Hs.error(`Firestore (${Ii}): ${t}`,...n)}}function js(t,...e){if(Hs.logLevel<=Ke.WARN){const n=e.map(Vc);Hs.warn(`Firestore (${Ii}): ${t}`,...n)}}function Vc(t){if(typeof t=="string")return t;try{/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/return function(n){return JSON.stringify(n)}(t)}catch{return t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Pe(t="Unexpected state"){const e=`FIRESTORE (${Ii}) INTERNAL ASSERTION FAILED: `+t;throw xn(e),new Error(e)}function Qe(t,e){t||Pe()}function Me(t,e){return t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const z={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class _e extends Es{constructor(e,n){super(e,n),this.code=e,this.message=n,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Dn{constructor(){this.promise=new Promise((e,n)=>{this.resolve=e,this.reject=n})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bg{constructor(e,n){this.user=n,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class wg{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,n){e.enqueueRetryable(()=>n(Mt.UNAUTHENTICATED))}shutdown(){}}class wb{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,n){this.changeListener=n,e.enqueueRetryable(()=>n(this.token.user))}shutdown(){this.changeListener=null}}class Ab{constructor(e){this.t=e,this.currentUser=Mt.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,n){Qe(this.o===void 0);let s=this.i;const i=c=>this.i!==s?(s=this.i,n(c)):Promise.resolve();let r=new Dn;this.o=()=>{this.i++,this.currentUser=this.u(),r.resolve(),r=new Dn,e.enqueueRetryable(()=>i(this.currentUser))};const o=()=>{const c=r;e.enqueueRetryable(async()=>{await c.promise,await i(this.currentUser)})},l=c=>{Ee("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=c,this.o&&(this.auth.addAuthTokenListener(this.o),o())};this.t.onInit(c=>l(c)),setTimeout(()=>{if(!this.auth){const c=this.t.getImmediate({optional:!0});c?l(c):(Ee("FirebaseAuthCredentialsProvider","Auth not yet detected"),r.resolve(),r=new Dn)}},0),o()}getToken(){const e=this.i,n=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(n).then(s=>this.i!==e?(Ee("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):s?(Qe(typeof s.accessToken=="string"),new bg(s.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const e=this.auth&&this.auth.getUid();return Qe(e===null||typeof e=="string"),new Mt(e)}}class Ib{constructor(e,n,s){this.l=e,this.h=n,this.P=s,this.type="FirstParty",this.user=Mt.FIRST_PARTY,this.T=new Map}I(){return this.P?this.P():null}get headers(){this.T.set("X-Goog-AuthUser",this.l);const e=this.I();return e&&this.T.set("Authorization",e),this.h&&this.T.set("X-Goog-Iam-Authorization-Token",this.h),this.T}}class Sb{constructor(e,n,s){this.l=e,this.h=n,this.P=s}getToken(){return Promise.resolve(new Ib(this.l,this.h,this.P))}start(e,n){e.enqueueRetryable(()=>n(Mt.FIRST_PARTY))}shutdown(){}invalidateToken(){}}class yh{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class Cb{constructor(e,n){this.A=n,this.forceRefresh=!1,this.appCheck=null,this.R=null,this.V=null,jE(e)&&e.settings.appCheckToken&&(this.V=e.settings.appCheckToken)}start(e,n){Qe(this.o===void 0);const s=r=>{r.error!=null&&Ee("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${r.error.message}`);const o=r.token!==this.R;return this.R=r.token,Ee("FirebaseAppCheckTokenProvider",`Received ${o?"new":"existing"} token.`),o?n(r.token):Promise.resolve()};this.o=r=>{e.enqueueRetryable(()=>s(r))};const i=r=>{Ee("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=r,this.o&&this.appCheck.addTokenListener(this.o)};this.A.onInit(r=>i(r)),setTimeout(()=>{if(!this.appCheck){const r=this.A.getImmediate({optional:!0});r?i(r):Ee("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){if(this.V)return Promise.resolve(new yh(this.V));const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then(n=>n?(Qe(typeof n.token=="string"),this.R=n.token,new yh(n.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function kb(t){const e=typeof self<"u"&&(self.crypto||self.msCrypto),n=new Uint8Array(t);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(n);else for(let s=0;s<t;s++)n[s]=Math.floor(256*Math.random());return n}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Fc{static newId(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",n=62*Math.floor(4.129032258064516);let s="";for(;s.length<20;){const i=kb(40);for(let r=0;r<i.length;++r)s.length<20&&i[r]<n&&(s+=e.charAt(i[r]%62))}return s}}function He(t,e){return t<e?-1:t>e?1:0}function yi(t,e,n){return t.length===e.length&&t.every((s,i)=>n(s,e[i]))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const _h=-62135596800,Eh=1e6;class yt{static now(){return yt.fromMillis(Date.now())}static fromDate(e){return yt.fromMillis(e.getTime())}static fromMillis(e){const n=Math.floor(e/1e3),s=Math.floor((e-1e3*n)*Eh);return new yt(n,s)}constructor(e,n){if(this.seconds=e,this.nanoseconds=n,n<0)throw new _e(z.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+n);if(n>=1e9)throw new _e(z.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+n);if(e<_h)throw new _e(z.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new _e(z.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/Eh}_compareTo(e){return this.seconds===e.seconds?He(this.nanoseconds,e.nanoseconds):He(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}}valueOf(){const e=this.seconds-_h;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class De{static fromTimestamp(e){return new De(e)}static min(){return new De(new yt(0,0))}static max(){return new De(new yt(253402300799,999999999))}constructor(e){this.timestamp=e}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Th="__name__";class pn{constructor(e,n,s){n===void 0?n=0:n>e.length&&Pe(),s===void 0?s=e.length-n:s>e.length-n&&Pe(),this.segments=e,this.offset=n,this.len=s}get length(){return this.len}isEqual(e){return pn.comparator(this,e)===0}child(e){const n=this.segments.slice(this.offset,this.limit());return e instanceof pn?e.forEach(s=>{n.push(s)}):n.push(e),this.construct(n)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let n=0;n<this.length;n++)if(this.get(n)!==e.get(n))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let n=0;n<this.length;n++)if(this.get(n)!==e.get(n))return!1;return!0}forEach(e){for(let n=this.offset,s=this.limit();n<s;n++)e(this.segments[n])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,n){const s=Math.min(e.length,n.length);for(let i=0;i<s;i++){const r=pn.compareSegments(e.get(i),n.get(i));if(r!==0)return r}return Math.sign(e.length-n.length)}static compareSegments(e,n){const s=pn.isNumericId(e),i=pn.isNumericId(n);return s&&!i?-1:!s&&i?1:s&&i?pn.extractNumericId(e).compare(pn.extractNumericId(n)):e<n?-1:e>n?1:0}static isNumericId(e){return e.startsWith("__id")&&e.endsWith("__")}static extractNumericId(e){return es.fromString(e.substring(4,e.length-2))}}class st extends pn{construct(e,n,s){return new st(e,n,s)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){const n=[];for(const s of e){if(s.indexOf("//")>=0)throw new _e(z.INVALID_ARGUMENT,`Invalid segment (${s}). Paths must not contain // in them.`);n.push(...s.split("/").filter(i=>i.length>0))}return new st(n)}static emptyPath(){return new st([])}}const Pb=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class bt extends pn{construct(e,n,s){return new bt(e,n,s)}static isValidIdentifier(e){return Pb.test(e)}canonicalString(){return this.toArray().map(e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),bt.isValidIdentifier(e)||(e="`"+e+"`"),e)).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)===Th}static keyField(){return new bt([Th])}static fromServerFormat(e){const n=[];let s="",i=0;const r=()=>{if(s.length===0)throw new _e(z.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);n.push(s),s=""};let o=!1;for(;i<e.length;){const l=e[i];if(l==="\\"){if(i+1===e.length)throw new _e(z.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const c=e[i+1];if(c!=="\\"&&c!=="."&&c!=="`")throw new _e(z.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);s+=c,i+=2}else l==="`"?(o=!o,i++):l!=="."||o?(s+=l,i++):(r(),i++)}if(r(),o)throw new _e(z.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new bt(n)}static emptyPath(){return new bt([])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ae{constructor(e){this.path=e}static fromPath(e){return new Ae(st.fromString(e))}static fromName(e){return new Ae(st.fromString(e).popFirst(5))}static empty(){return new Ae(st.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&st.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,n){return st.comparator(e.path,n.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new Ae(new st(e.slice()))}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Tr=-1;function Rb(t,e){const n=t.toTimestamp().seconds,s=t.toTimestamp().nanoseconds+1,i=De.fromTimestamp(s===1e9?new yt(n+1,0):new yt(n,s));return new as(i,Ae.empty(),e)}function Db(t){return new as(t.readTime,t.key,Tr)}class as{constructor(e,n,s){this.readTime=e,this.documentKey=n,this.largestBatchId=s}static min(){return new as(De.min(),Ae.empty(),Tr)}static max(){return new as(De.max(),Ae.empty(),Tr)}}function Mb(t,e){let n=t.readTime.compareTo(e.readTime);return n!==0?n:(n=Ae.comparator(t.documentKey,e.documentKey),n!==0?n:He(t.largestBatchId,e.largestBatchId))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ob="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class Nb{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(e=>e())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Si(t){if(t.code!==z.FAILED_PRECONDITION||t.message!==Ob)throw t;Ee("LocalStore","Unexpectedly lost primary lease")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Y{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e(n=>{this.isDone=!0,this.result=n,this.nextCallback&&this.nextCallback(n)},n=>{this.isDone=!0,this.error=n,this.catchCallback&&this.catchCallback(n)})}catch(e){return this.next(void 0,e)}next(e,n){return this.callbackAttached&&Pe(),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(n,this.error):this.wrapSuccess(e,this.result):new Y((s,i)=>{this.nextCallback=r=>{this.wrapSuccess(e,r).next(s,i)},this.catchCallback=r=>{this.wrapFailure(n,r).next(s,i)}})}toPromise(){return new Promise((e,n)=>{this.next(e,n)})}wrapUserFunction(e){try{const n=e();return n instanceof Y?n:Y.resolve(n)}catch(n){return Y.reject(n)}}wrapSuccess(e,n){return e?this.wrapUserFunction(()=>e(n)):Y.resolve(n)}wrapFailure(e,n){return e?this.wrapUserFunction(()=>e(n)):Y.reject(n)}static resolve(e){return new Y((n,s)=>{n(e)})}static reject(e){return new Y((n,s)=>{s(e)})}static waitFor(e){return new Y((n,s)=>{let i=0,r=0,o=!1;e.forEach(l=>{++i,l.next(()=>{++r,o&&r===i&&n()},c=>s(c))}),o=!0,r===i&&n()})}static or(e){let n=Y.resolve(!1);for(const s of e)n=n.next(i=>i?Y.resolve(i):s());return n}static forEach(e,n){const s=[];return e.forEach((i,r)=>{s.push(n.call(this,i,r))}),this.waitFor(s)}static mapArray(e,n){return new Y((s,i)=>{const r=e.length,o=new Array(r);let l=0;for(let c=0;c<r;c++){const u=c;n(e[u]).next(h=>{o[u]=h,++l,l===r&&s(o)},h=>i(h))}})}static doWhile(e,n){return new Y((s,i)=>{const r=()=>{e()===!0?n().next(()=>{r()},i):s()};r()})}}function xb(t){const e=t.match(/Android ([\d.]+)/i),n=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(n)}function Ci(t){return t.name==="IndexedDbTransactionError"}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ua{constructor(e,n){this.previousValue=e,n&&(n.sequenceNumberHandler=s=>this.oe(s),this._e=s=>n.writeSequenceNumber(s))}oe(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this._e&&this._e(e),e}}ua.ae=-1;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const $c=-1;function da(t){return t==null}function Vo(t){return t===0&&1/t==-1/0}function Vb(t){return typeof t=="number"&&Number.isInteger(t)&&!Vo(t)&&t<=Number.MAX_SAFE_INTEGER&&t>=Number.MIN_SAFE_INTEGER}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ag="";function Fb(t){let e="";for(let n=0;n<t.length;n++)e.length>0&&(e=bh(e)),e=$b(t.get(n),e);return bh(e)}function $b(t,e){let n=e;const s=t.length;for(let i=0;i<s;i++){const r=t.charAt(i);switch(r){case"\0":n+="";break;case Ag:n+="";break;default:n+=r}}return n}function bh(t){return t+Ag+""}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function wh(t){let e=0;for(const n in t)Object.prototype.hasOwnProperty.call(t,n)&&e++;return e}function zs(t,e){for(const n in t)Object.prototype.hasOwnProperty.call(t,n)&&e(n,t[n])}function Ig(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class at{constructor(e,n){this.comparator=e,this.root=n||It.EMPTY}insert(e,n){return new at(this.comparator,this.root.insert(e,n,this.comparator).copy(null,null,It.BLACK,null,null))}remove(e){return new at(this.comparator,this.root.remove(e,this.comparator).copy(null,null,It.BLACK,null,null))}get(e){let n=this.root;for(;!n.isEmpty();){const s=this.comparator(e,n.key);if(s===0)return n.value;s<0?n=n.left:s>0&&(n=n.right)}return null}indexOf(e){let n=0,s=this.root;for(;!s.isEmpty();){const i=this.comparator(e,s.key);if(i===0)return n+s.left.size;i<0?s=s.left:(n+=s.left.size+1,s=s.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal((n,s)=>(e(n,s),!1))}toString(){const e=[];return this.inorderTraversal((n,s)=>(e.push(`${n}:${s}`),!1)),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new oo(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new oo(this.root,e,this.comparator,!1)}getReverseIterator(){return new oo(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new oo(this.root,e,this.comparator,!0)}}class oo{constructor(e,n,s,i){this.isReverse=i,this.nodeStack=[];let r=1;for(;!e.isEmpty();)if(r=n?s(e.key,n):1,n&&i&&(r*=-1),r<0)e=this.isReverse?e.left:e.right;else{if(r===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const n={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return n}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class It{constructor(e,n,s,i,r){this.key=e,this.value=n,this.color=s??It.RED,this.left=i??It.EMPTY,this.right=r??It.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,n,s,i,r){return new It(e??this.key,n??this.value,s??this.color,i??this.left,r??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,n,s){let i=this;const r=s(e,i.key);return i=r<0?i.copy(null,null,null,i.left.insert(e,n,s),null):r===0?i.copy(null,n,null,null,null):i.copy(null,null,null,null,i.right.insert(e,n,s)),i.fixUp()}removeMin(){if(this.left.isEmpty())return It.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,n){let s,i=this;if(n(e,i.key)<0)i.left.isEmpty()||i.left.isRed()||i.left.left.isRed()||(i=i.moveRedLeft()),i=i.copy(null,null,null,i.left.remove(e,n),null);else{if(i.left.isRed()&&(i=i.rotateRight()),i.right.isEmpty()||i.right.isRed()||i.right.left.isRed()||(i=i.moveRedRight()),n(e,i.key)===0){if(i.right.isEmpty())return It.EMPTY;s=i.right.min(),i=i.copy(s.key,s.value,null,null,i.right.removeMin())}i=i.copy(null,null,null,null,i.right.remove(e,n))}return i.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,It.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,It.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),n=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,n)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed()||this.right.isRed())throw Pe();const e=this.left.check();if(e!==this.right.check())throw Pe();return e+(this.isRed()?0:1)}}It.EMPTY=null,It.RED=!0,It.BLACK=!1;It.EMPTY=new class{constructor(){this.size=0}get key(){throw Pe()}get value(){throw Pe()}get color(){throw Pe()}get left(){throw Pe()}get right(){throw Pe()}copy(e,n,s,i,r){return this}insert(e,n,s){return new It(e,n)}remove(e,n){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Et{constructor(e){this.comparator=e,this.data=new at(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal((n,s)=>(e(n),!1))}forEachInRange(e,n){const s=this.data.getIteratorFrom(e[0]);for(;s.hasNext();){const i=s.getNext();if(this.comparator(i.key,e[1])>=0)return;n(i.key)}}forEachWhile(e,n){let s;for(s=n!==void 0?this.data.getIteratorFrom(n):this.data.getIterator();s.hasNext();)if(!e(s.getNext().key))return}firstAfterOrEqual(e){const n=this.data.getIteratorFrom(e);return n.hasNext()?n.getNext().key:null}getIterator(){return new Ah(this.data.getIterator())}getIteratorFrom(e){return new Ah(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let n=this;return n.size<e.size&&(n=e,e=this),e.forEach(s=>{n=n.add(s)}),n}isEqual(e){if(!(e instanceof Et)||this.size!==e.size)return!1;const n=this.data.getIterator(),s=e.data.getIterator();for(;n.hasNext();){const i=n.getNext().key,r=s.getNext().key;if(this.comparator(i,r)!==0)return!1}return!0}toArray(){const e=[];return this.forEach(n=>{e.push(n)}),e}toString(){const e=[];return this.forEach(n=>e.push(n)),"SortedSet("+e.toString()+")"}copy(e){const n=new Et(this.comparator);return n.data=e,n}}class Ah{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ln{constructor(e){this.fields=e,e.sort(bt.comparator)}static empty(){return new ln([])}unionWith(e){let n=new Et(bt.comparator);for(const s of this.fields)n=n.add(s);for(const s of e)n=n.add(s);return new ln(n.toArray())}covers(e){for(const n of this.fields)if(n.isPrefixOf(e))return!0;return!1}isEqual(e){return yi(this.fields,e.fields,(n,s)=>n.isEqual(s))}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Sg extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wt{constructor(e){this.binaryString=e}static fromBase64String(e){const n=function(i){try{return atob(i)}catch(r){throw typeof DOMException<"u"&&r instanceof DOMException?new Sg("Invalid base64 string: "+r):r}}(e);return new wt(n)}static fromUint8Array(e){const n=function(i){let r="";for(let o=0;o<i.length;++o)r+=String.fromCharCode(i[o]);return r}(e);return new wt(n)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return function(n){return btoa(n)}(this.binaryString)}toUint8Array(){return function(n){const s=new Uint8Array(n.length);for(let i=0;i<n.length;i++)s[i]=n.charCodeAt(i);return s}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return He(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}wt.EMPTY_BYTE_STRING=new wt("");const Lb=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function ls(t){if(Qe(!!t),typeof t=="string"){let e=0;const n=Lb.exec(t);if(Qe(!!n),n[1]){let i=n[1];i=(i+"000000000").substr(0,9),e=Number(i)}const s=new Date(t);return{seconds:Math.floor(s.getTime()/1e3),nanos:e}}return{seconds:dt(t.seconds),nanos:dt(t.nanos)}}function dt(t){return typeof t=="number"?t:typeof t=="string"?Number(t):0}function cs(t){return typeof t=="string"?wt.fromBase64String(t):wt.fromUint8Array(t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Cg="server_timestamp",kg="__type__",Pg="__previous_value__",Rg="__local_write_time__";function Lc(t){var e,n;return((n=(((e=t==null?void 0:t.mapValue)===null||e===void 0?void 0:e.fields)||{})[kg])===null||n===void 0?void 0:n.stringValue)===Cg}function ha(t){const e=t.mapValue.fields[Pg];return Lc(e)?ha(e):e}function br(t){const e=ls(t.mapValue.fields[Rg].timestampValue);return new yt(e.seconds,e.nanos)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Bb{constructor(e,n,s,i,r,o,l,c,u){this.databaseId=e,this.appId=n,this.persistenceKey=s,this.host=i,this.ssl=r,this.forceLongPolling=o,this.autoDetectLongPolling=l,this.longPollingOptions=c,this.useFetchStreams=u}}const Fo="(default)";class _i{constructor(e,n){this.projectId=e,this.database=n||Fo}static empty(){return new _i("","")}get isDefaultDatabase(){return this.database===Fo}isEqual(e){return e instanceof _i&&e.projectId===this.projectId&&e.database===this.database}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Dg="__type__",Ub="__max__",ao={mapValue:{}},Mg="__vector__",$o="value";function us(t){return"nullValue"in t?0:"booleanValue"in t?1:"integerValue"in t||"doubleValue"in t?2:"timestampValue"in t?3:"stringValue"in t?5:"bytesValue"in t?6:"referenceValue"in t?7:"geoPointValue"in t?8:"arrayValue"in t?9:"mapValue"in t?Lc(t)?4:jb(t)?9007199254740991:Hb(t)?10:11:Pe()}function Tn(t,e){if(t===e)return!0;const n=us(t);if(n!==us(e))return!1;switch(n){case 0:case 9007199254740991:return!0;case 1:return t.booleanValue===e.booleanValue;case 4:return br(t).isEqual(br(e));case 3:return function(i,r){if(typeof i.timestampValue=="string"&&typeof r.timestampValue=="string"&&i.timestampValue.length===r.timestampValue.length)return i.timestampValue===r.timestampValue;const o=ls(i.timestampValue),l=ls(r.timestampValue);return o.seconds===l.seconds&&o.nanos===l.nanos}(t,e);case 5:return t.stringValue===e.stringValue;case 6:return function(i,r){return cs(i.bytesValue).isEqual(cs(r.bytesValue))}(t,e);case 7:return t.referenceValue===e.referenceValue;case 8:return function(i,r){return dt(i.geoPointValue.latitude)===dt(r.geoPointValue.latitude)&&dt(i.geoPointValue.longitude)===dt(r.geoPointValue.longitude)}(t,e);case 2:return function(i,r){if("integerValue"in i&&"integerValue"in r)return dt(i.integerValue)===dt(r.integerValue);if("doubleValue"in i&&"doubleValue"in r){const o=dt(i.doubleValue),l=dt(r.doubleValue);return o===l?Vo(o)===Vo(l):isNaN(o)&&isNaN(l)}return!1}(t,e);case 9:return yi(t.arrayValue.values||[],e.arrayValue.values||[],Tn);case 10:case 11:return function(i,r){const o=i.mapValue.fields||{},l=r.mapValue.fields||{};if(wh(o)!==wh(l))return!1;for(const c in o)if(o.hasOwnProperty(c)&&(l[c]===void 0||!Tn(o[c],l[c])))return!1;return!0}(t,e);default:return Pe()}}function wr(t,e){return(t.values||[]).find(n=>Tn(n,e))!==void 0}function Ei(t,e){if(t===e)return 0;const n=us(t),s=us(e);if(n!==s)return He(n,s);switch(n){case 0:case 9007199254740991:return 0;case 1:return He(t.booleanValue,e.booleanValue);case 2:return function(r,o){const l=dt(r.integerValue||r.doubleValue),c=dt(o.integerValue||o.doubleValue);return l<c?-1:l>c?1:l===c?0:isNaN(l)?isNaN(c)?0:-1:1}(t,e);case 3:return Ih(t.timestampValue,e.timestampValue);case 4:return Ih(br(t),br(e));case 5:return He(t.stringValue,e.stringValue);case 6:return function(r,o){const l=cs(r),c=cs(o);return l.compareTo(c)}(t.bytesValue,e.bytesValue);case 7:return function(r,o){const l=r.split("/"),c=o.split("/");for(let u=0;u<l.length&&u<c.length;u++){const h=He(l[u],c[u]);if(h!==0)return h}return He(l.length,c.length)}(t.referenceValue,e.referenceValue);case 8:return function(r,o){const l=He(dt(r.latitude),dt(o.latitude));return l!==0?l:He(dt(r.longitude),dt(o.longitude))}(t.geoPointValue,e.geoPointValue);case 9:return Sh(t.arrayValue,e.arrayValue);case 10:return function(r,o){var l,c,u,h;const f=r.fields||{},m=o.fields||{},y=(l=f[$o])===null||l===void 0?void 0:l.arrayValue,C=(c=m[$o])===null||c===void 0?void 0:c.arrayValue,D=He(((u=y==null?void 0:y.values)===null||u===void 0?void 0:u.length)||0,((h=C==null?void 0:C.values)===null||h===void 0?void 0:h.length)||0);return D!==0?D:Sh(y,C)}(t.mapValue,e.mapValue);case 11:return function(r,o){if(r===ao.mapValue&&o===ao.mapValue)return 0;if(r===ao.mapValue)return 1;if(o===ao.mapValue)return-1;const l=r.fields||{},c=Object.keys(l),u=o.fields||{},h=Object.keys(u);c.sort(),h.sort();for(let f=0;f<c.length&&f<h.length;++f){const m=He(c[f],h[f]);if(m!==0)return m;const y=Ei(l[c[f]],u[h[f]]);if(y!==0)return y}return He(c.length,h.length)}(t.mapValue,e.mapValue);default:throw Pe()}}function Ih(t,e){if(typeof t=="string"&&typeof e=="string"&&t.length===e.length)return He(t,e);const n=ls(t),s=ls(e),i=He(n.seconds,s.seconds);return i!==0?i:He(n.nanos,s.nanos)}function Sh(t,e){const n=t.values||[],s=e.values||[];for(let i=0;i<n.length&&i<s.length;++i){const r=Ei(n[i],s[i]);if(r)return r}return He(n.length,s.length)}function Ti(t){return Kl(t)}function Kl(t){return"nullValue"in t?"null":"booleanValue"in t?""+t.booleanValue:"integerValue"in t?""+t.integerValue:"doubleValue"in t?""+t.doubleValue:"timestampValue"in t?function(n){const s=ls(n);return`time(${s.seconds},${s.nanos})`}(t.timestampValue):"stringValue"in t?t.stringValue:"bytesValue"in t?function(n){return cs(n).toBase64()}(t.bytesValue):"referenceValue"in t?function(n){return Ae.fromName(n).toString()}(t.referenceValue):"geoPointValue"in t?function(n){return`geo(${n.latitude},${n.longitude})`}(t.geoPointValue):"arrayValue"in t?function(n){let s="[",i=!0;for(const r of n.values||[])i?i=!1:s+=",",s+=Kl(r);return s+"]"}(t.arrayValue):"mapValue"in t?function(n){const s=Object.keys(n.fields||{}).sort();let i="{",r=!0;for(const o of s)r?r=!1:i+=",",i+=`${o}:${Kl(n.fields[o])}`;return i+"}"}(t.mapValue):Pe()}function yo(t){switch(us(t)){case 0:case 1:return 4;case 2:return 8;case 3:case 8:return 16;case 4:const e=ha(t);return e?16+yo(e):16;case 5:return 2*t.stringValue.length;case 6:return cs(t.bytesValue).approximateByteSize();case 7:return t.referenceValue.length;case 9:return function(s){return(s.values||[]).reduce((i,r)=>i+yo(r),0)}(t.arrayValue);case 10:case 11:return function(s){let i=0;return zs(s.fields,(r,o)=>{i+=r.length+yo(o)}),i}(t.mapValue);default:throw Pe()}}function Ch(t,e){return{referenceValue:`projects/${t.projectId}/databases/${t.database}/documents/${e.path.canonicalString()}`}}function ql(t){return!!t&&"integerValue"in t}function Bc(t){return!!t&&"arrayValue"in t}function kh(t){return!!t&&"nullValue"in t}function Ph(t){return!!t&&"doubleValue"in t&&isNaN(Number(t.doubleValue))}function _o(t){return!!t&&"mapValue"in t}function Hb(t){var e,n;return((n=(((e=t==null?void 0:t.mapValue)===null||e===void 0?void 0:e.fields)||{})[Dg])===null||n===void 0?void 0:n.stringValue)===Mg}function or(t){if(t.geoPointValue)return{geoPointValue:Object.assign({},t.geoPointValue)};if(t.timestampValue&&typeof t.timestampValue=="object")return{timestampValue:Object.assign({},t.timestampValue)};if(t.mapValue){const e={mapValue:{fields:{}}};return zs(t.mapValue.fields,(n,s)=>e.mapValue.fields[n]=or(s)),e}if(t.arrayValue){const e={arrayValue:{values:[]}};for(let n=0;n<(t.arrayValue.values||[]).length;++n)e.arrayValue.values[n]=or(t.arrayValue.values[n]);return e}return Object.assign({},t)}function jb(t){return(((t.mapValue||{}).fields||{}).__type__||{}).stringValue===Ub}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nn{constructor(e){this.value=e}static empty(){return new nn({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let n=this.value;for(let s=0;s<e.length-1;++s)if(n=(n.mapValue.fields||{})[e.get(s)],!_o(n))return null;return n=(n.mapValue.fields||{})[e.lastSegment()],n||null}}set(e,n){this.getFieldsMap(e.popLast())[e.lastSegment()]=or(n)}setAll(e){let n=bt.emptyPath(),s={},i=[];e.forEach((o,l)=>{if(!n.isImmediateParentOf(l)){const c=this.getFieldsMap(n);this.applyChanges(c,s,i),s={},i=[],n=l.popLast()}o?s[l.lastSegment()]=or(o):i.push(l.lastSegment())});const r=this.getFieldsMap(n);this.applyChanges(r,s,i)}delete(e){const n=this.field(e.popLast());_o(n)&&n.mapValue.fields&&delete n.mapValue.fields[e.lastSegment()]}isEqual(e){return Tn(this.value,e.value)}getFieldsMap(e){let n=this.value;n.mapValue.fields||(n.mapValue={fields:{}});for(let s=0;s<e.length;++s){let i=n.mapValue.fields[e.get(s)];_o(i)&&i.mapValue.fields||(i={mapValue:{fields:{}}},n.mapValue.fields[e.get(s)]=i),n=i}return n.mapValue.fields}applyChanges(e,n,s){zs(n,(i,r)=>e[i]=r);for(const i of s)delete e[i]}clone(){return new nn(or(this.value))}}function Og(t){const e=[];return zs(t.fields,(n,s)=>{const i=new bt([n]);if(_o(s)){const r=Og(s.mapValue).fields;if(r.length===0)e.push(i);else for(const o of r)e.push(i.child(o))}else e.push(i)}),new ln(e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xt{constructor(e,n,s,i,r,o,l){this.key=e,this.documentType=n,this.version=s,this.readTime=i,this.createTime=r,this.data=o,this.documentState=l}static newInvalidDocument(e){return new xt(e,0,De.min(),De.min(),De.min(),nn.empty(),0)}static newFoundDocument(e,n,s,i){return new xt(e,1,n,De.min(),s,i,0)}static newNoDocument(e,n){return new xt(e,2,n,De.min(),De.min(),nn.empty(),0)}static newUnknownDocument(e,n){return new xt(e,3,n,De.min(),De.min(),nn.empty(),2)}convertToFoundDocument(e,n){return!this.createTime.isEqual(De.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=n,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=nn.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=nn.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=De.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof xt&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new xt(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Lo{constructor(e,n){this.position=e,this.inclusive=n}}function Rh(t,e,n){let s=0;for(let i=0;i<t.position.length;i++){const r=e[i],o=t.position[i];if(r.field.isKeyField()?s=Ae.comparator(Ae.fromName(o.referenceValue),n.key):s=Ei(o,n.data.field(r.field)),r.dir==="desc"&&(s*=-1),s!==0)break}return s}function Dh(t,e){if(t===null)return e===null;if(e===null||t.inclusive!==e.inclusive||t.position.length!==e.position.length)return!1;for(let n=0;n<t.position.length;n++)if(!Tn(t.position[n],e.position[n]))return!1;return!0}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ar{constructor(e,n="asc"){this.field=e,this.dir=n}}function Kb(t,e){return t.dir===e.dir&&t.field.isEqual(e.field)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ng{}class vt extends Ng{constructor(e,n,s){super(),this.field=e,this.op=n,this.value=s}static create(e,n,s){return e.isKeyField()?n==="in"||n==="not-in"?this.createKeyFieldInFilter(e,n,s):new Gb(e,n,s):n==="array-contains"?new Yb(e,s):n==="in"?new Qb(e,s):n==="not-in"?new Xb(e,s):n==="array-contains-any"?new Jb(e,s):new vt(e,n,s)}static createKeyFieldInFilter(e,n,s){return n==="in"?new Wb(e,s):new zb(e,s)}matches(e){const n=e.data.field(this.field);return this.op==="!="?n!==null&&this.matchesComparison(Ei(n,this.value)):n!==null&&us(this.value)===us(n)&&this.matchesComparison(Ei(n,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return Pe()}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class dn extends Ng{constructor(e,n){super(),this.filters=e,this.op=n,this.ce=null}static create(e,n){return new dn(e,n)}matches(e){return xg(this)?this.filters.find(n=>!n.matches(e))===void 0:this.filters.find(n=>n.matches(e))!==void 0}getFlattenedFilters(){return this.ce!==null||(this.ce=this.filters.reduce((e,n)=>e.concat(n.getFlattenedFilters()),[])),this.ce}getFilters(){return Object.assign([],this.filters)}}function xg(t){return t.op==="and"}function Vg(t){return qb(t)&&xg(t)}function qb(t){for(const e of t.filters)if(e instanceof dn)return!1;return!0}function Gl(t){if(t instanceof vt)return t.field.canonicalString()+t.op.toString()+Ti(t.value);if(Vg(t))return t.filters.map(e=>Gl(e)).join(",");{const e=t.filters.map(n=>Gl(n)).join(",");return`${t.op}(${e})`}}function Fg(t,e){return t instanceof vt?function(s,i){return i instanceof vt&&s.op===i.op&&s.field.isEqual(i.field)&&Tn(s.value,i.value)}(t,e):t instanceof dn?function(s,i){return i instanceof dn&&s.op===i.op&&s.filters.length===i.filters.length?s.filters.reduce((r,o,l)=>r&&Fg(o,i.filters[l]),!0):!1}(t,e):void Pe()}function $g(t){return t instanceof vt?function(n){return`${n.field.canonicalString()} ${n.op} ${Ti(n.value)}`}(t):t instanceof dn?function(n){return n.op.toString()+" {"+n.getFilters().map($g).join(" ,")+"}"}(t):"Filter"}class Gb extends vt{constructor(e,n,s){super(e,n,s),this.key=Ae.fromName(s.referenceValue)}matches(e){const n=Ae.comparator(e.key,this.key);return this.matchesComparison(n)}}class Wb extends vt{constructor(e,n){super(e,"in",n),this.keys=Lg("in",n)}matches(e){return this.keys.some(n=>n.isEqual(e.key))}}class zb extends vt{constructor(e,n){super(e,"not-in",n),this.keys=Lg("not-in",n)}matches(e){return!this.keys.some(n=>n.isEqual(e.key))}}function Lg(t,e){var n;return(((n=e.arrayValue)===null||n===void 0?void 0:n.values)||[]).map(s=>Ae.fromName(s.referenceValue))}class Yb extends vt{constructor(e,n){super(e,"array-contains",n)}matches(e){const n=e.data.field(this.field);return Bc(n)&&wr(n.arrayValue,this.value)}}class Qb extends vt{constructor(e,n){super(e,"in",n)}matches(e){const n=e.data.field(this.field);return n!==null&&wr(this.value.arrayValue,n)}}class Xb extends vt{constructor(e,n){super(e,"not-in",n)}matches(e){if(wr(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const n=e.data.field(this.field);return n!==null&&!wr(this.value.arrayValue,n)}}class Jb extends vt{constructor(e,n){super(e,"array-contains-any",n)}matches(e){const n=e.data.field(this.field);return!(!Bc(n)||!n.arrayValue.values)&&n.arrayValue.values.some(s=>wr(this.value.arrayValue,s))}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Zb{constructor(e,n=null,s=[],i=[],r=null,o=null,l=null){this.path=e,this.collectionGroup=n,this.orderBy=s,this.filters=i,this.limit=r,this.startAt=o,this.endAt=l,this.le=null}}function Mh(t,e=null,n=[],s=[],i=null,r=null,o=null){return new Zb(t,e,n,s,i,r,o)}function Uc(t){const e=Me(t);if(e.le===null){let n=e.path.canonicalString();e.collectionGroup!==null&&(n+="|cg:"+e.collectionGroup),n+="|f:",n+=e.filters.map(s=>Gl(s)).join(","),n+="|ob:",n+=e.orderBy.map(s=>function(r){return r.field.canonicalString()+r.dir}(s)).join(","),da(e.limit)||(n+="|l:",n+=e.limit),e.startAt&&(n+="|lb:",n+=e.startAt.inclusive?"b:":"a:",n+=e.startAt.position.map(s=>Ti(s)).join(",")),e.endAt&&(n+="|ub:",n+=e.endAt.inclusive?"a:":"b:",n+=e.endAt.position.map(s=>Ti(s)).join(",")),e.le=n}return e.le}function Hc(t,e){if(t.limit!==e.limit||t.orderBy.length!==e.orderBy.length)return!1;for(let n=0;n<t.orderBy.length;n++)if(!Kb(t.orderBy[n],e.orderBy[n]))return!1;if(t.filters.length!==e.filters.length)return!1;for(let n=0;n<t.filters.length;n++)if(!Fg(t.filters[n],e.filters[n]))return!1;return t.collectionGroup===e.collectionGroup&&!!t.path.isEqual(e.path)&&!!Dh(t.startAt,e.startAt)&&Dh(t.endAt,e.endAt)}function Wl(t){return Ae.isDocumentKey(t.path)&&t.collectionGroup===null&&t.filters.length===0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ki{constructor(e,n=null,s=[],i=[],r=null,o="F",l=null,c=null){this.path=e,this.collectionGroup=n,this.explicitOrderBy=s,this.filters=i,this.limit=r,this.limitType=o,this.startAt=l,this.endAt=c,this.he=null,this.Pe=null,this.Te=null,this.startAt,this.endAt}}function ew(t,e,n,s,i,r,o,l){return new ki(t,e,n,s,i,r,o,l)}function jc(t){return new ki(t)}function Oh(t){return t.filters.length===0&&t.limit===null&&t.startAt==null&&t.endAt==null&&(t.explicitOrderBy.length===0||t.explicitOrderBy.length===1&&t.explicitOrderBy[0].field.isKeyField())}function Bg(t){return t.collectionGroup!==null}function ar(t){const e=Me(t);if(e.he===null){e.he=[];const n=new Set;for(const r of e.explicitOrderBy)e.he.push(r),n.add(r.field.canonicalString());const s=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(o){let l=new Et(bt.comparator);return o.filters.forEach(c=>{c.getFlattenedFilters().forEach(u=>{u.isInequality()&&(l=l.add(u.field))})}),l})(e).forEach(r=>{n.has(r.canonicalString())||r.isKeyField()||e.he.push(new Ar(r,s))}),n.has(bt.keyField().canonicalString())||e.he.push(new Ar(bt.keyField(),s))}return e.he}function yn(t){const e=Me(t);return e.Pe||(e.Pe=tw(e,ar(t))),e.Pe}function tw(t,e){if(t.limitType==="F")return Mh(t.path,t.collectionGroup,e,t.filters,t.limit,t.startAt,t.endAt);{e=e.map(i=>{const r=i.dir==="desc"?"asc":"desc";return new Ar(i.field,r)});const n=t.endAt?new Lo(t.endAt.position,t.endAt.inclusive):null,s=t.startAt?new Lo(t.startAt.position,t.startAt.inclusive):null;return Mh(t.path,t.collectionGroup,e,t.filters,t.limit,n,s)}}function zl(t,e){const n=t.filters.concat([e]);return new ki(t.path,t.collectionGroup,t.explicitOrderBy.slice(),n,t.limit,t.limitType,t.startAt,t.endAt)}function Bo(t,e,n){return new ki(t.path,t.collectionGroup,t.explicitOrderBy.slice(),t.filters.slice(),e,n,t.startAt,t.endAt)}function fa(t,e){return Hc(yn(t),yn(e))&&t.limitType===e.limitType}function Ug(t){return`${Uc(yn(t))}|lt:${t.limitType}`}function ci(t){return`Query(target=${function(n){let s=n.path.canonicalString();return n.collectionGroup!==null&&(s+=" collectionGroup="+n.collectionGroup),n.filters.length>0&&(s+=`, filters: [${n.filters.map(i=>$g(i)).join(", ")}]`),da(n.limit)||(s+=", limit: "+n.limit),n.orderBy.length>0&&(s+=`, orderBy: [${n.orderBy.map(i=>function(o){return`${o.field.canonicalString()} (${o.dir})`}(i)).join(", ")}]`),n.startAt&&(s+=", startAt: ",s+=n.startAt.inclusive?"b:":"a:",s+=n.startAt.position.map(i=>Ti(i)).join(",")),n.endAt&&(s+=", endAt: ",s+=n.endAt.inclusive?"a:":"b:",s+=n.endAt.position.map(i=>Ti(i)).join(",")),`Target(${s})`}(yn(t))}; limitType=${t.limitType})`}function pa(t,e){return e.isFoundDocument()&&function(s,i){const r=i.key.path;return s.collectionGroup!==null?i.key.hasCollectionId(s.collectionGroup)&&s.path.isPrefixOf(r):Ae.isDocumentKey(s.path)?s.path.isEqual(r):s.path.isImmediateParentOf(r)}(t,e)&&function(s,i){for(const r of ar(s))if(!r.field.isKeyField()&&i.data.field(r.field)===null)return!1;return!0}(t,e)&&function(s,i){for(const r of s.filters)if(!r.matches(i))return!1;return!0}(t,e)&&function(s,i){return!(s.startAt&&!function(o,l,c){const u=Rh(o,l,c);return o.inclusive?u<=0:u<0}(s.startAt,ar(s),i)||s.endAt&&!function(o,l,c){const u=Rh(o,l,c);return o.inclusive?u>=0:u>0}(s.endAt,ar(s),i))}(t,e)}function nw(t){return t.collectionGroup||(t.path.length%2==1?t.path.lastSegment():t.path.get(t.path.length-2))}function Hg(t){return(e,n)=>{let s=!1;for(const i of ar(t)){const r=sw(i,e,n);if(r!==0)return r;s=s||i.field.isKeyField()}return 0}}function sw(t,e,n){const s=t.field.isKeyField()?Ae.comparator(e.key,n.key):function(r,o,l){const c=o.data.field(r),u=l.data.field(r);return c!==null&&u!==null?Ei(c,u):Pe()}(t.field,e,n);switch(t.dir){case"asc":return s;case"desc":return-1*s;default:return Pe()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ys{constructor(e,n){this.mapKeyFn=e,this.equalsFn=n,this.inner={},this.innerSize=0}get(e){const n=this.mapKeyFn(e),s=this.inner[n];if(s!==void 0){for(const[i,r]of s)if(this.equalsFn(i,e))return r}}has(e){return this.get(e)!==void 0}set(e,n){const s=this.mapKeyFn(e),i=this.inner[s];if(i===void 0)return this.inner[s]=[[e,n]],void this.innerSize++;for(let r=0;r<i.length;r++)if(this.equalsFn(i[r][0],e))return void(i[r]=[e,n]);i.push([e,n]),this.innerSize++}delete(e){const n=this.mapKeyFn(e),s=this.inner[n];if(s===void 0)return!1;for(let i=0;i<s.length;i++)if(this.equalsFn(s[i][0],e))return s.length===1?delete this.inner[n]:s.splice(i,1),this.innerSize--,!0;return!1}forEach(e){zs(this.inner,(n,s)=>{for(const[i,r]of s)e(i,r)})}isEmpty(){return Ig(this.inner)}size(){return this.innerSize}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const iw=new at(Ae.comparator);function Vn(){return iw}const jg=new at(Ae.comparator);function zi(...t){let e=jg;for(const n of t)e=e.insert(n.key,n);return e}function Kg(t){let e=jg;return t.forEach((n,s)=>e=e.insert(n,s.overlayedDocument)),e}function Ns(){return lr()}function qg(){return lr()}function lr(){return new Ys(t=>t.toString(),(t,e)=>t.isEqual(e))}const rw=new at(Ae.comparator),ow=new Et(Ae.comparator);function Be(...t){let e=ow;for(const n of t)e=e.add(n);return e}const aw=new Et(He);function lw(){return aw}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Kc(t,e){if(t.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:Vo(e)?"-0":e}}function Gg(t){return{integerValue:""+t}}function cw(t,e){return Vb(e)?Gg(e):Kc(t,e)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ga{constructor(){this._=void 0}}function uw(t,e,n){return t instanceof Ir?function(i,r){const o={fields:{[kg]:{stringValue:Cg},[Rg]:{timestampValue:{seconds:i.seconds,nanos:i.nanoseconds}}}};return r&&Lc(r)&&(r=ha(r)),r&&(o.fields[Pg]=r),{mapValue:o}}(n,e):t instanceof Sr?zg(t,e):t instanceof Cr?Yg(t,e):function(i,r){const o=Wg(i,r),l=Nh(o)+Nh(i.Ie);return ql(o)&&ql(i.Ie)?Gg(l):Kc(i.serializer,l)}(t,e)}function dw(t,e,n){return t instanceof Sr?zg(t,e):t instanceof Cr?Yg(t,e):n}function Wg(t,e){return t instanceof Uo?function(s){return ql(s)||function(r){return!!r&&"doubleValue"in r}(s)}(e)?e:{integerValue:0}:null}class Ir extends ga{}class Sr extends ga{constructor(e){super(),this.elements=e}}function zg(t,e){const n=Qg(e);for(const s of t.elements)n.some(i=>Tn(i,s))||n.push(s);return{arrayValue:{values:n}}}class Cr extends ga{constructor(e){super(),this.elements=e}}function Yg(t,e){let n=Qg(e);for(const s of t.elements)n=n.filter(i=>!Tn(i,s));return{arrayValue:{values:n}}}class Uo extends ga{constructor(e,n){super(),this.serializer=e,this.Ie=n}}function Nh(t){return dt(t.integerValue||t.doubleValue)}function Qg(t){return Bc(t)&&t.arrayValue.values?t.arrayValue.values.slice():[]}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hw{constructor(e,n){this.field=e,this.transform=n}}function fw(t,e){return t.field.isEqual(e.field)&&function(s,i){return s instanceof Sr&&i instanceof Sr||s instanceof Cr&&i instanceof Cr?yi(s.elements,i.elements,Tn):s instanceof Uo&&i instanceof Uo?Tn(s.Ie,i.Ie):s instanceof Ir&&i instanceof Ir}(t.transform,e.transform)}class pw{constructor(e,n){this.version=e,this.transformResults=n}}class _n{constructor(e,n){this.updateTime=e,this.exists=n}static none(){return new _n}static exists(e){return new _n(void 0,e)}static updateTime(e){return new _n(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function Eo(t,e){return t.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(t.updateTime):t.exists===void 0||t.exists===e.isFoundDocument()}class ma{}function Xg(t,e){if(!t.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return t.isNoDocument()?new qc(t.key,_n.none()):new Or(t.key,t.data,_n.none());{const n=t.data,s=nn.empty();let i=new Et(bt.comparator);for(let r of e.fields)if(!i.has(r)){let o=n.field(r);o===null&&r.length>1&&(r=r.popLast(),o=n.field(r)),o===null?s.delete(r):s.set(r,o),i=i.add(r)}return new Qs(t.key,s,new ln(i.toArray()),_n.none())}}function gw(t,e,n){t instanceof Or?function(i,r,o){const l=i.value.clone(),c=Vh(i.fieldTransforms,r,o.transformResults);l.setAll(c),r.convertToFoundDocument(o.version,l).setHasCommittedMutations()}(t,e,n):t instanceof Qs?function(i,r,o){if(!Eo(i.precondition,r))return void r.convertToUnknownDocument(o.version);const l=Vh(i.fieldTransforms,r,o.transformResults),c=r.data;c.setAll(Jg(i)),c.setAll(l),r.convertToFoundDocument(o.version,c).setHasCommittedMutations()}(t,e,n):function(i,r,o){r.convertToNoDocument(o.version).setHasCommittedMutations()}(0,e,n)}function cr(t,e,n,s){return t instanceof Or?function(r,o,l,c){if(!Eo(r.precondition,o))return l;const u=r.value.clone(),h=Fh(r.fieldTransforms,c,o);return u.setAll(h),o.convertToFoundDocument(o.version,u).setHasLocalMutations(),null}(t,e,n,s):t instanceof Qs?function(r,o,l,c){if(!Eo(r.precondition,o))return l;const u=Fh(r.fieldTransforms,c,o),h=o.data;return h.setAll(Jg(r)),h.setAll(u),o.convertToFoundDocument(o.version,h).setHasLocalMutations(),l===null?null:l.unionWith(r.fieldMask.fields).unionWith(r.fieldTransforms.map(f=>f.field))}(t,e,n,s):function(r,o,l){return Eo(r.precondition,o)?(o.convertToNoDocument(o.version).setHasLocalMutations(),null):l}(t,e,n)}function mw(t,e){let n=null;for(const s of t.fieldTransforms){const i=e.data.field(s.field),r=Wg(s.transform,i||null);r!=null&&(n===null&&(n=nn.empty()),n.set(s.field,r))}return n||null}function xh(t,e){return t.type===e.type&&!!t.key.isEqual(e.key)&&!!t.precondition.isEqual(e.precondition)&&!!function(s,i){return s===void 0&&i===void 0||!(!s||!i)&&yi(s,i,(r,o)=>fw(r,o))}(t.fieldTransforms,e.fieldTransforms)&&(t.type===0?t.value.isEqual(e.value):t.type!==1||t.data.isEqual(e.data)&&t.fieldMask.isEqual(e.fieldMask))}class Or extends ma{constructor(e,n,s,i=[]){super(),this.key=e,this.value=n,this.precondition=s,this.fieldTransforms=i,this.type=0}getFieldMask(){return null}}class Qs extends ma{constructor(e,n,s,i,r=[]){super(),this.key=e,this.data=n,this.fieldMask=s,this.precondition=i,this.fieldTransforms=r,this.type=1}getFieldMask(){return this.fieldMask}}function Jg(t){const e=new Map;return t.fieldMask.fields.forEach(n=>{if(!n.isEmpty()){const s=t.data.field(n);e.set(n,s)}}),e}function Vh(t,e,n){const s=new Map;Qe(t.length===n.length);for(let i=0;i<n.length;i++){const r=t[i],o=r.transform,l=e.data.field(r.field);s.set(r.field,dw(o,l,n[i]))}return s}function Fh(t,e,n){const s=new Map;for(const i of t){const r=i.transform,o=n.data.field(i.field);s.set(i.field,uw(r,o,e))}return s}class qc extends ma{constructor(e,n){super(),this.key=e,this.precondition=n,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class vw extends ma{constructor(e,n){super(),this.key=e,this.precondition=n,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yw{constructor(e,n,s,i){this.batchId=e,this.localWriteTime=n,this.baseMutations=s,this.mutations=i}applyToRemoteDocument(e,n){const s=n.mutationResults;for(let i=0;i<this.mutations.length;i++){const r=this.mutations[i];r.key.isEqual(e.key)&&gw(r,e,s[i])}}applyToLocalView(e,n){for(const s of this.baseMutations)s.key.isEqual(e.key)&&(n=cr(s,e,n,this.localWriteTime));for(const s of this.mutations)s.key.isEqual(e.key)&&(n=cr(s,e,n,this.localWriteTime));return n}applyToLocalDocumentSet(e,n){const s=qg();return this.mutations.forEach(i=>{const r=e.get(i.key),o=r.overlayedDocument;let l=this.applyToLocalView(o,r.mutatedFields);l=n.has(i.key)?null:l;const c=Xg(o,l);c!==null&&s.set(i.key,c),o.isValidDocument()||o.convertToNoDocument(De.min())}),s}keys(){return this.mutations.reduce((e,n)=>e.add(n.key),Be())}isEqual(e){return this.batchId===e.batchId&&yi(this.mutations,e.mutations,(n,s)=>xh(n,s))&&yi(this.baseMutations,e.baseMutations,(n,s)=>xh(n,s))}}class Gc{constructor(e,n,s,i){this.batch=e,this.commitVersion=n,this.mutationResults=s,this.docVersions=i}static from(e,n,s){Qe(e.mutations.length===s.length);let i=function(){return rw}();const r=e.mutations;for(let o=0;o<r.length;o++)i=i.insert(r[o].key,s[o].version);return new Gc(e,n,s,i)}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _w{constructor(e,n){this.largestBatchId=e,this.mutation=n}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ew{constructor(e,n){this.count=e,this.unchangedNames=n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var gt,je;function Tw(t){switch(t){case z.OK:return Pe();case z.CANCELLED:case z.UNKNOWN:case z.DEADLINE_EXCEEDED:case z.RESOURCE_EXHAUSTED:case z.INTERNAL:case z.UNAVAILABLE:case z.UNAUTHENTICATED:return!1;case z.INVALID_ARGUMENT:case z.NOT_FOUND:case z.ALREADY_EXISTS:case z.PERMISSION_DENIED:case z.FAILED_PRECONDITION:case z.ABORTED:case z.OUT_OF_RANGE:case z.UNIMPLEMENTED:case z.DATA_LOSS:return!0;default:return Pe()}}function Zg(t){if(t===void 0)return xn("GRPC error has no .code"),z.UNKNOWN;switch(t){case gt.OK:return z.OK;case gt.CANCELLED:return z.CANCELLED;case gt.UNKNOWN:return z.UNKNOWN;case gt.DEADLINE_EXCEEDED:return z.DEADLINE_EXCEEDED;case gt.RESOURCE_EXHAUSTED:return z.RESOURCE_EXHAUSTED;case gt.INTERNAL:return z.INTERNAL;case gt.UNAVAILABLE:return z.UNAVAILABLE;case gt.UNAUTHENTICATED:return z.UNAUTHENTICATED;case gt.INVALID_ARGUMENT:return z.INVALID_ARGUMENT;case gt.NOT_FOUND:return z.NOT_FOUND;case gt.ALREADY_EXISTS:return z.ALREADY_EXISTS;case gt.PERMISSION_DENIED:return z.PERMISSION_DENIED;case gt.FAILED_PRECONDITION:return z.FAILED_PRECONDITION;case gt.ABORTED:return z.ABORTED;case gt.OUT_OF_RANGE:return z.OUT_OF_RANGE;case gt.UNIMPLEMENTED:return z.UNIMPLEMENTED;case gt.DATA_LOSS:return z.DATA_LOSS;default:return Pe()}}(je=gt||(gt={}))[je.OK=0]="OK",je[je.CANCELLED=1]="CANCELLED",je[je.UNKNOWN=2]="UNKNOWN",je[je.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",je[je.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",je[je.NOT_FOUND=5]="NOT_FOUND",je[je.ALREADY_EXISTS=6]="ALREADY_EXISTS",je[je.PERMISSION_DENIED=7]="PERMISSION_DENIED",je[je.UNAUTHENTICATED=16]="UNAUTHENTICATED",je[je.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",je[je.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",je[je.ABORTED=10]="ABORTED",je[je.OUT_OF_RANGE=11]="OUT_OF_RANGE",je[je.UNIMPLEMENTED=12]="UNIMPLEMENTED",je[je.INTERNAL=13]="INTERNAL",je[je.UNAVAILABLE=14]="UNAVAILABLE",je[je.DATA_LOSS=15]="DATA_LOSS";/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function bw(){return new TextEncoder}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ww=new es([4294967295,4294967295],0);function $h(t){const e=bw().encode(t),n=new mg;return n.update(e),new Uint8Array(n.digest())}function Lh(t){const e=new DataView(t.buffer),n=e.getUint32(0,!0),s=e.getUint32(4,!0),i=e.getUint32(8,!0),r=e.getUint32(12,!0);return[new es([n,s],0),new es([i,r],0)]}class Wc{constructor(e,n,s){if(this.bitmap=e,this.padding=n,this.hashCount=s,n<0||n>=8)throw new Yi(`Invalid padding: ${n}`);if(s<0)throw new Yi(`Invalid hash count: ${s}`);if(e.length>0&&this.hashCount===0)throw new Yi(`Invalid hash count: ${s}`);if(e.length===0&&n!==0)throw new Yi(`Invalid padding when bitmap length is 0: ${n}`);this.Ee=8*e.length-n,this.de=es.fromNumber(this.Ee)}Ae(e,n,s){let i=e.add(n.multiply(es.fromNumber(s)));return i.compare(ww)===1&&(i=new es([i.getBits(0),i.getBits(1)],0)),i.modulo(this.de).toNumber()}Re(e){return!!(this.bitmap[Math.floor(e/8)]&1<<e%8)}mightContain(e){if(this.Ee===0)return!1;const n=$h(e),[s,i]=Lh(n);for(let r=0;r<this.hashCount;r++){const o=this.Ae(s,i,r);if(!this.Re(o))return!1}return!0}static create(e,n,s){const i=e%8==0?0:8-e%8,r=new Uint8Array(Math.ceil(e/8)),o=new Wc(r,i,n);return s.forEach(l=>o.insert(l)),o}insert(e){if(this.Ee===0)return;const n=$h(e),[s,i]=Lh(n);for(let r=0;r<this.hashCount;r++){const o=this.Ae(s,i,r);this.Ve(o)}}Ve(e){const n=Math.floor(e/8),s=e%8;this.bitmap[n]|=1<<s}}class Yi extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class va{constructor(e,n,s,i,r){this.snapshotVersion=e,this.targetChanges=n,this.targetMismatches=s,this.documentUpdates=i,this.resolvedLimboDocuments=r}static createSynthesizedRemoteEventForCurrentChange(e,n,s){const i=new Map;return i.set(e,Nr.createSynthesizedTargetChangeForCurrentChange(e,n,s)),new va(De.min(),i,new at(He),Vn(),Be())}}class Nr{constructor(e,n,s,i,r){this.resumeToken=e,this.current=n,this.addedDocuments=s,this.modifiedDocuments=i,this.removedDocuments=r}static createSynthesizedTargetChangeForCurrentChange(e,n,s){return new Nr(s,n,Be(),Be(),Be())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class To{constructor(e,n,s,i){this.me=e,this.removedTargetIds=n,this.key=s,this.fe=i}}class em{constructor(e,n){this.targetId=e,this.ge=n}}class tm{constructor(e,n,s=wt.EMPTY_BYTE_STRING,i=null){this.state=e,this.targetIds=n,this.resumeToken=s,this.cause=i}}class Bh{constructor(){this.pe=0,this.ye=Uh(),this.we=wt.EMPTY_BYTE_STRING,this.be=!1,this.Se=!0}get current(){return this.be}get resumeToken(){return this.we}get De(){return this.pe!==0}get ve(){return this.Se}Ce(e){e.approximateByteSize()>0&&(this.Se=!0,this.we=e)}Fe(){let e=Be(),n=Be(),s=Be();return this.ye.forEach((i,r)=>{switch(r){case 0:e=e.add(i);break;case 2:n=n.add(i);break;case 1:s=s.add(i);break;default:Pe()}}),new Nr(this.we,this.be,e,n,s)}Me(){this.Se=!1,this.ye=Uh()}xe(e,n){this.Se=!0,this.ye=this.ye.insert(e,n)}Oe(e){this.Se=!0,this.ye=this.ye.remove(e)}Ne(){this.pe+=1}Be(){this.pe-=1,Qe(this.pe>=0)}Le(){this.Se=!0,this.be=!0}}class Aw{constructor(e){this.ke=e,this.qe=new Map,this.Qe=Vn(),this.$e=lo(),this.Ke=lo(),this.Ue=new at(He)}We(e){for(const n of e.me)e.fe&&e.fe.isFoundDocument()?this.Ge(n,e.fe):this.ze(n,e.key,e.fe);for(const n of e.removedTargetIds)this.ze(n,e.key,e.fe)}je(e){this.forEachTarget(e,n=>{const s=this.He(n);switch(e.state){case 0:this.Je(n)&&s.Ce(e.resumeToken);break;case 1:s.Be(),s.De||s.Me(),s.Ce(e.resumeToken);break;case 2:s.Be(),s.De||this.removeTarget(n);break;case 3:this.Je(n)&&(s.Le(),s.Ce(e.resumeToken));break;case 4:this.Je(n)&&(this.Ye(n),s.Ce(e.resumeToken));break;default:Pe()}})}forEachTarget(e,n){e.targetIds.length>0?e.targetIds.forEach(n):this.qe.forEach((s,i)=>{this.Je(i)&&n(i)})}Ze(e){const n=e.targetId,s=e.ge.count,i=this.Xe(n);if(i){const r=i.target;if(Wl(r))if(s===0){const o=new Ae(r.path);this.ze(n,o,xt.newNoDocument(o,De.min()))}else Qe(s===1);else{const o=this.et(n);if(o!==s){const l=this.tt(e),c=l?this.nt(l,e,o):1;if(c!==0){this.Ye(n);const u=c===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Ue=this.Ue.insert(n,u)}}}}}tt(e){const n=e.ge.unchangedNames;if(!n||!n.bits)return null;const{bits:{bitmap:s="",padding:i=0},hashCount:r=0}=n;let o,l;try{o=cs(s).toUint8Array()}catch(c){if(c instanceof Sg)return js("Decoding the base64 bloom filter in existence filter failed ("+c.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw c}try{l=new Wc(o,i,r)}catch(c){return js(c instanceof Yi?"BloomFilter error: ":"Applying bloom filter failed: ",c),null}return l.Ee===0?null:l}nt(e,n,s){return n.ge.count===s-this.st(e,n.targetId)?0:2}st(e,n){const s=this.ke.getRemoteKeysForTarget(n);let i=0;return s.forEach(r=>{const o=this.ke.it(),l=`projects/${o.projectId}/databases/${o.database}/documents/${r.path.canonicalString()}`;e.mightContain(l)||(this.ze(n,r,null),i++)}),i}ot(e){const n=new Map;this.qe.forEach((r,o)=>{const l=this.Xe(o);if(l){if(r.current&&Wl(l.target)){const c=new Ae(l.target.path);this._t(c).has(o)||this.ut(o,c)||this.ze(o,c,xt.newNoDocument(c,e))}r.ve&&(n.set(o,r.Fe()),r.Me())}});let s=Be();this.Ke.forEach((r,o)=>{let l=!0;o.forEachWhile(c=>{const u=this.Xe(c);return!u||u.purpose==="TargetPurposeLimboResolution"||(l=!1,!1)}),l&&(s=s.add(r))}),this.Qe.forEach((r,o)=>o.setReadTime(e));const i=new va(e,n,this.Ue,this.Qe,s);return this.Qe=Vn(),this.$e=lo(),this.Ke=lo(),this.Ue=new at(He),i}Ge(e,n){if(!this.Je(e))return;const s=this.ut(e,n.key)?2:0;this.He(e).xe(n.key,s),this.Qe=this.Qe.insert(n.key,n),this.$e=this.$e.insert(n.key,this._t(n.key).add(e)),this.Ke=this.Ke.insert(n.key,this.ct(n.key).add(e))}ze(e,n,s){if(!this.Je(e))return;const i=this.He(e);this.ut(e,n)?i.xe(n,1):i.Oe(n),this.Ke=this.Ke.insert(n,this.ct(n).delete(e)),this.Ke=this.Ke.insert(n,this.ct(n).add(e)),s&&(this.Qe=this.Qe.insert(n,s))}removeTarget(e){this.qe.delete(e)}et(e){const n=this.He(e).Fe();return this.ke.getRemoteKeysForTarget(e).size+n.addedDocuments.size-n.removedDocuments.size}Ne(e){this.He(e).Ne()}He(e){let n=this.qe.get(e);return n||(n=new Bh,this.qe.set(e,n)),n}ct(e){let n=this.Ke.get(e);return n||(n=new Et(He),this.Ke=this.Ke.insert(e,n)),n}_t(e){let n=this.$e.get(e);return n||(n=new Et(He),this.$e=this.$e.insert(e,n)),n}Je(e){const n=this.Xe(e)!==null;return n||Ee("WatchChangeAggregator","Detected inactive target",e),n}Xe(e){const n=this.qe.get(e);return n&&n.De?null:this.ke.lt(e)}Ye(e){this.qe.set(e,new Bh),this.ke.getRemoteKeysForTarget(e).forEach(n=>{this.ze(e,n,null)})}ut(e,n){return this.ke.getRemoteKeysForTarget(e).has(n)}}function lo(){return new at(Ae.comparator)}function Uh(){return new at(Ae.comparator)}const Iw={asc:"ASCENDING",desc:"DESCENDING"},Sw={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},Cw={and:"AND",or:"OR"};class kw{constructor(e,n){this.databaseId=e,this.useProto3Json=n}}function Yl(t,e){return t.useProto3Json||da(e)?e:{value:e}}function Ho(t,e){return t.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function nm(t,e){return t.useProto3Json?e.toBase64():e.toUint8Array()}function Pw(t,e){return Ho(t,e.toTimestamp())}function En(t){return Qe(!!t),De.fromTimestamp(function(n){const s=ls(n);return new yt(s.seconds,s.nanos)}(t))}function zc(t,e){return Ql(t,e).canonicalString()}function Ql(t,e){const n=function(i){return new st(["projects",i.projectId,"databases",i.database])}(t).child("documents");return e===void 0?n:n.child(e)}function sm(t){const e=st.fromString(t);return Qe(lm(e)),e}function Xl(t,e){return zc(t.databaseId,e.path)}function ml(t,e){const n=sm(e);if(n.get(1)!==t.databaseId.projectId)throw new _e(z.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+n.get(1)+" vs "+t.databaseId.projectId);if(n.get(3)!==t.databaseId.database)throw new _e(z.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+n.get(3)+" vs "+t.databaseId.database);return new Ae(rm(n))}function im(t,e){return zc(t.databaseId,e)}function Rw(t){const e=sm(t);return e.length===4?st.emptyPath():rm(e)}function Jl(t){return new st(["projects",t.databaseId.projectId,"databases",t.databaseId.database]).canonicalString()}function rm(t){return Qe(t.length>4&&t.get(4)==="documents"),t.popFirst(5)}function Hh(t,e,n){return{name:Xl(t,e),fields:n.value.mapValue.fields}}function Dw(t,e){let n;if("targetChange"in e){e.targetChange;const s=function(u){return u==="NO_CHANGE"?0:u==="ADD"?1:u==="REMOVE"?2:u==="CURRENT"?3:u==="RESET"?4:Pe()}(e.targetChange.targetChangeType||"NO_CHANGE"),i=e.targetChange.targetIds||[],r=function(u,h){return u.useProto3Json?(Qe(h===void 0||typeof h=="string"),wt.fromBase64String(h||"")):(Qe(h===void 0||h instanceof Buffer||h instanceof Uint8Array),wt.fromUint8Array(h||new Uint8Array))}(t,e.targetChange.resumeToken),o=e.targetChange.cause,l=o&&function(u){const h=u.code===void 0?z.UNKNOWN:Zg(u.code);return new _e(h,u.message||"")}(o);n=new tm(s,i,r,l||null)}else if("documentChange"in e){e.documentChange;const s=e.documentChange;s.document,s.document.name,s.document.updateTime;const i=ml(t,s.document.name),r=En(s.document.updateTime),o=s.document.createTime?En(s.document.createTime):De.min(),l=new nn({mapValue:{fields:s.document.fields}}),c=xt.newFoundDocument(i,r,o,l),u=s.targetIds||[],h=s.removedTargetIds||[];n=new To(u,h,c.key,c)}else if("documentDelete"in e){e.documentDelete;const s=e.documentDelete;s.document;const i=ml(t,s.document),r=s.readTime?En(s.readTime):De.min(),o=xt.newNoDocument(i,r),l=s.removedTargetIds||[];n=new To([],l,o.key,o)}else if("documentRemove"in e){e.documentRemove;const s=e.documentRemove;s.document;const i=ml(t,s.document),r=s.removedTargetIds||[];n=new To([],r,i,null)}else{if(!("filter"in e))return Pe();{e.filter;const s=e.filter;s.targetId;const{count:i=0,unchangedNames:r}=s,o=new Ew(i,r),l=s.targetId;n=new em(l,o)}}return n}function Mw(t,e){let n;if(e instanceof Or)n={update:Hh(t,e.key,e.value)};else if(e instanceof qc)n={delete:Xl(t,e.key)};else if(e instanceof Qs)n={update:Hh(t,e.key,e.data),updateMask:Uw(e.fieldMask)};else{if(!(e instanceof vw))return Pe();n={verify:Xl(t,e.key)}}return e.fieldTransforms.length>0&&(n.updateTransforms=e.fieldTransforms.map(s=>function(r,o){const l=o.transform;if(l instanceof Ir)return{fieldPath:o.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(l instanceof Sr)return{fieldPath:o.field.canonicalString(),appendMissingElements:{values:l.elements}};if(l instanceof Cr)return{fieldPath:o.field.canonicalString(),removeAllFromArray:{values:l.elements}};if(l instanceof Uo)return{fieldPath:o.field.canonicalString(),increment:l.Ie};throw Pe()}(0,s))),e.precondition.isNone||(n.currentDocument=function(i,r){return r.updateTime!==void 0?{updateTime:Pw(i,r.updateTime)}:r.exists!==void 0?{exists:r.exists}:Pe()}(t,e.precondition)),n}function Ow(t,e){return t&&t.length>0?(Qe(e!==void 0),t.map(n=>function(i,r){let o=i.updateTime?En(i.updateTime):En(r);return o.isEqual(De.min())&&(o=En(r)),new pw(o,i.transformResults||[])}(n,e))):[]}function Nw(t,e){return{documents:[im(t,e.path)]}}function xw(t,e){const n={structuredQuery:{}},s=e.path;let i;e.collectionGroup!==null?(i=s,n.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(i=s.popLast(),n.structuredQuery.from=[{collectionId:s.lastSegment()}]),n.parent=im(t,i);const r=function(u){if(u.length!==0)return am(dn.create(u,"and"))}(e.filters);r&&(n.structuredQuery.where=r);const o=function(u){if(u.length!==0)return u.map(h=>function(m){return{field:ui(m.field),direction:$w(m.dir)}}(h))}(e.orderBy);o&&(n.structuredQuery.orderBy=o);const l=Yl(t,e.limit);return l!==null&&(n.structuredQuery.limit=l),e.startAt&&(n.structuredQuery.startAt=function(u){return{before:u.inclusive,values:u.position}}(e.startAt)),e.endAt&&(n.structuredQuery.endAt=function(u){return{before:!u.inclusive,values:u.position}}(e.endAt)),{ht:n,parent:i}}function Vw(t){let e=Rw(t.parent);const n=t.structuredQuery,s=n.from?n.from.length:0;let i=null;if(s>0){Qe(s===1);const h=n.from[0];h.allDescendants?i=h.collectionId:e=e.child(h.collectionId)}let r=[];n.where&&(r=function(f){const m=om(f);return m instanceof dn&&Vg(m)?m.getFilters():[m]}(n.where));let o=[];n.orderBy&&(o=function(f){return f.map(m=>function(C){return new Ar(di(C.field),function(S){switch(S){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(C.direction))}(m))}(n.orderBy));let l=null;n.limit&&(l=function(f){let m;return m=typeof f=="object"?f.value:f,da(m)?null:m}(n.limit));let c=null;n.startAt&&(c=function(f){const m=!!f.before,y=f.values||[];return new Lo(y,m)}(n.startAt));let u=null;return n.endAt&&(u=function(f){const m=!f.before,y=f.values||[];return new Lo(y,m)}(n.endAt)),ew(e,i,o,r,l,"F",c,u)}function Fw(t,e){const n=function(i){switch(i){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return Pe()}}(e.purpose);return n==null?null:{"goog-listen-tags":n}}function om(t){return t.unaryFilter!==void 0?function(n){switch(n.unaryFilter.op){case"IS_NAN":const s=di(n.unaryFilter.field);return vt.create(s,"==",{doubleValue:NaN});case"IS_NULL":const i=di(n.unaryFilter.field);return vt.create(i,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const r=di(n.unaryFilter.field);return vt.create(r,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const o=di(n.unaryFilter.field);return vt.create(o,"!=",{nullValue:"NULL_VALUE"});default:return Pe()}}(t):t.fieldFilter!==void 0?function(n){return vt.create(di(n.fieldFilter.field),function(i){switch(i){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";default:return Pe()}}(n.fieldFilter.op),n.fieldFilter.value)}(t):t.compositeFilter!==void 0?function(n){return dn.create(n.compositeFilter.filters.map(s=>om(s)),function(i){switch(i){case"AND":return"and";case"OR":return"or";default:return Pe()}}(n.compositeFilter.op))}(t):Pe()}function $w(t){return Iw[t]}function Lw(t){return Sw[t]}function Bw(t){return Cw[t]}function ui(t){return{fieldPath:t.canonicalString()}}function di(t){return bt.fromServerFormat(t.fieldPath)}function am(t){return t instanceof vt?function(n){if(n.op==="=="){if(Ph(n.value))return{unaryFilter:{field:ui(n.field),op:"IS_NAN"}};if(kh(n.value))return{unaryFilter:{field:ui(n.field),op:"IS_NULL"}}}else if(n.op==="!="){if(Ph(n.value))return{unaryFilter:{field:ui(n.field),op:"IS_NOT_NAN"}};if(kh(n.value))return{unaryFilter:{field:ui(n.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:ui(n.field),op:Lw(n.op),value:n.value}}}(t):t instanceof dn?function(n){const s=n.getFilters().map(i=>am(i));return s.length===1?s[0]:{compositeFilter:{op:Bw(n.op),filters:s}}}(t):Pe()}function Uw(t){const e=[];return t.fields.forEach(n=>e.push(n.canonicalString())),{fieldPaths:e}}function lm(t){return t.length>=4&&t.get(0)==="projects"&&t.get(2)==="databases"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Yn{constructor(e,n,s,i,r=De.min(),o=De.min(),l=wt.EMPTY_BYTE_STRING,c=null){this.target=e,this.targetId=n,this.purpose=s,this.sequenceNumber=i,this.snapshotVersion=r,this.lastLimboFreeSnapshotVersion=o,this.resumeToken=l,this.expectedCount=c}withSequenceNumber(e){return new Yn(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,n){return new Yn(this.target,this.targetId,this.purpose,this.sequenceNumber,n,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new Yn(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new Yn(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Hw{constructor(e){this.Tt=e}}function jw(t){const e=Vw({parent:t.parent,structuredQuery:t.structuredQuery});return t.limitType==="LAST"?Bo(e,e.limit,"L"):e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Kw{constructor(){this.Tn=new qw}addToCollectionParentIndex(e,n){return this.Tn.add(n),Y.resolve()}getCollectionParents(e,n){return Y.resolve(this.Tn.getEntries(n))}addFieldIndex(e,n){return Y.resolve()}deleteFieldIndex(e,n){return Y.resolve()}deleteAllFieldIndexes(e){return Y.resolve()}createTargetIndexes(e,n){return Y.resolve()}getDocumentsMatchingTarget(e,n){return Y.resolve(null)}getIndexType(e,n){return Y.resolve(0)}getFieldIndexes(e,n){return Y.resolve([])}getNextCollectionGroupToUpdate(e){return Y.resolve(null)}getMinOffset(e,n){return Y.resolve(as.min())}getMinOffsetFromCollectionGroup(e,n){return Y.resolve(as.min())}updateCollectionGroup(e,n,s){return Y.resolve()}updateIndexEntries(e,n){return Y.resolve()}}class qw{constructor(){this.index={}}add(e){const n=e.lastSegment(),s=e.popLast(),i=this.index[n]||new Et(st.comparator),r=!i.has(s);return this.index[n]=i.add(s),r}has(e){const n=e.lastSegment(),s=e.popLast(),i=this.index[n];return i&&i.has(s)}getEntries(e){return(this.index[e]||new Et(st.comparator)).toArray()}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const jh={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},cm=41943040;class Ht{static withCacheSize(e){return new Ht(e,Ht.DEFAULT_COLLECTION_PERCENTILE,Ht.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}constructor(e,n,s){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=n,this.maximumSequenceNumbersToCollect=s}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */Ht.DEFAULT_COLLECTION_PERCENTILE=10,Ht.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,Ht.DEFAULT=new Ht(cm,Ht.DEFAULT_COLLECTION_PERCENTILE,Ht.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),Ht.DISABLED=new Ht(-1,0,0);/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bi{constructor(e){this.$n=e}next(){return this.$n+=2,this.$n}static Kn(){return new bi(0)}static Un(){return new bi(-1)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Kh="LruGarbageCollector",Gw=1048576;function qh([t,e],[n,s]){const i=He(t,n);return i===0?He(e,s):i}class Ww{constructor(e){this.Hn=e,this.buffer=new Et(qh),this.Jn=0}Yn(){return++this.Jn}Zn(e){const n=[e,this.Yn()];if(this.buffer.size<this.Hn)this.buffer=this.buffer.add(n);else{const s=this.buffer.last();qh(n,s)<0&&(this.buffer=this.buffer.delete(s).add(n))}}get maxValue(){return this.buffer.last()[0]}}class zw{constructor(e,n,s){this.garbageCollector=e,this.asyncQueue=n,this.localStore=s,this.Xn=null}start(){this.garbageCollector.params.cacheSizeCollectionThreshold!==-1&&this.er(6e4)}stop(){this.Xn&&(this.Xn.cancel(),this.Xn=null)}get started(){return this.Xn!==null}er(e){Ee(Kh,`Garbage collection scheduled in ${e}ms`),this.Xn=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,async()=>{this.Xn=null;try{await this.localStore.collectGarbage(this.garbageCollector)}catch(n){Ci(n)?Ee(Kh,"Ignoring IndexedDB error during garbage collection: ",n):await Si(n)}await this.er(3e5)})}}class Yw{constructor(e,n){this.tr=e,this.params=n}calculateTargetCount(e,n){return this.tr.nr(e).next(s=>Math.floor(n/100*s))}nthSequenceNumber(e,n){if(n===0)return Y.resolve(ua.ae);const s=new Ww(n);return this.tr.forEachTarget(e,i=>s.Zn(i.sequenceNumber)).next(()=>this.tr.rr(e,i=>s.Zn(i))).next(()=>s.maxValue)}removeTargets(e,n,s){return this.tr.removeTargets(e,n,s)}removeOrphanedDocuments(e,n){return this.tr.removeOrphanedDocuments(e,n)}collect(e,n){return this.params.cacheSizeCollectionThreshold===-1?(Ee("LruGarbageCollector","Garbage collection skipped; disabled"),Y.resolve(jh)):this.getCacheSize(e).next(s=>s<this.params.cacheSizeCollectionThreshold?(Ee("LruGarbageCollector",`Garbage collection skipped; Cache size ${s} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),jh):this.ir(e,n))}getCacheSize(e){return this.tr.getCacheSize(e)}ir(e,n){let s,i,r,o,l,c,u;const h=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next(f=>(f>this.params.maximumSequenceNumbersToCollect?(Ee("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${f}`),i=this.params.maximumSequenceNumbersToCollect):i=f,o=Date.now(),this.nthSequenceNumber(e,i))).next(f=>(s=f,l=Date.now(),this.removeTargets(e,s,n))).next(f=>(r=f,c=Date.now(),this.removeOrphanedDocuments(e,s))).next(f=>(u=Date.now(),li()<=Ke.DEBUG&&Ee("LruGarbageCollector",`LRU Garbage Collection
	Counted targets in ${o-h}ms
	Determined least recently used ${i} in `+(l-o)+`ms
	Removed ${r} targets in `+(c-l)+`ms
	Removed ${f} documents in `+(u-c)+`ms
Total Duration: ${u-h}ms`),Y.resolve({didRun:!0,sequenceNumbersCollected:i,targetsRemoved:r,documentsRemoved:f})))}}function Qw(t,e){return new Yw(t,e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Xw{constructor(){this.changes=new Ys(e=>e.toString(),(e,n)=>e.isEqual(n)),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,n){this.assertNotApplied(),this.changes.set(e,xt.newInvalidDocument(e).setReadTime(n))}getEntry(e,n){this.assertNotApplied();const s=this.changes.get(n);return s!==void 0?Y.resolve(s):this.getFromCache(e,n)}getEntries(e,n){return this.getAllFromCache(e,n)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Jw{constructor(e,n){this.overlayedDocument=e,this.mutatedFields=n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Zw{constructor(e,n,s,i){this.remoteDocumentCache=e,this.mutationQueue=n,this.documentOverlayCache=s,this.indexManager=i}getDocument(e,n){let s=null;return this.documentOverlayCache.getOverlay(e,n).next(i=>(s=i,this.remoteDocumentCache.getEntry(e,n))).next(i=>(s!==null&&cr(s.mutation,i,ln.empty(),yt.now()),i))}getDocuments(e,n){return this.remoteDocumentCache.getEntries(e,n).next(s=>this.getLocalViewOfDocuments(e,s,Be()).next(()=>s))}getLocalViewOfDocuments(e,n,s=Be()){const i=Ns();return this.populateOverlays(e,i,n).next(()=>this.computeViews(e,n,i,s).next(r=>{let o=zi();return r.forEach((l,c)=>{o=o.insert(l,c.overlayedDocument)}),o}))}getOverlayedDocuments(e,n){const s=Ns();return this.populateOverlays(e,s,n).next(()=>this.computeViews(e,n,s,Be()))}populateOverlays(e,n,s){const i=[];return s.forEach(r=>{n.has(r)||i.push(r)}),this.documentOverlayCache.getOverlays(e,i).next(r=>{r.forEach((o,l)=>{n.set(o,l)})})}computeViews(e,n,s,i){let r=Vn();const o=lr(),l=function(){return lr()}();return n.forEach((c,u)=>{const h=s.get(u.key);i.has(u.key)&&(h===void 0||h.mutation instanceof Qs)?r=r.insert(u.key,u):h!==void 0?(o.set(u.key,h.mutation.getFieldMask()),cr(h.mutation,u,h.mutation.getFieldMask(),yt.now())):o.set(u.key,ln.empty())}),this.recalculateAndSaveOverlays(e,r).next(c=>(c.forEach((u,h)=>o.set(u,h)),n.forEach((u,h)=>{var f;return l.set(u,new Jw(h,(f=o.get(u))!==null&&f!==void 0?f:null))}),l))}recalculateAndSaveOverlays(e,n){const s=lr();let i=new at((o,l)=>o-l),r=Be();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,n).next(o=>{for(const l of o)l.keys().forEach(c=>{const u=n.get(c);if(u===null)return;let h=s.get(c)||ln.empty();h=l.applyToLocalView(u,h),s.set(c,h);const f=(i.get(l.batchId)||Be()).add(c);i=i.insert(l.batchId,f)})}).next(()=>{const o=[],l=i.getReverseIterator();for(;l.hasNext();){const c=l.getNext(),u=c.key,h=c.value,f=qg();h.forEach(m=>{if(!r.has(m)){const y=Xg(n.get(m),s.get(m));y!==null&&f.set(m,y),r=r.add(m)}}),o.push(this.documentOverlayCache.saveOverlays(e,u,f))}return Y.waitFor(o)}).next(()=>s)}recalculateAndSaveOverlaysForDocumentKeys(e,n){return this.remoteDocumentCache.getEntries(e,n).next(s=>this.recalculateAndSaveOverlays(e,s))}getDocumentsMatchingQuery(e,n,s,i){return function(o){return Ae.isDocumentKey(o.path)&&o.collectionGroup===null&&o.filters.length===0}(n)?this.getDocumentsMatchingDocumentQuery(e,n.path):Bg(n)?this.getDocumentsMatchingCollectionGroupQuery(e,n,s,i):this.getDocumentsMatchingCollectionQuery(e,n,s,i)}getNextDocuments(e,n,s,i){return this.remoteDocumentCache.getAllFromCollectionGroup(e,n,s,i).next(r=>{const o=i-r.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,n,s.largestBatchId,i-r.size):Y.resolve(Ns());let l=Tr,c=r;return o.next(u=>Y.forEach(u,(h,f)=>(l<f.largestBatchId&&(l=f.largestBatchId),r.get(h)?Y.resolve():this.remoteDocumentCache.getEntry(e,h).next(m=>{c=c.insert(h,m)}))).next(()=>this.populateOverlays(e,u,r)).next(()=>this.computeViews(e,c,u,Be())).next(h=>({batchId:l,changes:Kg(h)})))})}getDocumentsMatchingDocumentQuery(e,n){return this.getDocument(e,new Ae(n)).next(s=>{let i=zi();return s.isFoundDocument()&&(i=i.insert(s.key,s)),i})}getDocumentsMatchingCollectionGroupQuery(e,n,s,i){const r=n.collectionGroup;let o=zi();return this.indexManager.getCollectionParents(e,r).next(l=>Y.forEach(l,c=>{const u=function(f,m){return new ki(m,null,f.explicitOrderBy.slice(),f.filters.slice(),f.limit,f.limitType,f.startAt,f.endAt)}(n,c.child(r));return this.getDocumentsMatchingCollectionQuery(e,u,s,i).next(h=>{h.forEach((f,m)=>{o=o.insert(f,m)})})}).next(()=>o))}getDocumentsMatchingCollectionQuery(e,n,s,i){let r;return this.documentOverlayCache.getOverlaysForCollection(e,n.path,s.largestBatchId).next(o=>(r=o,this.remoteDocumentCache.getDocumentsMatchingQuery(e,n,s,r,i))).next(o=>{r.forEach((c,u)=>{const h=u.getKey();o.get(h)===null&&(o=o.insert(h,xt.newInvalidDocument(h)))});let l=zi();return o.forEach((c,u)=>{const h=r.get(c);h!==void 0&&cr(h.mutation,u,ln.empty(),yt.now()),pa(n,u)&&(l=l.insert(c,u))}),l})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class eA{constructor(e){this.serializer=e,this.dr=new Map,this.Ar=new Map}getBundleMetadata(e,n){return Y.resolve(this.dr.get(n))}saveBundleMetadata(e,n){return this.dr.set(n.id,function(i){return{id:i.id,version:i.version,createTime:En(i.createTime)}}(n)),Y.resolve()}getNamedQuery(e,n){return Y.resolve(this.Ar.get(n))}saveNamedQuery(e,n){return this.Ar.set(n.name,function(i){return{name:i.name,query:jw(i.bundledQuery),readTime:En(i.readTime)}}(n)),Y.resolve()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tA{constructor(){this.overlays=new at(Ae.comparator),this.Rr=new Map}getOverlay(e,n){return Y.resolve(this.overlays.get(n))}getOverlays(e,n){const s=Ns();return Y.forEach(n,i=>this.getOverlay(e,i).next(r=>{r!==null&&s.set(i,r)})).next(()=>s)}saveOverlays(e,n,s){return s.forEach((i,r)=>{this.Et(e,n,r)}),Y.resolve()}removeOverlaysForBatchId(e,n,s){const i=this.Rr.get(s);return i!==void 0&&(i.forEach(r=>this.overlays=this.overlays.remove(r)),this.Rr.delete(s)),Y.resolve()}getOverlaysForCollection(e,n,s){const i=Ns(),r=n.length+1,o=new Ae(n.child("")),l=this.overlays.getIteratorFrom(o);for(;l.hasNext();){const c=l.getNext().value,u=c.getKey();if(!n.isPrefixOf(u.path))break;u.path.length===r&&c.largestBatchId>s&&i.set(c.getKey(),c)}return Y.resolve(i)}getOverlaysForCollectionGroup(e,n,s,i){let r=new at((u,h)=>u-h);const o=this.overlays.getIterator();for(;o.hasNext();){const u=o.getNext().value;if(u.getKey().getCollectionGroup()===n&&u.largestBatchId>s){let h=r.get(u.largestBatchId);h===null&&(h=Ns(),r=r.insert(u.largestBatchId,h)),h.set(u.getKey(),u)}}const l=Ns(),c=r.getIterator();for(;c.hasNext()&&(c.getNext().value.forEach((u,h)=>l.set(u,h)),!(l.size()>=i)););return Y.resolve(l)}Et(e,n,s){const i=this.overlays.get(s.key);if(i!==null){const o=this.Rr.get(i.largestBatchId).delete(s.key);this.Rr.set(i.largestBatchId,o)}this.overlays=this.overlays.insert(s.key,new _w(n,s));let r=this.Rr.get(n);r===void 0&&(r=Be(),this.Rr.set(n,r)),this.Rr.set(n,r.add(s.key))}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nA{constructor(){this.sessionToken=wt.EMPTY_BYTE_STRING}getSessionToken(e){return Y.resolve(this.sessionToken)}setSessionToken(e,n){return this.sessionToken=n,Y.resolve()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Yc{constructor(){this.Vr=new Et(Tt.mr),this.gr=new Et(Tt.pr)}isEmpty(){return this.Vr.isEmpty()}addReference(e,n){const s=new Tt(e,n);this.Vr=this.Vr.add(s),this.gr=this.gr.add(s)}yr(e,n){e.forEach(s=>this.addReference(s,n))}removeReference(e,n){this.wr(new Tt(e,n))}br(e,n){e.forEach(s=>this.removeReference(s,n))}Sr(e){const n=new Ae(new st([])),s=new Tt(n,e),i=new Tt(n,e+1),r=[];return this.gr.forEachInRange([s,i],o=>{this.wr(o),r.push(o.key)}),r}Dr(){this.Vr.forEach(e=>this.wr(e))}wr(e){this.Vr=this.Vr.delete(e),this.gr=this.gr.delete(e)}vr(e){const n=new Ae(new st([])),s=new Tt(n,e),i=new Tt(n,e+1);let r=Be();return this.gr.forEachInRange([s,i],o=>{r=r.add(o.key)}),r}containsKey(e){const n=new Tt(e,0),s=this.Vr.firstAfterOrEqual(n);return s!==null&&e.isEqual(s.key)}}class Tt{constructor(e,n){this.key=e,this.Cr=n}static mr(e,n){return Ae.comparator(e.key,n.key)||He(e.Cr,n.Cr)}static pr(e,n){return He(e.Cr,n.Cr)||Ae.comparator(e.key,n.key)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sA{constructor(e,n){this.indexManager=e,this.referenceDelegate=n,this.mutationQueue=[],this.Fr=1,this.Mr=new Et(Tt.mr)}checkEmpty(e){return Y.resolve(this.mutationQueue.length===0)}addMutationBatch(e,n,s,i){const r=this.Fr;this.Fr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const o=new yw(r,n,s,i);this.mutationQueue.push(o);for(const l of i)this.Mr=this.Mr.add(new Tt(l.key,r)),this.indexManager.addToCollectionParentIndex(e,l.key.path.popLast());return Y.resolve(o)}lookupMutationBatch(e,n){return Y.resolve(this.Or(n))}getNextMutationBatchAfterBatchId(e,n){const s=n+1,i=this.Nr(s),r=i<0?0:i;return Y.resolve(this.mutationQueue.length>r?this.mutationQueue[r]:null)}getHighestUnacknowledgedBatchId(){return Y.resolve(this.mutationQueue.length===0?$c:this.Fr-1)}getAllMutationBatches(e){return Y.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,n){const s=new Tt(n,0),i=new Tt(n,Number.POSITIVE_INFINITY),r=[];return this.Mr.forEachInRange([s,i],o=>{const l=this.Or(o.Cr);r.push(l)}),Y.resolve(r)}getAllMutationBatchesAffectingDocumentKeys(e,n){let s=new Et(He);return n.forEach(i=>{const r=new Tt(i,0),o=new Tt(i,Number.POSITIVE_INFINITY);this.Mr.forEachInRange([r,o],l=>{s=s.add(l.Cr)})}),Y.resolve(this.Br(s))}getAllMutationBatchesAffectingQuery(e,n){const s=n.path,i=s.length+1;let r=s;Ae.isDocumentKey(r)||(r=r.child(""));const o=new Tt(new Ae(r),0);let l=new Et(He);return this.Mr.forEachWhile(c=>{const u=c.key.path;return!!s.isPrefixOf(u)&&(u.length===i&&(l=l.add(c.Cr)),!0)},o),Y.resolve(this.Br(l))}Br(e){const n=[];return e.forEach(s=>{const i=this.Or(s);i!==null&&n.push(i)}),n}removeMutationBatch(e,n){Qe(this.Lr(n.batchId,"removed")===0),this.mutationQueue.shift();let s=this.Mr;return Y.forEach(n.mutations,i=>{const r=new Tt(i.key,n.batchId);return s=s.delete(r),this.referenceDelegate.markPotentiallyOrphaned(e,i.key)}).next(()=>{this.Mr=s})}qn(e){}containsKey(e,n){const s=new Tt(n,0),i=this.Mr.firstAfterOrEqual(s);return Y.resolve(n.isEqual(i&&i.key))}performConsistencyCheck(e){return this.mutationQueue.length,Y.resolve()}Lr(e,n){return this.Nr(e)}Nr(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}Or(e){const n=this.Nr(e);return n<0||n>=this.mutationQueue.length?null:this.mutationQueue[n]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class iA{constructor(e){this.kr=e,this.docs=function(){return new at(Ae.comparator)}(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,n){const s=n.key,i=this.docs.get(s),r=i?i.size:0,o=this.kr(n);return this.docs=this.docs.insert(s,{document:n.mutableCopy(),size:o}),this.size+=o-r,this.indexManager.addToCollectionParentIndex(e,s.path.popLast())}removeEntry(e){const n=this.docs.get(e);n&&(this.docs=this.docs.remove(e),this.size-=n.size)}getEntry(e,n){const s=this.docs.get(n);return Y.resolve(s?s.document.mutableCopy():xt.newInvalidDocument(n))}getEntries(e,n){let s=Vn();return n.forEach(i=>{const r=this.docs.get(i);s=s.insert(i,r?r.document.mutableCopy():xt.newInvalidDocument(i))}),Y.resolve(s)}getDocumentsMatchingQuery(e,n,s,i){let r=Vn();const o=n.path,l=new Ae(o.child("__id-9223372036854775808__")),c=this.docs.getIteratorFrom(l);for(;c.hasNext();){const{key:u,value:{document:h}}=c.getNext();if(!o.isPrefixOf(u.path))break;u.path.length>o.length+1||Mb(Db(h),s)<=0||(i.has(h.key)||pa(n,h))&&(r=r.insert(h.key,h.mutableCopy()))}return Y.resolve(r)}getAllFromCollectionGroup(e,n,s,i){Pe()}qr(e,n){return Y.forEach(this.docs,s=>n(s))}newChangeBuffer(e){return new rA(this)}getSize(e){return Y.resolve(this.size)}}class rA extends Xw{constructor(e){super(),this.Ir=e}applyChanges(e){const n=[];return this.changes.forEach((s,i)=>{i.isValidDocument()?n.push(this.Ir.addEntry(e,i)):this.Ir.removeEntry(s)}),Y.waitFor(n)}getFromCache(e,n){return this.Ir.getEntry(e,n)}getAllFromCache(e,n){return this.Ir.getEntries(e,n)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class oA{constructor(e){this.persistence=e,this.Qr=new Ys(n=>Uc(n),Hc),this.lastRemoteSnapshotVersion=De.min(),this.highestTargetId=0,this.$r=0,this.Kr=new Yc,this.targetCount=0,this.Ur=bi.Kn()}forEachTarget(e,n){return this.Qr.forEach((s,i)=>n(i)),Y.resolve()}getLastRemoteSnapshotVersion(e){return Y.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return Y.resolve(this.$r)}allocateTargetId(e){return this.highestTargetId=this.Ur.next(),Y.resolve(this.highestTargetId)}setTargetsMetadata(e,n,s){return s&&(this.lastRemoteSnapshotVersion=s),n>this.$r&&(this.$r=n),Y.resolve()}zn(e){this.Qr.set(e.target,e);const n=e.targetId;n>this.highestTargetId&&(this.Ur=new bi(n),this.highestTargetId=n),e.sequenceNumber>this.$r&&(this.$r=e.sequenceNumber)}addTargetData(e,n){return this.zn(n),this.targetCount+=1,Y.resolve()}updateTargetData(e,n){return this.zn(n),Y.resolve()}removeTargetData(e,n){return this.Qr.delete(n.target),this.Kr.Sr(n.targetId),this.targetCount-=1,Y.resolve()}removeTargets(e,n,s){let i=0;const r=[];return this.Qr.forEach((o,l)=>{l.sequenceNumber<=n&&s.get(l.targetId)===null&&(this.Qr.delete(o),r.push(this.removeMatchingKeysForTargetId(e,l.targetId)),i++)}),Y.waitFor(r).next(()=>i)}getTargetCount(e){return Y.resolve(this.targetCount)}getTargetData(e,n){const s=this.Qr.get(n)||null;return Y.resolve(s)}addMatchingKeys(e,n,s){return this.Kr.yr(n,s),Y.resolve()}removeMatchingKeys(e,n,s){this.Kr.br(n,s);const i=this.persistence.referenceDelegate,r=[];return i&&n.forEach(o=>{r.push(i.markPotentiallyOrphaned(e,o))}),Y.waitFor(r)}removeMatchingKeysForTargetId(e,n){return this.Kr.Sr(n),Y.resolve()}getMatchingKeysForTargetId(e,n){const s=this.Kr.vr(n);return Y.resolve(s)}containsKey(e,n){return Y.resolve(this.Kr.containsKey(n))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class um{constructor(e,n){this.Wr={},this.overlays={},this.Gr=new ua(0),this.zr=!1,this.zr=!0,this.jr=new nA,this.referenceDelegate=e(this),this.Hr=new oA(this),this.indexManager=new Kw,this.remoteDocumentCache=function(i){return new iA(i)}(s=>this.referenceDelegate.Jr(s)),this.serializer=new Hw(n),this.Yr=new eA(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.zr=!1,Promise.resolve()}get started(){return this.zr}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let n=this.overlays[e.toKey()];return n||(n=new tA,this.overlays[e.toKey()]=n),n}getMutationQueue(e,n){let s=this.Wr[e.toKey()];return s||(s=new sA(n,this.referenceDelegate),this.Wr[e.toKey()]=s),s}getGlobalsCache(){return this.jr}getTargetCache(){return this.Hr}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Yr}runTransaction(e,n,s){Ee("MemoryPersistence","Starting transaction:",e);const i=new aA(this.Gr.next());return this.referenceDelegate.Zr(),s(i).next(r=>this.referenceDelegate.Xr(i).next(()=>r)).toPromise().then(r=>(i.raiseOnCommittedEvent(),r))}ei(e,n){return Y.or(Object.values(this.Wr).map(s=>()=>s.containsKey(e,n)))}}class aA extends Nb{constructor(e){super(),this.currentSequenceNumber=e}}class Qc{constructor(e){this.persistence=e,this.ti=new Yc,this.ni=null}static ri(e){return new Qc(e)}get ii(){if(this.ni)return this.ni;throw Pe()}addReference(e,n,s){return this.ti.addReference(s,n),this.ii.delete(s.toString()),Y.resolve()}removeReference(e,n,s){return this.ti.removeReference(s,n),this.ii.add(s.toString()),Y.resolve()}markPotentiallyOrphaned(e,n){return this.ii.add(n.toString()),Y.resolve()}removeTarget(e,n){this.ti.Sr(n.targetId).forEach(i=>this.ii.add(i.toString()));const s=this.persistence.getTargetCache();return s.getMatchingKeysForTargetId(e,n.targetId).next(i=>{i.forEach(r=>this.ii.add(r.toString()))}).next(()=>s.removeTargetData(e,n))}Zr(){this.ni=new Set}Xr(e){const n=this.persistence.getRemoteDocumentCache().newChangeBuffer();return Y.forEach(this.ii,s=>{const i=Ae.fromPath(s);return this.si(e,i).next(r=>{r||n.removeEntry(i,De.min())})}).next(()=>(this.ni=null,n.apply(e)))}updateLimboDocument(e,n){return this.si(e,n).next(s=>{s?this.ii.delete(n.toString()):this.ii.add(n.toString())})}Jr(e){return 0}si(e,n){return Y.or([()=>Y.resolve(this.ti.containsKey(n)),()=>this.persistence.getTargetCache().containsKey(e,n),()=>this.persistence.ei(e,n)])}}class jo{constructor(e,n){this.persistence=e,this.oi=new Ys(s=>Fb(s.path),(s,i)=>s.isEqual(i)),this.garbageCollector=Qw(this,n)}static ri(e,n){return new jo(e,n)}Zr(){}Xr(e){return Y.resolve()}forEachTarget(e,n){return this.persistence.getTargetCache().forEachTarget(e,n)}nr(e){const n=this.sr(e);return this.persistence.getTargetCache().getTargetCount(e).next(s=>n.next(i=>s+i))}sr(e){let n=0;return this.rr(e,s=>{n++}).next(()=>n)}rr(e,n){return Y.forEach(this.oi,(s,i)=>this.ar(e,s,i).next(r=>r?Y.resolve():n(i)))}removeTargets(e,n,s){return this.persistence.getTargetCache().removeTargets(e,n,s)}removeOrphanedDocuments(e,n){let s=0;const i=this.persistence.getRemoteDocumentCache(),r=i.newChangeBuffer();return i.qr(e,o=>this.ar(e,o,n).next(l=>{l||(s++,r.removeEntry(o,De.min()))})).next(()=>r.apply(e)).next(()=>s)}markPotentiallyOrphaned(e,n){return this.oi.set(n,e.currentSequenceNumber),Y.resolve()}removeTarget(e,n){const s=n.withSequenceNumber(e.currentSequenceNumber);return this.persistence.getTargetCache().updateTargetData(e,s)}addReference(e,n,s){return this.oi.set(s,e.currentSequenceNumber),Y.resolve()}removeReference(e,n,s){return this.oi.set(s,e.currentSequenceNumber),Y.resolve()}updateLimboDocument(e,n){return this.oi.set(n,e.currentSequenceNumber),Y.resolve()}Jr(e){let n=e.key.toString().length;return e.isFoundDocument()&&(n+=yo(e.data.value)),n}ar(e,n,s){return Y.or([()=>this.persistence.ei(e,n),()=>this.persistence.getTargetCache().containsKey(e,n),()=>{const i=this.oi.get(n);return Y.resolve(i!==void 0&&i>s)}])}getCacheSize(e){return this.persistence.getRemoteDocumentCache().getSize(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Xc{constructor(e,n,s,i){this.targetId=e,this.fromCache=n,this.Hi=s,this.Ji=i}static Yi(e,n){let s=Be(),i=Be();for(const r of n.docChanges)switch(r.type){case 0:s=s.add(r.doc.key);break;case 1:i=i.add(r.doc.key)}return new Xc(e,n.fromCache,s,i)}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lA{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cA{constructor(){this.Zi=!1,this.Xi=!1,this.es=100,this.ts=function(){return L0()?8:xb(V0())>0?6:4}()}initialize(e,n){this.ns=e,this.indexManager=n,this.Zi=!0}getDocumentsMatchingQuery(e,n,s,i){const r={result:null};return this.rs(e,n).next(o=>{r.result=o}).next(()=>{if(!r.result)return this.ss(e,n,i,s).next(o=>{r.result=o})}).next(()=>{if(r.result)return;const o=new lA;return this._s(e,n,o).next(l=>{if(r.result=l,this.Xi)return this.us(e,n,o,l.size)})}).next(()=>r.result)}us(e,n,s,i){return s.documentReadCount<this.es?(li()<=Ke.DEBUG&&Ee("QueryEngine","SDK will not create cache indexes for query:",ci(n),"since it only creates cache indexes for collection contains","more than or equal to",this.es,"documents"),Y.resolve()):(li()<=Ke.DEBUG&&Ee("QueryEngine","Query:",ci(n),"scans",s.documentReadCount,"local documents and returns",i,"documents as results."),s.documentReadCount>this.ts*i?(li()<=Ke.DEBUG&&Ee("QueryEngine","The SDK decides to create cache indexes for query:",ci(n),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,yn(n))):Y.resolve())}rs(e,n){if(Oh(n))return Y.resolve(null);let s=yn(n);return this.indexManager.getIndexType(e,s).next(i=>i===0?null:(n.limit!==null&&i===1&&(n=Bo(n,null,"F"),s=yn(n)),this.indexManager.getDocumentsMatchingTarget(e,s).next(r=>{const o=Be(...r);return this.ns.getDocuments(e,o).next(l=>this.indexManager.getMinOffset(e,s).next(c=>{const u=this.cs(n,l);return this.ls(n,u,o,c.readTime)?this.rs(e,Bo(n,null,"F")):this.hs(e,u,n,c)}))})))}ss(e,n,s,i){return Oh(n)||i.isEqual(De.min())?Y.resolve(null):this.ns.getDocuments(e,s).next(r=>{const o=this.cs(n,r);return this.ls(n,o,s,i)?Y.resolve(null):(li()<=Ke.DEBUG&&Ee("QueryEngine","Re-using previous result from %s to execute query: %s",i.toString(),ci(n)),this.hs(e,o,n,Rb(i,Tr)).next(l=>l))})}cs(e,n){let s=new Et(Hg(e));return n.forEach((i,r)=>{pa(e,r)&&(s=s.add(r))}),s}ls(e,n,s,i){if(e.limit===null)return!1;if(s.size!==n.size)return!0;const r=e.limitType==="F"?n.last():n.first();return!!r&&(r.hasPendingWrites||r.version.compareTo(i)>0)}_s(e,n,s){return li()<=Ke.DEBUG&&Ee("QueryEngine","Using full collection scan to execute query:",ci(n)),this.ns.getDocumentsMatchingQuery(e,n,as.min(),s)}hs(e,n,s,i){return this.ns.getDocumentsMatchingQuery(e,s,i).next(r=>(n.forEach(o=>{r=r.insert(o.key,o)}),r))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Jc="LocalStore",uA=3e8;class dA{constructor(e,n,s,i){this.persistence=e,this.Ps=n,this.serializer=i,this.Ts=new at(He),this.Is=new Ys(r=>Uc(r),Hc),this.Es=new Map,this.ds=e.getRemoteDocumentCache(),this.Hr=e.getTargetCache(),this.Yr=e.getBundleCache(),this.As(s)}As(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new Zw(this.ds,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.ds.setIndexManager(this.indexManager),this.Ps.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",n=>e.collect(n,this.Ts))}}function hA(t,e,n,s){return new dA(t,e,n,s)}async function dm(t,e){const n=Me(t);return await n.persistence.runTransaction("Handle user change","readonly",s=>{let i;return n.mutationQueue.getAllMutationBatches(s).next(r=>(i=r,n.As(e),n.mutationQueue.getAllMutationBatches(s))).next(r=>{const o=[],l=[];let c=Be();for(const u of i){o.push(u.batchId);for(const h of u.mutations)c=c.add(h.key)}for(const u of r){l.push(u.batchId);for(const h of u.mutations)c=c.add(h.key)}return n.localDocuments.getDocuments(s,c).next(u=>({Rs:u,removedBatchIds:o,addedBatchIds:l}))})})}function fA(t,e){const n=Me(t);return n.persistence.runTransaction("Acknowledge batch","readwrite-primary",s=>{const i=e.batch.keys(),r=n.ds.newChangeBuffer({trackRemovals:!0});return function(l,c,u,h){const f=u.batch,m=f.keys();let y=Y.resolve();return m.forEach(C=>{y=y.next(()=>h.getEntry(c,C)).next(D=>{const S=u.docVersions.get(C);Qe(S!==null),D.version.compareTo(S)<0&&(f.applyToRemoteDocument(D,u),D.isValidDocument()&&(D.setReadTime(u.commitVersion),h.addEntry(D)))})}),y.next(()=>l.mutationQueue.removeMutationBatch(c,f))}(n,s,e,r).next(()=>r.apply(s)).next(()=>n.mutationQueue.performConsistencyCheck(s)).next(()=>n.documentOverlayCache.removeOverlaysForBatchId(s,i,e.batch.batchId)).next(()=>n.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(s,function(l){let c=Be();for(let u=0;u<l.mutationResults.length;++u)l.mutationResults[u].transformResults.length>0&&(c=c.add(l.batch.mutations[u].key));return c}(e))).next(()=>n.localDocuments.getDocuments(s,i))})}function hm(t){const e=Me(t);return e.persistence.runTransaction("Get last remote snapshot version","readonly",n=>e.Hr.getLastRemoteSnapshotVersion(n))}function pA(t,e){const n=Me(t),s=e.snapshotVersion;let i=n.Ts;return n.persistence.runTransaction("Apply remote event","readwrite-primary",r=>{const o=n.ds.newChangeBuffer({trackRemovals:!0});i=n.Ts;const l=[];e.targetChanges.forEach((h,f)=>{const m=i.get(f);if(!m)return;l.push(n.Hr.removeMatchingKeys(r,h.removedDocuments,f).next(()=>n.Hr.addMatchingKeys(r,h.addedDocuments,f)));let y=m.withSequenceNumber(r.currentSequenceNumber);e.targetMismatches.get(f)!==null?y=y.withResumeToken(wt.EMPTY_BYTE_STRING,De.min()).withLastLimboFreeSnapshotVersion(De.min()):h.resumeToken.approximateByteSize()>0&&(y=y.withResumeToken(h.resumeToken,s)),i=i.insert(f,y),function(D,S,M){return D.resumeToken.approximateByteSize()===0||S.snapshotVersion.toMicroseconds()-D.snapshotVersion.toMicroseconds()>=uA?!0:M.addedDocuments.size+M.modifiedDocuments.size+M.removedDocuments.size>0}(m,y,h)&&l.push(n.Hr.updateTargetData(r,y))});let c=Vn(),u=Be();if(e.documentUpdates.forEach(h=>{e.resolvedLimboDocuments.has(h)&&l.push(n.persistence.referenceDelegate.updateLimboDocument(r,h))}),l.push(gA(r,o,e.documentUpdates).next(h=>{c=h.Vs,u=h.fs})),!s.isEqual(De.min())){const h=n.Hr.getLastRemoteSnapshotVersion(r).next(f=>n.Hr.setTargetsMetadata(r,r.currentSequenceNumber,s));l.push(h)}return Y.waitFor(l).next(()=>o.apply(r)).next(()=>n.localDocuments.getLocalViewOfDocuments(r,c,u)).next(()=>c)}).then(r=>(n.Ts=i,r))}function gA(t,e,n){let s=Be(),i=Be();return n.forEach(r=>s=s.add(r)),e.getEntries(t,s).next(r=>{let o=Vn();return n.forEach((l,c)=>{const u=r.get(l);c.isFoundDocument()!==u.isFoundDocument()&&(i=i.add(l)),c.isNoDocument()&&c.version.isEqual(De.min())?(e.removeEntry(l,c.readTime),o=o.insert(l,c)):!u.isValidDocument()||c.version.compareTo(u.version)>0||c.version.compareTo(u.version)===0&&u.hasPendingWrites?(e.addEntry(c),o=o.insert(l,c)):Ee(Jc,"Ignoring outdated watch update for ",l,". Current version:",u.version," Watch version:",c.version)}),{Vs:o,fs:i}})}function mA(t,e){const n=Me(t);return n.persistence.runTransaction("Get next mutation batch","readonly",s=>(e===void 0&&(e=$c),n.mutationQueue.getNextMutationBatchAfterBatchId(s,e)))}function vA(t,e){const n=Me(t);return n.persistence.runTransaction("Allocate target","readwrite",s=>{let i;return n.Hr.getTargetData(s,e).next(r=>r?(i=r,Y.resolve(i)):n.Hr.allocateTargetId(s).next(o=>(i=new Yn(e,o,"TargetPurposeListen",s.currentSequenceNumber),n.Hr.addTargetData(s,i).next(()=>i))))}).then(s=>{const i=n.Ts.get(s.targetId);return(i===null||s.snapshotVersion.compareTo(i.snapshotVersion)>0)&&(n.Ts=n.Ts.insert(s.targetId,s),n.Is.set(e,s.targetId)),s})}async function Zl(t,e,n){const s=Me(t),i=s.Ts.get(e),r=n?"readwrite":"readwrite-primary";try{n||await s.persistence.runTransaction("Release target",r,o=>s.persistence.referenceDelegate.removeTarget(o,i))}catch(o){if(!Ci(o))throw o;Ee(Jc,`Failed to update sequence numbers for target ${e}: ${o}`)}s.Ts=s.Ts.remove(e),s.Is.delete(i.target)}function Gh(t,e,n){const s=Me(t);let i=De.min(),r=Be();return s.persistence.runTransaction("Execute query","readwrite",o=>function(c,u,h){const f=Me(c),m=f.Is.get(h);return m!==void 0?Y.resolve(f.Ts.get(m)):f.Hr.getTargetData(u,h)}(s,o,yn(e)).next(l=>{if(l)return i=l.lastLimboFreeSnapshotVersion,s.Hr.getMatchingKeysForTargetId(o,l.targetId).next(c=>{r=c})}).next(()=>s.Ps.getDocumentsMatchingQuery(o,e,n?i:De.min(),n?r:Be())).next(l=>(yA(s,nw(e),l),{documents:l,gs:r})))}function yA(t,e,n){let s=t.Es.get(e)||De.min();n.forEach((i,r)=>{r.readTime.compareTo(s)>0&&(s=r.readTime)}),t.Es.set(e,s)}class Wh{constructor(){this.activeTargetIds=lw()}Ds(e){this.activeTargetIds=this.activeTargetIds.add(e)}vs(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Ss(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class _A{constructor(){this.ho=new Wh,this.Po={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,n,s){}addLocalQueryTarget(e,n=!0){return n&&this.ho.Ds(e),this.Po[e]||"not-current"}updateQueryState(e,n,s){this.Po[e]=n}removeLocalQueryTarget(e){this.ho.vs(e)}isLocalQueryTarget(e){return this.ho.activeTargetIds.has(e)}clearQueryState(e){delete this.Po[e]}getAllActiveQueryTargets(){return this.ho.activeTargetIds}isActiveQueryTarget(e){return this.ho.activeTargetIds.has(e)}start(){return this.ho=new Wh,Promise.resolve()}handleUserChange(e,n,s){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class EA{To(e){}shutdown(){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const zh="ConnectivityMonitor";class Yh{constructor(){this.Io=()=>this.Eo(),this.Ao=()=>this.Ro(),this.Vo=[],this.mo()}To(e){this.Vo.push(e)}shutdown(){window.removeEventListener("online",this.Io),window.removeEventListener("offline",this.Ao)}mo(){window.addEventListener("online",this.Io),window.addEventListener("offline",this.Ao)}Eo(){Ee(zh,"Network connectivity changed: AVAILABLE");for(const e of this.Vo)e(0)}Ro(){Ee(zh,"Network connectivity changed: UNAVAILABLE");for(const e of this.Vo)e(1)}static D(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let co=null;function ec(){return co===null?co=function(){return 268435456+Math.round(2147483648*Math.random())}():co++,"0x"+co.toString(16)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const vl="RestConnection",TA={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};class bA{get fo(){return!1}constructor(e){this.databaseInfo=e,this.databaseId=e.databaseId;const n=e.ssl?"https":"http",s=encodeURIComponent(this.databaseId.projectId),i=encodeURIComponent(this.databaseId.database);this.po=n+"://"+e.host,this.yo=`projects/${s}/databases/${i}`,this.wo=this.databaseId.database===Fo?`project_id=${s}`:`project_id=${s}&database_id=${i}`}bo(e,n,s,i,r){const o=ec(),l=this.So(e,n.toUriEncodedString());Ee(vl,`Sending RPC '${e}' ${o}:`,l,s);const c={"google-cloud-resource-prefix":this.yo,"x-goog-request-params":this.wo};return this.Do(c,i,r),this.vo(e,l,c,s).then(u=>(Ee(vl,`Received RPC '${e}' ${o}: `,u),u),u=>{throw js(vl,`RPC '${e}' ${o} failed with error: `,u,"url: ",l,"request:",s),u})}Co(e,n,s,i,r,o){return this.bo(e,n,s,i,r)}Do(e,n,s){e["X-Goog-Api-Client"]=function(){return"gl-js/ fire/"+Ii}(),e["Content-Type"]="text/plain",this.databaseInfo.appId&&(e["X-Firebase-GMPID"]=this.databaseInfo.appId),n&&n.headers.forEach((i,r)=>e[r]=i),s&&s.headers.forEach((i,r)=>e[r]=i)}So(e,n){const s=TA[e];return`${this.po}/v1/${n}:${s}`}terminate(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wA{constructor(e){this.Fo=e.Fo,this.Mo=e.Mo}xo(e){this.Oo=e}No(e){this.Bo=e}Lo(e){this.ko=e}onMessage(e){this.qo=e}close(){this.Mo()}send(e){this.Fo(e)}Qo(){this.Oo()}$o(){this.Bo()}Ko(e){this.ko(e)}Uo(e){this.qo(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Dt="WebChannelConnection";class AA extends bA{constructor(e){super(e),this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}vo(e,n,s,i){const r=ec();return new Promise((o,l)=>{const c=new vg;c.setWithCredentials(!0),c.listenOnce(yg.COMPLETE,()=>{try{switch(c.getLastErrorCode()){case vo.NO_ERROR:const h=c.getResponseJson();Ee(Dt,`XHR for RPC '${e}' ${r} received:`,JSON.stringify(h)),o(h);break;case vo.TIMEOUT:Ee(Dt,`RPC '${e}' ${r} timed out`),l(new _e(z.DEADLINE_EXCEEDED,"Request time out"));break;case vo.HTTP_ERROR:const f=c.getStatus();if(Ee(Dt,`RPC '${e}' ${r} failed with status:`,f,"response text:",c.getResponseText()),f>0){let m=c.getResponseJson();Array.isArray(m)&&(m=m[0]);const y=m==null?void 0:m.error;if(y&&y.status&&y.message){const C=function(S){const M=S.toLowerCase().replace(/_/g,"-");return Object.values(z).indexOf(M)>=0?M:z.UNKNOWN}(y.status);l(new _e(C,y.message))}else l(new _e(z.UNKNOWN,"Server responded with status "+c.getStatus()))}else l(new _e(z.UNAVAILABLE,"Connection failed."));break;default:Pe()}}finally{Ee(Dt,`RPC '${e}' ${r} completed.`)}});const u=JSON.stringify(i);Ee(Dt,`RPC '${e}' ${r} sending request:`,i),c.send(n,"POST",u,s,15)})}Wo(e,n,s){const i=ec(),r=[this.po,"/","google.firestore.v1.Firestore","/",e,"/channel"],o=Tg(),l=Eg(),c={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},u=this.longPollingOptions.timeoutSeconds;u!==void 0&&(c.longPollingTimeout=Math.round(1e3*u)),this.useFetchStreams&&(c.useFetchStreams=!0),this.Do(c.initMessageHeaders,n,s),c.encodeInitMessageHeaders=!0;const h=r.join("");Ee(Dt,`Creating RPC '${e}' stream ${i}: ${h}`,c);const f=o.createWebChannel(h,c);let m=!1,y=!1;const C=new wA({Fo:S=>{y?Ee(Dt,`Not sending because RPC '${e}' stream ${i} is closed:`,S):(m||(Ee(Dt,`Opening RPC '${e}' stream ${i} transport.`),f.open(),m=!0),Ee(Dt,`RPC '${e}' stream ${i} sending:`,S),f.send(S))},Mo:()=>f.close()}),D=(S,M,P)=>{S.listen(M,V=>{try{P(V)}catch(R){setTimeout(()=>{throw R},0)}})};return D(f,Wi.EventType.OPEN,()=>{y||(Ee(Dt,`RPC '${e}' stream ${i} transport opened.`),C.Qo())}),D(f,Wi.EventType.CLOSE,()=>{y||(y=!0,Ee(Dt,`RPC '${e}' stream ${i} transport closed`),C.Ko())}),D(f,Wi.EventType.ERROR,S=>{y||(y=!0,js(Dt,`RPC '${e}' stream ${i} transport errored:`,S),C.Ko(new _e(z.UNAVAILABLE,"The operation could not be completed")))}),D(f,Wi.EventType.MESSAGE,S=>{var M;if(!y){const P=S.data[0];Qe(!!P);const V=P,R=(V==null?void 0:V.error)||((M=V[0])===null||M===void 0?void 0:M.error);if(R){Ee(Dt,`RPC '${e}' stream ${i} received error:`,R);const H=R.status;let O=function(v){const _=gt[v];if(_!==void 0)return Zg(_)}(H),I=R.message;O===void 0&&(O=z.INTERNAL,I="Unknown error status: "+H+" with message "+R.message),y=!0,C.Ko(new _e(O,I)),f.close()}else Ee(Dt,`RPC '${e}' stream ${i} received:`,P),C.Uo(P)}}),D(l,_g.STAT_EVENT,S=>{S.stat===jl.PROXY?Ee(Dt,`RPC '${e}' stream ${i} detected buffering proxy`):S.stat===jl.NOPROXY&&Ee(Dt,`RPC '${e}' stream ${i} detected no buffering proxy`)}),setTimeout(()=>{C.$o()},0),C}}function yl(){return typeof document<"u"?document:null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ya(t){return new kw(t,!0)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fm{constructor(e,n,s=1e3,i=1.5,r=6e4){this.Ti=e,this.timerId=n,this.Go=s,this.zo=i,this.jo=r,this.Ho=0,this.Jo=null,this.Yo=Date.now(),this.reset()}reset(){this.Ho=0}Zo(){this.Ho=this.jo}Xo(e){this.cancel();const n=Math.floor(this.Ho+this.e_()),s=Math.max(0,Date.now()-this.Yo),i=Math.max(0,n-s);i>0&&Ee("ExponentialBackoff",`Backing off for ${i} ms (base delay: ${this.Ho} ms, delay with jitter: ${n} ms, last attempt: ${s} ms ago)`),this.Jo=this.Ti.enqueueAfterDelay(this.timerId,i,()=>(this.Yo=Date.now(),e())),this.Ho*=this.zo,this.Ho<this.Go&&(this.Ho=this.Go),this.Ho>this.jo&&(this.Ho=this.jo)}t_(){this.Jo!==null&&(this.Jo.skipDelay(),this.Jo=null)}cancel(){this.Jo!==null&&(this.Jo.cancel(),this.Jo=null)}e_(){return(Math.random()-.5)*this.Ho}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Qh="PersistentStream";class pm{constructor(e,n,s,i,r,o,l,c){this.Ti=e,this.n_=s,this.r_=i,this.connection=r,this.authCredentialsProvider=o,this.appCheckCredentialsProvider=l,this.listener=c,this.state=0,this.i_=0,this.s_=null,this.o_=null,this.stream=null,this.__=0,this.a_=new fm(e,n)}u_(){return this.state===1||this.state===5||this.c_()}c_(){return this.state===2||this.state===3}start(){this.__=0,this.state!==4?this.auth():this.l_()}async stop(){this.u_()&&await this.close(0)}h_(){this.state=0,this.a_.reset()}P_(){this.c_()&&this.s_===null&&(this.s_=this.Ti.enqueueAfterDelay(this.n_,6e4,()=>this.T_()))}I_(e){this.E_(),this.stream.send(e)}async T_(){if(this.c_())return this.close(0)}E_(){this.s_&&(this.s_.cancel(),this.s_=null)}d_(){this.o_&&(this.o_.cancel(),this.o_=null)}async close(e,n){this.E_(),this.d_(),this.a_.cancel(),this.i_++,e!==4?this.a_.reset():n&&n.code===z.RESOURCE_EXHAUSTED?(xn(n.toString()),xn("Using maximum backoff delay to prevent overloading the backend."),this.a_.Zo()):n&&n.code===z.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.A_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.Lo(n)}A_(){}auth(){this.state=1;const e=this.R_(this.i_),n=this.i_;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([s,i])=>{this.i_===n&&this.V_(s,i)},s=>{e(()=>{const i=new _e(z.UNKNOWN,"Fetching auth token failed: "+s.message);return this.m_(i)})})}V_(e,n){const s=this.R_(this.i_);this.stream=this.f_(e,n),this.stream.xo(()=>{s(()=>this.listener.xo())}),this.stream.No(()=>{s(()=>(this.state=2,this.o_=this.Ti.enqueueAfterDelay(this.r_,1e4,()=>(this.c_()&&(this.state=3),Promise.resolve())),this.listener.No()))}),this.stream.Lo(i=>{s(()=>this.m_(i))}),this.stream.onMessage(i=>{s(()=>++this.__==1?this.g_(i):this.onNext(i))})}l_(){this.state=5,this.a_.Xo(async()=>{this.state=0,this.start()})}m_(e){return Ee(Qh,`close with error: ${e}`),this.stream=null,this.close(4,e)}R_(e){return n=>{this.Ti.enqueueAndForget(()=>this.i_===e?n():(Ee(Qh,"stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}}class IA extends pm{constructor(e,n,s,i,r,o){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",n,s,i,o),this.serializer=r}f_(e,n){return this.connection.Wo("Listen",e,n)}g_(e){return this.onNext(e)}onNext(e){this.a_.reset();const n=Dw(this.serializer,e),s=function(r){if(!("targetChange"in r))return De.min();const o=r.targetChange;return o.targetIds&&o.targetIds.length?De.min():o.readTime?En(o.readTime):De.min()}(e);return this.listener.p_(n,s)}y_(e){const n={};n.database=Jl(this.serializer),n.addTarget=function(r,o){let l;const c=o.target;if(l=Wl(c)?{documents:Nw(r,c)}:{query:xw(r,c).ht},l.targetId=o.targetId,o.resumeToken.approximateByteSize()>0){l.resumeToken=nm(r,o.resumeToken);const u=Yl(r,o.expectedCount);u!==null&&(l.expectedCount=u)}else if(o.snapshotVersion.compareTo(De.min())>0){l.readTime=Ho(r,o.snapshotVersion.toTimestamp());const u=Yl(r,o.expectedCount);u!==null&&(l.expectedCount=u)}return l}(this.serializer,e);const s=Fw(this.serializer,e);s&&(n.labels=s),this.I_(n)}w_(e){const n={};n.database=Jl(this.serializer),n.removeTarget=e,this.I_(n)}}class SA extends pm{constructor(e,n,s,i,r,o){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",n,s,i,o),this.serializer=r}get b_(){return this.__>0}start(){this.lastStreamToken=void 0,super.start()}A_(){this.b_&&this.S_([])}f_(e,n){return this.connection.Wo("Write",e,n)}g_(e){return Qe(!!e.streamToken),this.lastStreamToken=e.streamToken,Qe(!e.writeResults||e.writeResults.length===0),this.listener.D_()}onNext(e){Qe(!!e.streamToken),this.lastStreamToken=e.streamToken,this.a_.reset();const n=Ow(e.writeResults,e.commitTime),s=En(e.commitTime);return this.listener.v_(s,n)}C_(){const e={};e.database=Jl(this.serializer),this.I_(e)}S_(e){const n={streamToken:this.lastStreamToken,writes:e.map(s=>Mw(this.serializer,s))};this.I_(n)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class CA{}class kA extends CA{constructor(e,n,s,i){super(),this.authCredentials=e,this.appCheckCredentials=n,this.connection=s,this.serializer=i,this.F_=!1}M_(){if(this.F_)throw new _e(z.FAILED_PRECONDITION,"The client has already been terminated.")}bo(e,n,s,i){return this.M_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([r,o])=>this.connection.bo(e,Ql(n,s),i,r,o)).catch(r=>{throw r.name==="FirebaseError"?(r.code===z.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),r):new _e(z.UNKNOWN,r.toString())})}Co(e,n,s,i,r){return this.M_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([o,l])=>this.connection.Co(e,Ql(n,s),i,o,l,r)).catch(o=>{throw o.name==="FirebaseError"?(o.code===z.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),o):new _e(z.UNKNOWN,o.toString())})}terminate(){this.F_=!0,this.connection.terminate()}}class PA{constructor(e,n){this.asyncQueue=e,this.onlineStateHandler=n,this.state="Unknown",this.x_=0,this.O_=null,this.N_=!0}B_(){this.x_===0&&(this.L_("Unknown"),this.O_=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this.O_=null,this.k_("Backend didn't respond within 10 seconds."),this.L_("Offline"),Promise.resolve())))}q_(e){this.state==="Online"?this.L_("Unknown"):(this.x_++,this.x_>=1&&(this.Q_(),this.k_(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.L_("Offline")))}set(e){this.Q_(),this.x_=0,e==="Online"&&(this.N_=!1),this.L_(e)}L_(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}k_(e){const n=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.N_?(xn(n),this.N_=!1):Ee("OnlineStateTracker",n)}Q_(){this.O_!==null&&(this.O_.cancel(),this.O_=null)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ks="RemoteStore";class RA{constructor(e,n,s,i,r){this.localStore=e,this.datastore=n,this.asyncQueue=s,this.remoteSyncer={},this.K_=[],this.U_=new Map,this.W_=new Set,this.G_=[],this.z_=r,this.z_.To(o=>{s.enqueueAndForget(async()=>{Xs(this)&&(Ee(Ks,"Restarting streams for network reachability change."),await async function(c){const u=Me(c);u.W_.add(4),await xr(u),u.j_.set("Unknown"),u.W_.delete(4),await _a(u)}(this))})}),this.j_=new PA(s,i)}}async function _a(t){if(Xs(t))for(const e of t.G_)await e(!0)}async function xr(t){for(const e of t.G_)await e(!1)}function gm(t,e){const n=Me(t);n.U_.has(e.targetId)||(n.U_.set(e.targetId,e),nu(n)?tu(n):Pi(n).c_()&&eu(n,e))}function Zc(t,e){const n=Me(t),s=Pi(n);n.U_.delete(e),s.c_()&&mm(n,e),n.U_.size===0&&(s.c_()?s.P_():Xs(n)&&n.j_.set("Unknown"))}function eu(t,e){if(t.H_.Ne(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(De.min())>0){const n=t.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(n)}Pi(t).y_(e)}function mm(t,e){t.H_.Ne(e),Pi(t).w_(e)}function tu(t){t.H_=new Aw({getRemoteKeysForTarget:e=>t.remoteSyncer.getRemoteKeysForTarget(e),lt:e=>t.U_.get(e)||null,it:()=>t.datastore.serializer.databaseId}),Pi(t).start(),t.j_.B_()}function nu(t){return Xs(t)&&!Pi(t).u_()&&t.U_.size>0}function Xs(t){return Me(t).W_.size===0}function vm(t){t.H_=void 0}async function DA(t){t.j_.set("Online")}async function MA(t){t.U_.forEach((e,n)=>{eu(t,e)})}async function OA(t,e){vm(t),nu(t)?(t.j_.q_(e),tu(t)):t.j_.set("Unknown")}async function NA(t,e,n){if(t.j_.set("Online"),e instanceof tm&&e.state===2&&e.cause)try{await async function(i,r){const o=r.cause;for(const l of r.targetIds)i.U_.has(l)&&(await i.remoteSyncer.rejectListen(l,o),i.U_.delete(l),i.H_.removeTarget(l))}(t,e)}catch(s){Ee(Ks,"Failed to remove targets %s: %s ",e.targetIds.join(","),s),await Ko(t,s)}else if(e instanceof To?t.H_.We(e):e instanceof em?t.H_.Ze(e):t.H_.je(e),!n.isEqual(De.min()))try{const s=await hm(t.localStore);n.compareTo(s)>=0&&await function(r,o){const l=r.H_.ot(o);return l.targetChanges.forEach((c,u)=>{if(c.resumeToken.approximateByteSize()>0){const h=r.U_.get(u);h&&r.U_.set(u,h.withResumeToken(c.resumeToken,o))}}),l.targetMismatches.forEach((c,u)=>{const h=r.U_.get(c);if(!h)return;r.U_.set(c,h.withResumeToken(wt.EMPTY_BYTE_STRING,h.snapshotVersion)),mm(r,c);const f=new Yn(h.target,c,u,h.sequenceNumber);eu(r,f)}),r.remoteSyncer.applyRemoteEvent(l)}(t,n)}catch(s){Ee(Ks,"Failed to raise snapshot:",s),await Ko(t,s)}}async function Ko(t,e,n){if(!Ci(e))throw e;t.W_.add(1),await xr(t),t.j_.set("Offline"),n||(n=()=>hm(t.localStore)),t.asyncQueue.enqueueRetryable(async()=>{Ee(Ks,"Retrying IndexedDB access"),await n(),t.W_.delete(1),await _a(t)})}function ym(t,e){return e().catch(n=>Ko(t,n,e))}async function Ea(t){const e=Me(t),n=ds(e);let s=e.K_.length>0?e.K_[e.K_.length-1].batchId:$c;for(;xA(e);)try{const i=await mA(e.localStore,s);if(i===null){e.K_.length===0&&n.P_();break}s=i.batchId,VA(e,i)}catch(i){await Ko(e,i)}_m(e)&&Em(e)}function xA(t){return Xs(t)&&t.K_.length<10}function VA(t,e){t.K_.push(e);const n=ds(t);n.c_()&&n.b_&&n.S_(e.mutations)}function _m(t){return Xs(t)&&!ds(t).u_()&&t.K_.length>0}function Em(t){ds(t).start()}async function FA(t){ds(t).C_()}async function $A(t){const e=ds(t);for(const n of t.K_)e.S_(n.mutations)}async function LA(t,e,n){const s=t.K_.shift(),i=Gc.from(s,e,n);await ym(t,()=>t.remoteSyncer.applySuccessfulWrite(i)),await Ea(t)}async function BA(t,e){e&&ds(t).b_&&await async function(s,i){if(function(o){return Tw(o)&&o!==z.ABORTED}(i.code)){const r=s.K_.shift();ds(s).h_(),await ym(s,()=>s.remoteSyncer.rejectFailedWrite(r.batchId,i)),await Ea(s)}}(t,e),_m(t)&&Em(t)}async function Xh(t,e){const n=Me(t);n.asyncQueue.verifyOperationInProgress(),Ee(Ks,"RemoteStore received new credentials");const s=Xs(n);n.W_.add(3),await xr(n),s&&n.j_.set("Unknown"),await n.remoteSyncer.handleCredentialChange(e),n.W_.delete(3),await _a(n)}async function UA(t,e){const n=Me(t);e?(n.W_.delete(2),await _a(n)):e||(n.W_.add(2),await xr(n),n.j_.set("Unknown"))}function Pi(t){return t.J_||(t.J_=function(n,s,i){const r=Me(n);return r.M_(),new IA(s,r.connection,r.authCredentials,r.appCheckCredentials,r.serializer,i)}(t.datastore,t.asyncQueue,{xo:DA.bind(null,t),No:MA.bind(null,t),Lo:OA.bind(null,t),p_:NA.bind(null,t)}),t.G_.push(async e=>{e?(t.J_.h_(),nu(t)?tu(t):t.j_.set("Unknown")):(await t.J_.stop(),vm(t))})),t.J_}function ds(t){return t.Y_||(t.Y_=function(n,s,i){const r=Me(n);return r.M_(),new SA(s,r.connection,r.authCredentials,r.appCheckCredentials,r.serializer,i)}(t.datastore,t.asyncQueue,{xo:()=>Promise.resolve(),No:FA.bind(null,t),Lo:BA.bind(null,t),D_:$A.bind(null,t),v_:LA.bind(null,t)}),t.G_.push(async e=>{e?(t.Y_.h_(),await Ea(t)):(await t.Y_.stop(),t.K_.length>0&&(Ee(Ks,`Stopping write stream with ${t.K_.length} pending writes`),t.K_=[]))})),t.Y_}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class su{constructor(e,n,s,i,r){this.asyncQueue=e,this.timerId=n,this.targetTimeMs=s,this.op=i,this.removalCallback=r,this.deferred=new Dn,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(o=>{})}get promise(){return this.deferred.promise}static createAndSchedule(e,n,s,i,r){const o=Date.now()+s,l=new su(e,n,o,i,r);return l.start(s),l}start(e){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new _e(z.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then(e=>this.deferred.resolve(e))):Promise.resolve())}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function iu(t,e){if(xn("AsyncQueue",`${e}: ${t}`),Ci(t))return new _e(z.UNAVAILABLE,`${e}: ${t}`);throw t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mi{static emptySet(e){return new mi(e.comparator)}constructor(e){this.comparator=e?(n,s)=>e(n,s)||Ae.comparator(n.key,s.key):(n,s)=>Ae.comparator(n.key,s.key),this.keyedMap=zi(),this.sortedSet=new at(this.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const n=this.keyedMap.get(e);return n?this.sortedSet.indexOf(n):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal((n,s)=>(e(n),!1))}add(e){const n=this.delete(e.key);return n.copy(n.keyedMap.insert(e.key,e),n.sortedSet.insert(e,null))}delete(e){const n=this.get(e);return n?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(n)):this}isEqual(e){if(!(e instanceof mi)||this.size!==e.size)return!1;const n=this.sortedSet.getIterator(),s=e.sortedSet.getIterator();for(;n.hasNext();){const i=n.getNext().key,r=s.getNext().key;if(!i.isEqual(r))return!1}return!0}toString(){const e=[];return this.forEach(n=>{e.push(n.toString())}),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,n){const s=new mi;return s.comparator=this.comparator,s.keyedMap=e,s.sortedSet=n,s}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Jh{constructor(){this.Z_=new at(Ae.comparator)}track(e){const n=e.doc.key,s=this.Z_.get(n);s?e.type!==0&&s.type===3?this.Z_=this.Z_.insert(n,e):e.type===3&&s.type!==1?this.Z_=this.Z_.insert(n,{type:s.type,doc:e.doc}):e.type===2&&s.type===2?this.Z_=this.Z_.insert(n,{type:2,doc:e.doc}):e.type===2&&s.type===0?this.Z_=this.Z_.insert(n,{type:0,doc:e.doc}):e.type===1&&s.type===0?this.Z_=this.Z_.remove(n):e.type===1&&s.type===2?this.Z_=this.Z_.insert(n,{type:1,doc:s.doc}):e.type===0&&s.type===1?this.Z_=this.Z_.insert(n,{type:2,doc:e.doc}):Pe():this.Z_=this.Z_.insert(n,e)}X_(){const e=[];return this.Z_.inorderTraversal((n,s)=>{e.push(s)}),e}}class wi{constructor(e,n,s,i,r,o,l,c,u){this.query=e,this.docs=n,this.oldDocs=s,this.docChanges=i,this.mutatedKeys=r,this.fromCache=o,this.syncStateChanged=l,this.excludesMetadataChanges=c,this.hasCachedResults=u}static fromInitialDocuments(e,n,s,i,r){const o=[];return n.forEach(l=>{o.push({type:0,doc:l})}),new wi(e,n,mi.emptySet(n),o,s,i,!0,!1,r)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&fa(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const n=this.docChanges,s=e.docChanges;if(n.length!==s.length)return!1;for(let i=0;i<n.length;i++)if(n[i].type!==s[i].type||!n[i].doc.isEqual(s[i].doc))return!1;return!0}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class HA{constructor(){this.ea=void 0,this.ta=[]}na(){return this.ta.some(e=>e.ra())}}class jA{constructor(){this.queries=Zh(),this.onlineState="Unknown",this.ia=new Set}terminate(){(function(n,s){const i=Me(n),r=i.queries;i.queries=Zh(),r.forEach((o,l)=>{for(const c of l.ta)c.onError(s)})})(this,new _e(z.ABORTED,"Firestore shutting down"))}}function Zh(){return new Ys(t=>Ug(t),fa)}async function Tm(t,e){const n=Me(t);let s=3;const i=e.query;let r=n.queries.get(i);r?!r.na()&&e.ra()&&(s=2):(r=new HA,s=e.ra()?0:1);try{switch(s){case 0:r.ea=await n.onListen(i,!0);break;case 1:r.ea=await n.onListen(i,!1);break;case 2:await n.onFirstRemoteStoreListen(i)}}catch(o){const l=iu(o,`Initialization of query '${ci(e.query)}' failed`);return void e.onError(l)}n.queries.set(i,r),r.ta.push(e),e.sa(n.onlineState),r.ea&&e.oa(r.ea)&&ru(n)}async function bm(t,e){const n=Me(t),s=e.query;let i=3;const r=n.queries.get(s);if(r){const o=r.ta.indexOf(e);o>=0&&(r.ta.splice(o,1),r.ta.length===0?i=e.ra()?0:1:!r.na()&&e.ra()&&(i=2))}switch(i){case 0:return n.queries.delete(s),n.onUnlisten(s,!0);case 1:return n.queries.delete(s),n.onUnlisten(s,!1);case 2:return n.onLastRemoteStoreUnlisten(s);default:return}}function KA(t,e){const n=Me(t);let s=!1;for(const i of e){const r=i.query,o=n.queries.get(r);if(o){for(const l of o.ta)l.oa(i)&&(s=!0);o.ea=i}}s&&ru(n)}function qA(t,e,n){const s=Me(t),i=s.queries.get(e);if(i)for(const r of i.ta)r.onError(n);s.queries.delete(e)}function ru(t){t.ia.forEach(e=>{e.next()})}var tc,ef;(ef=tc||(tc={}))._a="default",ef.Cache="cache";class wm{constructor(e,n,s){this.query=e,this.aa=n,this.ua=!1,this.ca=null,this.onlineState="Unknown",this.options=s||{}}oa(e){if(!this.options.includeMetadataChanges){const s=[];for(const i of e.docChanges)i.type!==3&&s.push(i);e=new wi(e.query,e.docs,e.oldDocs,s,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let n=!1;return this.ua?this.la(e)&&(this.aa.next(e),n=!0):this.ha(e,this.onlineState)&&(this.Pa(e),n=!0),this.ca=e,n}onError(e){this.aa.error(e)}sa(e){this.onlineState=e;let n=!1;return this.ca&&!this.ua&&this.ha(this.ca,e)&&(this.Pa(this.ca),n=!0),n}ha(e,n){if(!e.fromCache||!this.ra())return!0;const s=n!=="Offline";return(!this.options.Ta||!s)&&(!e.docs.isEmpty()||e.hasCachedResults||n==="Offline")}la(e){if(e.docChanges.length>0)return!0;const n=this.ca&&this.ca.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!n)&&this.options.includeMetadataChanges===!0}Pa(e){e=wi.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.ua=!0,this.aa.next(e)}ra(){return this.options.source!==tc.Cache}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Am{constructor(e){this.key=e}}class Im{constructor(e){this.key=e}}class GA{constructor(e,n){this.query=e,this.fa=n,this.ga=null,this.hasCachedResults=!1,this.current=!1,this.pa=Be(),this.mutatedKeys=Be(),this.ya=Hg(e),this.wa=new mi(this.ya)}get ba(){return this.fa}Sa(e,n){const s=n?n.Da:new Jh,i=n?n.wa:this.wa;let r=n?n.mutatedKeys:this.mutatedKeys,o=i,l=!1;const c=this.query.limitType==="F"&&i.size===this.query.limit?i.last():null,u=this.query.limitType==="L"&&i.size===this.query.limit?i.first():null;if(e.inorderTraversal((h,f)=>{const m=i.get(h),y=pa(this.query,f)?f:null,C=!!m&&this.mutatedKeys.has(m.key),D=!!y&&(y.hasLocalMutations||this.mutatedKeys.has(y.key)&&y.hasCommittedMutations);let S=!1;m&&y?m.data.isEqual(y.data)?C!==D&&(s.track({type:3,doc:y}),S=!0):this.va(m,y)||(s.track({type:2,doc:y}),S=!0,(c&&this.ya(y,c)>0||u&&this.ya(y,u)<0)&&(l=!0)):!m&&y?(s.track({type:0,doc:y}),S=!0):m&&!y&&(s.track({type:1,doc:m}),S=!0,(c||u)&&(l=!0)),S&&(y?(o=o.add(y),r=D?r.add(h):r.delete(h)):(o=o.delete(h),r=r.delete(h)))}),this.query.limit!==null)for(;o.size>this.query.limit;){const h=this.query.limitType==="F"?o.last():o.first();o=o.delete(h.key),r=r.delete(h.key),s.track({type:1,doc:h})}return{wa:o,Da:s,ls:l,mutatedKeys:r}}va(e,n){return e.hasLocalMutations&&n.hasCommittedMutations&&!n.hasLocalMutations}applyChanges(e,n,s,i){const r=this.wa;this.wa=e.wa,this.mutatedKeys=e.mutatedKeys;const o=e.Da.X_();o.sort((h,f)=>function(y,C){const D=S=>{switch(S){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return Pe()}};return D(y)-D(C)}(h.type,f.type)||this.ya(h.doc,f.doc)),this.Ca(s),i=i!=null&&i;const l=n&&!i?this.Fa():[],c=this.pa.size===0&&this.current&&!i?1:0,u=c!==this.ga;return this.ga=c,o.length!==0||u?{snapshot:new wi(this.query,e.wa,r,o,e.mutatedKeys,c===0,u,!1,!!s&&s.resumeToken.approximateByteSize()>0),Ma:l}:{Ma:l}}sa(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({wa:this.wa,Da:new Jh,mutatedKeys:this.mutatedKeys,ls:!1},!1)):{Ma:[]}}xa(e){return!this.fa.has(e)&&!!this.wa.has(e)&&!this.wa.get(e).hasLocalMutations}Ca(e){e&&(e.addedDocuments.forEach(n=>this.fa=this.fa.add(n)),e.modifiedDocuments.forEach(n=>{}),e.removedDocuments.forEach(n=>this.fa=this.fa.delete(n)),this.current=e.current)}Fa(){if(!this.current)return[];const e=this.pa;this.pa=Be(),this.wa.forEach(s=>{this.xa(s.key)&&(this.pa=this.pa.add(s.key))});const n=[];return e.forEach(s=>{this.pa.has(s)||n.push(new Im(s))}),this.pa.forEach(s=>{e.has(s)||n.push(new Am(s))}),n}Oa(e){this.fa=e.gs,this.pa=Be();const n=this.Sa(e.documents);return this.applyChanges(n,!0)}Na(){return wi.fromInitialDocuments(this.query,this.wa,this.mutatedKeys,this.ga===0,this.hasCachedResults)}}const ou="SyncEngine";class WA{constructor(e,n,s){this.query=e,this.targetId=n,this.view=s}}class zA{constructor(e){this.key=e,this.Ba=!1}}class YA{constructor(e,n,s,i,r,o){this.localStore=e,this.remoteStore=n,this.eventManager=s,this.sharedClientState=i,this.currentUser=r,this.maxConcurrentLimboResolutions=o,this.La={},this.ka=new Ys(l=>Ug(l),fa),this.qa=new Map,this.Qa=new Set,this.$a=new at(Ae.comparator),this.Ka=new Map,this.Ua=new Yc,this.Wa={},this.Ga=new Map,this.za=bi.Un(),this.onlineState="Unknown",this.ja=void 0}get isPrimaryClient(){return this.ja===!0}}async function QA(t,e,n=!0){const s=Dm(t);let i;const r=s.ka.get(e);return r?(s.sharedClientState.addLocalQueryTarget(r.targetId),i=r.view.Na()):i=await Sm(s,e,n,!0),i}async function XA(t,e){const n=Dm(t);await Sm(n,e,!0,!1)}async function Sm(t,e,n,s){const i=await vA(t.localStore,yn(e)),r=i.targetId,o=t.sharedClientState.addLocalQueryTarget(r,n);let l;return s&&(l=await JA(t,e,r,o==="current",i.resumeToken)),t.isPrimaryClient&&n&&gm(t.remoteStore,i),l}async function JA(t,e,n,s,i){t.Ha=(f,m,y)=>async function(D,S,M,P){let V=S.view.Sa(M);V.ls&&(V=await Gh(D.localStore,S.query,!1).then(({documents:I})=>S.view.Sa(I,V)));const R=P&&P.targetChanges.get(S.targetId),H=P&&P.targetMismatches.get(S.targetId)!=null,O=S.view.applyChanges(V,D.isPrimaryClient,R,H);return nf(D,S.targetId,O.Ma),O.snapshot}(t,f,m,y);const r=await Gh(t.localStore,e,!0),o=new GA(e,r.gs),l=o.Sa(r.documents),c=Nr.createSynthesizedTargetChangeForCurrentChange(n,s&&t.onlineState!=="Offline",i),u=o.applyChanges(l,t.isPrimaryClient,c);nf(t,n,u.Ma);const h=new WA(e,n,o);return t.ka.set(e,h),t.qa.has(n)?t.qa.get(n).push(e):t.qa.set(n,[e]),u.snapshot}async function ZA(t,e,n){const s=Me(t),i=s.ka.get(e),r=s.qa.get(i.targetId);if(r.length>1)return s.qa.set(i.targetId,r.filter(o=>!fa(o,e))),void s.ka.delete(e);s.isPrimaryClient?(s.sharedClientState.removeLocalQueryTarget(i.targetId),s.sharedClientState.isActiveQueryTarget(i.targetId)||await Zl(s.localStore,i.targetId,!1).then(()=>{s.sharedClientState.clearQueryState(i.targetId),n&&Zc(s.remoteStore,i.targetId),nc(s,i.targetId)}).catch(Si)):(nc(s,i.targetId),await Zl(s.localStore,i.targetId,!0))}async function eI(t,e){const n=Me(t),s=n.ka.get(e),i=n.qa.get(s.targetId);n.isPrimaryClient&&i.length===1&&(n.sharedClientState.removeLocalQueryTarget(s.targetId),Zc(n.remoteStore,s.targetId))}async function tI(t,e,n){const s=lI(t);try{const i=await function(o,l){const c=Me(o),u=yt.now(),h=l.reduce((y,C)=>y.add(C.key),Be());let f,m;return c.persistence.runTransaction("Locally write mutations","readwrite",y=>{let C=Vn(),D=Be();return c.ds.getEntries(y,h).next(S=>{C=S,C.forEach((M,P)=>{P.isValidDocument()||(D=D.add(M))})}).next(()=>c.localDocuments.getOverlayedDocuments(y,C)).next(S=>{f=S;const M=[];for(const P of l){const V=mw(P,f.get(P.key).overlayedDocument);V!=null&&M.push(new Qs(P.key,V,Og(V.value.mapValue),_n.exists(!0)))}return c.mutationQueue.addMutationBatch(y,u,M,l)}).next(S=>{m=S;const M=S.applyToLocalDocumentSet(f,D);return c.documentOverlayCache.saveOverlays(y,S.batchId,M)})}).then(()=>({batchId:m.batchId,changes:Kg(f)}))}(s.localStore,e);s.sharedClientState.addPendingMutation(i.batchId),function(o,l,c){let u=o.Wa[o.currentUser.toKey()];u||(u=new at(He)),u=u.insert(l,c),o.Wa[o.currentUser.toKey()]=u}(s,i.batchId,n),await Vr(s,i.changes),await Ea(s.remoteStore)}catch(i){const r=iu(i,"Failed to persist write");n.reject(r)}}async function Cm(t,e){const n=Me(t);try{const s=await pA(n.localStore,e);e.targetChanges.forEach((i,r)=>{const o=n.Ka.get(r);o&&(Qe(i.addedDocuments.size+i.modifiedDocuments.size+i.removedDocuments.size<=1),i.addedDocuments.size>0?o.Ba=!0:i.modifiedDocuments.size>0?Qe(o.Ba):i.removedDocuments.size>0&&(Qe(o.Ba),o.Ba=!1))}),await Vr(n,s,e)}catch(s){await Si(s)}}function tf(t,e,n){const s=Me(t);if(s.isPrimaryClient&&n===0||!s.isPrimaryClient&&n===1){const i=[];s.ka.forEach((r,o)=>{const l=o.view.sa(e);l.snapshot&&i.push(l.snapshot)}),function(o,l){const c=Me(o);c.onlineState=l;let u=!1;c.queries.forEach((h,f)=>{for(const m of f.ta)m.sa(l)&&(u=!0)}),u&&ru(c)}(s.eventManager,e),i.length&&s.La.p_(i),s.onlineState=e,s.isPrimaryClient&&s.sharedClientState.setOnlineState(e)}}async function nI(t,e,n){const s=Me(t);s.sharedClientState.updateQueryState(e,"rejected",n);const i=s.Ka.get(e),r=i&&i.key;if(r){let o=new at(Ae.comparator);o=o.insert(r,xt.newNoDocument(r,De.min()));const l=Be().add(r),c=new va(De.min(),new Map,new at(He),o,l);await Cm(s,c),s.$a=s.$a.remove(r),s.Ka.delete(e),au(s)}else await Zl(s.localStore,e,!1).then(()=>nc(s,e,n)).catch(Si)}async function sI(t,e){const n=Me(t),s=e.batch.batchId;try{const i=await fA(n.localStore,e);Pm(n,s,null),km(n,s),n.sharedClientState.updateMutationState(s,"acknowledged"),await Vr(n,i)}catch(i){await Si(i)}}async function iI(t,e,n){const s=Me(t);try{const i=await function(o,l){const c=Me(o);return c.persistence.runTransaction("Reject batch","readwrite-primary",u=>{let h;return c.mutationQueue.lookupMutationBatch(u,l).next(f=>(Qe(f!==null),h=f.keys(),c.mutationQueue.removeMutationBatch(u,f))).next(()=>c.mutationQueue.performConsistencyCheck(u)).next(()=>c.documentOverlayCache.removeOverlaysForBatchId(u,h,l)).next(()=>c.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(u,h)).next(()=>c.localDocuments.getDocuments(u,h))})}(s.localStore,e);Pm(s,e,n),km(s,e),s.sharedClientState.updateMutationState(e,"rejected",n),await Vr(s,i)}catch(i){await Si(i)}}function km(t,e){(t.Ga.get(e)||[]).forEach(n=>{n.resolve()}),t.Ga.delete(e)}function Pm(t,e,n){const s=Me(t);let i=s.Wa[s.currentUser.toKey()];if(i){const r=i.get(e);r&&(n?r.reject(n):r.resolve(),i=i.remove(e)),s.Wa[s.currentUser.toKey()]=i}}function nc(t,e,n=null){t.sharedClientState.removeLocalQueryTarget(e);for(const s of t.qa.get(e))t.ka.delete(s),n&&t.La.Ja(s,n);t.qa.delete(e),t.isPrimaryClient&&t.Ua.Sr(e).forEach(s=>{t.Ua.containsKey(s)||Rm(t,s)})}function Rm(t,e){t.Qa.delete(e.path.canonicalString());const n=t.$a.get(e);n!==null&&(Zc(t.remoteStore,n),t.$a=t.$a.remove(e),t.Ka.delete(n),au(t))}function nf(t,e,n){for(const s of n)s instanceof Am?(t.Ua.addReference(s.key,e),rI(t,s)):s instanceof Im?(Ee(ou,"Document no longer in limbo: "+s.key),t.Ua.removeReference(s.key,e),t.Ua.containsKey(s.key)||Rm(t,s.key)):Pe()}function rI(t,e){const n=e.key,s=n.path.canonicalString();t.$a.get(n)||t.Qa.has(s)||(Ee(ou,"New document in limbo: "+n),t.Qa.add(s),au(t))}function au(t){for(;t.Qa.size>0&&t.$a.size<t.maxConcurrentLimboResolutions;){const e=t.Qa.values().next().value;t.Qa.delete(e);const n=new Ae(st.fromString(e)),s=t.za.next();t.Ka.set(s,new zA(n)),t.$a=t.$a.insert(n,s),gm(t.remoteStore,new Yn(yn(jc(n.path)),s,"TargetPurposeLimboResolution",ua.ae))}}async function Vr(t,e,n){const s=Me(t),i=[],r=[],o=[];s.ka.isEmpty()||(s.ka.forEach((l,c)=>{o.push(s.Ha(c,e,n).then(u=>{var h;if((u||n)&&s.isPrimaryClient){const f=u?!u.fromCache:(h=n==null?void 0:n.targetChanges.get(c.targetId))===null||h===void 0?void 0:h.current;s.sharedClientState.updateQueryState(c.targetId,f?"current":"not-current")}if(u){i.push(u);const f=Xc.Yi(c.targetId,u);r.push(f)}}))}),await Promise.all(o),s.La.p_(i),await async function(c,u){const h=Me(c);try{await h.persistence.runTransaction("notifyLocalViewChanges","readwrite",f=>Y.forEach(u,m=>Y.forEach(m.Hi,y=>h.persistence.referenceDelegate.addReference(f,m.targetId,y)).next(()=>Y.forEach(m.Ji,y=>h.persistence.referenceDelegate.removeReference(f,m.targetId,y)))))}catch(f){if(!Ci(f))throw f;Ee(Jc,"Failed to update sequence numbers: "+f)}for(const f of u){const m=f.targetId;if(!f.fromCache){const y=h.Ts.get(m),C=y.snapshotVersion,D=y.withLastLimboFreeSnapshotVersion(C);h.Ts=h.Ts.insert(m,D)}}}(s.localStore,r))}async function oI(t,e){const n=Me(t);if(!n.currentUser.isEqual(e)){Ee(ou,"User change. New user:",e.toKey());const s=await dm(n.localStore,e);n.currentUser=e,function(r,o){r.Ga.forEach(l=>{l.forEach(c=>{c.reject(new _e(z.CANCELLED,o))})}),r.Ga.clear()}(n,"'waitForPendingWrites' promise is rejected due to a user change."),n.sharedClientState.handleUserChange(e,s.removedBatchIds,s.addedBatchIds),await Vr(n,s.Rs)}}function aI(t,e){const n=Me(t),s=n.Ka.get(e);if(s&&s.Ba)return Be().add(s.key);{let i=Be();const r=n.qa.get(e);if(!r)return i;for(const o of r){const l=n.ka.get(o);i=i.unionWith(l.view.ba)}return i}}function Dm(t){const e=Me(t);return e.remoteStore.remoteSyncer.applyRemoteEvent=Cm.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=aI.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=nI.bind(null,e),e.La.p_=KA.bind(null,e.eventManager),e.La.Ja=qA.bind(null,e.eventManager),e}function lI(t){const e=Me(t);return e.remoteStore.remoteSyncer.applySuccessfulWrite=sI.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=iI.bind(null,e),e}class qo{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(e){this.serializer=ya(e.databaseInfo.databaseId),this.sharedClientState=this.Za(e),this.persistence=this.Xa(e),await this.persistence.start(),this.localStore=this.eu(e),this.gcScheduler=this.tu(e,this.localStore),this.indexBackfillerScheduler=this.nu(e,this.localStore)}tu(e,n){return null}nu(e,n){return null}eu(e){return hA(this.persistence,new cA,e.initialUser,this.serializer)}Xa(e){return new um(Qc.ri,this.serializer)}Za(e){return new _A}async terminate(){var e,n;(e=this.gcScheduler)===null||e===void 0||e.stop(),(n=this.indexBackfillerScheduler)===null||n===void 0||n.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}qo.provider={build:()=>new qo};class cI extends qo{constructor(e){super(),this.cacheSizeBytes=e}tu(e,n){Qe(this.persistence.referenceDelegate instanceof jo);const s=this.persistence.referenceDelegate.garbageCollector;return new zw(s,e.asyncQueue,n)}Xa(e){const n=this.cacheSizeBytes!==void 0?Ht.withCacheSize(this.cacheSizeBytes):Ht.DEFAULT;return new um(s=>jo.ri(s,n),this.serializer)}}class sc{async initialize(e,n){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(n),this.remoteStore=this.createRemoteStore(n),this.eventManager=this.createEventManager(n),this.syncEngine=this.createSyncEngine(n,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=s=>tf(this.syncEngine,s,1),this.remoteStore.remoteSyncer.handleCredentialChange=oI.bind(null,this.syncEngine),await UA(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return function(){return new jA}()}createDatastore(e){const n=ya(e.databaseInfo.databaseId),s=function(r){return new AA(r)}(e.databaseInfo);return function(r,o,l,c){return new kA(r,o,l,c)}(e.authCredentials,e.appCheckCredentials,s,n)}createRemoteStore(e){return function(s,i,r,o,l){return new RA(s,i,r,o,l)}(this.localStore,this.datastore,e.asyncQueue,n=>tf(this.syncEngine,n,0),function(){return Yh.D()?new Yh:new EA}())}createSyncEngine(e,n){return function(i,r,o,l,c,u,h){const f=new YA(i,r,o,l,c,u);return h&&(f.ja=!0),f}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,n)}async terminate(){var e,n;await async function(i){const r=Me(i);Ee(Ks,"RemoteStore shutting down."),r.W_.add(5),await xr(r),r.z_.shutdown(),r.j_.set("Unknown")}(this.remoteStore),(e=this.datastore)===null||e===void 0||e.terminate(),(n=this.eventManager)===null||n===void 0||n.terminate()}}sc.provider={build:()=>new sc};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Mm{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.iu(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.iu(this.observer.error,e):xn("Uncaught Error in snapshot listener:",e.toString()))}su(){this.muted=!0}iu(e,n){setTimeout(()=>{this.muted||e(n)},0)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const hs="FirestoreClient";class uI{constructor(e,n,s,i,r){this.authCredentials=e,this.appCheckCredentials=n,this.asyncQueue=s,this.databaseInfo=i,this.user=Mt.UNAUTHENTICATED,this.clientId=Fc.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=r,this.authCredentials.start(s,async o=>{Ee(hs,"Received user=",o.uid),await this.authCredentialListener(o),this.user=o}),this.appCheckCredentials.start(s,o=>(Ee(hs,"Received new app check token=",o),this.appCheckCredentialListener(o,this.user)))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();const e=new Dn;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(n){const s=iu(n,"Failed to shutdown persistence");e.reject(s)}}),e.promise}}async function _l(t,e){t.asyncQueue.verifyOperationInProgress(),Ee(hs,"Initializing OfflineComponentProvider");const n=t.configuration;await e.initialize(n);let s=n.initialUser;t.setCredentialChangeListener(async i=>{s.isEqual(i)||(await dm(e.localStore,i),s=i)}),e.persistence.setDatabaseDeletedListener(()=>t.terminate()),t._offlineComponents=e}async function sf(t,e){t.asyncQueue.verifyOperationInProgress();const n=await dI(t);Ee(hs,"Initializing OnlineComponentProvider"),await e.initialize(n,t.configuration),t.setCredentialChangeListener(s=>Xh(e.remoteStore,s)),t.setAppCheckTokenChangeListener((s,i)=>Xh(e.remoteStore,i)),t._onlineComponents=e}async function dI(t){if(!t._offlineComponents)if(t._uninitializedComponentsProvider){Ee(hs,"Using user provided OfflineComponentProvider");try{await _l(t,t._uninitializedComponentsProvider._offline)}catch(e){const n=e;if(!function(i){return i.name==="FirebaseError"?i.code===z.FAILED_PRECONDITION||i.code===z.UNIMPLEMENTED:!(typeof DOMException<"u"&&i instanceof DOMException)||i.code===22||i.code===20||i.code===11}(n))throw n;js("Error using user provided cache. Falling back to memory cache: "+n),await _l(t,new qo)}}else Ee(hs,"Using default OfflineComponentProvider"),await _l(t,new cI(void 0));return t._offlineComponents}async function Om(t){return t._onlineComponents||(t._uninitializedComponentsProvider?(Ee(hs,"Using user provided OnlineComponentProvider"),await sf(t,t._uninitializedComponentsProvider._online)):(Ee(hs,"Using default OnlineComponentProvider"),await sf(t,new sc))),t._onlineComponents}function hI(t){return Om(t).then(e=>e.syncEngine)}async function Nm(t){const e=await Om(t),n=e.eventManager;return n.onListen=QA.bind(null,e.syncEngine),n.onUnlisten=ZA.bind(null,e.syncEngine),n.onFirstRemoteStoreListen=XA.bind(null,e.syncEngine),n.onLastRemoteStoreUnlisten=eI.bind(null,e.syncEngine),n}function fI(t,e,n={}){const s=new Dn;return t.asyncQueue.enqueueAndForget(async()=>function(r,o,l,c,u){const h=new Mm({next:m=>{h.su(),o.enqueueAndForget(()=>bm(r,f));const y=m.docs.has(l);!y&&m.fromCache?u.reject(new _e(z.UNAVAILABLE,"Failed to get document because the client is offline.")):y&&m.fromCache&&c&&c.source==="server"?u.reject(new _e(z.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):u.resolve(m)},error:m=>u.reject(m)}),f=new wm(jc(l.path),h,{includeMetadataChanges:!0,Ta:!0});return Tm(r,f)}(await Nm(t),t.asyncQueue,e,n,s)),s.promise}function pI(t,e,n={}){const s=new Dn;return t.asyncQueue.enqueueAndForget(async()=>function(r,o,l,c,u){const h=new Mm({next:m=>{h.su(),o.enqueueAndForget(()=>bm(r,f)),m.fromCache&&c.source==="server"?u.reject(new _e(z.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):u.resolve(m)},error:m=>u.reject(m)}),f=new wm(l,h,{includeMetadataChanges:!0,Ta:!0});return Tm(r,f)}(await Nm(t),t.asyncQueue,e,n,s)),s.promise}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function xm(t){const e={};return t.timeoutSeconds!==void 0&&(e.timeoutSeconds=t.timeoutSeconds),e}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const rf=new Map;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Vm(t,e,n){if(!n)throw new _e(z.INVALID_ARGUMENT,`Function ${t}() cannot be called with an empty ${e}.`)}function Fm(t,e,n,s){if(e===!0&&s===!0)throw new _e(z.INVALID_ARGUMENT,`${t} and ${n} cannot be used together.`)}function of(t){if(!Ae.isDocumentKey(t))throw new _e(z.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${t} has ${t.length}.`)}function af(t){if(Ae.isDocumentKey(t))throw new _e(z.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${t} has ${t.length}.`)}function Ta(t){if(t===void 0)return"undefined";if(t===null)return"null";if(typeof t=="string")return t.length>20&&(t=`${t.substring(0,20)}...`),JSON.stringify(t);if(typeof t=="number"||typeof t=="boolean")return""+t;if(typeof t=="object"){if(t instanceof Array)return"an array";{const e=function(s){return s.constructor?s.constructor.name:null}(t);return e?`a custom ${e} object`:"an object"}}return typeof t=="function"?"a function":Pe()}function Fn(t,e){if("_delegate"in t&&(t=t._delegate),!(t instanceof e)){if(e.name===t.constructor.name)throw new _e(z.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const n=Ta(t);throw new _e(z.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${n}`)}}return t}function gI(t,e){if(e<=0)throw new _e(z.INVALID_ARGUMENT,`Function ${t}() requires a positive number, but it was: ${e}.`)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const $m="firestore.googleadsasd23232pis.com",lf=!0;class cf{constructor(e){var n,s;if(e.host===void 0){if(e.ssl!==void 0)throw new _e(z.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host=$m,this.ssl=lf}else this.host=e.host,this.ssl=(n=e.ssl)!==null&&n!==void 0?n:lf;if(this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=cm;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<Gw)throw new _e(z.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}Fm("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=xm((s=e.experimentalLongPollingOptions)!==null&&s!==void 0?s:{}),function(r){if(r.timeoutSeconds!==void 0){if(isNaN(r.timeoutSeconds))throw new _e(z.INVALID_ARGUMENT,`invalid long polling timeout: ${r.timeoutSeconds} (must not be NaN)`);if(r.timeoutSeconds<5)throw new _e(z.INVALID_ARGUMENT,`invalid long polling timeout: ${r.timeoutSeconds} (minimum allowed value is 5)`);if(r.timeoutSeconds>30)throw new _e(z.INVALID_ARGUMENT,`invalid long polling timeout: ${r.timeoutSeconds} (maximum allowed value is 30)`)}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&function(s,i){return s.timeoutSeconds===i.timeoutSeconds}(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class ba{constructor(e,n,s,i){this._authCredentials=e,this._appCheckCredentials=n,this._databaseId=s,this._app=i,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new cf({}),this._settingsFrozen=!1,this._emulatorOptions={},this._terminateTask="notTerminated"}get app(){if(!this._app)throw new _e(z.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(e){if(this._settingsFrozen)throw new _e(z.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new cf(e),this._emulatorOptions=e.emulatorOptions||{},e.credentials!==void 0&&(this._authCredentials=function(s){if(!s)return new wg;switch(s.type){case"firstParty":return new Sb(s.sessionIndex||"0",s.iamToken||null,s.authTokenFactory||null);case"provider":return s.client;default:throw new _e(z.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}_getSettings(){return this._settings}_getEmulatorOptions(){return this._emulatorOptions}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){this._terminateTask==="notTerminated"?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(n){const s=rf.get(n);s&&(Ee("ComponentProvider","Removing Datastore"),rf.delete(n),s.terminate())}(this),Promise.resolve()}}function Lm(t,e,n,s={}){var i;const r=(t=Fn(t,ba))._getSettings(),o=Object.assign(Object.assign({},r),{emulatorOptions:t._getEmulatorOptions()}),l=`${e}:${n}`;r.host!==$m&&r.host!==l&&js("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used.");const c=Object.assign(Object.assign({},r),{host:l,ssl:!1,emulatorOptions:s});if(!_r(c,o)&&(t._setSettings(c),s.mockUserToken)){let u,h;if(typeof s.mockUserToken=="string")u=s.mockUserToken,h=Mt.MOCK_USER;else{u=x0(s.mockUserToken,(i=t._app)===null||i===void 0?void 0:i.options.projectId);const f=s.mockUserToken.sub||s.mockUserToken.user_id;if(!f)throw new _e(z.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");h=new Mt(f)}t._authCredentials=new wb(new bg(u,h))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Bn{constructor(e,n,s){this.converter=n,this._query=s,this.type="query",this.firestore=e}withConverter(e){return new Bn(this.firestore,e,this._query)}}class Ut{constructor(e,n,s){this.converter=n,this._key=s,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new Mn(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new Ut(this.firestore,e,this._key)}}class Mn extends Bn{constructor(e,n,s){super(e,n,jc(s)),this._path=s,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new Ut(this.firestore,null,new Ae(e))}withConverter(e){return new Mn(this.firestore,e,this._path)}}function Js(t,e,...n){if(t=rs(t),Vm("collection","path",e),t instanceof ba){const s=st.fromString(e,...n);return af(s),new Mn(t,null,s)}{if(!(t instanceof Ut||t instanceof Mn))throw new _e(z.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const s=t._path.child(st.fromString(e,...n));return af(s),new Mn(t.firestore,null,s)}}function qs(t,e,...n){if(t=rs(t),arguments.length===1&&(e=Fc.newId()),Vm("doc","path",e),t instanceof ba){const s=st.fromString(e,...n);return of(s),new Ut(t,null,new Ae(s))}{if(!(t instanceof Ut||t instanceof Mn))throw new _e(z.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const s=t._path.child(st.fromString(e,...n));return of(s),new Ut(t.firestore,t instanceof Mn?t.converter:null,new Ae(s))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const uf="AsyncQueue";class df{constructor(e=Promise.resolve()){this.Vu=[],this.mu=!1,this.fu=[],this.gu=null,this.pu=!1,this.yu=!1,this.wu=[],this.a_=new fm(this,"async_queue_retry"),this.bu=()=>{const s=yl();s&&Ee(uf,"Visibility state changed to "+s.visibilityState),this.a_.t_()},this.Su=e;const n=yl();n&&typeof n.addEventListener=="function"&&n.addEventListener("visibilitychange",this.bu)}get isShuttingDown(){return this.mu}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.Du(),this.vu(e)}enterRestrictedMode(e){if(!this.mu){this.mu=!0,this.yu=e||!1;const n=yl();n&&typeof n.removeEventListener=="function"&&n.removeEventListener("visibilitychange",this.bu)}}enqueue(e){if(this.Du(),this.mu)return new Promise(()=>{});const n=new Dn;return this.vu(()=>this.mu&&this.yu?Promise.resolve():(e().then(n.resolve,n.reject),n.promise)).then(()=>n.promise)}enqueueRetryable(e){this.enqueueAndForget(()=>(this.Vu.push(e),this.Cu()))}async Cu(){if(this.Vu.length!==0){try{await this.Vu[0](),this.Vu.shift(),this.a_.reset()}catch(e){if(!Ci(e))throw e;Ee(uf,"Operation failed with retryable error: "+e)}this.Vu.length>0&&this.a_.Xo(()=>this.Cu())}}vu(e){const n=this.Su.then(()=>(this.pu=!0,e().catch(s=>{this.gu=s,this.pu=!1;const i=function(o){let l=o.message||"";return o.stack&&(l=o.stack.includes(o.message)?o.stack:o.message+`
`+o.stack),l}(s);throw xn("INTERNAL UNHANDLED ERROR: ",i),s}).then(s=>(this.pu=!1,s))));return this.Su=n,n}enqueueAfterDelay(e,n,s){this.Du(),this.wu.indexOf(e)>-1&&(n=0);const i=su.createAndSchedule(this,e,n,s,r=>this.Fu(r));return this.fu.push(i),i}Du(){this.gu&&Pe()}verifyOperationInProgress(){}async Mu(){let e;do e=this.Su,await e;while(e!==this.Su)}xu(e){for(const n of this.fu)if(n.timerId===e)return!0;return!1}Ou(e){return this.Mu().then(()=>{this.fu.sort((n,s)=>n.targetTimeMs-s.targetTimeMs);for(const n of this.fu)if(n.skipDelay(),e!=="all"&&n.timerId===e)break;return this.Mu()})}Nu(e){this.wu.push(e)}Fu(e){const n=this.fu.indexOf(e);this.fu.splice(n,1)}}class Ri extends ba{constructor(e,n,s,i){super(e,n,s,i),this.type="firestore",this._queue=new df,this._persistenceKey=(i==null?void 0:i.name)||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const e=this._firestoreClient.terminate();this._queue=new df(e),this._firestoreClient=void 0,await e}}}function Bm(t,e){const n=typeof t=="object"?t:Kp(),s=typeof t=="string"?t:Fo,i=Mr(n,"firestore").getImmediate({identifier:s});if(!i._initialized){const r=O0("firestore");r&&Lm(i,...r)}return i}function wa(t){if(t._terminated)throw new _e(z.FAILED_PRECONDITION,"The client has already been terminated.");return t._firestoreClient||mI(t),t._firestoreClient}function mI(t){var e,n,s;const i=t._freezeSettings(),r=function(l,c,u,h){return new Bb(l,c,u,h.host,h.ssl,h.experimentalForceLongPolling,h.experimentalAutoDetectLongPolling,xm(h.experimentalLongPollingOptions),h.useFetchStreams)}(t._databaseId,((e=t._app)===null||e===void 0?void 0:e.options.appId)||"",t._persistenceKey,i);t._componentsProvider||!((n=i.localCache)===null||n===void 0)&&n._offlineComponentProvider&&(!((s=i.localCache)===null||s===void 0)&&s._onlineComponentProvider)&&(t._componentsProvider={_offline:i.localCache._offlineComponentProvider,_online:i.localCache._onlineComponentProvider}),t._firestoreClient=new uI(t._authCredentials,t._appCheckCredentials,t._queue,r,t._componentsProvider&&function(l){const c=l==null?void 0:l._online.build();return{_offline:l==null?void 0:l._offline.build(c),_online:c}}(t._componentsProvider))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Gs{constructor(e){this._byteString=e}static fromBase64String(e){try{return new Gs(wt.fromBase64String(e))}catch(n){throw new _e(z.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+n)}}static fromUint8Array(e){return new Gs(wt.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Aa{constructor(...e){for(let n=0;n<e.length;++n)if(e[n].length===0)throw new _e(z.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new bt(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ia{constructor(e){this._methodName=e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Sa{constructor(e,n){if(!isFinite(e)||e<-90||e>90)throw new _e(z.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(n)||n<-180||n>180)throw new _e(z.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+n);this._lat=e,this._long=n}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}toJSON(){return{latitude:this._lat,longitude:this._long}}_compareTo(e){return He(this._lat,e._lat)||He(this._long,e._long)}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ca{constructor(e){this._values=(e||[]).map(n=>n)}toArray(){return this._values.map(e=>e)}isEqual(e){return function(s,i){if(s.length!==i.length)return!1;for(let r=0;r<s.length;++r)if(s[r]!==i[r])return!1;return!0}(this._values,e._values)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const vI=/^__.*__$/;class yI{constructor(e,n,s){this.data=e,this.fieldMask=n,this.fieldTransforms=s}toMutation(e,n){return this.fieldMask!==null?new Qs(e,this.data,this.fieldMask,n,this.fieldTransforms):new Or(e,this.data,n,this.fieldTransforms)}}function Um(t){switch(t){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw Pe()}}class lu{constructor(e,n,s,i,r,o){this.settings=e,this.databaseId=n,this.serializer=s,this.ignoreUndefinedProperties=i,r===void 0&&this.Bu(),this.fieldTransforms=r||[],this.fieldMask=o||[]}get path(){return this.settings.path}get Lu(){return this.settings.Lu}ku(e){return new lu(Object.assign(Object.assign({},this.settings),e),this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}qu(e){var n;const s=(n=this.path)===null||n===void 0?void 0:n.child(e),i=this.ku({path:s,Qu:!1});return i.$u(e),i}Ku(e){var n;const s=(n=this.path)===null||n===void 0?void 0:n.child(e),i=this.ku({path:s,Qu:!1});return i.Bu(),i}Uu(e){return this.ku({path:void 0,Qu:!0})}Wu(e){return Go(e,this.settings.methodName,this.settings.Gu||!1,this.path,this.settings.zu)}contains(e){return this.fieldMask.find(n=>e.isPrefixOf(n))!==void 0||this.fieldTransforms.find(n=>e.isPrefixOf(n.field))!==void 0}Bu(){if(this.path)for(let e=0;e<this.path.length;e++)this.$u(this.path.get(e))}$u(e){if(e.length===0)throw this.Wu("Document fields must not be empty");if(Um(this.Lu)&&vI.test(e))throw this.Wu('Document fields cannot begin and end with "__"')}}class _I{constructor(e,n,s){this.databaseId=e,this.ignoreUndefinedProperties=n,this.serializer=s||ya(e)}ju(e,n,s,i=!1){return new lu({Lu:e,methodName:n,zu:s,path:bt.emptyPath(),Qu:!1,Gu:i},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function Hm(t){const e=t._freezeSettings(),n=ya(t._databaseId);return new _I(t._databaseId,!!e.ignoreUndefinedProperties,n)}function EI(t,e,n,s,i,r={}){const o=t.ju(r.merge||r.mergeFields?2:0,e,n,i);qm("Data must be an object, but it was:",o,s);const l=jm(s,o);let c,u;if(r.merge)c=new ln(o.fieldMask),u=o.fieldTransforms;else if(r.mergeFields){const h=[];for(const f of r.mergeFields){const m=bI(e,f,n);if(!o.contains(m))throw new _e(z.INVALID_ARGUMENT,`Field '${m}' is specified in your field mask but missing from your input data.`);AI(h,m)||h.push(m)}c=new ln(h),u=o.fieldTransforms.filter(f=>c.covers(f.field))}else c=null,u=o.fieldTransforms;return new yI(new nn(l),c,u)}class cu extends Ia{_toFieldTransform(e){return new hw(e.path,new Ir)}isEqual(e){return e instanceof cu}}function TI(t,e,n,s=!1){return uu(n,t.ju(s?4:3,e))}function uu(t,e){if(Km(t=rs(t)))return qm("Unsupported field value:",e,t),jm(t,e);if(t instanceof Ia)return function(s,i){if(!Um(i.Lu))throw i.Wu(`${s._methodName}() can only be used with update() and set()`);if(!i.path)throw i.Wu(`${s._methodName}() is not currently supported inside arrays`);const r=s._toFieldTransform(i);r&&i.fieldTransforms.push(r)}(t,e),null;if(t===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),t instanceof Array){if(e.settings.Qu&&e.Lu!==4)throw e.Wu("Nested arrays are not supported");return function(s,i){const r=[];let o=0;for(const l of s){let c=uu(l,i.Uu(o));c==null&&(c={nullValue:"NULL_VALUE"}),r.push(c),o++}return{arrayValue:{values:r}}}(t,e)}return function(s,i){if((s=rs(s))===null)return{nullValue:"NULL_VALUE"};if(typeof s=="number")return cw(i.serializer,s);if(typeof s=="boolean")return{booleanValue:s};if(typeof s=="string")return{stringValue:s};if(s instanceof Date){const r=yt.fromDate(s);return{timestampValue:Ho(i.serializer,r)}}if(s instanceof yt){const r=new yt(s.seconds,1e3*Math.floor(s.nanoseconds/1e3));return{timestampValue:Ho(i.serializer,r)}}if(s instanceof Sa)return{geoPointValue:{latitude:s.latitude,longitude:s.longitude}};if(s instanceof Gs)return{bytesValue:nm(i.serializer,s._byteString)};if(s instanceof Ut){const r=i.databaseId,o=s.firestore._databaseId;if(!o.isEqual(r))throw i.Wu(`Document reference is for database ${o.projectId}/${o.database} but should be for database ${r.projectId}/${r.database}`);return{referenceValue:zc(s.firestore._databaseId||i.databaseId,s._key.path)}}if(s instanceof Ca)return function(o,l){return{mapValue:{fields:{[Dg]:{stringValue:Mg},[$o]:{arrayValue:{values:o.toArray().map(u=>{if(typeof u!="number")throw l.Wu("VectorValues must only contain numeric values.");return Kc(l.serializer,u)})}}}}}}(s,i);throw i.Wu(`Unsupported field value: ${Ta(s)}`)}(t,e)}function jm(t,e){const n={};return Ig(t)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):zs(t,(s,i)=>{const r=uu(i,e.qu(s));r!=null&&(n[s]=r)}),{mapValue:{fields:n}}}function Km(t){return!(typeof t!="object"||t===null||t instanceof Array||t instanceof Date||t instanceof yt||t instanceof Sa||t instanceof Gs||t instanceof Ut||t instanceof Ia||t instanceof Ca)}function qm(t,e,n){if(!Km(n)||!function(i){return typeof i=="object"&&i!==null&&(Object.getPrototypeOf(i)===Object.prototype||Object.getPrototypeOf(i)===null)}(n)){const s=Ta(n);throw s==="an object"?e.Wu(t+" a custom object"):e.Wu(t+" "+s)}}function bI(t,e,n){if((e=rs(e))instanceof Aa)return e._internalPath;if(typeof e=="string")return Gm(t,e);throw Go("Field path arguments must be of type string or ",t,!1,void 0,n)}const wI=new RegExp("[~\\*/\\[\\]]");function Gm(t,e,n){if(e.search(wI)>=0)throw Go(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,t,!1,void 0,n);try{return new Aa(...e.split("."))._internalPath}catch{throw Go(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,t,!1,void 0,n)}}function Go(t,e,n,s,i){const r=s&&!s.isEmpty(),o=i!==void 0;let l=`Function ${e}() called with invalid data`;n&&(l+=" (via `toFirestore()`)"),l+=". ";let c="";return(r||o)&&(c+=" (found",r&&(c+=` in field ${s}`),o&&(c+=` in document ${i}`),c+=")"),new _e(z.INVALID_ARGUMENT,l+t+c)}function AI(t,e){return t.some(n=>n.isEqual(e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Wm{constructor(e,n,s,i,r){this._firestore=e,this._userDataWriter=n,this._key=s,this._document=i,this._converter=r}get id(){return this._key.path.lastSegment()}get ref(){return new Ut(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const e=new II(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const n=this._document.data.field(ka("DocumentSnapshot.get",e));if(n!==null)return this._userDataWriter.convertValue(n)}}}class II extends Wm{data(){return super.data()}}function ka(t,e){return typeof e=="string"?Gm(t,e):e instanceof Aa?e._internalPath:e._delegate._internalPath}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function SI(t){if(t.limitType==="L"&&t.explicitOrderBy.length===0)throw new _e(z.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class du{}class Pa extends du{}function fs(t,e,...n){let s=[];e instanceof du&&s.push(e),s=s.concat(n),function(r){const o=r.filter(c=>c instanceof Ra).length,l=r.filter(c=>c instanceof Fr).length;if(o>1||o>0&&l>0)throw new _e(z.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")}(s);for(const i of s)t=i._apply(t);return t}class Fr extends Pa{constructor(e,n,s){super(),this._field=e,this._op=n,this._value=s,this.type="where"}static _create(e,n,s){return new Fr(e,n,s)}_apply(e){const n=this._parse(e);return zm(e._query,n),new Bn(e.firestore,e.converter,zl(e._query,n))}_parse(e){const n=Hm(e.firestore);return function(r,o,l,c,u,h,f){let m;if(u.isKeyField()){if(h==="array-contains"||h==="array-contains-any")throw new _e(z.INVALID_ARGUMENT,`Invalid Query. You can't perform '${h}' queries on documentId().`);if(h==="in"||h==="not-in"){ff(f,h);const C=[];for(const D of f)C.push(hf(c,r,D));m={arrayValue:{values:C}}}else m=hf(c,r,f)}else h!=="in"&&h!=="not-in"&&h!=="array-contains-any"||ff(f,h),m=TI(l,o,f,h==="in"||h==="not-in");return vt.create(u,h,m)}(e._query,"where",n,e.firestore._databaseId,this._field,this._op,this._value)}}function Ws(t,e,n){const s=e,i=ka("where",t);return Fr._create(i,s,n)}class Ra extends du{constructor(e,n){super(),this.type=e,this._queryConstraints=n}static _create(e,n){return new Ra(e,n)}_parse(e){const n=this._queryConstraints.map(s=>s._parse(e)).filter(s=>s.getFilters().length>0);return n.length===1?n[0]:dn.create(n,this._getOperator())}_apply(e){const n=this._parse(e);return n.getFilters().length===0?e:(function(i,r){let o=i;const l=r.getFlattenedFilters();for(const c of l)zm(o,c),o=zl(o,c)}(e._query,n),new Bn(e.firestore,e.converter,zl(e._query,n)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return this.type==="and"?"and":"or"}}class Da extends Pa{constructor(e,n){super(),this._field=e,this._direction=n,this.type="orderBy"}static _create(e,n){return new Da(e,n)}_apply(e){const n=function(i,r,o){if(i.startAt!==null)throw new _e(z.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(i.endAt!==null)throw new _e(z.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");return new Ar(r,o)}(e._query,this._field,this._direction);return new Bn(e.firestore,e.converter,function(i,r){const o=i.explicitOrderBy.concat([r]);return new ki(i.path,i.collectionGroup,o,i.filters.slice(),i.limit,i.limitType,i.startAt,i.endAt)}(e._query,n))}}function Ai(t,e="asc"){const n=e,s=ka("orderBy",t);return Da._create(s,n)}class Ma extends Pa{constructor(e,n,s){super(),this.type=e,this._limit=n,this._limitType=s}static _create(e,n,s){return new Ma(e,n,s)}_apply(e){return new Bn(e.firestore,e.converter,Bo(e._query,this._limit,this._limitType))}}function ps(t){return gI("limit",t),Ma._create("limit",t,"F")}function hf(t,e,n){if(typeof(n=rs(n))=="string"){if(n==="")throw new _e(z.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!Bg(e)&&n.indexOf("/")!==-1)throw new _e(z.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${n}' contains a '/' character.`);const s=e.path.child(st.fromString(n));if(!Ae.isDocumentKey(s))throw new _e(z.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${s}' is not because it has an odd number of segments (${s.length}).`);return Ch(t,new Ae(s))}if(n instanceof Ut)return Ch(t,n._key);throw new _e(z.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${Ta(n)}.`)}function ff(t,e){if(!Array.isArray(t)||t.length===0)throw new _e(z.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${e.toString()}' filters.`)}function zm(t,e){const n=function(i,r){for(const o of i)for(const l of o.getFlattenedFilters())if(r.indexOf(l.op)>=0)return l.op;return null}(t.filters,function(i){switch(i){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}}(e.op));if(n!==null)throw n===e.op?new _e(z.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${e.op.toString()}' filter.`):new _e(z.INVALID_ARGUMENT,`Invalid query. You cannot use '${e.op.toString()}' filters with '${n.toString()}' filters.`)}class Ym{convertValue(e,n="none"){switch(us(e)){case 0:return null;case 1:return e.booleanValue;case 2:return dt(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,n);case 5:return e.stringValue;case 6:return this.convertBytes(cs(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,n);case 11:return this.convertObject(e.mapValue,n);case 10:return this.convertVectorValue(e.mapValue);default:throw Pe()}}convertObject(e,n){return this.convertObjectMap(e.fields,n)}convertObjectMap(e,n="none"){const s={};return zs(e,(i,r)=>{s[i]=this.convertValue(r,n)}),s}convertVectorValue(e){var n,s,i;const r=(i=(s=(n=e.fields)===null||n===void 0?void 0:n[$o].arrayValue)===null||s===void 0?void 0:s.values)===null||i===void 0?void 0:i.map(o=>dt(o.doubleValue));return new Ca(r)}convertGeoPoint(e){return new Sa(dt(e.latitude),dt(e.longitude))}convertArray(e,n){return(e.values||[]).map(s=>this.convertValue(s,n))}convertServerTimestamp(e,n){switch(n){case"previous":const s=ha(e);return s==null?null:this.convertValue(s,n);case"estimate":return this.convertTimestamp(br(e));default:return null}}convertTimestamp(e){const n=ls(e);return new yt(n.seconds,n.nanos)}convertDocumentKey(e,n){const s=st.fromString(e);Qe(lm(s));const i=new _i(s.get(1),s.get(3)),r=new Ae(s.popFirst(5));return i.isEqual(n)||xn(`Document ${r} contains a document reference within a different database (${i.projectId}/${i.database}) which is not supported. It will be treated as a reference in the current database (${n.projectId}/${n.database}) instead.`),r}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function CI(t,e,n){let s;return s=t?t.toFirestore(e):e,s}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hi{constructor(e,n){this.hasPendingWrites=e,this.fromCache=n}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class hu extends Wm{constructor(e,n,s,i,r,o){super(e,n,s,i,o),this._firestore=e,this._firestoreImpl=e,this.metadata=r}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const n=new ur(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(n,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,n={}){if(this._document){const s=this._document.data.field(ka("DocumentSnapshot.get",e));if(s!==null)return this._userDataWriter.convertValue(s,n.serverTimestamps)}}}class ur extends hu{data(e={}){return super.data(e)}}class Qm{constructor(e,n,s,i){this._firestore=e,this._userDataWriter=n,this._snapshot=i,this.metadata=new hi(i.hasPendingWrites,i.fromCache),this.query=s}get docs(){const e=[];return this.forEach(n=>e.push(n)),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,n){this._snapshot.docs.forEach(s=>{e.call(n,new ur(this._firestore,this._userDataWriter,s.key,s,new hi(this._snapshot.mutatedKeys.has(s.key),this._snapshot.fromCache),this.query.converter))})}docChanges(e={}){const n=!!e.includeMetadataChanges;if(n&&this._snapshot.excludesMetadataChanges)throw new _e(z.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===n||(this._cachedChanges=function(i,r){if(i._snapshot.oldDocs.isEmpty()){let o=0;return i._snapshot.docChanges.map(l=>{const c=new ur(i._firestore,i._userDataWriter,l.doc.key,l.doc,new hi(i._snapshot.mutatedKeys.has(l.doc.key),i._snapshot.fromCache),i.query.converter);return l.doc,{type:"added",doc:c,oldIndex:-1,newIndex:o++}})}{let o=i._snapshot.oldDocs;return i._snapshot.docChanges.filter(l=>r||l.type!==3).map(l=>{const c=new ur(i._firestore,i._userDataWriter,l.doc.key,l.doc,new hi(i._snapshot.mutatedKeys.has(l.doc.key),i._snapshot.fromCache),i.query.converter);let u=-1,h=-1;return l.type!==0&&(u=o.indexOf(l.doc.key),o=o.delete(l.doc.key)),l.type!==1&&(o=o.add(l.doc),h=o.indexOf(l.doc.key)),{type:kI(l.type),doc:c,oldIndex:u,newIndex:h}})}}(this,n),this._cachedChangesIncludeMetadataChanges=n),this._cachedChanges}}function kI(t){switch(t){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return Pe()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Oa(t){t=Fn(t,Ut);const e=Fn(t.firestore,Ri);return fI(wa(e),t._key).then(n=>RI(e,t,n))}class Xm extends Ym{constructor(e){super(),this.firestore=e}convertBytes(e){return new Gs(e)}convertReference(e){const n=this.convertDocumentKey(e,this.firestore._databaseId);return new Ut(this.firestore,null,n)}}function $n(t){t=Fn(t,Bn);const e=Fn(t.firestore,Ri),n=wa(e),s=new Xm(e);return SI(t._query),pI(n,t._query).then(i=>new Qm(e,s,t,i))}function fu(t,e,n){t=Fn(t,Ut);const s=Fn(t.firestore,Ri),i=CI(t.converter,e);return pu(s,[EI(Hm(s),"setDoc",t._key,i,t.converter!==null,n).toMutation(t._key,_n.none())])}function PI(t){return pu(Fn(t.firestore,Ri),[new qc(t._key,_n.none())])}function pu(t,e){return function(s,i){const r=new Dn;return s.asyncQueue.enqueueAndForget(async()=>tI(await hI(s),i,r)),r.promise}(wa(t),e)}function RI(t,e,n){const s=n.docs.get(e._key),i=new Xm(t);return new hu(t,i,e._key,s,new hi(n.hasPendingWrites,n.fromCache),e.converter)}function Jm(){return new cu("serverTimestamp")}(function(e,n=!0){(function(i){Ii=i})(GE),os(new On("firestore",(s,{instanceIdentifier:i,options:r})=>{const o=s.getProvider("app").getImmediate(),l=new Ri(new Ab(s.getProvider("auth-internal")),new Cb(o,s.getProvider("app-check-internal")),function(u,h){if(!Object.prototype.hasOwnProperty.apply(u.options,["projectId"]))throw new _e(z.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new _i(u.options.projectId,h)}(o,i),o);return r=Object.assign({useFetchStreams:n},r),l._setSettings(r),l},"PUBLIC").setMultipleInstances(!0)),vn(mh,vh,e),vn(mh,vh,"esm2017")})();const DI=Object.freeze(Object.defineProperty({__proto__:null,AbstractUserDataWriter:Ym,Bytes:Gs,CollectionReference:Mn,DocumentReference:Ut,DocumentSnapshot:hu,FieldPath:Aa,FieldValue:Ia,Firestore:Ri,FirestoreError:_e,GeoPoint:Sa,Query:Bn,QueryCompositeFilterConstraint:Ra,QueryConstraint:Pa,QueryDocumentSnapshot:ur,QueryFieldFilterConstraint:Fr,QueryLimitConstraint:Ma,QueryOrderByConstraint:Da,QuerySnapshot:Qm,SnapshotMetadata:hi,Timestamp:yt,VectorValue:Ca,_AutoId:Fc,_ByteString:wt,_DatabaseId:_i,_DocumentKey:Ae,_EmptyAuthCredentialsProvider:wg,_FieldPath:bt,_cast:Fn,_logWarn:js,_validateIsNotUsedTogether:Fm,collection:Js,connectFirestoreEmulator:Lm,deleteDoc:PI,doc:qs,ensureFirestoreConfigured:wa,executeWrite:pu,getDoc:Oa,getDocs:$n,getFirestore:Bm,limit:ps,orderBy:Ai,query:fs,serverTimestamp:Jm,setDoc:fu,where:Ws},Symbol.toStringTag,{value:"Module"})),MI={apiKey:"AIzaSyCw2lGGKsheeEAzv2f3lmW8UzXi8EhMdOs",authDomain:"muaythai-idle.firebaseapp.com",projectId:"muaythai-idle",storageBucket:"muaythai-idle.firebasestorage.app",messagingSenderId:"130683543892",appId:"1:130683543892:web:be4841cc08f5280b6a28c1",measurementId:"G-FPVNYZ95LB"},gu=jp(MI),ic=Eb(gu),Zt=Bm(gu),gs=(t,e={})=>{ic&&gg(ic,t,e)};gs("page_view");const OI=Object.freeze(Object.defineProperty({__proto__:null,analytics:ic,app:gu,db:Zt,logAnalyticsEvent:gs},Symbol.toStringTag,{value:"Module"})),sn=Dr("skills",()=>{const t=ue([]);function e(){t.value=[]}const n=Le(()=>mo),s=Le(()=>mo.filter(u=>!t.value.includes(u.name)));function i(u){return mo.find(h=>h.name===u)}function r(u){const h=$e(),f=i(u);return!f||t.value.includes(u)?!1:h.spendTrainingPoints(f.cost)?(t.value.push(u),gs("skill_purchased",{skill_name:u,skill_tier:f.tier,skill_cost:f.cost,str_modifier:f.strength||0,agi_modifier:f.agility||0,end_modifier:f.endurance||0,owned_skills_count:t.value.length}),l(),!0):!1}function o(u){return t.value.includes(u)}function l(){oa("skillsData",{ownedSkills:t.value})}function c(){const u=Cc("skillsData");u&&u.ownedSkills&&(t.value=u.ownedSkills)}return{ownedSkills:t,availableSkills:n,purchasableSkills:s,getSkillByName:i,purchaseSkill:r,hasSkill:o,saveSkillsData:l,loadSkillsData:c,$reset:e}}),ae={specialAttackChance:.12,damage:{minRandomFactor:.8,maxRandomFactor:1.2,damageReductionCap:.9,enduranceScaling:{baseDivisor:8.5,tier1Threshold:25,tier1Bonus:.06,tier2Threshold:50,tier2Bonus:.1,tier3Threshold:75,tier3Bonus:.12,ratioScaling:{enabled:!0,baseMultiplier:.5,optimalRatio:.8,maxRatioBonus:.18}},strengthMultiplier:1,enduranceAdvantage:{thresholdPercentage:10,baseChance:.25,maxChance:.45,bonusReduction:.5,maximumReduction:.95},damageCap:{maxDamagePercent:.3,tierOneCapPercent:.35,finalBossCapPercent:.2,criticalHitCapMultiplier:1.1,comboCapMultiplier:1.05}},evasion:{maxChance:.98,minChance:.05,divisor:2.5,agilityAdvantage:{doubleAgilityChance:.6,tripleAgilityChance:.9},strengthAdvantage:{minStrengthRatio:1.25,baseChance:.15,additionalChancePerHalfRatio:.1,maxChance:.4,damageMultiplier:1.75},accuracy:{baseImpact:.4,scalingExponent:.8,maxAdvantage:.9},counterAttack:{enabled:!0,baseChance:.25,agilityBonus:.01,maxChance:.7,baseDamageMultiplier:.5,strengthPunishmentFactor:.002,maxStrengthPunishmentBonus:.4,tierBonus:.04}},specialEvents:{knockoutChance:.01,adrenalineSurgeChance:.05,staminaDrainChance:.04,perfectCounterChance:.06,clinchRecoveryChance:.08,crowdFavoriteChance:.1,focusShiftChance:.1,comebackChance:.3,fighterMotiveChance:.05,fighterMotiveDuration:4,motiveTypes:{family:{name:"family",strengthBuff:15,agilityBuff:5,enduranceBuff:10,message:"thinks of their family and fights with renewed purpose!"},revenge:{name:"revenge",strengthBuff:20,agilityBuff:10,enduranceBuff:0,message:"is driven by revenge and unleashes devastating power!"},pride:{name:"pride",strengthBuff:10,agilityBuff:15,enduranceBuff:5,message:"fights for pride with increased focus and speed!"},legacy:{name:"legacy",strengthBuff:15,agilityBuff:0,enduranceBuff:15,message:"is fighting for their legacy with unwavering determination!"}},secondChanceChance:.08,secondChanceHealPercent:50,secondChanceStrengthBuff:20,secondChanceAgilityBuff:10,secondChanceDuration:5,comebackThreshold:20,adrenalineSurgeStrengthBuff:30,staminaDrainAgilityDebuff:-10,clinchRecoveryHealPercent:15,crowdFavoriteStrengthBuff:20,focusOffensiveStrengthBuff:20,focusOffensiveAgilityChange:-5,focusOffensiveEnduranceChange:-10,focusDefensiveStrengthChange:-10,focusDefensiveAgilityBuff:5,focusDefensiveEnduranceBuff:20,focusBalancedStrengthChange:5,focusBalancedAgilityChange:5,focusBalancedEnduranceChange:5,comebackStrengthBuff:25,comebackEnduranceChange:-10,buffDuration:5,focusShiftDuration:7,counterDamageMultiplier:1.15},comboAttacks:{strengthMultiplier:.12,minStrengthBonus:.7,maxStrengthBonus:1.25,doubleStrikeMultiplier:.4,tripleComboMultiplier:.3,comboEvasion:{enabled:!0,agilityBonus:.2,ratioThreshold:.5,maxBonus:.7,hitNumberMultiplier:.15}},rewards:{enabled:!0,baseReward:1,scalingEnabled:!1,consolationReward:0},cooldown:{durationMinutes:5}},Qt={baseTrainingTime:1*60*1e3,growthRate:.09,maxTrainingTimeHours:3,rewards:{trainingPoints:1,statIncrease:1},maxLevels:{strength:100,agility:100,endurance:100},restMultiplier:{enabled:!0,accumulationRate:1,baseMaxPoints:60,pointsPerLevel:2,maxMultiplier:4,multiplierCalculation:"linear"},devMode:!1,devModeSpeedMultiplier:99999},xs=Object.freeze(Object.defineProperty({__proto__:null,default:Qt,trainingConfig:Qt},Symbol.toStringTag,{value:"Module"})),ot={startingStats:{strength:10,agility:10,endurance:10,trainingPoints:0},limits:{maxStrength:100,maxAgility:100,maxEndurance:100,maxStrengthModifier:.9,maxAgilityModifier:.9,maxEnduranceModifier:.9},antiCheat:{enabled:!0,training:{maxDailyGainPerStat:20,fightBasedCaps:[[0,20],[5,30],[10,40],[20,60],[40,80],[60,100]],suspiciousGapThreshold:8,maxOfflineGainPerHour:8,maxBackgroundHours:24}},skillEffects:{stackingType:"multiplicative"},boostItems:{cost:10,boostPercentage:50,dailyLimit:3},skillScaling:{enabled:!0,statDivisor:100,skillDivisor:20}},NI=()=>typeof window<"u"?new URLSearchParams(window.location.search).get("devToken")==="stupidbear":!1;NI();const pf=Object.freeze(Object.defineProperty({__proto__:null,combatConfig:ae,playerConfig:ot,trainingConfig:Qt},Symbol.toStringTag,{value:"Module"})),$e=Dr("player",()=>{const{startingStats:t}=ot,e=ue("Fighter"),n=ue(t.strength),s=ue(t.agility),i=ue(t.endurance),r=ue(t.trainingPoints),o=ue([]),l=ue(null),c=ue([]),u=ue(0),h=ue(Date.now()),f=ue({}),m=ue({}),y=ue({wins:0,losses:0,totalFights:0,winRate:0}),C=ue({perfectBlocks:0,criticalStrikes:0,counterAttacks:0,firstStrikes:0,comebackVictories:0,quickWins:0,nightFighter:0,morningWarrior:0,giantKillerOpponents:[],lastUpdated:0}),D=ue({lastTraining:{strength:0,agility:0,endurance:0},dailyCounts:{strength:0,agility:0,endurance:0,date:""},statHistory:{strength:[],agility:[],endurance:[]},suspiciousActivity:[]});function S(){e.value="Fighter",n.value=t.strength,s.value=t.agility,i.value=t.endurance,r.value=t.trainingPoints,o.value=[],l.value=null,c.value=[],u.value=0,h.value=Date.now(),f.value={},de.value={},m.value={},y.value={wins:0,losses:0,totalFights:0,winRate:0},C.value={perfectBlocks:0,criticalStrikes:0,counterAttacks:0,firstStrikes:0,comebackVictories:0,quickWins:0,nightFighter:0,morningWarrior:0,giantKillerOpponents:[],lastUpdated:0},D.value={lastTraining:{strength:0,agility:0,endurance:0},dailyCounts:{strength:0,agility:0,endurance:0,date:new Date().toISOString().split("T")[0]},statHistory:{strength:[],agility:[],endurance:[]},suspiciousActivity:[]}}function M(x){var Vt;if(!((Vt=ot.skillScaling)!=null&&Vt.enabled))return 1;const fe=sn().ownedSkills.length;let be;switch(x){case"strength":be=n.value;break;case"agility":be=s.value;break;case"endurance":be=i.value;break;default:be=0}const Se=ot.skillScaling.statDivisor,Ve=ot.skillScaling.skillDivisor,ze=1/(1+be/Se),ut=1/(1+fe/Ve);return ze*ut}const P=Le(()=>M("strength")),V=Le(()=>M("agility")),R=Le(()=>M("endurance")),H=Le(()=>{const x=sn();n.value;let te=1;for(const be of x.ownedSkills){const Se=x.getSkillByName(be);if(Se&&Se.strength!==0){const Ve=Se.strength/100*P.value;te*=1+Ve}}l.value==="strength"&&(te*=1+ot.boostItems.boostPercentage/100);const fe=Math.min(te,1+ot.limits.maxStrengthModifier);return Math.round(n.value*fe)}),O=Le(()=>{const x=sn();s.value;let te=1;for(const be of x.ownedSkills){const Se=x.getSkillByName(be);if(Se&&Se.agility!==0){const Ve=Se.agility/100*V.value;te*=1+Ve}}l.value==="agility"&&(te*=1+ot.boostItems.boostPercentage/100);const fe=Math.min(te,1+ot.limits.maxAgilityModifier);return Math.round(s.value*fe)}),I=Le(()=>{const x=sn();i.value;let te=1;for(const be of x.ownedSkills){const Se=x.getSkillByName(be);if(Se&&Se.endurance!==0){const Ve=Se.endurance/100*R.value;te*=1+Ve}}l.value==="endurance"&&(te*=1+ot.boostItems.boostPercentage/100);const fe=Math.min(te,1+ot.limits.maxEnduranceModifier);return Math.round(i.value*fe)});function E(){var x;return(x=ot.antiCheat)!=null&&x.enabled?oe():(n.value++,Re(),!0)}function v(){var x;return(x=ot.antiCheat)!=null&&x.enabled?ge():(s.value++,Re(),!0)}function _(){var x;return(x=ot.antiCheat)!=null&&x.enabled?he():(i.value++,Re(),!0)}function T(x){r.value+=x,Re()}function b(x){return r.value>=x?(r.value-=x,Re(),!0):!1}function A(x){o.value.includes(x)||(o.value.push(x),Re())}const de=ue({});function W(x,te=!0){f.value[x]||(f.value[x]=0),f.value[x]++,te&&(de.value[x]||(de.value[x]=0),de.value[x]++),m.value[x]=Date.now(),Re()}function q(x){return f.value[x]||0}function G(x){return de.value[x]||0}function Q(x){const te=m.value[x];if(!te||G(x)===0)return!1;const Se=ae.cooldown.durationMinutes*60*1e3;return Date.now()-te<Se}function le(x){if(G(x)===0)return null;const fe=m.value[x];if(!fe)return null;const Ve=ae.cooldown.durationMinutes*60*1e3-(Date.now()-fe);return Ve<=0?null:`${Math.ceil(Ve/(60*1e3))}m`}function ke(){y.value.wins++,y.value.totalFights++,Fe(),Re()}function Ge(){y.value.losses++,y.value.totalFights++,Fe(),Re()}function Fe(){y.value.totalFights>0?y.value.winRate=Math.round(y.value.wins/y.value.totalFights*100):y.value.winRate=0}function ie(){C.value.perfectBlocks++,C.value.lastUpdated=Date.now(),Re()}function F(){C.value.criticalStrikes++,C.value.lastUpdated=Date.now(),Re()}function me(){C.value.counterAttacks++,C.value.lastUpdated=Date.now(),Re()}function Te(){C.value.firstStrikes++,C.value.lastUpdated=Date.now(),Re()}function xe(){C.value.comebackVictories++,C.value.lastUpdated=Date.now(),Re()}function Xe(){C.value.quickWins++,C.value.lastUpdated=Date.now(),Re()}function et(){const x=new Date().getHours();(x>=22||x<4)&&C.value.nightFighter++,x>=5&&x<9&&C.value.morningWarrior++,C.value.lastUpdated=Date.now(),Re()}function rt(x,te){te>=30&&(C.value.giantKillerOpponents.includes(x)||(C.value.giantKillerOpponents.push(x),C.value.lastUpdated=Date.now(),Re()))}function Re(){oa("playerData",{playerName:e.value,strength:n.value,agility:s.value,endurance:i.value,trainingPoints:r.value,defeatedOpponents:o.value,fightStats:y.value,opponentFightCounts:f.value,opponentVictoryCounts:de.value,opponentLastFights:m.value,trainingHistory:D.value,activeBoost:l.value,boostPurchases:c.value,achievements:C.value,restPoints:u.value,lastRestCheck:h.value})}function k(){var te;const x=Cc("playerData");if(x){if(x.playerName&&(e.value=x.playerName),n.value=x.strength,s.value=x.agility,i.value=x.endurance,r.value=x.trainingPoints,o.value=x.defeatedOpponents||[],x.activeBoost!==void 0&&(l.value=x.activeBoost),x.boostPurchases!==void 0?c.value=x.boostPurchases:x.lastBoostPurchase&&(c.value=[x.lastBoostPurchase]),x.fightStats&&(y.value=x.fightStats),x.opponentFightCounts&&(f.value=x.opponentFightCounts),x.opponentVictoryCounts?de.value=x.opponentVictoryCounts:x.opponentFightCounts&&(de.value={...x.opponentFightCounts}),x.opponentLastFights&&(m.value=x.opponentLastFights),x.trainingHistory){D.value=x.trainingHistory;const fe=new Date().toISOString().split("T")[0];D.value.dailyCounts.date!==fe&&(D.value.dailyCounts={strength:0,agility:0,endurance:0,date:fe})}else D.value={lastTraining:{strength:0,agility:0,endurance:0},dailyCounts:{strength:0,agility:0,endurance:0,date:new Date().toISOString().split("T")[0]},statHistory:{strength:[n.value],agility:[s.value],endurance:[i.value]},suspiciousActivity:[]};(te=ot.antiCheat)!=null&&te.enabled&&N(),x.achievements&&(C.value=x.achievements),x.restPoints!==void 0&&(u.value=x.restPoints),x.lastRestCheck!==void 0?h.value=x.lastRestCheck:h.value=Date.now()}}function N(){var Ve;if(!((Ve=ot.antiCheat)!=null&&Ve.enabled))return;const x=y.value.totalFights,te=ot.antiCheat.training.fightBasedCaps;let fe=100;for(const[ze,ut]of te)if(x<ze){fe=ut;break}let be=!1,Se=`Enforced fight-based caps (${x} fights, max: ${fe}): `;if(n.value>fe){const ze=n.value;n.value=fe,be=!0,Se+=`STR ${ze}->${fe} `}if(s.value>fe){const ze=s.value;s.value=fe,be=!0,Se+=`AGI ${ze}->${fe} `}if(i.value>fe){const ze=i.value;i.value=fe,be=!0,Se+=`END ${ze}->${fe}`}be&&(D.value.suspiciousActivity.push({timestamp:Date.now(),type:"fight_cap_applied",details:Se}),ne(),console.log(Se))}function U(x,te,fe){var Ve;if(!((Ve=ot.antiCheat)!=null&&Ve.enabled))return!1;const be=ot.antiCheat.training.suspiciousGapThreshold,Se=fe-te;if(Se>be){const ze={timestamp:Date.now(),type:"suspicious_stat_jump",details:`${x}: ${te} -> ${fe} (jump of ${Se})`};return D.value.suspiciousActivity.push(ze),console.warn(`Suspicious stat jump detected: ${ze.details}`),!0}return!1}function ne(){D.value.statHistory.strength.push(n.value),D.value.statHistory.agility.push(s.value),D.value.statHistory.endurance.push(i.value);const x=10;D.value.statHistory.strength.length>x&&(D.value.statHistory.strength=D.value.statHistory.strength.slice(-10)),D.value.statHistory.agility.length>x&&(D.value.statHistory.agility=D.value.statHistory.agility.slice(-10)),D.value.statHistory.endurance.length>x&&(D.value.statHistory.endurance=D.value.statHistory.endurance.slice(-10))}function J(x){var be;if(!((be=ot.antiCheat)!=null&&be.enabled))return!0;const te=new Date().toISOString().split("T")[0];D.value.dailyCounts.date!==te&&(D.value.dailyCounts={strength:0,agility:0,endurance:0,date:te}),D.value.dailyCounts[x]++,D.value.lastTraining[x]=Date.now();const fe=ot.antiCheat.training.maxDailyGainPerStat;return D.value.dailyCounts[x]>fe?(D.value.suspiciousActivity.push({timestamp:Date.now(),type:"daily_limit_reached",details:`${x} daily training limit reached (${fe})`}),console.warn(`Daily training limit reached for ${x}`),!1):!0}function oe(){if(!J("strength"))return!1;const x=n.value;return n.value++,U("strength",x,n.value),ne(),N(),Re(),!0}function ge(){if(!J("agility"))return!1;const x=s.value;return s.value++,U("agility",x,s.value),ne(),N(),Re(),!0}function he(){if(!J("endurance"))return!1;const x=i.value;return i.value++,U("endurance",x,i.value),ne(),N(),Re(),!0}function ce(){St(async()=>{const{useTrainingStore:x}=await Promise.resolve().then(()=>xI);return{useTrainingStore:x}},void 0).then(({useTrainingStore:x})=>{St(async()=>{const{trainingConfig:te}=await Promise.resolve().then(()=>xs);return{trainingConfig:te}},void 0).then(({trainingConfig:te})=>{if(!te.restMultiplier.enabled)return;const fe=x();if(console.log(`Checking rest points - Is player training: ${fe.isTraining}`),fe.isTraining)console.log("Player is training - updating lastRestCheck timestamp without adding points"),h.value=Date.now(),Re();else{const be=Date.now(),Se=(be-h.value)/(60*1e3);if(console.log(`Time since last rest check: ${Se.toFixed(2)} minutes`),Se>0){const Ve=Se*te.restMultiplier.accumulationRate,ze=Math.floor(Ve);if(ze>0||Ve>0){const Vt=Math.min(u.value+ze,4);console.log(`Adding rest points: ${u.value} + ${ze} = ${Vt} (capped at 4)`),u.value=Vt;const Ts=ze/te.restMultiplier.accumulationRate,_t=h.value+Ts*60*1e3;Vt>=4?h.value=be:h.value=_t,Re()}}}}).catch(te=>{console.error("Error loading training config:",te)})}).catch(x=>{console.error("Error loading training store:",x)})}async function re(){try{const{trainingConfig:x}=await St(async()=>{const{trainingConfig:te}=await Promise.resolve().then(()=>xs);return{trainingConfig:te}},void 0);return x.restMultiplier.enabled?4:0}catch(x){return console.error("Error loading training config:",x),0}}async function Ie(x){if(x<=0||x>u.value)return 1;try{const{trainingConfig:te}=await St(async()=>{const{trainingConfig:Ve}=await Promise.resolve().then(()=>xs);return{trainingConfig:Ve}},void 0);if(!te.restMultiplier.enabled)return 1;const fe=await re(),Se=1+x/fe*(te.restMultiplier.maxMultiplier-1);return console.log(`Deducting ${x} rest points from ${u.value}`),u.value-=x,console.log(`New rest points: ${u.value}`),Re(),Se}catch(te){return console.error("Error loading training config:",te),1}}async function ve(x){try{const{trainingConfig:te}=await St(async()=>{const{trainingConfig:Se}=await Promise.resolve().then(()=>xs);return{trainingConfig:Se}},void 0);if(!te.restMultiplier.enabled||(x=Math.min(x,u.value),x<=0))return 1;const fe=await re();return 1+x/fe*(te.restMultiplier.maxMultiplier-1)}catch(te){return console.error("Error loading training config:",te),1}}function we(x){e.value=x,Re()}return{playerName:e,strength:n,agility:s,endurance:i,trainingPoints:r,defeatedOpponents:o,fightStats:y,opponentFightCounts:f,opponentVictoryCounts:de,opponentLastFights:m,trainingHistory:D,achievements:C,activeBoost:l,boostPurchases:c,restPoints:u,lastRestCheck:h,updateRestPoints:ce,getMaxRestPoints:re,useRestPoints:Ie,calculateRestMultiplier:ve,effectiveStrength:H,effectiveAgility:O,effectiveEndurance:I,strengthScalingFactor:P,agilityScalingFactor:V,enduranceScalingFactor:R,calculateSkillScalingFactor:M,setPlayerName:we,increaseStrength:E,increaseAgility:v,increaseEndurance:_,addTrainingPoints:T,spendTrainingPoints:b,addDefeatedOpponent:A,addWin:ke,addLoss:Ge,updateWinRate:Fe,savePlayerData:Re,loadPlayerData:k,trackOpponentFight:W,getOpponentFightCount:q,getOpponentVictoryCount:G,isOpponentOnCooldown:Q,getOpponentCooldownTime:le,trackPerfectBlock:ie,trackCriticalStrike:F,trackCounterAttack:me,trackFirstStrike:Te,trackComebackVictory:xe,trackQuickWin:Xe,trackTimeBasedWin:et,trackGiantKillerVictory:rt,enforceFightBasedStatCaps:N,checkForSuspiciousStatJump:U,updateStatHistory:ne,updateDailyTrainingCount:J,$reset:S}}),Di=Dr("training",()=>{const t=ue(!1),e=ue(null),n=ue(0),s=ue(0),i=ue(!1);let r=null;function o(){t.value=!1,e.value=null,n.value=0,s.value=0,i.value=!1,r&&(clearInterval(r),r=null),localStorage.removeItem("pendingTraining")}const l=Le(()=>{if(!t.value)return 0;const O=Date.now()-n.value;return Math.min(O/1e3,s.value/1e3)}),c=Le(()=>s.value===0?0:(Date.now()-n.value)/s.value*100),u=Le(()=>{if(!t.value)return"0:00";const O=Date.now()-n.value,I=Math.max(0,(s.value-O)/1e3),E=Math.floor(I/3600),v=Math.floor(I%3600/60),_=Math.floor(I%60);return E>0?`${E}h ${v}m ${_}s`:`${v}:${_<10?"0":""}${_}`});function h(O){const E=$e()[O],v=Qt.baseTrainingTime/1e3,_=Qt.growthRate;let T=v*Math.pow(1+_,E-1);const b=Qt.maxTrainingTimeHours*60*60;return T>b&&(console.log(`Training time for ${O} level ${E} capped from ${(T/3600).toFixed(2)}h to ${Qt.maxTrainingTimeHours}h`),T=b),T*1e3}function f(O){const I=h(O)/1e3,E=Math.floor(I/3600),v=Math.floor(I%3600/60),_=Math.floor(I%60);return E>0?`${E}h ${v}m ${_}s`:`${v}:${_<10?"0":""}${_}`}function m(O,I=!1,E=0){if(t.value)return!1;r&&clearInterval(r);const v=h(O);if(t.value=!0,e.value=O,n.value=Date.now(),i.value=I,localStorage.getItem("fastTraining")==="true")localStorage.removeItem("fastTraining"),St(async()=>{const{trainingConfig:T}=await Promise.resolve().then(()=>xs);return{trainingConfig:T}},void 0).then(({trainingConfig:T})=>{const b=T.restMultiplier.maxMultiplier,A=Math.max(b,3),de=Math.round(v/A),W=v*.75;s.value=Math.min(de,W),console.log(`Fast training applied: ${v/1e3}s → ${s.value/1e3}s (${A}x)`),R()}).catch(T=>{console.error("Error loading training config for fast training:",T),s.value=v});else if(E>0){const T=$e();(async()=>{try{const{trainingConfig:A}=await St(async()=>{const{trainingConfig:G}=await Promise.resolve().then(()=>xs);return{trainingConfig:G}},void 0);if(!A.restMultiplier.enabled){s.value=v;return}const de=A.restMultiplier.maxMultiplier,W=Math.round(v/de);s.value=W,console.log(`Fast training (old method): ${v/1e3}s → ${W/1e3}s (${de}x)`);const q=await T.useRestPoints(E);R()}catch(A){console.error("Error in fast training:",A),s.value=v}})()}else s.value=v;return gs("training_started",{stat_type:O,continuous:I,duration_seconds:s.value/1e3,rest_points_used:E}),C(),R(),!0}function y(){return i.value=!i.value,R(),i.value}function C(){r=setInterval(()=>{if(!t.value){clearInterval(r);return}if(Date.now()-n.value>=s.value){if(D(),i.value){const I=e.value;setTimeout(()=>{m(I,!0)},100)}else clearInterval(r);return}},2e3)}function D(){const O=$e(),I=e.value;let E=!0;I==="strength"?E=O.increaseStrength():I==="agility"?E=O.increaseAgility():I==="endurance"&&(E=O.increaseEndurance()),E&&O.addTrainingPoints(Qt.rewards.trainingPoints),gs("training_completed",{stat_type:I,continuous:i.value,new_stat_value:O[I]});try{St(async()=>{const{saveAndSyncProgress:T}=await Promise.resolve().then(()=>cc);return{saveAndSyncProgress:T}},void 0).then(({saveAndSyncProgress:T})=>{T()}).catch(T=>{console.error("Could not sync with leaderboard:",T)})}catch(T){console.error("Could not import leaderboard module:",T)}const v=h(I),_=s.value<v*.75;if(console.log(`Completing training - base time: ${v/1e3}s, actual time: ${s.value/1e3}s`),console.log(`Was fast training: ${_}, Continuous mode: ${i.value}`),!i.value)console.log("Not in continuous mode - resetting training state"),S();else{console.log("In continuous mode - preparing for next training session"),t.value=!1,n.value=0,s.value=0,console.log(`Training state partially reset: isTraining=${t.value}, currentStat=${e.value}`);const T=O.restPoints>=P;console.log(`Continuous training: Was fast training: ${_}, Has ${O.restPoints} rest points`),_&&T&&(console.log("Setting fastTraining flag for next continuous session"),localStorage.setItem("fastTraining","true"),O.$patch({restPoints:O.restPoints-P}),O.savePlayerData())}}function S(){console.log(`RESETTING TRAINING STATE: was training=${t.value}, stat=${e.value}`),t.value=!1,e.value=null,n.value=0,s.value=0,i.value=!1,r&&(clearInterval(r),r=null),localStorage.removeItem("pendingTraining"),localStorage.removeItem("fastTraining"),console.log(`TRAINING STATE RESET COMPLETE: isTraining=${t.value}`)}function M(){const O=$e();console.log("=== CHECKING PENDING TRAINING ==="),console.log(`Current rest points: ${O.restPoints}`),console.log(`isTraining: ${t.value}, currentStat: ${e.value}`);const I=localStorage.getItem("pendingTraining");if(I)try{let E;if(I.startsWith("{"))E=JSON.parse(I);else{const v=localStorage.getItem(I);if(v){(async function(){try{const{decryptData:_}=await St(async()=>{const{decryptData:b}=await Promise.resolve().then(()=>Yd);return{decryptData:b}},void 0),{playerConfig:T}=await St(async()=>{const{playerConfig:b}=await Promise.resolve().then(()=>pf);return{playerConfig:b}},void 0);E=_(v),localStorage.removeItem(I),await V(E)}catch(_){console.error("Error importing decryption module:",_);try{E=JSON.parse(I),await V(E)}catch(T){console.error("Failed to parse training data:",T),localStorage.removeItem("pendingTraining")}}})();return}else try{E=JSON.parse(I)}catch{localStorage.removeItem("pendingTraining");return}}(async()=>{try{await V(E)}catch(v){console.error("Error processing pending training:",v),localStorage.removeItem("pendingTraining")}})()}catch(E){console.error("Error parsing pending training data:",E),localStorage.removeItem("pendingTraining"),O.updateRestPoints()}else O.updateRestPoints()}const P=2;async function V(O){var E,v;if(!O||!O.stat){localStorage.removeItem("pendingTraining"),$e().updateRestPoints();return}console.log("=== PROCESSING PENDING TRAINING ==="),console.log(`Training data: ${JSON.stringify(O)}`);const I=$e();console.log(`Current rest points: ${I.restPoints}`);try{if(O&&O.startTime&&O.stat){const _=Date.now(),T=O.duration||h(O.stat),b=h(O.stat),A=O.continuous||!1,de=O.saveTime||O.startTime,W=(_-de)/1e3;if(A){console.log(`Training recovery - Checking continuous training sessions for ${O.stat}`),console.log(`Start time: ${O.startTimeISO||new Date(O.startTime).toISOString()}`),console.log(`Save time: ${O.saveTimeISO||new Date(O.saveTime).toISOString()}`),console.log(`Current time: ${new Date(_).toISOString()}`),console.log(`Time since save: ${W} seconds`),console.log(`Training duration: ${T/1e3} seconds`);const q=$e();let G=0,Q=W,le=q[O.stat];const ke=O.saveTime||O.startTime,Ge=(_-ke)/1e3,Fe=O.startTime,ie=(ke-Fe)/1e3;_<ke&&(console.warn(`SUSPICIOUS TIME: Save timestamp (${new Date(ke).toISOString()}) is in the future. Possible time manipulation detected.`),q.trainingHistory.suspiciousActivity.push({timestamp:_,type:"time_manipulation",details:`Future timestamp detected: save time ${new Date(ke).toISOString()} vs current time ${new Date(_).toISOString()}`}),Q=0,G=0);const{playerConfig:F}=await St(async()=>{const{playerConfig:Te}=await Promise.resolve().then(()=>pf);return{playerConfig:Te}},void 0);let me=24;if((E=F.antiCheat)!=null&&E.enabled){me=F.antiCheat.training.maxBackgroundHours;const Te=me*3600;Q>Te&&(console.warn(`EXCESSIVE OFFLINE TIME: ${(Q/3600).toFixed(1)} hours exceeds limit of ${me} hours.`),q.trainingHistory.suspiciousActivity.push({timestamp:_,type:"excessive_offline_time",details:`${(Q/3600).toFixed(1)} hours exceeds limit of ${me} hours`}),Q=Te)}for(let Te=0;Te<500;Te++){let Xe=Qt.baseTrainingTime/1e3*Math.pow(1+Qt.growthRate,le-1);const et=Qt.maxTrainingTimeHours*60*60;if(Xe>et&&(Xe=et),Q<Xe)break;G++,Q-=Xe,le++}if((v=F.antiCheat)!=null&&v.enabled){const Te=F.antiCheat.training.maxDailyGainPerStat;if(G>Te&&(console.log(`RATE LIMITING: Capping training gain from ${G} to ${Te}`),q.trainingHistory.suspiciousActivity.push({timestamp:_,type:"excessive_training_gain",details:`Capped ${O.stat} gain from ${G} to ${Te}`}),G=Te),W>3600){const xe=F.antiCheat.training.maxOfflineGainPerHour,Xe=F.antiCheat.training.maxBackgroundHours,et=W/3600,rt=Math.ceil(Math.min(xe*Xe,Math.log(et+1)*xe));G>rt&&(console.log(`TIME LIMITING: Capping ${G} sessions to ${rt} for ${et.toFixed(2)} hours`),q.trainingHistory.suspiciousActivity.push({timestamp:_,type:"hourly_limit_exceeded",details:`Capped ${O.stat} gain from ${G} to ${rt} for ${et.toFixed(1)} hours`}),G=rt)}}else if(G>20&&(console.log(`RATE LIMITING: Capping training gain from ${G} to 20`),G=20),W>3600){const Xe=W/3600,et=Math.ceil(Math.min(24,Math.log(Xe+1)*8));G>et&&(console.log(`TIME LIMITING: Capping ${G} sessions to ${et} for ${Xe.toFixed(2)} hours`),G=et)}if(console.log(`Simulated ${G} progressively longer training sessions`),console.log(`Starting level: ${q[O.stat]}, Final level: ${q[O.stat]+G}`),console.log(`Remaining time: ${Q} seconds`),G>0){let Te=0;if(O.isFastTraining){const Re=Math.min(4,q.restPoints+P);console.log(`Initial rest points (estimated): ${Re}`);const k=Math.floor(Re/P);console.log(`Possible fast sessions with ${Re} rest points: ${k}`),Te=Math.min(k,G),console.log(`Will apply ${Te} fast sessions out of ${G} total sessions`);const N=Te*P;if(N>0){const U=Math.max(0,Re-N);console.log(`Deducting ${N} rest points: ${Re} -> ${U}`),q.$patch({restPoints:U}),q.savePlayerData()}}for(let Re=0;Re<G;Re++)O.stat==="strength"?q.increaseStrength():O.stat==="agility"?q.increaseAgility():O.stat==="endurance"&&q.increaseEndurance(),q.addTrainingPoints(Qt.rewards.trainingPoints);console.log(`Applied ${G} training sessions for ${O.stat}`);const xe=W%(T/1e3),Xe=O.isFastTraining||!1;t.value=!0,e.value=O.stat,i.value=!0,n.value=_-xe*1e3;const et=q.restPoints===0,rt=q.restPoints>=P;et?(console.log("***FORCING NORMAL SPEED - ZERO REST POINTS LEFT***"),s.value=b,localStorage.removeItem("fastTraining")):Xe&&rt?(s.value=T,console.log("Restored fast training with boosted duration - player has rest points available"),localStorage.setItem("fastTraining","true"),q.$patch({restPoints:q.restPoints-P}),q.savePlayerData()):(s.value=b,console.log(Xe?"Previous training was fast, but no rest points left - switching to normal speed":"Continuing with normal training speed"),localStorage.removeItem("fastTraining")),C()}else{console.log("No full sessions completed, resuming from previous state");const Te=O.saveTime||O.startTime,xe=Math.max(0,(Te-O.startTime)/1e3),Xe=xe+W,et=Xe%(T/1e3);if(console.log(`Elapsed before save: ${xe} seconds`),console.log(`Total elapsed: ${Xe} seconds`),console.log(`Calculated remaining time: ${et} seconds`),O.isFastTraining||!1){console.log("Restoring a fast training session");const Re=O.fastSessionPaid===!0;console.log(`Fast session already paid for: ${Re}`);const k=$e();console.log(`Current rest points: ${k.restPoints}`);const N=k.restPoints===0,U=!N&&(Re||k.restPoints>=P);N?(console.log("***FORCING NORMAL SPEED - ZERO REST POINTS LEFT***"),t.value=!0,e.value=O.stat,i.value=!0,n.value=_-et*1e3,s.value=b,localStorage.removeItem("fastTraining")):U?(console.log(`Fast training can continue - consuming ${P} rest points`),Re?console.log("Session already paid for - not deducting rest points"):(console.log("Deducting rest points for fast training session"),k.$patch({restPoints:k.restPoints-P}),k.savePlayerData()),t.value=!0,e.value=O.stat,i.value=!0,n.value=_-et*1e3,s.value=T,localStorage.setItem("fastTraining","true")):(console.log("Not enough rest points to continue fast training - switching to normal speed"),t.value=!0,e.value=O.stat,i.value=!0,n.value=_-et*1e3,s.value=b,localStorage.removeItem("fastTraining")),C()}else t.value=!0,e.value=O.stat,i.value=!0,n.value=_-et*1e3,s.value=b,C()}}else{console.log(`Training recovery - Checking single training session for ${O.stat}`),console.log(`Start time: ${O.startTimeISO||new Date(O.startTime).toISOString()}`),console.log(`Save time: ${O.saveTimeISO||new Date(O.saveTime).toISOString()}`),console.log(`Current time: ${new Date(_).toISOString()}`);const q=O.saveTime||O.startTime,G=Math.max(0,(q-O.startTime)/1e3),Q=G+W;if(console.log(`Original elapsed: ${G} seconds`),console.log(`Time since save: ${W} seconds`),console.log(`Total elapsed: ${Q} seconds`),console.log(`Training duration: ${T/1e3} seconds`),Q>=T/1e3){console.log("Single training session completed while away");const le=$e();if(W>T/1e3*4&&console.log(`SUSPICIOUS TIMING: Time since save (${W}s) is much larger than training duration (${T/1e3}s)`),O.stat==="strength"?le.increaseStrength():O.stat==="agility"?le.increaseAgility():O.stat==="endurance"&&le.increaseEndurance(),le.addTrainingPoints(Qt.rewards.trainingPoints),O.isFastTraining&&(console.log("Single fast training session completed while away"),O.continuous)){const ke=Math.min(4,le.restPoints+P);if(console.log(`Initial rest points (estimated): ${ke}`),ke>=P*2){const Ge=P,Fe=ke-Ge;console.log(`Deducting ${Ge} rest points: ${ke} -> ${Fe}`),le.$patch({restPoints:Fe}),Fe>=P&&(console.log("Setting up next fast training session after auto-completion"),localStorage.setItem("fastTraining","true")),le.savePlayerData()}}localStorage.removeItem("pendingTraining")}else{console.log(`Resuming session with ${T/1e3-Q} seconds remaining`);const le=O.isFastTraining||!1;console.log(`Is fast training: ${le}`),t.value=!0,e.value=O.stat,i.value=O.continuous||!1,n.value=_-Q*1e3;const ke=I.restPoints>=P;le&&ke?(s.value=T,console.log("Restored fast training with boosted duration - player has rest points available"),localStorage.setItem("fastTraining","true"),I.$patch({restPoints:I.restPoints-P}),I.savePlayerData()):(s.value=b,console.log(le?"Previous training was fast, but no rest points left - switching to normal speed":"Continuing with normal training speed"),localStorage.removeItem("fastTraining")),C()}}}}catch(_){console.error("Error processing pending training data:",_)}finally{localStorage.removeItem("pendingTraining"),$e().updateRestPoints()}}function R(){if(t.value){const O=Date.now(),I=h(e.value),E=s.value<I*.9,v=localStorage.getItem("fastTraining")==="true";console.log(`Saving training state - base time: ${I/1e3}s, actual time: ${s.value/1e3}s`),console.log(`Fast training detected by duration: ${E}`),console.log(`Fast training flag in localStorage: ${v}`);const _=E||v;console.log(`Final fast training determination: ${_}`);const T={stat:e.value,startTime:n.value,startTimeISO:new Date(n.value).toISOString(),saveTime:O,saveTimeISO:new Date(O).toISOString(),duration:s.value,continuous:i.value,originalDuration:I,isFastTraining:_,fastSessionPaid:_};console.log(`Saving training state at: ${T.saveTimeISO}`);try{(async function(){try{const{encryptData:b}=await St(async()=>{const{encryptData:de}=await Promise.resolve().then(()=>Yd);return{encryptData:de}},void 0),A="train_"+Math.random().toString(36).substring(2,10)+"_data";localStorage.setItem("pendingTraining",A),localStorage.setItem(A,b(T))}catch(b){console.error("Error importing encryption:",b),localStorage.setItem("pendingTraining",JSON.stringify(T))}})()}catch(b){console.error("Error in async wrapper:",b),localStorage.setItem("pendingTraining",JSON.stringify({stat:e.value,startTime:n.value,saveTime:Date.now(),duration:s.value,continuous:i.value}))}}else{const O=localStorage.getItem("pendingTraining");O&&!O.startsWith("{")&&localStorage.removeItem(O),localStorage.removeItem("pendingTraining")}}function H(){r&&(clearInterval(r),r=null),R()}return{isTraining:t,currentStat:e,trainingStartTime:n,trainingDuration:s,continuousTraining:i,trainingElapsed:l,trainingProgress:c,trainingTimeRemaining:u,getTrainingTime:h,getFormattedTrainingTime:f,startTraining:m,toggleContinuousTraining:y,completeTraining:D,resetTraining:S,checkPendingTraining:M,saveTrainingState:R,cleanup:H,$reset:o}}),xI=Object.freeze(Object.defineProperty({__proto__:null,useTrainingStore:Di},Symbol.toStringTag,{value:"Module"})),ct=(t,e)=>{const n=t.__vccOpts||t;for(const[s,i]of e)n[s]=i;return n},VI={class:"stat-header"},FI={class:"stat-label"},$I={class:"stat-value"},LI={key:0,class:"effective-value"},BI={class:"training-controls"},UI=["disabled"],HI={key:1,class:"continuous-option"},jI={class:"continuous-label"},KI=["checked"],El=2,qI={__name:"StatTraining",props:{stat:{type:String,required:!0},label:{type:String,required:!0},value:{type:Number,required:!0},showEffective:{type:Boolean,default:!0}},setup(t){const e=t,n=Di(),s=$e(),i=Le(()=>n.getFormattedTrainingTime(e.stat)),r=ue(1);Wt(async()=>{try{const{trainingConfig:y}=await St(async()=>{const{trainingConfig:C}=await Promise.resolve().then(()=>xs);return{trainingConfig:C}},void 0);r.value=y.restMultiplier.maxMultiplier}catch(y){console.error("Error loading max multiplier:",y),r.value=3}});const o=Le(()=>{const y=n.getTrainingTime(e.stat),D=Math.round(y/3)/1e3,S=Math.floor(D/3600),M=Math.floor(D%3600/60),P=Math.floor(D%60);return S>0?`${S}h ${M}m ${P}s`:`${M}:${P<10?"0":""}${P}`}),l=Le(()=>e.stat==="strength"?s.effectiveStrength:e.stat==="agility"?s.effectiveAgility:e.stat==="endurance"?s.effectiveEndurance:e.value),c=Le(()=>n.isTraining&&n.currentStat===e.stat);function u(){c.value?m():n.startTraining(e.stat,!1,0)}function h(){if(n.isTraining||s.restPoints<El)return;const y=El;f(e.stat,y)}function f(y,C){const D=s.restPoints;console.log(`Using fast training: ${D} points - ${C} = ${D-C}`),s.$patch({restPoints:D-C}),s.savePlayerData(),localStorage.setItem("fastTraining","true"),n.startTraining(y,!1),console.log(`Fast training started using ${C} rest points`)}function m(){n.toggleContinuousTraining()}return(y,C)=>(B(),K("div",{class:Oe(["stat-training",t.stat])},[g("div",VI,[g("div",FI,L(t.label),1),g("div",$I,L(t.value),1),t.showEffective&&Math.round(l.value)!==t.value?(B(),K("div",LI," ("+L(Math.round(l.value))+") ",1)):X("v-if",!0)]),g("div",BI,[g("button",{onClick:u,disabled:ee(n).isTraining&&ee(n).currentStat!==t.stat,class:Oe(["train-button",[t.stat,{active:ee(n).isTraining&&ee(n).currentStat===t.stat}]])}," Train ("+L(i.value)+") ",11,UI),!ee(n).isTraining&&ee(s).restPoints>=El?(B(),K("button",{key:0,onClick:h,class:Oe(["rest-boost-button",t.stat])}," Fast Train ("+L(o.value)+") ",3)):X("v-if",!0),ee(n).isTraining&&ee(n).currentStat===t.stat?(B(),K("div",HI,[g("label",jI,[g("input",{type:"checkbox",checked:ee(n).continuousTraining,onChange:m},null,40,KI),C[0]||(C[0]=g("span",{class:"checkbox-text"},"Repeat",-1))])])):X("v-if",!0)])],2))}},Tl=ct(qI,[["__scopeId","data-v-0b4175f9"]]),GI={class:"progress-header"},WI={class:"training-info"},zI={key:0,class:"continuous-badge"},YI={class:"time-remaining"},QI={class:"static-progress"},XI={__name:"TrainingProgress",setup(t){const e=Di(),n=ue(""),s=ue(0),i=ue("0:00");let r=null;function o(){const c=e.trainingStartTime,u=e.trainingDuration,h=e.currentStat;if(h==="strength"?n.value="Strength":h==="agility"?n.value="Agility":h==="endurance"?n.value="Endurance":n.value="",!c||!u){i.value="0:00",s.value=0;return}const m=Date.now()-c,y=m/1e3,C=Math.max(0,u/1e3-y);s.value=m/u*100;const D=Math.floor(C/3600),S=Math.floor(C%3600/60),M=Math.floor(C%60);D>0?i.value=`${D}h ${S}m ${M}s`:i.value=`${S}:${M<10?"0":""}${M}`}Wt(()=>{o();const c=setInterval(o,100);setTimeout(()=>{clearInterval(c),r=setInterval(o,1e3)},2e3)}),Pr(()=>{r&&clearInterval(r)});function l(){confirm("确定要取消本次训练吗？一切进步都将化为乌有。")&&e.resetTraining()}return(c,u)=>(B(),K("div",{class:Oe(["training-progress",{continuous:ee(e).continuousTraining,strength:n.value==="Strength",agility:n.value==="Agility",endurance:n.value==="Endurance"}])},[g("div",GI,[g("h3",null,"Training "+L(n.value),1),g("div",WI,[ee(e).continuousTraining?(B(),K("span",zI,"Repeating")):X("v-if",!0),g("span",YI,L(i.value)+" remaining",1)])]),X(" Static progress display instead of animated bar "),g("div",QI,L(Math.round(s.value))+"% complete ",1),X(" Cancel button "),g("button",{class:"cancel-button",onClick:l}," Cancel Training ")],2))}},JI=ct(XI,[["__scopeId","data-v-2d38c470"]]),dr=[{name:"Rookie Fighter",strength:8,agility:10,endurance:7,skills:["Quick Jab"],description:"A balanced beginner learning the basics of Muay Thai.",tier:1},{name:"Glass Cannon",strength:15,agility:8,endurance:3,skills:["Sharp Elbow"],description:"Hits hard but crumbles when struck. High risk, high reward style.",tier:1},{name:"Yoga Practitioner",strength:3,agility:15,endurance:8,skills:["Side Step"],description:"A flexible fighter who uses agility to compensate for low power.",tier:1},{name:"Stubborn Student",strength:6,agility:4,endurance:16,skills:["Knee Guard"],description:"What he lacks in technique, he makes up for in sheer resilience.",tier:1},{name:"Weekend Warrior",strength:13,agility:13,endurance:14,skills:["Low Kick","Quick Jab"],description:"A balanced amateur who trains around his day job.",tier:2},{name:"Gym Brawler",strength:20,agility:10,endurance:10,skills:["Power Elbow"],description:"Built his strength at the gym, but lacks technical refinement.",tier:2},{name:"Marathon Runner",strength:9,agility:22,endurance:9,skills:["Side Step","Footwork Mastery"],description:"Uses exceptional cardio and speed to wear opponents down.",tier:2},{name:"Heavy Bag",strength:10,agility:7,endurance:23,skills:["Turtle Shell"],description:"Takes tremendous punishment but keeps coming forward.",tier:2},{name:"Rising Talent",strength:18,agility:19,endurance:17,skills:["Flying Knee","Quick Jab"],description:"A well-rounded prospect with natural talent.",tier:3},{name:"Bar Knuckle",strength:26,agility:16,endurance:12,skills:["Power Elbow","Low Kick"],description:"Former bouncer who specializes in powerful short-range strikes.",tier:3},{name:"Dancing Phantom",strength:12,agility:28,endurance:14,skills:["Elusive Dodge","Tiger Step"],description:"So fast that opponents often swing at where she was, not where she is.",tier:3},{name:"Tank",strength:16,agility:10,endurance:28,skills:["Iron Chin","Knee Guard"],description:"Nicknamed for his ability to absorb punishment like a military vehicle.",tier:3},{name:"Versatile Fighter",strength:24,agility:25,endurance:21,skills:["Counter Hook","Flying Knee"],description:"A true all-rounder with no significant weaknesses.",tier:4},{name:"One-Punch Wonder",strength:32,agility:18,endurance:20,skills:["Power Elbow","Dragon Kick"],description:"Known for ending fights with a single devastating strike.",tier:4},{name:"Swift Shadow",strength:16,agility:34,endurance:20,skills:["Tiger Step","Elusive Dodge"],description:"Moves like water, impossible to pin down.",tier:4},{name:"Chin of Steel",strength:18,agility:13,endurance:39,skills:["Steel Guard","Warrior's Endurance"],description:"Has never been knocked out despite taking tremendous punishment.",tier:4},{name:"National Prospect",strength:32,agility:30,endurance:28,skills:["Counter Hook","Flying Knee","Power Elbow"],description:"A prime athlete with championship potential.",tier:5},{name:"Demolition Man",strength:40,agility:22,endurance:28,skills:["Titan's Grip","Dragon Kick"],description:"Focuses on overwhelming power and devastating clinch work.",tier:5},{name:"Wind Dancer",strength:20,agility:42,endurance:28,skills:["Lightning Reflex","Elusive Dodge","Side Step"],description:"Former dancer who uses exceptional footwork and fluid movement.",tier:5},{name:"Granite Jaw",strength:25,agility:20,endurance:45,skills:["Heavenly Guard","Iron Chin","Warrior's Endurance"],description:"His strategy is simple: outlast the opponent, no matter what.",tier:5},{name:"Complete Package",strength:38,agility:36,endurance:35,skills:["Muay Thai Fury","Counter Hook","Flying Knee"],description:"A complete fighter, equally dangerous in all aspects of combat.",tier:6},{name:"Knockout Artist",strength:48,agility:32,endurance:29,skills:["Dragon Kick","Power Elbow","Spinning Kick"],description:"Has more first-round knockouts than any other fighter in the country.",tier:6},{name:"The Matador",strength:26,agility:50,endurance:33,skills:["Phantom Strike","Lightning Reflex","Tiger Step"],description:"A counter-striker who makes opponents miss by millimeters.",tier:6},{name:"The Mountain",strength:34,agility:22,endurance:53,skills:["Steel Guard","Warrior's Endurance","Heavenly Guard"],description:"His fights often go the distance, with opponents exhausting themselves.",tier:6},{name:"Global Competitor",strength:45,agility:42,endurance:43,skills:["Muay Thai Fury","Counter Hook","Zen Focus"],description:"A seasoned international fighter with experience against various styles.",tier:7},{name:"The Executioner",strength:57,agility:37,endurance:36,skills:["Titan's Grip","Dragon Kick","Power Elbow"],description:"His opponents frequently leave on stretchers.",tier:7},{name:"The Wraith",strength:33,agility:58,endurance:39,skills:["Lightning Reflex","Phantom Strike","Elusive Dodge"],description:"Has the highest strike evasion rate in competition history.",tier:7},{name:"The Immovable",strength:38,agility:29,endurance:63,skills:["Heavenly Guard","Warrior's Endurance","Iron Chin"],description:"Has absorbed more damage without falling than any fighter on record.",tier:7},{name:"Title Contender",strength:52,agility:50,endurance:48,skills:["Muay Thai Fury","Counter Hook","Spinning Kick","Zen Focus"],description:"An elite fighter on the cusp of world championship glory.",tier:8},{name:"The Wrecking Ball",strength:65,agility:42,endurance:43,skills:["Titan's Grip","Dragon Kick","Power Elbow","Muay Thai Fury"],description:"Destroys opponents with devastating power and relentless aggression.",tier:8},{name:"The Phantom",strength:40,agility:68,endurance:42,skills:["Lightning Reflex","Phantom Strike","Elusive Dodge","Tiger Step"],description:"His opponents claim fighting him is like trying to catch smoke.",tier:8},{name:"The Fortress",strength:44,agility:36,endurance:70,skills:["Heavenly Guard","Warrior's Endurance","Iron Chin","Steel Guard"],description:"Has never been finished in over 50 professional fights.",tier:8},{name:"Undisputed Champion",strength:60,agility:58,endurance:56,skills:["Muay Thai Fury","Zen Focus","Flying Knee","Counter Hook","Dragon Kick"],description:"The reigning world champion, complete in every aspect of the art.",tier:9},{name:"The Destroyer",strength:75,agility:50,endurance:49,skills:["Titan's Grip","Dragon Kick","Muay Thai Fury","Spinning Kick","Power Elbow"],description:"The most feared puncher in the sport's history, with unreal knockout power.",tier:9},{name:"Living Mirage",strength:47,agility:77,endurance:50,skills:["Lightning Reflex","Phantom Strike","Tiger Step","Elusive Dodge","Footwork Mastery"],description:"Holds the record for most strikes evaded in championship fights.",tier:9},{name:"The Immortal",strength:50,agility:44,endurance:80,skills:["Heavenly Guard","Warrior's Endurance","Iron Chin","Steel Guard","Zen Focus"],description:"Legendary for his ability to walk through fire and keep fighting.",tier:9},{name:"The GOAT",strength:70,agility:68,endurance:65,skills:["Muay Thai Fury","Zen Focus","Counter Hook","Flying Knee","Dragon Kick","Phantom Strike"],description:"Widely considered the greatest of all time, with mastery of every technique.",tier:10},{name:"The Legend",strength:85,agility:55,endurance:60,skills:["Titan's Grip","Dragon Kick","Muay Thai Fury","Power Elbow","Spinning Kick","Zen Focus"],description:"A mythical knockout artist with devastating power in every limb.",tier:10},{name:"The Ghost",strength:55,agility:88,endurance:57,skills:["Lightning Reflex","Phantom Strike","Tiger Step","Elusive Dodge","Footwork Mastery","Side Step"],description:"Some say his opponents never landed a clean hit in his entire career.",tier:10},{name:"The Eternal",strength:57,agility:50,endurance:93,skills:["Heavenly Guard","Warrior's Endurance","Iron Chin","Steel Guard","Zen Focus","Turtle Shell"],description:"A living legend who seems to get stronger the more punishment he takes.",tier:10},{name:"Perfect Fighter",strength:80,agility:78,endurance:75,skills:["Muay Thai Fury","Zen Focus","Flying Knee","Counter Hook","Lightning Reflex","Tiger Step","Phantom Strike"],description:"Has mastered every aspect of Muay Thai to near perfection.",tier:11},{name:"Titan",strength:98,agility:65,endurance:70,skills:["Titan's Grip","Dragon Kick","Power Elbow","Muay Thai Fury","Spinning Kick","Zen Focus","Counter Hook"],description:"His power defies human limitations; even a glancing blow can end a fight.",tier:11},{name:"Ethereal",strength:65,agility:98,endurance:70,skills:["Lightning Reflex","Phantom Strike","Tiger Step","Elusive Dodge","Footwork Mastery","Side Step","Zen Focus"],description:"Moves with such speed that he appears to be in multiple places at once.",tier:11},{name:"Undying",strength:70,agility:60,endurance:98,skills:["Heavenly Guard","Warrior's Endurance","Iron Chin","Steel Guard","Zen Focus","Turtle Shell","Knee Guard"],description:"No one knows if it's even possible to knock him out or break his will.",tier:11},{name:"Grandmaster of Combat",strength:95,agility:90,endurance:88,skills:["Zen Focus","Muay Thai Fury","Titan's Grip","Lightning Reflex","Warrior's Endurance","Dragon Kick","Phantom Strike","Counter Hook"],description:"The ultimate master who has transcended human limitations through decades of training.",tier:12}],ZI={class:"brag-content"},eS={class:"stats-grid"},tS={class:"stat-box combined-stats-box"},nS={class:"combined-content"},sS={class:"record-section"},iS={class:"record-row"},rS={class:"record-data"},oS={class:"number-badge wins"},aS={class:"number-badge losses"},lS={class:"win-rate"},cS={class:"record-row"},uS={class:"record-data"},dS={class:"number-badge training"},hS={class:"stats-section"},fS={class:"stat-row"},pS={class:"stat-values"},gS={class:"stat-number"},mS={class:"base-stat"},vS={class:"stat-row"},yS={class:"stat-values"},_S={class:"stat-number"},ES={class:"base-stat"},TS={class:"stat-row"},bS={class:"stat-values"},wS={class:"stat-number"},AS={class:"base-stat"},IS={class:"stat-box skills-box"},SS={class:"skills-list"},CS={key:0,class:"no-skills"},kS={key:1,class:"skill-chips"},PS={class:"stat-box victories-box"},RS={class:"victories-list",ref:"victoriesList"},DS={key:0,class:"no-victories"},MS={key:1,class:"opponent-list"},OS={class:"opponent-name"},NS={class:"defeat-count"},xS={__name:"BragStatsModal",props:{show:Boolean},emits:["close"],setup(t,{emit:e}){const n=e,s=$e(),i=sn();Le(()=>s.playerName||"Fighter");const r=Le(()=>{const c=s.fightStats.wins+s.fightStats.losses;return c===0?"0":Math.round(s.fightStats.wins/c*100)}),o=Le(()=>{const u=[...s.defeatedOpponents].map(h=>{const f=dr.find(m=>m.name===h);return f?{name:f.name,tier:f.tier||1,strength:f.strength,agility:f.agility,endurance:f.endurance,victoryCount:s.getOpponentVictoryCount(f.name)}:null}).filter(Boolean);return u.sort((h,f)=>{if(f.tier!==h.tier)return f.tier-h.tier;const m=h.strength+h.agility+h.endurance;return f.strength+f.agility+f.endurance-m}),u});function l(){n("close")}return(c,u)=>t.show?(B(),K("div",{key:0,class:"modal-backdrop",onClick:l},[g("div",{class:"brag-modal",onClick:u[0]||(u[0]=sr(()=>{},["stop"]))},[g("div",{class:"brag-header"},[u[1]||(u[1]=g("div",{class:"game-title"},"Muay Thai Idle Fight",-1)),g("button",{class:"close-button",onClick:l},"×")]),g("div",ZI,[g("div",eS,[X(" Combined Fighter Record and Stats "),g("div",tS,[u[8]||(u[8]=g("div",{class:"stat-title"},"Fighter Profile",-1)),g("div",nS,[X(" Record section "),g("div",sS,[g("div",iS,[u[3]||(u[3]=g("div",{class:"record-label"},"W/L:",-1)),g("div",rS,[g("span",oS,L(ee(s).fightStats.wins),1),u[2]||(u[2]=ft(" : ")),g("span",aS,L(ee(s).fightStats.losses),1),g("span",lS,L(r.value)+"%",1)])]),g("div",cS,[u[4]||(u[4]=g("div",{class:"record-label"},"TP:",-1)),g("div",uS,[g("span",dS,L(ee(s).trainingPoints),1)])])]),X(" Stat section "),g("div",hS,[g("div",fS,[u[5]||(u[5]=g("span",{class:"stat-label"},"💪 STR",-1)),g("div",pS,[g("span",gS,L(ee(s).effectiveStrength),1),g("span",mS,"("+L(ee(s).strength)+")",1)])]),g("div",vS,[u[6]||(u[6]=g("span",{class:"stat-label"},"⚡ AGI",-1)),g("div",yS,[g("span",_S,L(ee(s).effectiveAgility),1),g("span",ES,"("+L(ee(s).agility)+")",1)])]),g("div",TS,[u[7]||(u[7]=g("span",{class:"stat-label"},"🛡️ END",-1)),g("div",bS,[g("span",wS,L(ee(s).effectiveEndurance),1),g("span",AS,"("+L(ee(s).endurance)+")",1)])])])])]),X(" Skills Mastered "),g("div",IS,[u[9]||(u[9]=g("div",{class:"stat-title"},"Skills Mastered",-1)),g("div",SS,[ee(i).ownedSkills.length===0?(B(),K("div",CS," No skills yet ")):(B(),K("div",kS,[(B(!0),K(mt,null,ns(ee(i).ownedSkills,h=>(B(),K("div",{key:h,class:"skill-chip"},L(h),1))),128))]))])]),X(" Victories with tier-based colors and defeat count "),g("div",PS,[u[10]||(u[10]=g("div",{class:"stat-title"},"Defeated Opponents",-1)),g("div",RS,[o.value.length===0?(B(),K("div",DS," No victories yet ")):(B(),K("div",MS,[(B(!0),K(mt,null,ns(o.value,h=>(B(),K("div",{key:h.name,class:Oe(["opponent-entry",`tier-${h.tier}`])},[g("span",OS,L(h.name),1),g("span",NS,L(h.victoryCount)+"x",1)],2))),128))]))],512)])]),u[11]||(u[11]=g("div",{class:"share-footer"},[g("div",{class:"share-hint"}," 📱 Screenshot to share your progress! ")],-1))])])])):X("v-if",!0)}},VS=ct(xS,[["__scopeId","data-v-cabf8d7a"]]);function FS(){const t=ue(!1),e=ue(0),n=ue(!1),s=vi({playerHP:100,opponentHP:100,opponent:null,log:[],fightEnded:!1,fightInterval:null,buffs:{playerStrengthBuff:0,playerAgilityBuff:0,playerEnduranceBuff:0,opponentStrengthBuff:0,opponentAgilityBuff:0,opponentEnduranceBuff:0},buffDurations:{playerStrengthBuff:0,playerAgilityBuff:0,playerEnduranceBuff:0,opponentStrengthBuff:0,opponentAgilityBuff:0,opponentEnduranceBuff:0},playerFocusMode:"balanced",opponentFocusMode:"balanced",playerFocusShiftDuration:0,opponentFocusShiftDuration:0,playerInComeback:!1,opponentInComeback:!1,crowdFavoriteTarget:null,crowdFavoriteDuration:0,playerMotiveActive:!1,opponentMotiveActive:!1,playerMotiveType:null,opponentMotiveType:null,playerMotiveDuration:0,opponentMotiveDuration:0,playerHasSecondChance:!0,opponentHasSecondChance:!0,playerSecondChanceActive:!1,opponentSecondChanceActive:!1,playerSecondChanceDuration:0,opponentSecondChanceDuration:0}),i=vi({enabled:ae.rewards.enabled,baseReward:ae.rewards.baseReward,scalingEnabled:ae.rewards.scalingEnabled,consolationReward:ae.rewards.consolationReward});function r(){t.value=!1,Object.assign(s,{playerHP:100,opponentHP:100,opponent:null,log:[],fightEnded:!1,fightInterval:null,buffs:{playerStrengthBuff:0,playerAgilityBuff:0,playerEnduranceBuff:0,opponentStrengthBuff:0,opponentAgilityBuff:0,opponentEnduranceBuff:0},buffDurations:{playerStrengthBuff:0,playerAgilityBuff:0,playerEnduranceBuff:0,opponentStrengthBuff:0,opponentAgilityBuff:0,opponentEnduranceBuff:0},playerFocusMode:"balanced",opponentFocusMode:"balanced",playerFocusShiftDuration:0,opponentFocusShiftDuration:0,playerInComeback:!1,opponentInComeback:!1,crowdFavoriteTarget:null,crowdFavoriteDuration:0,playerMotiveActive:!1,opponentMotiveActive:!1,playerMotiveType:null,opponentMotiveType:null,playerMotiveDuration:0,opponentMotiveDuration:0,playerHasSecondChance:!0,opponentHasSecondChance:!0,playerSecondChanceActive:!1,opponentSecondChanceActive:!1,playerSecondChanceDuration:0,opponentSecondChanceDuration:0}),Object.assign(i,{enabled:ae.rewards.enabled,baseReward:ae.rewards.baseReward,scalingEnabled:ae.rewards.scalingEnabled,consolationReward:ae.rewards.consolationReward})}function o(){saveGame("fightRewardConfig",i)}function l(){const h=Cc("fightRewardConfig");h&&Object.assign(i,h)}function c(h){Object.assign(i,h),o()}function u(h=null){return h!==null?i.enabled=h:i.enabled=!i.enabled,o(),i.enabled}return l(),{inFight:t,fightStartTime:e,isBackgrounded:n,fightState:s,rewardConfig:i,resetState:r,updateRewardConfig:c,toggleRewards:u}}const se={ATTACK:"attack",EVADE:"evade",COUNTER:"counter",COMBO:"combo",KNOCKOUT:"knockout",CLINCH:"clinch",FOCUS_SHIFT:"focus_shift",CROWD_FAVOR:"crowd_favor",COMEBACK:"comeback",ADRENALINE:"adrenaline",PERFECT_BLOCK:"perfect_block",STAMINA_DRAIN:"stamina_drain",CRUSHING_BLOW:"crushing_blow",FIGHT_START:"fight_start",FIGHT_END:"fight_end",REWARD:"reward",INFO:"info",FIGHTER_MOTIVE:"fighter_motive",SECOND_CHANCE:"second_chance"},ye={PLAYER:"player",OPPONENT:"opponent",SYSTEM:"system"},Z={PLAYER:{type:ye.PLAYER,name:"player",nameDisplay:"You",possessive:"Your",objective:"you",hpRef:"playerHP",focusMode:"playerFocusMode",focusDuration:"playerFocusShiftDuration",inComeback:"playerInComeback",buffPrefix:"player"},OPPONENT:{type:ye.OPPONENT,name:"opponent",nameDisplay:"Opponent",possessive:"Opponent's",objective:"opponent",hpRef:"opponentHP",focusMode:"opponentFocusMode",focusDuration:"opponentFocusShiftDuration",inComeback:"opponentInComeback",buffPrefix:"opponent"}};function $S(t){const e={addMessage:function(n,s,i=ye.SYSTEM,r={}){const o={message:n,eventType:s,actor:i,timestamp:Date.now(),data:r};return t.log.push(o),t.log.length-1},updateMessage:function(n,s){return n>=0&&n<t.log.length?(t.log[n].message=s,!0):!1}};return t.logStore=e,e.addMessage}function LS(t,e){function n(f,m,y){const C=`${Z[f].buffPrefix}${m.charAt(0).toUpperCase()+m.slice(1)}Buff`,D=Z[f].focusMode,S=Z[f].focusDuration,M=Z[f].inComeback;let P=t.buffs[C]||0;if(t[S]>0){const H=t[D];H==="offensive"?m==="strength"?P+=ae.specialEvents.focusOffensiveStrengthBuff:m==="agility"?P+=ae.specialEvents.focusOffensiveAgilityChange:m==="endurance"&&(P+=ae.specialEvents.focusOffensiveEnduranceChange):H==="defensive"?m==="strength"?P+=ae.specialEvents.focusDefensiveStrengthChange:m==="agility"?P+=ae.specialEvents.focusDefensiveAgilityBuff:m==="endurance"&&(P+=ae.specialEvents.focusDefensiveEnduranceBuff):H==="balanced"&&(m==="strength"?P+=ae.specialEvents.focusBalancedStrengthChange:m==="agility"?P+=ae.specialEvents.focusBalancedAgilityChange:m==="endurance"&&(P+=ae.specialEvents.focusBalancedEnduranceChange))}if(m==="strength"&&t.crowdFavoriteTarget===Z[f].name&&t.crowdFavoriteDuration>0&&(P+=ae.specialEvents.crowdFavoriteStrengthBuff),t[M]&&(m==="strength"?P+=ae.specialEvents.comebackStrengthBuff:m==="endurance"&&(P+=ae.specialEvents.comebackEnduranceChange)),f==="PLAYER"&&t.playerMotiveActive&&t.playerMotiveDuration>0){const H=t.playerMotiveType;if(H&&ae.specialEvents.motiveTypes[H]){const O=ae.specialEvents.motiveTypes[H];m==="strength"?P+=O.strengthBuff:m==="agility"?P+=O.agilityBuff:m==="endurance"&&(P+=O.enduranceBuff)}}else if(f==="OPPONENT"&&t.opponentMotiveActive&&t.opponentMotiveDuration>0){const H=t.opponentMotiveType;if(H&&ae.specialEvents.motiveTypes[H]){const O=ae.specialEvents.motiveTypes[H];m==="strength"?P+=O.strengthBuff:m==="agility"?P+=O.agilityBuff:m==="endurance"&&(P+=O.enduranceBuff)}}(f==="PLAYER"&&t.playerSecondChanceActive&&t.playerSecondChanceDuration>0||f==="OPPONENT"&&t.opponentSecondChanceActive&&t.opponentSecondChanceDuration>0)&&(m==="strength"?P+=ae.specialEvents.secondChanceStrengthBuff:m==="agility"&&(P+=ae.specialEvents.secondChanceAgilityBuff));let V=1;const R=1+P/100;return Math.round(y*R*V)}function s(f){return n("PLAYER","strength",f)}function i(f){return n("PLAYER","agility",f)}function r(f){return n("PLAYER","endurance",f)}function o(f){return n("OPPONENT","strength",f)}function l(f){return n("OPPONENT","agility",f)}function c(f){return n("OPPONENT","endurance",f)}function u(){if(t.buffDurations.playerStrengthBuff>0&&(t.buffDurations.playerStrengthBuff--,t.buffDurations.playerStrengthBuff===0&&(t.buffs.playerStrengthBuff=0,t.log.push("Your adrenaline surge fades."))),t.buffDurations.playerAgilityBuff<0&&(t.buffDurations.playerAgilityBuff++,t.buffDurations.playerAgilityBuff===0&&(t.buffs.playerAgilityBuff=0,t.log.push("Your stamina returns to normal."))),t.buffDurations.playerEnduranceBuff>0&&(t.buffDurations.playerEnduranceBuff--,t.buffDurations.playerEnduranceBuff===0&&(t.buffs.playerEnduranceBuff=0,t.log.push("Your defensive boost fades."))),t.buffDurations.opponentStrengthBuff>0&&(t.buffDurations.opponentStrengthBuff--,t.buffDurations.opponentStrengthBuff===0&&(t.buffs.opponentStrengthBuff=0,t.log.push(`${t.opponent.name}'s adrenaline surge fades.`))),t.buffDurations.opponentAgilityBuff<0&&(t.buffDurations.opponentAgilityBuff++,t.buffDurations.opponentAgilityBuff===0&&(t.buffs.opponentAgilityBuff=0,t.log.push(`${t.opponent.name}'s stamina returns to normal.`))),t.buffDurations.opponentEnduranceBuff>0&&(t.buffDurations.opponentEnduranceBuff--,t.buffDurations.opponentEnduranceBuff===0&&(t.buffs.opponentEnduranceBuff=0,t.log.push(`${t.opponent.name}'s defensive boost fades.`))),t.playerFocusShiftDuration>0&&(t.playerFocusShiftDuration--,t.playerFocusShiftDuration===0&&(t.playerFocusMode="balanced",e("You return to a balanced fighting stance.",se.FOCUS_SHIFT,ye.PLAYER,{newFocusMode:"balanced"}))),t.opponentFocusShiftDuration>0&&(t.opponentFocusShiftDuration--,t.opponentFocusShiftDuration===0&&(t.opponentFocusMode="balanced",e(`${t.opponent.name} returns to a balanced fighting stance.`,se.FOCUS_SHIFT,ye.OPPONENT,{opponent:t.opponent.name,newFocusMode:"balanced"}))),t.crowdFavoriteDuration>0&&(t.crowdFavoriteDuration--,t.crowdFavoriteDuration===0)){const f=t.crowdFavoriteTarget;t.crowdFavoriteTarget=null,f==="player"?e("The crowd's cheering dies down.",se.CROWD_FAVOR,ye.PLAYER,{favorEnded:!0,previousTarget:"player"}):f==="opponent"&&e(`The crowd stops cheering for ${t.opponent.name}.`,se.CROWD_FAVOR,ye.OPPONENT,{favorEnded:!0,previousTarget:"opponent",opponent:t.opponent.name})}t.playerInComeback?t.playerHP>ae.specialEvents.comebackThreshold&&(t.playerInComeback=!1,e("You're no longer fighting desperately.",se.COMEBACK,ye.PLAYER,{comebackEnded:!0,currentHp:t.playerHP,threshold:ae.specialEvents.comebackThreshold})):t.playerHP<=ae.specialEvents.comebackThreshold&&Math.random()<ae.specialEvents.comebackChance&&(t.playerInComeback=!0,e("💢 DESPERATE SITUATION: You fight with renewed determination!",se.COMEBACK,ye.PLAYER,{comebackStarted:!0,currentHp:t.playerHP,threshold:ae.specialEvents.comebackThreshold,strengthBuff:ae.specialEvents.comebackStrengthBuff,enduranceChange:ae.specialEvents.comebackEnduranceChange,chance:Math.round(ae.specialEvents.comebackChance*100)})),t.opponentInComeback?t.opponentHP>ae.specialEvents.comebackThreshold&&(t.opponentInComeback=!1,e(`${t.opponent.name} is no longer fighting desperately.`,se.COMEBACK,ye.OPPONENT,{comebackEnded:!0,opponent:t.opponent.name,currentHp:t.opponentHP,threshold:ae.specialEvents.comebackThreshold})):t.opponentHP<=ae.specialEvents.comebackThreshold&&Math.random()<ae.specialEvents.comebackChance&&(t.opponentInComeback=!0,e(`💢 DESPERATE SITUATION: ${t.opponent.name} fights with renewed determination!`,se.COMEBACK,ye.OPPONENT,{comebackStarted:!0,opponent:t.opponent.name,currentHp:t.opponentHP,threshold:ae.specialEvents.comebackThreshold,strengthBuff:ae.specialEvents.comebackStrengthBuff,enduranceChange:ae.specialEvents.comebackEnduranceChange,chance:Math.round(ae.specialEvents.comebackChance*100)})),t.playerMotiveActive&&t.playerMotiveDuration>0&&(t.playerMotiveDuration--,t.playerMotiveDuration===0&&(t.playerMotiveActive=!1,t.playerMotiveType=null,e("Your motivation fades as you return to normal fighting.",se.FIGHTER_MOTIVE,ye.PLAYER,{motiveEnded:!0}))),t.opponentMotiveActive&&t.opponentMotiveDuration>0&&(t.opponentMotiveDuration--,t.opponentMotiveDuration===0&&(t.opponentMotiveActive=!1,t.opponentMotiveType=null,e(`${t.opponent.name}'s motivation fades as they return to normal fighting.`,se.FIGHTER_MOTIVE,ye.OPPONENT,{motiveEnded:!0,opponent:t.opponent.name}))),t.playerSecondChanceActive&&t.playerSecondChanceDuration>0&&(t.playerSecondChanceDuration--,t.playerSecondChanceDuration===0&&(t.playerSecondChanceActive=!1,e("The surge of energy from your second chance fades away.",se.SECOND_CHANCE,ye.PLAYER,{secondChanceBuffEnded:!0}))),t.opponentSecondChanceActive&&t.opponentSecondChanceDuration>0&&(t.opponentSecondChanceDuration--,t.opponentSecondChanceDuration===0&&(t.opponentSecondChanceActive=!1,e(`The surge of energy from ${t.opponent.name}'s second chance fades away.`,se.SECOND_CHANCE,ye.OPPONENT,{secondChanceBuffEnded:!0,opponent:t.opponent.name})))}function h(){t.opponent&&(Z.OPPONENT.nameDisplay=t.opponent.name,Z.OPPONENT.possessive=`${t.opponent.name}'s`,Z.OPPONENT.objective=t.opponent.name)}return{getEffectivePlayerStrength:s,getEffectivePlayerAgility:i,getEffectivePlayerEndurance:r,getEffectiveOpponentStrength:o,getEffectiveOpponentAgility:l,getEffectiveOpponentEndurance:c,getEffectiveStat:n,updateBuffDurations:u,updateOpponentInfo:h}}function kn(t,e,n=100,s=1,i=!1,r=!1){const{minRandomFactor:o,maxRandomFactor:l,damageReductionCap:c,strengthMultiplier:u,enduranceAdvantage:h,damageCap:f}=ae.damage,m=Math.max(.1,t),y=Math.max(0,e),C=ae.damage.enduranceScaling;let D=Math.sqrt(y)/C.baseDivisor;if(y>=C.tier1Threshold&&(D+=C.tier1Bonus),y>=C.tier2Threshold&&(D+=C.tier2Bonus),y>=C.tier3Threshold&&(D+=C.tier3Bonus),C.ratioScaling&&C.ratioScaling.enabled){const v=C.ratioScaling;if(m>0){const _=y/m,T=v.optimalRatio,b=Math.abs(_-T),A=Math.exp(-1.8*b),de=v.maxRatioBonus*A*v.baseMultiplier;D+=de}}D=Math.min(c,D);const S=y/m*100,M=S>100+h.thresholdPercentage;let P=!1;if(M){const v=Math.max(0,S-100),_=Math.min(3,v/100),T=Math.min(h.maxChance,Math.max(0,h.baseChance+_*.1));Math.random()<T&&(P=!0,D=Math.min(h.maximumReduction,D+h.bonusReduction))}const V=m*u*(1-D),R=l-o,H=o+Math.random()*R;let O=V*H,I=!1;{let v=f.maxDamagePercent;{const b=Math.min(1,(s-1)/12);v=f.tierOneCapPercent-b*(f.tierOneCapPercent-f.finalBossCapPercent)}i?v*=f.criticalHitCapMultiplier:r&&(v*=f.comboCapMultiplier);const _=n*v;O>_&&(O=_,I=!0)}return(isNaN(O)||!isFinite(O))&&(O=1),{damage:Math.max(1,O),perfectBlockTriggered:P,damageCapped:I}}function BS(t,e,n){const{maxChance:s,divisor:i,minChance:r}=ae.evasion,o=Math.max(1,t||1),l=Math.max(1,e||1),c=Math.max(1,n||1);let u=o/(l*i);const h=o/c;if(h>1){const{doubleAgilityChance:S,tripleAgilityChance:M}=ae.evasion.agilityAdvantage;let P=0;if(h>=3)P=M;else{const V=(h-1)/2,R=S;if(V<=.5)P=.5+(R-.5)*(V*2);else{const H=(V-.5)*2;P=R+(M-R)*H}}P>u&&(u=P)}const f=c/o,{baseImpact:m,scalingExponent:y,maxAdvantage:C}=ae.evasion.accuracy;let D=0;return f>1&&(D=m*Math.pow(f-1,y),D=Math.min(D,C),u=u*(1-D)),u=Math.max(r,Math.min(s,u)),u}function US(t,e,n,s=0,i=1,r=0,o=0,l={}){const{counterAttack:c}=ae.evasion,u=Math.max(1,t||1),h=Math.max(1,e||1),f=Math.max(1,n||1),m=Math.max(1,s||1),y=Math.max(1,i||1),C=Math.max(1,r||1),D=Math.max(1,o||1);let S=BS(t,e,n);if(l.isCombo&&l.hitNumber>1&&ae.comboAttacks.comboEvasion.enabled){const{agilityBonus:T,ratioThreshold:b,maxBonus:A,hitNumberMultiplier:de}=ae.comboAttacks.comboEvasion,W=u/f;if(W>=b){let q=T+(l.hitNumber-1)*de;q*=Math.min(2,W),q=Math.min(q,A),S=S+q*(1-S)}}let M=Math.random()<S;const{strengthAdvantage:P}=ae.evasion;let V=!1;{const T=h/u;if(T>=P.minStrengthRatio&&h>u){const b=(T-P.minStrengthRatio)/.5;let A=P.baseChance+b*P.additionalChancePerHalfRatio;A=Math.min(A,P.maxChance),V=Math.random()<A,V&&M&&(M=!1)}}const R=M?0:Math.min(.35,D/(h*2)),H=!M&&Math.random()<R,O=H?Math.min(.3,D/(h*4)):0,I=H&&Math.random()<O,E=!M&&!H?V?1:Math.min(.2,n/(t*3)):0,v=!M&&!H&&(V||Math.random()<E),_={evaded:M,blocked:H,counter:!1,counterDamage:0,perfectBlock:I,critical:v,crushingBlow:V,damageMultiplier:V?P.damageMultiplier:v?1.5:1};if(H&&c.enabled&&m>0&&C>0){let T=c.baseChance;const b=Math.max(0,u-f);if(T+=b*c.agilityBonus,y>1&&(T+=(y-1)*c.tierBonus),T=Math.min(c.maxChance,T),Math.random()<T){_.counter=!0,_.blocked=!0;let de=kn(m,C).damage*c.baseDamageMultiplier,W=h*c.strengthPunishmentFactor;W=Math.min(c.maxStrengthPunishmentBonus,W),de*=1+W,_.counterDamage=Math.max(1,Math.round(de))}}return _}function HS(t,e,n){const{getEffectivePlayerStrength:s,getEffectivePlayerAgility:i,getEffectivePlayerEndurance:r,getEffectiveOpponentStrength:o,getEffectiveOpponentAgility:l,getEffectiveOpponentEndurance:c}=n;function u(S){var P;const M=$e();return S===Z.PLAYER?{strength:M.effectiveStrength,agility:M.effectiveAgility,endurance:M.effectiveEndurance,tier:1}:{strength:t.opponent.strength,agility:t.opponent.agility,endurance:t.opponent.endurance,tier:((P=t.opponent)==null?void 0:P.tier)||1}}function h(S){var V;const M=sn();let P="Strike";if(S===Z.PLAYER){const R=M.ownedSkills;R.length>0&&(P=R[Math.floor(Math.random()*R.length)])}else{const R=((V=t.opponent)==null?void 0:V.skills)||[];R.length>0&&(P=R[Math.floor(Math.random()*R.length)])}return P}function f(S,M,P={}){const V=$e(),R=u(S),H=u(M),O=S===Z.PLAYER?s(R.strength):o(R.strength),I=S===Z.PLAYER?i(R.agility):l(R.agility),E=M===Z.PLAYER?i(H.agility):l(H.agility),v=M===Z.PLAYER?V.effectiveEndurance:c(H.endurance),_=h(S),T=P||{},b=US(E,O,I,S===Z.PLAYER?o(H.strength):s(H.strength),H.tier||1,S===Z.PLAYER?V.effectiveEndurance:c(R.endurance),v,T||{}),A=S===Z.PLAYER?"You":t.opponent.name,de=M===Z.PLAYER?"you":t.opponent.name,W={nameDisplay:A},q={nameDisplay:de},G={attacker:S===Z.PLAYER?"player":t.opponent.name,defender:M===Z.PLAYER?"player":t.opponent.name,attackName:_,skillUsed:_,attackerStr:O,attackerAgi:I,defenderAgi:E,defenderEnd:v};if(b.evaded)return e(`🏃 ${q.nameDisplay} evaded ${W.nameDisplay.toLowerCase()}'s ${_}!`,se.EVADE,M===Z.PLAYER?ye.PLAYER:ye.OPPONENT,{...G,evaded:!0}),!1;if(b.blocked){if(b.counter){const Q=h(M),le=S===Z.PLAYER?V.effectiveEndurance:c(u(S).endurance),ke=M===Z.PLAYER?s(u(M).strength):o(u(M).strength),Ge=kn(ke,le),Fe=Math.round(Ge.damage);S===Z.PLAYER?t.playerHP-=Fe:t.opponentHP-=Fe,M===Z.PLAYER&&V.trackCounterAttack(),e(`⚡ COUNTER! with ${Q} for ${Fe} damage!`,se.COUNTER,M===Z.PLAYER?ye.PLAYER:ye.OPPONENT,{...G,blocked:!0,counter:!0,damage:Fe,skillUsed:Q})}else{const Q=kn(O*b.damageMultiplier,v);let le=Math.round(Q.damage*.5);isNaN(le)&&(le=1),b.perfectBlock?(le=0,M===Z.PLAYER&&V.trackPerfectBlock(),e(`🛡️ PERFECT BLOCK! ${q.nameDisplay} completely blocked ${W.nameDisplay.toLowerCase()}'s "${_}" with high endurance!`,se.BLOCK,M===Z.PLAYER?ye.PLAYER:ye.OPPONENT,{...G,blocked:!0,perfectBlock:!0,damage:0})):(M===Z.PLAYER?t.playerHP-=le:t.opponentHP-=le,e(`🛡️ ${q.nameDisplay} blocked ${W.nameDisplay.toLowerCase()}'s "${_}" but took ${le} reduced damage!`,se.BLOCK,M===Z.PLAYER?ye.PLAYER:ye.OPPONENT,{...G,blocked:!0,damage:le,damageMultiplier:b.damageMultiplier}))}return!0}else{const Q=kn(O*b.damageMultiplier,v),le=Math.round(isNaN(Q.damage)?1:Q.damage);if(M===Z.PLAYER?t.playerHP-=le:t.opponentHP-=le,b.crushingBlow){const ke=Math.round(O),Ge=Math.round(E);e(`💥 CRUSHING BLOW! ${W.nameDisplay} overpowers ${q.nameDisplay} with raw strength (STR ${ke} vs AGI ${Ge}), dealing ${le} massive damage!`,se.CRUSHING_BLOW,S===Z.PLAYER?ye.PLAYER:ye.OPPONENT,{...G,damage:le,crushingBlow:!0,damageMultiplier:b.damageMultiplier,attackerStr:ke,defenderAgi:Ge})}else b.critical?(S===Z.PLAYER&&V.trackCriticalStrike(),e(`🔥 ${W.nameDisplay} use "${_}" for ${le} critical damage!`,se.ATTACK,S===Z.PLAYER?ye.PLAYER:ye.OPPONENT,{...G,damage:le,critical:!0,damageMultiplier:b.damageMultiplier})):e(`👊 ${W.nameDisplay} use "${_}" for ${le} damage!`,se.ATTACK,S===Z.PLAYER?ye.PLAYER:ye.OPPONENT,{...G,damage:le,damageMultiplier:b.damageMultiplier});return!0}}function m(S,M){const P=S===Z.PLAYER?"You":t.opponent.name,V=M===Z.PLAYER?"you":t.opponent.name;let R,H;S===Z.PLAYER?(R={strength:s(u(Z.PLAYER).strength)},H={endurance:c(u(Z.OPPONENT).endurance)}):(R={strength:o(u(Z.OPPONENT).strength)},H={endurance:r(u(Z.PLAYER).endurance)});let O=1;O=1+Math.max(0,(R.strength-10)/10*ae.comboAttacks.strengthMultiplier),O=Math.max(ae.comboAttacks.minStrengthBonus,Math.min(ae.comboAttacks.maxStrengthBonus,O));const I=kn(R.strength,H.endurance).damage,E=Math.round(I*(1+ae.comboAttacks.doubleStrikeMultiplier)*O);let v=0,_=-1;const T=O!==1?` (STR bonus: ${(O*100-100).toFixed(0)}%)`:"";_=e(`⚔️ DOUBLE STRIKE! ${P} attacks ${V} twice this turn...`,se.SPECIAL_ATTACK,S===Z.PLAYER?ye.PLAYER:ye.OPPONENT,{attacker:S===Z.PLAYER?"player":t.opponent.name,defender:M===Z.PLAYER?"player":t.opponent.name,specialAttack:"double_strike",potentialDamage:E,strengthBonus:O});const b={attacker:S===Z.PLAYER?"player":t.opponent.name,defender:M===Z.PLAYER?"player":t.opponent.name,isCombo:!0,hitNumber:1,attackerAgility:R.agility,defenderAgility:H.endurance},A=e,de=(G,Q,le,ke)=>(ke&&ke.damage&&Q===se.ATTACK&&(v+=ke.damage),A(G,Q,le,ke)),W=e;e=de;const q=t.logStore;if(b.hitNumber=1,f(S,M,b),t.playerHP<=0||t.opponentHP<=0){e=W,q&&typeof q.updateMessage=="function"&&(v===0?q.updateMessage(_,`⚔️ DOUBLE STRIKE! ${P} missed ${V} completely! (All attacks evaded)`):q.updateMessage(_,`⚔️ DOUBLE STRIKE! ${P} attacked ${V} for ${v} damage! (Potential: ${E})${T}`));return}b.hitNumber=2,f(S,M,b),e=W,q&&typeof q.updateMessage=="function"&&(v===0?q.updateMessage(_,`⚔️ DOUBLE STRIKE! ${P} missed ${V} completely! (All attacks evaded)`):q.updateMessage(_,`⚔️ DOUBLE STRIKE! ${P} hit ${V} for ${v} damage! (Potential: ${E})${T}`))}function y(S,M){const P=S===Z.PLAYER?"You":t.opponent.name,V=M===Z.PLAYER?"you":t.opponent.name;let R,H;S===Z.PLAYER?(R={strength:s(u(Z.PLAYER).strength),agility:i(u(Z.PLAYER).agility)},H={endurance:c(u(Z.OPPONENT).endurance)}):(R={strength:o(u(Z.OPPONENT).strength),agility:l(u(Z.OPPONENT).agility)},H={endurance:r(u(Z.PLAYER).endurance)});let O=1;O=1+Math.max(0,(R.strength-10)/10*ae.comboAttacks.strengthMultiplier),O=Math.max(ae.comboAttacks.minStrengthBonus,Math.min(ae.comboAttacks.maxStrengthBonus,O));const I=kn(R.strength,H.endurance).damage,E=Math.round(I*(1+ae.comboAttacks.tripleComboMultiplier*2)*O);let v=0,_=-1;const T=O!==1?` (STR bonus: ${(O*100-100).toFixed(0)}%)`:"";_=e(`🔄 TRIPLE COMBO! ${P} unleashes a 3-hit combo attack against ${V}...`,se.SPECIAL_ATTACK,S===Z.PLAYER?ye.PLAYER:ye.OPPONENT,{attacker:S===Z.PLAYER?"player":t.opponent.name,defender:M===Z.PLAYER?"player":t.opponent.name,specialAttack:"triple_combo",potentialDamage:E,strengthBonus:O});const b={attacker:S===Z.PLAYER?"player":t.opponent.name,defender:M===Z.PLAYER?"player":t.opponent.name,isCombo:!0,hitNumber:1,attackerAgility:R.agility,defenderAgility:H.endurance},A=e,de=(G,Q,le,ke)=>(ke&&ke.damage&&Q===se.ATTACK&&(v+=ke.damage),A(G,Q,le,ke)),W=e;e=de;const q=t.logStore;if(b.hitNumber=1,f(S,M,b),t.playerHP<=0||t.opponentHP<=0){e=W,q&&typeof q.updateMessage=="function"&&(v===0?q.updateMessage(_,`🔄 TRIPLE COMBO! ${P} missed ${V} completely! (All attacks evaded)`):q.updateMessage(_,`🔄 TRIPLE COMBO! ${P} attacked ${V} for ${v} damage! (Potential: ${E})${T}`));return}if(b.hitNumber=2,f(S,M,b),t.playerHP<=0||t.opponentHP<=0){e=W,q&&typeof q.updateMessage=="function"&&(v===0?q.updateMessage(_,`🔄 TRIPLE COMBO! ${P} missed ${V} completely! (All attacks evaded)`):q.updateMessage(_,`🔄 TRIPLE COMBO! ${P} attacked ${V} for ${v} damage! (Potential: ${E})${T}`));return}b.hitNumber=3,f(S,M,b),e=W,q&&typeof q.updateMessage=="function"&&(v===0?q.updateMessage(_,`🔄 TRIPLE COMBO! ${P} missed ${V} completely! (All attacks evaded)`):q.updateMessage(_,`🔄 TRIPLE COMBO! ${P} hit ${V} for ${v} damage! (Potential: ${E})${T}`))}function C(S,M){const P=$e(),V=S===Z.PLAYER?"You":t.opponent.name,R=M===Z.PLAYER?"you":t.opponent.name,H=u(S),O=u(M),I=1.75,E=S===Z.PLAYER?s(H.strength)*I:o(H.strength)*I,v=M===Z.PLAYER?P.effectiveEndurance:c(O.endurance),_=kn(E,v),T=Math.round(_.damage),b=ae.damage.minRandomFactor+Math.random()*(ae.damage.maxRandomFactor-ae.damage.minRandomFactor),A=Math.max(1,Math.round(T*b));e(`💥 DEVASTATING FINISHER! ${V} charges up a powerful strike against ${R} for up to ${T} potential damage!`,se.SPECIAL_ATTACK,S===Z.PLAYER?ye.PLAYER:ye.OPPONENT,{attacker:S===Z.PLAYER?"player":t.opponent.name,defender:M===Z.PLAYER?"player":t.opponent.name,specialAttack:"devastating_finisher",damageMultiplier:I,potentialDamage:T}),M===Z.PLAYER?t.playerHP-=A:t.opponentHP-=A,e(`${V} devastating finisher hits ${R} for ${A} massive damage!`,se.ATTACK,S===Z.PLAYER?ye.PLAYER:ye.OPPONENT,{attacker:S===Z.PLAYER?"player":t.opponent.name,defender:M===Z.PLAYER?"player":t.opponent.name,damage:A,specialAttack:"devastating_finisher",damageMultiplier:I})}function D(S){const M=$e();if(t.playerHP<=0||t.opponentHP<=0)return!0;if(S&&S(),t.crowdFavoriteTarget){const A=t.crowdFavoriteTarget,de=ae.specialEvents.crowdFavoriteStrengthBuff;A==="player"?t.buffs.playerStrengthBuff+=de:t.buffs.opponentStrengthBuff+=de}const P=u(Z.PLAYER),V=u(Z.OPPONENT),R=i(P.agility),H=l(V.agility),O=Math.random()<R/(R+H);O&&!t.firstStrikeTracked&&(M.trackFirstStrike(),t.firstStrikeTracked=!0);const I=Math.min(.2,R/100),E=Math.min(.2,H/100),v=ae.specialAttackChance+I,_=ae.specialAttackChance+E,T=Math.random()<v?Math.random():null,b=Math.random()<_?Math.random():null;if(O){if(T!==null?T<.4?m(Z.PLAYER,Z.OPPONENT):T<.7?y(Z.PLAYER,Z.OPPONENT):C(Z.PLAYER,Z.OPPONENT):f(Z.PLAYER,Z.OPPONENT),t.opponentHP<=0)return!0;b!==null?b<.4?m(Z.OPPONENT,Z.PLAYER):b<.7?y(Z.OPPONENT,Z.PLAYER):C(Z.OPPONENT,Z.PLAYER):f(Z.OPPONENT,Z.PLAYER)}else{if(b!==null?b<.4?m(Z.OPPONENT,Z.PLAYER):b<.7?y(Z.OPPONENT,Z.PLAYER):C(Z.OPPONENT,Z.PLAYER):f(Z.OPPONENT,Z.PLAYER),t.playerHP<=0)return!0;T!==null?T<.4?m(Z.PLAYER,Z.OPPONENT):T<.7?y(Z.PLAYER,Z.OPPONENT):C(Z.PLAYER,Z.OPPONENT):f(Z.PLAYER,Z.OPPONENT)}if(t.crowdFavoriteTarget){const A=t.crowdFavoriteTarget,de=ae.specialEvents.crowdFavoriteStrengthBuff;A==="player"?t.buffs.playerStrengthBuff-=de:t.buffs.opponentStrengthBuff-=de}return t.playerHP<=0||t.opponentHP<=0}return{processFightTurn:D,performAttack:f,performDoubleStrike:m,performTripleCombo:y,performDevastatingFinisher:C}}function jS(t,e,n){const{getEffectivePlayerStrength:s,getEffectiveOpponentStrength:i}=n;function r(){const{knockoutChance:l,adrenalineSurgeChance:c,staminaDrainChance:u,perfectCounterChance:h,adrenalineSurgeStrengthBuff:f,staminaDrainAgilityDebuff:m,buffDuration:y,counterDamageMultiplier:C,clinchRecoveryChance:D,clinchRecoveryHealPercent:S,focusShiftChance:M,focusShiftDuration:P,crowdFavoriteChance:V,crowdFavoriteStrengthBuff:R,fighterMotiveChance:H,fighterMotiveDuration:O,motiveTypes:I}=ae.specialEvents;if(Math.random()<l){Math.random()>.5&&(t.playerHP=0,e(`💥 FLASH KNOCKOUT! ${t.opponent.name} catches you with a perfect strike!`,se.KNOCKOUT,ye.OPPONENT,{isFlashKnockout:!0,opponent:t.opponent.name,target:"player"}));return}if(Math.random()<c&&(Math.random()<.5?(t.buffs.playerStrengthBuff=f,t.buffDurations.playerStrengthBuff=y,e(`💪 ADRENALINE SURGE! Your strength increases by ${f}% for ${y} turns!`,se.ADRENALINE,ye.PLAYER,{strengthBuff:f,duration:y})):(t.buffs.opponentStrengthBuff=f,t.buffDurations.opponentStrengthBuff=y,e(`💪 ADRENALINE SURGE! ${t.opponent.name}'s strength increases by ${f}% for ${y} turns!`,se.ADRENALINE,ye.OPPONENT,{opponent:t.opponent.name,strengthBuff:f,duration:y}))),Math.random()<u&&(Math.random()<.5?(t.buffs.playerAgilityBuff=m,t.buffDurations.playerAgilityBuff=-5,e(`😓 STAMINA DRAIN! Your agility decreases by ${Math.abs(m)}% for ${y} turns!`,se.STAMINA_DRAIN,ye.PLAYER,{agilityDebuff:Math.abs(m),duration:y})):(t.buffs.opponentAgilityBuff=m,t.buffDurations.opponentAgilityBuff=-5,e(`😓 STAMINA DRAIN! ${t.opponent.name}'s agility decreases by ${Math.abs(m)}% for ${y} turns!`,se.STAMINA_DRAIN,ye.OPPONENT,{opponent:t.opponent.name,agilityDebuff:Math.abs(m),duration:y}))),Math.random()<h)if(Math.random()<.5){const E=s($e().effectiveStrength),v=kn(E*C,t.opponent.endurance),_=isNaN(v.damage)?1:v.damage;t.opponentHP-=_,isNaN(t.opponentHP)&&(console.warn("Opponent HP became NaN during counter! Resetting to 1"),t.opponentHP=1);const T=Math.round(isNaN(_)?1:_);e(`⚡ PERFECT COUNTER! You block and counter for 💥 ${T} damage!`,se.COUNTER,ye.PLAYER,{damage:T,isPerfectCounter:!0,counterTarget:t.opponent.name,multiplier:C})}else{const E=i(t.opponent.strength),v=kn(E*C,$e().effectiveEndurance),_=isNaN(v.damage)?1:v.damage;t.playerHP-=_,isNaN(t.playerHP)&&(console.warn("Player HP became NaN during counter! Resetting to 1"),t.playerHP=1);const T=Math.round(isNaN(_)?1:_);e(`⚡ PERFECT COUNTER! ${t.opponent.name} blocks and counters for 💥 ${T} damage!`,se.COUNTER,ye.OPPONENT,{damage:T,isPerfectCounter:!0,opponent:t.opponent.name,counterTarget:"player",multiplier:C})}if(Math.random()<D)if(Math.random()<.5){const E=Math.round(S);if(t.playerHP<100){const v=Math.min(E,100-t.playerHP);t.playerHP+=v,e(`🤼 CLINCH! You tie up your opponent and recover ${v}% health!`,se.CLINCH,ye.PLAYER,{healAmount:v,currentHp:t.playerHP,previousHp:t.playerHP-v})}}else{const E=Math.round(S);if(t.opponentHP<100){const v=Math.min(E,100-t.opponentHP);t.opponentHP+=v,e(`🤼 CLINCH! ${t.opponent.name} ties you up and recovers ${v}% health!`,se.CLINCH,ye.OPPONENT,{opponent:t.opponent.name,healAmount:v,currentHp:t.opponentHP,previousHp:t.opponentHP-v})}}if(Math.random()<M){if(Math.random()<.5){if(t.playerFocusShiftDuration<=0){const E=["offensive","defensive","balanced"].filter(b=>b!==t.playerFocusMode),v=E[Math.floor(Math.random()*E.length)];t.playerFocusMode=v,t.playerFocusShiftDuration=P;let _="",T={};v==="offensive"?(_="You shift to an offensive stance, increasing strength but sacrificing defense!",T={strengthChange:ae.specialEvents.focusOffensiveStrengthBuff,agilityChange:ae.specialEvents.focusOffensiveAgilityChange,enduranceChange:ae.specialEvents.focusOffensiveEnduranceChange}):v==="defensive"?(_="You adopt a defensive posture, increasing endurance but reducing offensive power!",T={strengthChange:ae.specialEvents.focusDefensiveStrengthChange,agilityChange:ae.specialEvents.focusDefensiveAgilityBuff,enduranceChange:ae.specialEvents.focusDefensiveEnduranceBuff}):(_="You readjust to a balanced fighting stance!",T={strengthChange:ae.specialEvents.focusBalancedStrengthChange,agilityChange:ae.specialEvents.focusBalancedAgilityChange,enduranceChange:ae.specialEvents.focusBalancedEnduranceChange}),e(`🔄 FOCUS SHIFT! ${_}`,se.FOCUS_SHIFT,ye.PLAYER,{previousFocus:t.playerFocusMode,newFocus:v,duration:P,...T})}}else if(t.opponentFocusShiftDuration<=0){const E=["offensive","defensive","balanced"].filter(b=>b!==t.opponentFocusMode),v=E[Math.floor(Math.random()*E.length)];t.opponentFocusMode=v,t.opponentFocusShiftDuration=P;let _="",T={};v==="offensive"?(_="shifts to an offensive stance, increasing strength but sacrificing defense!",T={strengthChange:ae.specialEvents.focusOffensiveStrengthBuff,agilityChange:ae.specialEvents.focusOffensiveAgilityChange,enduranceChange:ae.specialEvents.focusOffensiveEnduranceChange}):v==="defensive"?(_="adopts a defensive posture, increasing endurance but reducing offensive power!",T={strengthChange:ae.specialEvents.focusDefensiveStrengthChange,agilityChange:ae.specialEvents.focusDefensiveAgilityBuff,enduranceChange:ae.specialEvents.focusDefensiveEnduranceBuff}):(_="readjusts to a balanced fighting stance!",T={strengthChange:ae.specialEvents.focusBalancedStrengthChange,agilityChange:ae.specialEvents.focusBalancedAgilityChange,enduranceChange:ae.specialEvents.focusBalancedEnduranceChange}),e(`🔄 FOCUS SHIFT! ${t.opponent.name} ${_}`,se.FOCUS_SHIFT,ye.OPPONENT,{opponent:t.opponent.name,previousFocus:t.opponentFocusMode,newFocus:v,duration:P,...T})}}if(Math.random()<V&&!t.crowdFavoriteTarget){const E=Math.random()<.5?"player":"opponent";t.crowdFavoriteTarget=E,t.crowdFavoriteDuration=y,E==="player"?e(`🎭 CROWD FAVORITE! The crowd cheers for you, boosting your strength by ${R}% for ${y} turns!`,se.CROWD_FAVOR,ye.PLAYER,{favorTarget:"player",strengthBuff:R,duration:y}):e(`🎭 CROWD FAVORITE! The crowd cheers for ${t.opponent.name}, boosting their strength by ${R}% for ${y} turns!`,se.CROWD_FAVOR,ye.OPPONENT,{favorTarget:"opponent",opponent:t.opponent.name,strengthBuff:R,duration:y})}if(Math.random()<H){if(Math.random()<.5&&!t.playerMotiveActive){const E=Object.keys(I),v=E[Math.floor(Math.random()*E.length)],_=I[v];t.playerMotiveActive=!0,t.playerMotiveType=v,t.playerMotiveDuration=O,e(`🔥 MOTIVATION: You ${_.message}`,se.FIGHTER_MOTIVE,ye.PLAYER,{motiveStarted:!0,motiveType:v,strengthBuff:_.strengthBuff,agilityBuff:_.agilityBuff,enduranceBuff:_.enduranceBuff,duration:O})}else if(!t.opponentMotiveActive){const E=Object.keys(I),v=E[Math.floor(Math.random()*E.length)],_=I[v];t.opponentMotiveActive=!0,t.opponentMotiveType=v,t.opponentMotiveDuration=O,e(`🔥 MOTIVATION: ${t.opponent.name} ${_.message}`,se.FIGHTER_MOTIVE,ye.OPPONENT,{motiveStarted:!0,opponent:t.opponent.name,motiveType:v,strengthBuff:_.strengthBuff,agilityBuff:_.agilityBuff,enduranceBuff:_.enduranceBuff,duration:O})}}}function o(l){const{secondChanceChance:c,secondChanceHealPercent:u,secondChanceStrengthBuff:h,secondChanceAgilityBuff:f,secondChanceDuration:m}=ae.specialEvents;if(l===ye.PLAYER&&t.playerHasSecondChance){if(Math.random()<c)return t.playerHP=u,t.playerHasSecondChance=!1,t.playerSecondChanceActive=!0,t.playerSecondChanceDuration=m,e("✨ SECOND CHANCE! Through sheer determination, you refuse to stay down!",se.SECOND_CHANCE,ye.PLAYER,{healAmount:u,strengthBuff:h,agilityBuff:f,duration:m}),!0}else if(l===ye.OPPONENT&&t.opponentHasSecondChance&&Math.random()<c)return t.opponentHP=u,t.opponentHasSecondChance=!1,t.opponentSecondChanceActive=!0,t.opponentSecondChanceDuration=m,e(`✨ SECOND CHANCE! ${t.opponent.name} refuses to stay down!`,se.SECOND_CHANCE,ye.OPPONENT,{opponent:t.opponent.name,healAmount:u,strengthBuff:h,agilityBuff:f,duration:m}),!0;return!1}return{checkForSpecialEvents:r,checkForSecondChance:o}}function KS(t,e,n,s,i){const{inFight:r,fightStartTime:o,isBackgrounded:l,fightState:c,rewardConfig:u}=t;function h(P){if(l.value=P.detail.isHidden,r.value&&c.fightInterval){clearInterval(c.fightInterval);const V=l.value?6e3:2e3;c.fightInterval=setInterval(()=>{y()},V)}}function f(){typeof window<"u"&&window.addEventListener("app-visibility-changed",h)}function m(){typeof window<"u"&&window.removeEventListener("app-visibility-changed",h)}function y(){c.turnCount=(c.turnCount||0)+1;const P=e.processFightTurn(n.updateBuffDurations);if(c.playerHP<20&&!c.playerHpDroppedBelow20&&(c.playerHpDroppedBelow20=!0),P){D();return}s.checkForSpecialEvents()}function C(P){const V=$e(),R=sn();if(V.isOpponentOnCooldown(P.name)){const E=V.getOpponentCooldownTime(P.name),v=V.getOpponentFightCount(P.name);return{success:!1,error:`This opponent is on cooldown for ${E}. Try another opponent or wait.`,fightCount:v}}r.value=!0,o.value=Date.now(),c.opponent=P,c.playerHP=100,c.opponentHP=100,c.log=[],c.fightEnded=!1,c.turnCount=0,c.playerHpDroppedBelow20=!1,c.firstStrikeTracked=!1;const H=V.getOpponentFightCount(P.name)||0;i(`🥊 FIGHT STARTS: You vs ${P.name}! 🥊`,se.FIGHT_START,ye.SYSTEM,{opponent:P.name});const O=V.getOpponentVictoryCount(P.name);O>0?i(`You've defeated this opponent ${O} times before.`,se.INFO,ye.SYSTEM,{victoryCount:O}):H>0&&i(`You've attempted to defeat this opponent ${H} times, but haven't won yet.`,se.INFO,ye.SYSTEM,{fightCount:H,victoryCount:0}),gs("fight_started",{opponent_name:P.name,opponent_tier:P.tier,player_strength:V.effectiveStrength,player_agility:V.effectiveAgility,player_endurance:V.effectiveEndurance,player_skills_count:R.ownedSkills.length,fight_count:H}),c.buffs={playerStrengthBuff:0,playerAgilityBuff:0,playerEnduranceBuff:0,opponentStrengthBuff:0,opponentAgilityBuff:0,opponentEnduranceBuff:0},c.buffDurations={playerStrengthBuff:0,playerAgilityBuff:0,playerEnduranceBuff:0,opponentStrengthBuff:0,opponentAgilityBuff:0,opponentEnduranceBuff:0},c.playerFocusMode="balanced",c.opponentFocusMode="balanced",c.playerFocusShiftDuration=0,c.opponentFocusShiftDuration=0,c.playerInComeback=!1,c.opponentInComeback=!1,c.crowdFavoriteTarget=null,c.crowdFavoriteDuration=0,c.playerMotiveActive=!1,c.opponentMotiveActive=!1,c.playerMotiveType=null,c.opponentMotiveType=null,c.playerMotiveDuration=0,c.opponentMotiveDuration=0,c.playerHasSecondChance=!0,c.opponentHasSecondChance=!0,c.playerSecondChanceActive=!1,c.opponentSecondChanceActive=!1,c.playerSecondChanceDuration=0,c.opponentSecondChanceDuration=0,R.ownedSkills.length>0&&i(`Your skills: ${R.ownedSkills.join(", ")}`,se.INFO,ye.PLAYER,{skills:R.ownedSkills}),P.skills.length>0&&i(`${P.name}'s skills: ${P.skills.join(", ")}`,se.INFO,ye.OPPONENT,{skills:P.skills});const I=l.value?6e3:2e3;return c.fightInterval=setInterval(()=>{y()},I),{success:!0}}function D(){if(c.playerHP<=0){if(s.checkForSecondChance(ye.PLAYER))return}else if(c.opponentHP<=0&&s.checkForSecondChance(ye.OPPONENT))return;c.fightInterval&&(clearInterval(c.fightInterval),c.fightInterval=null),c.fightEnded=!0;const P=$e(),V=Date.now()-o.value,R=c.playerHP<=0?"defeat":"victory",H=R==="victory";P.trackOpponentFight(c.opponent.name,H);const O=P.getOpponentFightCount(c.opponent.name),I=P.getOpponentVictoryCount(c.opponent.name),E=Math.round(V/1e3),v=c.turnCount||0;if(H){v<5&&P.trackQuickWin();const b=(c.opponent.tier||1)-1;b>=3&&P.trackGiantKillerVictory(c.opponent.name,b*10),c.playerHpDroppedBelow20&&P.trackComebackVictory(),P.trackTimeBasedWin()}if(gs("fight_ended",{opponent_name:c.opponent.name,opponent_tier:c.opponent.tier,result:R,player_hp_remaining:c.playerHP,opponent_hp_remaining:c.opponentHP,fight_duration_seconds:E,total_fight_count:O,victory_count:I}),c.playerHP<=0){i(`😵 DEFEAT: You have been beaten by ${c.opponent.name}! 😞`,se.FIGHT_END,ye.SYSTEM,{result:"defeat",opponent:c.opponent.name,playerHpRemaining:0,opponentHpRemaining:c.opponentHP}),P.addLoss();try{St(async()=>{const{saveAndSyncProgress:_}=await Promise.resolve().then(()=>cc);return{saveAndSyncProgress:_}},void 0).then(({saveAndSyncProgress:_})=>{_()}).catch(_=>{console.error("Could not sync with leaderboard:",_)})}catch(_){console.error("Could not import leaderboard module:",_)}u.enabled&&u.consolationReward>0&&(P.addTrainingPoints(u.consolationReward),i(`You earned ${u.consolationReward} Training Point as consolation.`,se.REWARD,ye.SYSTEM,{rewardAmount:u.consolationReward,isConsolation:!0}))}else if(c.opponentHP<=0){i(`🏆 VICTORY: You have defeated ${c.opponent.name}! 💪`,se.FIGHT_END,ye.SYSTEM,{result:"victory",opponent:c.opponent.name,playerHpRemaining:c.playerHP,opponentHpRemaining:0}),P.addWin(),P.addDefeatedOpponent(c.opponent.name);try{St(async()=>{const{saveAndSyncProgress:_}=await Promise.resolve().then(()=>cc);return{saveAndSyncProgress:_}},void 0).then(({saveAndSyncProgress:_})=>{_()}).catch(_=>{console.error("Could not sync with leaderboard:",_)})}catch(_){console.error("Could not import leaderboard module:",_)}if(u.enabled){let _=u.baseReward;if(u.scalingEnabled){const b=c.opponent.strength+c.opponent.agility+c.opponent.endurance,A=Math.round(b/20);_+=A}P.getOpponentFightCount(c.opponent.name);const T=P.getOpponentVictoryCount(c.opponent.name);P.addTrainingPoints(_),i(`💰 REWARD: You earned ${_} Training Points! 🎉`,se.REWARD,ye.SYSTEM,{rewardAmount:_}),T<=1?i(`⏱️ COOLDOWN: Now that you've defeated this opponent, they will be on a ${ae.cooldown.durationMinutes} minute cooldown after future victories.`,se.INFO,ye.SYSTEM,{cooldownMinutes:ae.cooldown.durationMinutes,firstVictory:!0}):i(`⏱️ COOLDOWN: This opponent is now on a ${ae.cooldown.durationMinutes} minute cooldown.`,se.INFO,ye.SYSTEM,{cooldownMinutes:ae.cooldown.durationMinutes,firstVictory:!1})}else c.log.push("Fight rewards are currently disabled.")}}function S(){r.value=!1,c.opponent=null,c.log=[];const P=$e();P.activeBoost&&(P.activeBoost=null,P.savePlayerData()),m()}function M(){const P=$e();return[...dr].sort((V,R)=>{const H=P.defeatedOpponents.includes(V.name),O=P.defeatedOpponents.includes(R.name);if(H&&!O)return-1;if(!H&&O)return 1;const I=dr.findIndex(v=>v.name===V.name),E=dr.findIndex(v=>v.name===R.name);return I-E})}return f(),{startFight:C,processFightTurn:y,endFight:D,exitFight:S,availableOpponents:M,cleanupEventListeners:m}}const Zs=Dr("fight",()=>{const{inFight:t,fightStartTime:e,isBackgrounded:n,fightState:s,rewardConfig:i,resetState:r,updateRewardConfig:o,toggleRewards:l}=FS(),c=$S(s),u=LS(s,c),h=HS(s,c,u),f=jS(s,c,u),m=KS({inFight:t,fightStartTime:e,isBackgrounded:n,fightState:s,rewardConfig:i},h,u,f,c);return{inFight:t,fightState:s,rewardConfig:i,isBackgrounded:n,availableOpponents:m.availableOpponents,getEffectivePlayerStrength:u.getEffectivePlayerStrength,getEffectivePlayerAgility:u.getEffectivePlayerAgility,getEffectivePlayerEndurance:u.getEffectivePlayerEndurance,getEffectiveOpponentStrength:u.getEffectiveOpponentStrength,getEffectiveOpponentAgility:u.getEffectiveOpponentAgility,getEffectiveOpponentEndurance:u.getEffectiveOpponentEndurance,startFight:m.startFight,processFightTurn:m.processFightTurn,performAttack:h.performAttack,endFight:m.endFight,exitFight:m.exitFight,checkForSpecialEvents:f.checkForSpecialEvents,updateRewardConfig:o,toggleRewards:l,cleanupEventListeners:m.cleanupEventListeners,$reset:r}}),qS={class:"boost-items-container"},GS={class:"expandable-icon"},WS={key:0,class:"section-content"},zS={class:"boost-buttons"},YS=["disabled"],QS=["disabled"],XS=["disabled"],JS={class:"boost-info"},ZS={class:"boost-cost"},eC={key:0,class:"active-boost"},tC={__name:"BoostItems",setup(t){const e=$e(),n=Zs(),s=ue(localStorage.getItem("boostSectionExpanded")==="true"),i=ue(null),r=Le(()=>n.inFight),o=ot.boostItems.cost,l=ot.boostItems.boostPercentage,c=Le(()=>e.trainingPoints>=o),u=ot.boostItems.dailyLimit,h=Le(()=>{if(!e.boostPurchases)return 0;const D=new Date().toDateString();return e.boostPurchases.filter(S=>new Date(S).toDateString()===D).length}),f=Le(()=>h.value>=u);function m(){s.value=!s.value,localStorage.setItem("boostSectionExpanded",s.value)}function y(D){if(!c.value||r.value||f.value)return;e.trainingPoints-=o,e.activeBoost=D,i.value=D,e.boostPurchases||(e.boostPurchases=[]);const S=new Date().getTime();e.boostPurchases.push(S),e.savePlayerData()}function C(D){return D==="strength"?"STR":D==="agility"?"AGI":D==="endurance"?"END":D}return Wt(()=>{i.value=e.activeBoost}),on(()=>n.inFight,(D,S)=>{S&&!D&&i.value&&(e.activeBoost=null,i.value=null,e.savePlayerData())}),(D,S)=>(B(),K("div",qS,[g("div",{class:"section-header",onClick:m},[g("h3",null,[S[3]||(S[3]=ft("Boost Items ")),g("span",GS,L(s.value?"▼":"▶"),1)])]),s.value?(B(),K("div",WS,[g("div",zS,[g("button",{class:"boost-button str-boost",onClick:S[0]||(S[0]=M=>y("strength")),disabled:!c.value||r.value||f.value}," STR +"+L(ee(l))+"% ",9,YS),g("button",{class:"boost-button agi-boost",onClick:S[1]||(S[1]=M=>y("agility")),disabled:!c.value||r.value||f.value}," AGI +"+L(ee(l))+"% ",9,QS),g("button",{class:"boost-button end-boost",onClick:S[2]||(S[2]=M=>y("endurance")),disabled:!c.value||r.value||f.value}," END +"+L(ee(l))+"% ",9,XS)]),g("div",JS,[g("p",ZS,"Cost: "+L(ee(o))+" Training Points",1),g("p",{class:Oe(["boost-limit",{"limit-reached":f.value}])},L(f.value?"Daily limit reached. Available again tomorrow.":`Remaining: ${ee(u)-h.value} of ${ee(u)} per day`),3),S[4]||(S[4]=g("p",{class:"boost-condition"},"Effect lasts for one fight only",-1)),i.value?(B(),K("p",eC," Active: "+L(C(i.value))+" (+"+L(ee(l))+"%) for current fight ",1)):X("v-if",!0)])])):X("v-if",!0)]))}},nC=ct(tC,[["__scopeId","data-v-07dfb5c9"]]),sC={class:"card training-section"},iC={class:"training-header"},rC={class:"title-container"},oC={key:0,class:"record-badge"},aC={class:"win-count"},lC={class:"loss-count"},cC={class:"win-rate-pill"},uC={class:"stats-header-right"},dC={class:"header-stats"},hC={class:"rest-bars"},fC={key:0,class:"rest-tooltip"},pC={class:"training-points"},gC={class:"value"},mC={class:"stats-container"},vC={class:"stats-grid"},yC=2,_C={__name:"TrainingSection",setup(t){const e=$e(),n=Di(),s=ue(!1),i=ue(!1),r=ue(0);async function o(){r.value=await e.getMaxRestPoints()}let l;Wt(()=>{localStorage.getItem("pendingTraining")||e.updateRestPoints(),o(),e.restPoints>4&&(e.$patch({restPoints:4}),e.savePlayerData()),l=setInterval(()=>{n.isTraining||(e.updateRestPoints(),o())},6e4)}),Pr(()=>{l&&clearInterval(l)});function c(){s.value=!0}function u(){s.value=!1}function h(f){const m=yC*f;return e.restPoints>=m}return(f,m)=>(B(),K("div",sC,[g("div",iC,[g("div",rC,[ee(e).fightStats.totalFights>0?(B(),K("div",oC,[g("span",aC,L(ee(e).fightStats.wins)+"W",1),g("span",lC,L(ee(e).fightStats.losses)+"L",1),g("span",cC,L(ee(e).fightStats.winRate)+"%",1),g("span",{class:"share-icon",onClick:c,title:"Share your stats"},"📊")])):X("v-if",!0)]),g("div",uC,[g("div",dC,[g("div",{class:"rest-gauge",onClick:m[1]||(m[1]=y=>i.value=!i.value)},[m[6]||(m[6]=g("span",{class:"rest-icon"},"💤",-1)),g("div",hC,[(B(),K("div",{class:Oe(["rest-bar",{filled:h(1)}]),key:"bar1-"+ee(e).restPoints},null,2)),(B(),K("div",{class:Oe(["rest-bar",{filled:h(2)}]),key:"bar2-"+ee(e).restPoints},null,2))]),X(" Tooltip that appears when clicked "),i.value?(B(),K("div",fC,[m[2]||(m[2]=g("h4",null,"It's a Rest Day",-1)),m[3]||(m[3]=g("p",null,"- Stop training! Earn 1 bar every 2 minutes",-1)),m[4]||(m[4]=g("p",null,"- Each bar = one Fast Training session",-1)),m[5]||(m[5]=g("p",null,[ft("Use Fast Training to "),g("b",null,"⚡ train 4x faster!")],-1)),g("div",{class:"tooltip-close",onClick:m[0]||(m[0]=sr(y=>i.value=!1,["stop"]))}," × ")])):X("v-if",!0)]),g("div",pC,[m[7]||(m[7]=ft(" TP: ")),g("span",gC,L(ee(e).trainingPoints),1)])])])]),g("div",mC,[g("div",vC,[Ue(Tl,{stat:"strength",label:"STR",value:ee(e).strength},null,8,["value"]),Ue(Tl,{stat:"agility",label:"AGI",value:ee(e).agility},null,8,["value"]),Ue(Tl,{stat:"endurance",label:"END",value:ee(e).endurance},null,8,["value"])]),ee(n).isTraining?(B(),ss(JI,{key:0})):X("v-if",!0)]),Ue(nC,{class:"boost-items-section"}),X(" Brag Stats Modal "),Ue(VS,{show:s.value,onClose:u},null,8,["show"])]))}},EC=ct(_C,[["__scopeId","data-v-a7258fca"]]),TC={class:"skill-main"},bC={class:"skill-header"},wC={class:"skill-name"},AC={class:"skill-tier"},IC={class:"skill-description"},SC={class:"skill-stats"},CC={key:0,class:"scaling-info"},kC={key:0,class:"scaling-info"},PC={key:0,class:"scaling-info"},RC={key:0,class:"scaling-factors"},DC={class:"scaling-factor"},MC={class:"skill-action"},OC={class:"skill-cost"},NC=["disabled"],xC={key:1,class:"owned-badge"},VC={__name:"SkillItem",props:{skill:{type:Object,required:!0},owned:{type:Boolean,default:!1},canPurchase:{type:Boolean,default:!1}},setup(t){const e=t,n=sn(),s=$e();function i(){n.purchaseSkill(e.skill.name)}function r(c,u){if(!e.owned||c===0)return"";let h;switch(u){case"strength":h=s.strengthScalingFactor;break;case"agility":h=s.agilityScalingFactor;break;case"endurance":h=s.enduranceScalingFactor;break;default:h=1}const f=c*h;return f>0?"+"+f.toFixed(1)+"%":f.toFixed(1)+"%"}function o(){if(!e.owned)return 1;const c=[];return e.skill.strength!==0&&c.push(s.strengthScalingFactor),e.skill.agility!==0&&c.push(s.agilityScalingFactor),e.skill.endurance!==0&&c.push(s.enduranceScalingFactor),c.length===0?1:c.reduce((u,h)=>u+h,0)/c.length}function l(c){return(c*100).toFixed(0)+"%"}return(c,u)=>(B(),K("div",{class:Oe(["skill-item",{owned:t.owned,"tier-small":t.skill.tier==="Small","tier-medium":t.skill.tier==="Medium","tier-big":t.skill.tier==="Big","tier-ultimate":t.skill.tier==="Ultimate"}])},[g("div",TC,[g("div",bC,[g("h3",wC,L(t.skill.name),1),g("div",AC,L(t.skill.tier),1)]),g("p",IC,L(t.skill.description),1),g("div",SC,[g("div",{class:Oe(["stat",{positive:t.skill.strength>0,negative:t.skill.strength<0}])},[ft(" STR: "+L(t.skill.strength>0?"+":"")+L(t.skill.strength)+"% ",1),t.owned&&t.skill.strength!==0?(B(),K("span",CC," ("+L(r(t.skill.strength,"strength"))+") ",1)):X("v-if",!0)],2),g("div",{class:Oe(["stat",{positive:t.skill.agility>0,negative:t.skill.agility<0}])},[ft(" AGI: "+L(t.skill.agility>0?"+":"")+L(t.skill.agility)+"% ",1),t.owned&&t.skill.agility!==0?(B(),K("span",kC," ("+L(r(t.skill.agility,"agility"))+") ",1)):X("v-if",!0)],2),g("div",{class:Oe(["stat",{positive:t.skill.endurance>0,negative:t.skill.endurance<0}])},[ft(" END: "+L(t.skill.endurance>0?"+":"")+L(t.skill.endurance)+"% ",1),t.owned&&t.skill.endurance!==0?(B(),K("span",PC," ("+L(r(t.skill.endurance,"endurance"))+") ",1)):X("v-if",!0)],2)]),t.owned?(B(),K("div",RC,[g("div",DC," Effectiveness: "+L(l(o())),1)])):X("v-if",!0)]),g("div",MC,[g("div",OC,L(t.skill.cost)+" TP",1),t.owned?(B(),K("div",xC,"Learned")):(B(),K("button",{key:0,onClick:i,disabled:!t.canPurchase,class:"purchase-button"}," Learn ",8,NC))])],2))}},FC=ct(VC,[["__scopeId","data-v-c708d345"]]),$C={class:"section-header"},LC={key:0,class:"filter-controls"},BC={key:1,class:"scaling-info"},UC={class:"scaling-factor"},HC={class:"scaling-value"},jC={class:"scaling-factor"},KC={class:"scaling-value"},qC={class:"scaling-factor"},GC={class:"scaling-value"},WC={key:2,class:"skills-list"},zC={__name:"SkillsSection",setup(t){const e=sn(),n=$e(),s=ue("all"),i=ue(!0),r=Le(()=>s.value==="owned"?e.availableSkills.filter(l=>e.ownedSkills.includes(l.name)):s.value==="available"?e.availableSkills.filter(l=>!e.ownedSkills.includes(l.name)):e.availableSkills);function o(l){return(l*100).toFixed(0)+"%"}return(l,c)=>(B(),K("div",{class:Oe(["card skills-section",{collapsed:!i.value}])},[g("div",$C,[c[4]||(c[4]=g("h2",null,"Skills",-1)),g("button",{class:"toggle-button",onClick:c[0]||(c[0]=u=>i.value=!i.value)},L(i.value?"▲":"▼"),1)]),g("div",{class:Oe(["skills-container",{collapsed:!i.value}])},[i.value?(B(),K("div",LC,[g("button",{onClick:c[1]||(c[1]=u=>s.value="all"),class:Oe({active:s.value==="all"})}," All ",2),g("button",{onClick:c[2]||(c[2]=u=>s.value="owned"),class:Oe({active:s.value==="owned"})}," Owned ",2),g("button",{onClick:c[3]||(c[3]=u=>s.value="available"),class:Oe({active:s.value==="available"})}," Available ",2)])):X("v-if",!0),i.value&&ee(e).ownedSkills.length>0?(B(),K("div",BC,[g("div",UC,[c[5]||(c[5]=g("span",null,"STR Effectiveness:",-1)),g("span",HC,L(o(ee(n).strengthScalingFactor)),1)]),g("div",jC,[c[6]||(c[6]=g("span",null,"AGI Effectiveness:",-1)),g("span",KC,L(o(ee(n).agilityScalingFactor)),1)]),g("div",qC,[c[7]||(c[7]=g("span",null,"END Effectiveness:",-1)),g("span",GC,L(o(ee(n).enduranceScalingFactor)),1)])])):X("v-if",!0),i.value?(B(),K("div",WC,[(B(!0),K(mt,null,ns(r.value,u=>(B(),ss(FC,{key:u.name,skill:u,owned:ee(e).hasSkill(u.name),"can-purchase":ee(n).trainingPoints>=u.cost},null,8,["skill","owned","can-purchase"]))),128))])):X("v-if",!0)],2)],2))}},YC=ct(zC,[["__scopeId","data-v-18ef735d"]]),QC={class:"opponent-selection"},XC={class:"selection-header"},JC={class:"filter-controls"},ZC={class:"opponents-grid"},e1={class:"avatar-header"},t1={class:"fighter-emoji"},n1={key:0},s1={key:1},i1={key:2},r1={key:3},o1={key:4},a1={class:"header-info"},l1={class:"opponent-name"},c1=["title"],u1={key:1,class:"defeated-badge"},d1={class:"opponent-stats"},h1={class:"stat-bar"},f1={class:"stat-bar-bg"},p1={class:"stat-value"},g1={class:"stat-bar"},m1={class:"stat-bar-bg"},v1={class:"stat-value"},y1={class:"stat-bar"},_1={class:"stat-bar-bg"},E1={class:"stat-value"},T1={key:0,class:"opponent-description"},b1={class:"opponent-skills"},w1={class:"skills-list"},A1={class:"opponent-footer"},I1={key:0,class:"fight-count"},S1={key:1,class:"spacer"},C1=["onClick","disabled","title"],k1={__name:"OpponentSelection",setup(t){const e=Zs(),n=$e(),s=ue("all");try{const f=localStorage.getItem("opponentFilter");f&&(s.value=f)}catch(f){console.error("Error loading filter preference:",f)}const i=ue([]);function r(){try{const f=localStorage.getItem("recentOpponents");if(f){const m=e.availableOpponents(),y=JSON.parse(f),C=[];y.length>0&&typeof y[0]=="object"?y.sort((D,S)=>S.timestamp-D.timestamp).forEach(D=>{const S=m.find(M=>M.name===D.name);S&&C.push({...S,timestamp:D.timestamp})}):y.forEach(D=>{const S=m.find(M=>M.name===D);S&&C.push({...S,timestamp:Date.now()})}),i.value=C}}catch(f){console.error("Error loading recent opponents:",f)}}function o(){try{const f=i.value.map(m=>({name:m.name,timestamp:m.timestamp||Date.now()}));localStorage.setItem("recentOpponents",JSON.stringify(f))}catch(f){console.error("Error saving recent opponents:",f)}}function l(f){if(!f)return;const m={...f,timestamp:Date.now()},y=i.value.findIndex(C=>C.name===f.name);y!==-1&&i.value.splice(y,1),i.value.push(m),i.value.sort((C,D)=>D.timestamp-C.timestamp),i.value.length>5&&(i.value=i.value.slice(0,5)),o()}r(),on(()=>e.inFight,(f,m)=>{f&&!m&&e.fightState.opponent&&l(e.fightState.opponent)}),e.inFight&&e.fightState.opponent&&l(e.fightState.opponent);const c=Le(()=>{const f=e.availableOpponents();switch(s.value){case"defeated":return f.filter(y=>n.defeatedOpponents.includes(y.name));case"undefeated":return f.filter(y=>!n.defeatedOpponents.includes(y.name));case"recent":const m=i.value.map(y=>y.name);return f.filter(y=>m.includes(y.name)).sort((y,C)=>m.indexOf(y.name)-m.indexOf(C.name));default:return f}});function u(f){s.value=f;try{localStorage.setItem("opponentFilter",f)}catch(m){console.error("Error saving filter preference:",m)}}function h(f){if(n.isOpponentOnCooldown(f.name)){alert(`This opponent is on cooldown for ${n.getOpponentCooldownTime(f.name)}. Try again later or choose another opponent.`);return}l(f);const m=e.startFight(f);m&&!m.success&&alert(m.error)}return(f,m)=>(B(),K("div",QC,[g("div",XC,[m[4]||(m[4]=g("h3",null,"Select an opponent:",-1)),g("div",JC,[g("button",{onClick:m[0]||(m[0]=y=>u("all")),class:Oe(["filter-btn",{active:s.value==="all"}])}," All ",2),g("button",{onClick:m[1]||(m[1]=y=>u("defeated")),class:Oe(["filter-btn",{active:s.value==="defeated"}])}," Defeated ",2),g("button",{onClick:m[2]||(m[2]=y=>u("undefeated")),class:Oe(["filter-btn",{active:s.value==="undefeated"}])}," Undefeated ",2),g("button",{onClick:m[3]||(m[3]=y=>u("recent")),class:Oe(["filter-btn",{active:s.value==="recent"}])}," Recent ",2)])]),g("div",ZC,[(B(!0),K(mt,null,ns(c.value,y=>(B(),K("div",{key:y.name,class:Oe(["opponent-card",{defeated:ee(n).defeatedOpponents.includes(y.name),available:!ee(n).defeatedOpponents.includes(y.name),cooldown:ee(n).isOpponentOnCooldown(y.name)}])},[g("div",e1,[g("div",{class:Oe(["avatar-container","stance-"+y.name.length%5])},[g("div",t1,[y.name.length%5===0?(B(),K("span",n1,"🥊")):y.name.length%5===1?(B(),K("span",s1,"👊")):y.name.length%5===2?(B(),K("span",i1,"💪")):y.name.length%5===3?(B(),K("span",r1,"🦵")):y.name.length%5===4?(B(),K("span",o1,"🥋")):X("v-if",!0)])],2),g("div",a1,[g("h4",l1,L(y.name),1),ee(n).isOpponentOnCooldown(y.name)?(B(),K("div",{key:0,class:"cooldown-badge",title:`This opponent can be fought again in ${ee(n).getOpponentCooldownTime(y.name)}`}," Cooldown: "+L(ee(n).getOpponentCooldownTime(y.name)),9,c1)):ee(n).defeatedOpponents.includes(y.name)?(B(),K("div",u1," Defeated ")):X("v-if",!0)])]),g("div",d1,[g("div",h1,[m[5]||(m[5]=g("span",{class:"stat-label"},"STR:",-1)),g("div",f1,[g("div",{class:"stat-bar-fill str",style:qt({width:`${Math.min(100,y.strength)}%`})},null,4)]),g("span",p1,L(y.strength),1)]),g("div",g1,[m[6]||(m[6]=g("span",{class:"stat-label"},"AGI:",-1)),g("div",m1,[g("div",{class:"stat-bar-fill agi",style:qt({width:`${Math.min(100,y.agility)}%`})},null,4)]),g("span",v1,L(y.agility),1)]),g("div",y1,[m[7]||(m[7]=g("span",{class:"stat-label"},"END:",-1)),g("div",_1,[g("div",{class:"stat-bar-fill end",style:qt({width:`${Math.min(100,y.endurance)}%`})},null,4)]),g("span",E1,L(y.endurance),1)])]),y.description?(B(),K("div",T1,L(y.description),1)):X("v-if",!0),g("div",b1,[m[8]||(m[8]=g("div",{class:"skills-label"},"Skills:",-1)),g("div",w1,L(y.skills.join(", ")),1)]),g("div",A1,[ee(n).getOpponentVictoryCount(y.name)>0?(B(),K("div",I1," Defeated "+L(ee(n).getOpponentVictoryCount(y.name))+" times ",1)):(B(),K("div",S1)),g("button",{onClick:C=>h(y),class:"fight-button",disabled:ee(n).isOpponentOnCooldown(y.name),title:ee(n).isOpponentOnCooldown(y.name)?`On cooldown for ${ee(n).getOpponentCooldownTime(y.name)}`:""},L(ee(n).isOpponentOnCooldown(y.name)?"Cooldown":"Fight"),9,C1)])],2))),128))])]))}},P1=ct(k1,[["__scopeId","data-v-a9324640"]]),R1={class:"fighter-header"},D1={class:"fighter-name"},M1={class:"health-text"},O1={class:"health-container"},N1={class:"health-bar"},x1={key:0,class:"health-percent"},V1={key:0,class:"health-percent outside"},F1={key:0,class:"fighter-description"},$1={class:"fighter-stats-container"},L1={class:"stats-header"},B1={key:0,class:"record-badge"},U1={class:"win-count"},H1={class:"loss-count"},j1={class:"win-rate-pill"},K1={key:0,class:"fighter-stats"},q1={class:"stat"},G1={class:"stat-value"},W1={class:"stat"},z1={class:"stat-value"},Y1={class:"stat"},Q1={class:"stat-value"},X1={class:"skills-section"},J1={class:"skills-content"},Z1={key:0,class:"skills-list"},ek={key:1,class:"skills-empty"},tk={__name:"FighterStatus",props:{name:{type:String,required:!0},hp:{type:Number,required:!0},skills:{type:Array,default:()=>[]},side:{type:String,default:"left",validator:t=>["left","right"].includes(t)},description:{type:String,default:""},strength:{type:Number,default:0},agility:{type:Number,default:0},endurance:{type:Number,default:0},effectiveStrength:{type:Number,default:null},effectiveAgility:{type:Number,default:null},effectiveEndurance:{type:Number,default:null},showStats:{type:Boolean,default:!1},showFightStats:{type:Boolean,default:!1},fightStats:{type:Object,default:()=>({wins:0,losses:0,totalFights:0,winRate:0})}},setup(t){const e=t,n=Le(()=>e.hp>70?"high":e.hp>30?"medium":"low");return(s,i)=>(B(),K("div",{class:Oe(["fighter-status",t.side])},[g("div",R1,[g("h4",D1,L(t.name),1),g("div",M1,L(Math.round(t.hp))+"/100 HP",1)]),g("div",O1,[g("div",N1,[g("div",{class:Oe(["health",n.value]),style:qt({width:`${Math.max(0,Math.min(100,t.hp))}%`})},[t.hp>15?(B(),K("div",x1,L(Math.round(t.hp))+"%",1)):X("v-if",!0)],6),t.hp<=15?(B(),K("div",V1,L(Math.round(t.hp))+"% ",1)):X("v-if",!0)])]),t.description?(B(),K("div",F1,L(t.description),1)):X("v-if",!0),g("div",$1,[g("div",L1,[t.showFightStats?(B(),K("div",B1,[g("span",U1,L(t.fightStats.wins)+"W",1),g("span",H1,L(t.fightStats.losses)+"L",1),g("span",j1,L(t.fightStats.winRate)+"%",1)])):X("v-if",!0)]),t.showStats?(B(),K("div",K1,[g("div",q1,[i[0]||(i[0]=ft(" STR: ")),g("span",G1,L(t.strength),1),t.effectiveStrength!==null&&Math.round(t.effectiveStrength)!==t.strength?(B(),K("span",{key:0,class:Oe(["effective-stat",{buff:Math.round(t.effectiveStrength)>t.strength,debuff:Math.round(t.effectiveStrength)<t.strength}])}," ("+L(Math.round(t.effectiveStrength))+L(Math.round(t.effectiveStrength)>t.strength?" ↑":Math.round(t.effectiveStrength)<t.strength?" ↓":"")+") ",3)):X("v-if",!0)]),g("div",W1,[i[1]||(i[1]=ft(" AGI: ")),g("span",z1,L(t.agility),1),t.effectiveAgility!==null&&Math.round(t.effectiveAgility)!==t.agility?(B(),K("span",{key:0,class:Oe(["effective-stat",{buff:Math.round(t.effectiveAgility)>t.agility,debuff:Math.round(t.effectiveAgility)<t.agility}])}," ("+L(Math.round(t.effectiveAgility))+L(Math.round(t.effectiveAgility)>t.agility?" ↑":Math.round(t.effectiveAgility)<t.agility?" ↓":"")+") ",3)):X("v-if",!0)]),g("div",Y1,[i[2]||(i[2]=ft(" END: ")),g("span",Q1,L(t.endurance),1),t.effectiveEndurance!==null&&Math.round(t.effectiveEndurance)!==t.endurance?(B(),K("span",{key:0,class:Oe(["effective-stat",{buff:Math.round(t.effectiveEndurance)>t.endurance,debuff:Math.round(t.effectiveEndurance)<t.endurance}])}," ("+L(Math.round(t.effectiveEndurance))+L(Math.round(t.effectiveEndurance)>t.endurance?" ↑":Math.round(t.effectiveEndurance)<t.endurance?" ↓":"")+") ",3)):X("v-if",!0)])])):X("v-if",!0)]),g("div",X1,[i[3]||(i[3]=g("div",{class:"skills-label"},"Skills:",-1)),g("div",J1,[t.skills.length>0?(B(),K("span",Z1,L(t.skills.join(", ")),1)):(B(),K("span",ek,"None"))])])],2))}},gf=ct(tk,[["__scopeId","data-v-ce95e9d6"]]),nk={class:"fight-log"},sk={class:"log-header"},ik={class:"log-controls"},rk={key:0,class:"actor player"},ok=["data-opponent"],ak=["innerHTML"],lk={__name:"FightLog",props:{entries:{type:Array,default:()=>[]}},setup(t){const e=Zs(),n=t,s=ue(null),i=ue(!0),r=ue(!1),o=Le(()=>e.fightState.fightEnded&&n.entries.length>0);on(()=>n.entries,async(S,M)=>{i.value&&(await bc(),l())},{deep:!0,immediate:!0});function l(){s.value&&setTimeout(()=>{s.value.scrollTop=s.value.scrollHeight},0)}function c(){i.value=!i.value,i.value&&l()}function u(){var R;const S=((R=e.fightState.opponent)==null?void 0:R.name)||"Opponent";let M=`# Fight: You vs ${S}

`;const P=e.fightState.playerHP<=0?S:"You",V=e.fightState.playerHP<=0?e.fightState.opponentHP:e.fightState.playerHP;M+=`**Winner:** ${P}
`,M+=`**Remaining HP:** ${V}

`,M+=`## Fight Log

`;for(const H of n.entries){let O="";H.actor===ye.PLAYER?O="👤 YOU: ":H.actor===ye.OPPONENT&&(O="👹 OPP: ");const I=H.message.replace(/<\/?[^>]+(>|$)/g,"");M+=`${O}${I}
`}M+=`
_Generated from Muay Thai Idle Fight_`;try{navigator.clipboard&&navigator.clipboard.writeText?navigator.clipboard.writeText(M).then(()=>{r.value=!0,setTimeout(()=>{r.value=!1},2e3)}).catch(H=>{console.error("Clipboard write failed:",H),h(M)}):h(M)}catch(H){console.error("Clipboard operation failed:",H),h(M)}}function h(S){const M=document.createElement("textarea");if(M.value=S,M.setAttribute("readonly",""),M.style.position="absolute",M.style.left="-9999px",document.body.appendChild(M),navigator.userAgent.match(/ipad|ipod|iphone/i)){const V=document.createRange();V.selectNodeContents(M);const R=window.getSelection();R.removeAllRanges(),R.addRange(V),M.setSelectionRange(0,999999)}else M.select();let P=!1;try{P=document.execCommand("copy")}catch(V){console.error("Failed to copy text:",V)}document.body.removeChild(M),P?(r.value=!0,setTimeout(()=>{r.value=!1},2e3)):alert("Failed to copy fight log. Your browser may not support this feature.")}function f(S){switch(S.eventType){case se.KNOCKOUT:case se.FIGHT_END:return"knockout";case se.COUNTER:return"counter";case se.COMBO:if(S.data&&S.data.comboType){if(S.data.comboType==="double")return"combo double";if(S.data.comboType==="triple")return"combo triple";if(S.data.comboType==="finisher")return"combo finisher"}return"combo";case se.ADRENALINE:return"surge";case se.STAMINA_DRAIN:return"drain";case se.EVADE:return"evade";case se.REWARD:return"reward";case se.CLINCH:return"clinch";case se.FOCUS_SHIFT:return"focus-shift";case se.CROWD_FAVOR:return"crowd-favorite";case se.COMEBACK:return"comeback";case se.CRUSHING_BLOW:return"crushing-blow";case se.ATTACK:return S.data&&S.data.crushingBlow?"crushing-blow":"attack";case se.FIGHT_START:return"fight-start";default:return""}}function m(S){return S.actor===ye.PLAYER}function y(S){return S.actor===ye.OPPONENT}function C(S){var M;return S.data&&S.data.opponent?S.data.opponent:((M=e.fightState.opponent)==null?void 0:M.name)||"OPPONENT"}function D(S){var V;if(!S||!S.message)return"";let M=S.message;const P=((V=e.fightState.opponent)==null?void 0:V.name)||"Opponent";if(m(S)&&(M=M.replace(/^You\s+/i,""),M=M.replace(/^Your\s+/i,"Your ")),y(S)&&P){const R=P.replace(/[.*+?^${}()|[\]\\]/g,"\\$&"),H=new RegExp(`^${R}\\s+`,"i");M=M.replace(H,"")}if(S.data&&S.data.skillUsed){const R=S.data.skillUsed,H=R.replace(/[.*+?^${}()|[\]\\]/g,"\\$&"),O=new RegExp(`\\b${H}\\b`,"g");M=M.replace(O,`<i class="skill-name">${R}</i>`)}return(S.eventType===se.ATTACK||S.eventType===se.COUNTER||S.eventType===se.COMBO)&&(M=M.replace(/(\d+) damage/g,'<span class="damage-number">$1</span> damage')),M.length>0&&(M=M.charAt(0).toUpperCase()+M.slice(1)),M}return(S,M)=>(B(),K("div",nk,[g("div",sk,[M[0]||(M[0]=g("div",{class:"log-icon"},"📜",-1)),g("div",ik,[o.value?(B(),K("button",{key:0,class:Oe(["copy-log-button",{copied:r.value}]),onClick:u},L(r.value?"Copied! ✓":"Copy Log 📋"),3)):X("v-if",!0),g("button",{class:"auto-scroll",onClick:c},L(i.value?"Auto-scroll: On":"Auto-scroll: Off"),1)])]),g("div",{class:"log-entries",ref_key:"logContainer",ref:s},[(B(!0),K(mt,null,ns(t.entries,(P,V)=>(B(),K("p",{key:V,class:Oe(["log-entry",f(P)])},[m(P)?(B(),K("span",rk,"👤 YOU:")):y(P)?(B(),K("span",{key:1,class:"actor opponent","data-opponent":C(P)}," 👹 OPP: ",8,ok)):X("v-if",!0),g("span",{innerHTML:D(P)},null,8,ak)],2))),128))],512)]))}},ck=ct(lk,[["__scopeId","data-v-d7a339c8"]]),uk={class:"momentum-meter"},dk={class:"meter-header"},hk={class:"player-label"},fk={class:"opponent-label"},pk={class:"indicator-container"},Sn=100,gk=130,mk=20,vk=500,yk=.02,_k={__name:"MomentumMeter",setup(t){const e={HALF:100,ZERO:300},n={BASE_STEP:.08,ENHANCED_STEP:.16,OSCILLATION_FACTOR:.3},s={CHECK_INTERVAL:2e3,IMPACT_FACTOR:15},i=Zs(),r=ue(null),o=ue(300),l=ue(0),c=ue(0),u=ue(0),h=ue(0),f=ue(!1),m=ue(null),y=ue(null),C=ue(null),D=Le(()=>{var W;return((W=i.fightState.opponent)==null?void 0:W.name)||"Opponent"}),S=Le(()=>l.value/Sn*(o.value/2)),M=Le(()=>{const W=(l.value+Sn)/(2*Sn),q=Math.round(59+180*W),G=Math.round(130-130*W),Q=Math.round(246-246*W);return`rgb(${q}, ${G}, ${Q})`});on(()=>i.fightState.log.length,(W,q)=>{if(i.inFight&&W>q){const G=i.fightState.log.slice(q);R(G)}}),on(()=>i.inFight,W=>{if(b(),W){const q=Math.random()*10-5;c.value=q,f.value=!0,v(),P()}else C.value&&(clearInterval(C.value),C.value=null)}),on([()=>i.fightState.playerHP,()=>i.fightState.opponentHP],()=>{i.inFight&&V()});function P(){C.value&&clearInterval(C.value),C.value=setInterval(()=>{i.inFight&&V()},s.CHECK_INTERVAL)}function V(){const W=i.fightState.playerHP,q=i.fightState.opponentHP,G=W-q,Q=s.IMPACT_FACTOR,le=-(G/100)*Q;if(Math.abs(le)>1){const ke=c.value,Ge=Math.max(-100,Math.min(Sn,ke*.8+le*.2));c.value=Ge,f.value||(f.value=!0,v())}}function R(W){W.forEach(q=>{if(!H(q))return;const G=i.fightState.playerHP/100,Q=i.fightState.opponentHP/100;let le=0,ke=!1;if(q.actor===ye.PLAYER){const Ge=O(q,G,Q);le=Ge.momentum,ke=Ge.isHighImpact}else if(q.actor===ye.OPPONENT){const Ge=I(q,G,Q);le=Ge.momentum,ke=Ge.isHighImpact}le!==0&&E(le,ke)})}function H(W){return[se.EVADE,se.COUNTER,se.COMBO,se.KNOCKOUT,se.CLINCH,se.FOCUS_SHIFT,se.CROWD_FAVOR,se.COMEBACK,se.ADRENALINE,se.PERFECT_BLOCK].includes(W.eventType)}function O(W,q,G){let Q=0,le=!1;switch(W.eventType){case se.EVADE:Q=-25*(1+Math.max(0,G-q)*1.5),le=q<.4;break;case se.COUNTER:Q=-35,le=!0;break;case se.PERFECT_BLOCK:Q=-20,le=!1;break;case se.COMBO:W.data&&W.data.comboType?W.data.comboType==="double"?Q=-30:W.data.comboType==="triple"?(Q=-40,le=!0):W.data.comboType==="finisher"&&(Q=-55,le=!0):(Q=-40,le=!0);break;case se.KNOCKOUT:Q=-80,le=!0;break;case se.CLINCH:Q=-22*Math.max(1,2-q*1.5),le=q<.35;break;case se.FOCUS_SHIFT:Q=-18;break;case se.CROWD_FAVOR:Q=-32,le=!0;break;case se.COMEBACK:Q=-50,le=!0;break;case se.ADRENALINE:Q=-45,le=!0;break}return{momentum:Q,isHighImpact:le}}function I(W,q,G){let Q=0,le=!1;switch(W.eventType){case se.EVADE:Q=25*(1+Math.max(0,q-G)*1.5),le=G<.4;break;case se.COUNTER:Q=35,le=!0;break;case se.PERFECT_BLOCK:Q=20,le=!1;break;case se.COMBO:W.data&&W.data.comboType?W.data.comboType==="double"?Q=30:W.data.comboType==="triple"?(Q=40,le=!0):W.data.comboType==="finisher"&&(Q=55,le=!0):(Q=40,le=!0);break;case se.KNOCKOUT:Q=80,le=!0;break;case se.CLINCH:const ie=22,F=Math.max(1,2-G*1.5);Q=ie*F,le=G<.35;break;case se.FOCUS_SHIFT:Q=18;break;case se.CROWD_FAVOR:Q=32,le=!0;break;case se.COMEBACK:Q=50,le=!0;break;case se.ADRENALINE:Q=45,le=!0;break}return{momentum:Q,isHighImpact:le}}function E(W,q){const G=Math.random()*5-2.5;if(q){const le=l.value+W*1.5;c.value=Math.max(-130,Math.min(gk,le+G))}else c.value=Math.max(-100,Math.min(Sn,l.value+W+G));f.value||(f.value=!0,v())}function v(){m.value&&(clearTimeout(m.value),m.value=null),h.value=l.value;const W=c.value-l.value,q=Math.min(1,Math.abs(W)/50),G=n.BASE_STEP+q*(n.ENHANCED_STEP-n.BASE_STEP);let Q=W*G;if(Math.abs(W)<20&&Math.abs(u.value)>1){const le=u.value*n.OSCILLATION_FACTOR;Q+=le}Math.abs(W)>.5||Math.abs(Q)>.5?(l.value+=Q,_()||(l.value=Math.max(-100,Math.min(Sn,l.value))),u.value=l.value-h.value,m.value=setTimeout(v,mk)):(l.value=c.value,l.value=Math.max(-100,Math.min(Sn,l.value)),c.value=Math.max(-100,Math.min(Sn,c.value)),u.value=l.value-h.value,setTimeout(()=>{u.value*=.5},e.HALF),setTimeout(()=>{u.value=0},e.ZERO),f.value=!1,T())}function _(){return Math.abs(c.value)>Sn}function T(){y.value&&clearTimeout(y.value),y.value=setTimeout(()=>{if(!f.value){h.value=l.value;const W=Math.abs(l.value)*yk,q=l.value>0?-W:l.value<0?W:0;Math.abs(l.value)>1?(l.value+=q,u.value=l.value-h.value,T()):(l.value=0,u.value=0)}},vk)}function b(){l.value=0,c.value=0,u.value=0,h.value=0,A(),f.value=!1}function A(){m.value&&(clearTimeout(m.value),m.value=null),y.value&&(clearTimeout(y.value),y.value=null),C.value&&(clearInterval(C.value),C.value=null)}let de;return Wt(()=>{if(r.value&&(o.value=r.value.clientWidth,de=new ResizeObserver(()=>{r.value&&(o.value=r.value.clientWidth)}),de.observe(r.value)),i.inFight){const W=Math.random()*10-5;c.value=W,f.value=!0,v(),P()}}),Fs(()=>{de&&r.value&&(de.unobserve(r.value),de=null),A()}),(W,q)=>(B(),K("div",uk,[g("div",dk,[g("span",hk,[g("span",{class:Oe(["label-icon",{active:l.value<-20}])},"🔥",2),q[0]||(q[0]=ft(" You "))]),g("span",fk,[ft(L(D.value)+" ",1),g("span",{class:Oe(["label-icon",{active:l.value>20}])},"🔥",2)])]),g("div",{class:"meter-container",ref_key:"meterContainer",ref:r},[X(" Meter background "),q[1]||(q[1]=g("div",{class:"meter-background"},[g("div",{class:"player-zone"}),g("div",{class:"neutral-zone"}),g("div",{class:"opponent-zone"})],-1)),X(" Circle indicator "),g("div",pk,[g("div",{class:"momentum-indicator",style:qt({transform:`translateX(${S.value}px) translateY(-50%)`,background:M.value,boxShadow:`0 0 8px ${M.value}, 0 0 12px ${M.value}`})},null,4),X(" Tracer effect "),g("div",{class:"momentum-tracer",style:qt({transform:`translateX(${S.value}px) scaleX(${Math.abs(u.value)*.2+.5})`,background:`linear-gradient(to ${u.value>0?"right":"left"}, ${M.value}, transparent)`,opacity:Math.min(1,Math.abs(u.value)*.5+.2)})},null,4)]),X(" Labels "),q[2]||(q[2]=g("div",{class:"meter-labels"},[g("div",{class:"player-advantage"},"ADVANTAGE"),g("div",{class:"neutral"},"EVEN"),g("div",{class:"opponent-advantage"},"ADVANTAGE")],-1))],512)]))}},Ek=ct(_k,[["__scopeId","data-v-41f552ce"]]),Tk={class:"fight-arena"},bk={class:"arena-header"},wk={class:"fighters-container"},Ak={__name:"FightArena",setup(t){const e=Zs(),n=sn(),s=$e();function i(){e.exitFight()}function r(c){const u=e.fightState.opponent;if(!u)return 0;const h=u[c]||0,f=u.skills||[];if(f.length===0)return h;const m=o(h,f.length,c,u.tier||1);let y=1;for(const S of f){const M=mo.find(P=>P.name===S);if(M&&M[c]!==0){const P=M[c]/100*m;y*=1+P}}const C=l(u.tier||1),D=Math.min(y,1+C);return Math.round(h*D)}function o(c,u,h,f=1){const C=(f-1)*.05,D=120*(1+C),S=25*(1+C),M=1/(1+c/D),P=1/(1+u/S),V=.5+f*.02;return Math.max(V,M*P)}function l(c=1){const h=(c-1)*.05;return Math.min(.9+h,1.5)}return(c,u)=>{var h,f,m;return B(),K("div",Tk,[g("div",bk,[u[0]||(u[0]=g("h3",null,"Fight in Progress",-1)),ee(e).fightState.fightEnded?(B(),K("button",{key:0,onClick:i,class:"exit-button"}," Return to Opponents ")):X("v-if",!0)]),g("div",wk,[Ue(gf,{name:"You",hp:ee(e).fightState.playerHP,skills:ee(n).ownedSkills,strength:ee(s).effectiveStrength,agility:ee(s).effectiveAgility,endurance:ee(s).effectiveEndurance,effectiveStrength:ee(e).getEffectivePlayerStrength(ee(s).effectiveStrength),effectiveAgility:ee(e).getEffectivePlayerAgility(ee(s).effectiveAgility),effectiveEndurance:ee(e).getEffectivePlayerEndurance(ee(s).effectiveEndurance),showStats:!0,side:"left",class:"compact-mobile"},null,8,["hp","skills","strength","agility","endurance","effectiveStrength","effectiveAgility","effectiveEndurance"]),u[1]||(u[1]=g("div",{class:"versus"},[g("span",null,"VS")],-1)),Ue(gf,{name:((h=ee(e).fightState.opponent)==null?void 0:h.name)||"Opponent",hp:ee(e).fightState.opponentHP,skills:((f=ee(e).fightState.opponent)==null?void 0:f.skills)||[],description:((m=ee(e).fightState.opponent)==null?void 0:m.description)||"",strength:r("strength"),agility:r("agility"),endurance:r("endurance"),effectiveStrength:ee(e).getEffectiveOpponentStrength(r("strength")),effectiveAgility:ee(e).getEffectiveOpponentAgility(r("agility")),effectiveEndurance:ee(e).getEffectiveOpponentEndurance(r("endurance")),showStats:!0,side:"right",class:"compact-mobile"},null,8,["name","hp","skills","description","strength","agility","endurance","effectiveStrength","effectiveAgility","effectiveEndurance"])]),X(" Fight Momentum Meter (only shown during active fights) "),ee(e).inFight?(B(),ss(Ek,{key:0})):X("v-if",!0),Ue(ck,{entries:ee(e).fightState.log},null,8,["entries"])])}}},Ik=ct(Ak,[["__scopeId","data-v-cd1a1813"]]),Sk={class:"card fight-section"},Ck={class:"section-header"},kk={__name:"FightSection",setup(t){const e=Zs(),n=ue(!0);return(s,i)=>(B(),K("div",Sk,[g("div",Ck,[i[1]||(i[1]=g("h2",null,"Arena",-1)),ee(e).inFight?X("v-if",!0):(B(),K("button",{key:0,class:"toggle-button",onClick:i[0]||(i[0]=r=>n.value=!n.value)},L(n.value?"▲":"▼"),1))]),ee(e).inFight?(B(),ss(Ik,{key:1})):(B(),K("div",{key:0,class:Oe(["opponents-container",{collapsed:!n.value}])},[Ue(P1)],2))]))}},Pk=ct(kk,[["__scopeId","data-v-c385a8e5"]]),Rk=[{id:"red_gloves",name:"Red Boxing Gloves",description:"该物品未解锁。继续游戏以解锁它！",category:"gloves",imageUrl:"/locker/red_gloves.png",rarity:"common",unlocked:!1,unlockMethod:"starter"},{id:"blue_gloves",name:"Blue Boxing Gloves",description:"该物品未解锁。继续游戏以解锁它！",category:"gloves",imageUrl:"/locker/blue_gloves.png",rarity:"common",unlocked:!1,unlockMethod:"win_10_fights"},{id:"traditional_shorts",name:"Traditional Shorts",description:"该物品未解锁。继续游戏以解锁它！",category:"shorts",imageUrl:"/locker/traditional_shorts.png",rarity:"common",unlocked:!1,unlockMethod:"starter"},{id:"fighter_shorts",name:"Champion Shorts",description:"该物品未解锁。继续游戏以解锁它！",category:"shorts",imageUrl:"/locker/fighter_shorts.png",rarity:"uncommon",unlocked:!1,unlockMethod:"random_encounter"},{id:"basic_handwraps",name:"Basic Hand Wraps",description:"该物品未解锁。继续游戏以解锁它！",category:"handwraps",imageUrl:"/locker/basic_handwraps.png",rarity:"common",unlocked:!1,unlockMethod:"starter"},{id:"premium_handwraps",name:"Premium Hand Wraps",description:"该物品未解锁。继续游戏以解锁它！",category:"handwraps",imageUrl:"/locker/premium_handwraps.png",rarity:"uncommon",unlocked:!1,unlockMethod:"win_20_fights"},{id:"basic_headband",name:"Basic Headband",description:"该物品未解锁。继续游戏以解锁它！",category:"head",imageUrl:"/locker/basic_headband.png",rarity:"common",unlocked:!1,unlockMethod:"win_5_fights"},{id:"mongkol",name:"Mongkol",description:"该物品未解锁。继续游戏以解锁它！",category:"head",imageUrl:"/locker/mongkol.png",rarity:"rare",unlocked:!1,unlockMethod:"random_encounter"},{id:"wooden_dummy",name:"Wooden Training Dummy",description:"该物品未解锁。继续游戏以解锁它！",category:"equipment",imageUrl:"/locker/wooden_dummy.png",rarity:"uncommon",unlocked:!1,unlockMethod:"strength_50"},{id:"speed_bag",name:"Speed Bag",description:"该物品未解锁。继续游戏以解锁它！",category:"equipment",imageUrl:"/locker/speed_bag.png",rarity:"uncommon",unlocked:!1,unlockMethod:"agility_50"},{id:"heavy_bag",name:"Heavy Bag",description:"该物品未解锁。继续游戏以解锁它！",category:"equipment",imageUrl:"/locker/heavy_bag.png",rarity:"uncommon",unlocked:!1,unlockMethod:"endurance_50"},{id:"championship_belt",name:"Championship Belt",description:"该物品未解锁。继续游戏以解锁它！",category:"achievement",imageUrl:"/locker/medal.png",rarity:"legendary",unlocked:!1,unlockMethod:"defeat_all_opponents"}],mf=[{id:"all",name:"All Items"},{id:"gloves",name:"Gloves"},{id:"shorts",name:"Shorts"},{id:"handwraps",name:"Hand Wraps"},{id:"head",name:"Headwear"},{id:"equipment",name:"Equipment"},{id:"achievement",name:"Achievements"}],Dk={common:"#aaaaaa",uncommon:"#00cc00",rare:"#0088ff",legendary:"#aa00ff"},Zm=Dr("locker",()=>{const t=ue([...Rk]),e=ue("all"),n=Le(()=>e.value==="all"?t.value:t.value.filter(m=>m.category===e.value)),s=Le(()=>t.value.filter(m=>m.unlocked)),i=Le(()=>{const m={all:0};return t.value.forEach(y=>{m[y.category]||(m[y.category]=0)}),s.value.forEach(y=>{m[y.category]++,m.all++}),m}),r=Le(()=>{const m={all:t.value.length};return t.value.forEach(y=>{m[y.category]||(m[y.category]=0),m[y.category]++}),m});function o(m){e.value=m}function l(m){const y=t.value.find(C=>C.id===m);return y?(y.unlocked=!0,h(),!0):!1}function c(m,y){}function u(){t.value.forEach(m=>{m.unlocked=!1}),h()}function h(){const m=t.value.map(y=>({id:y.id,unlocked:y.unlocked}));oa("lockerData",m)}function f(){t.value.forEach(m=>{m.unlocked=!1})}return{lockerItems:t,filteredItems:n,unlockedItems:s,selectedCategory:e,unlockedCountByCategory:i,totalCountByCategory:r,setCategory:o,unlockItem:l,checkAchievements:c,resetItems:u,saveLockerData:h,loadLockerData:f}}),Mk={class:"card locker-room"},Ok={class:"locker-header"},Nk={class:"collection-stats"},xk={class:"collection-count"},Vk={class:"category-filters"},Fk=["onClick"],$k={class:"category-count"},Lk={class:"items-grid"},Bk=["onClick"],Uk={key:0,class:"item-details-modal"},Hk={class:"modal-content"},jk={class:"modal-header"},Kk={class:"item-image-large"},qk=["src","alt"],Gk={class:"item-details"},Wk={class:"item-description"},zk={class:"item-metadata"},Yk={class:"metadata-row"},Qk={class:"metadata-value"},Xk={class:"metadata-row"},Jk={class:"metadata-row"},Zk={class:"metadata-value"},eP={__name:"LockerRoom",setup(t){const e=Zm(),n=ue(null);function s(u){return!!(u.id==="championship_belt"&&u.unlocked)}function i(u){alert("该物品未解锁。继续游戏以解锁它！")}function r(u){const h=mf.find(f=>f.id===u);return h?h.name:u}function o(u){return Dk[u]||"#ffffff"}function l(u){return u.charAt(0).toUpperCase()+u.slice(1)}function c(u){return{starter:"Starting item",win_5_fights:"Win 5 fights",win_10_fights:"Win 10 fights",win_20_fights:"Win 20 fights",strength_50:"Reach 50 Strength",agility_50:"Reach 50 Agility",endurance_50:"Reach 50 Endurance",defeat_all_opponents:"Defeat all opponents",random_encounter:"Defeat a special opponent"}[u]||"Special condition"}return e.loadLockerData(),(u,h)=>(B(),K("div",Mk,[g("div",Ok,[h[2]||(h[2]=g("h2",null,"Locker Room",-1)),g("div",Nk,[g("span",xk,L(ee(e).unlockedCountByCategory[ee(e).selectedCategory])+" / "+L(ee(e).totalCountByCategory[ee(e).selectedCategory]),1),h[1]||(h[1]=ft(" unlocked "))])]),g("div",Vk,[(B(!0),K(mt,null,ns(ee(mf),f=>(B(),K("button",{key:f.id,class:Oe([{active:ee(e).selectedCategory===f.id},"category-button"]),onClick:m=>ee(e).setCategory(f.id)},[ft(L(f.name)+" ",1),g("span",$k,L(ee(e).unlockedCountByCategory[f.id])+"/"+L(ee(e).totalCountByCategory[f.id]),1)],10,Fk))),128))]),g("div",Lk,[(B(!0),K(mt,null,ns(ee(e).filteredItems,f=>(B(),K("div",{key:f.id,class:Oe(["locker-item",{unlocked:f.unlocked,common:f.rarity==="common",uncommon:f.rarity==="uncommon",rare:f.rarity==="rare",legendary:f.rarity==="legendary"}]),onClick:m=>i()},h[3]||(h[3]=[g("div",{class:"item-icon locked"},[X(" All items show as locked "),g("div",{class:"locked-icon"},"?")],-1),g("div",{class:"item-name locked-text"}," ??? ",-1)]),10,Bk))),128))]),X(" Item details modal "),n.value?(B(),K("div",Uk,[g("div",Hk,[g("div",jk,[g("h3",{style:qt({color:o(n.value.rarity)})},L(n.value.name),5),g("button",{class:"close-button",onClick:h[0]||(h[0]=f=>n.value=null)},"×")]),g("div",Kk,[X(" If we have actual images "),s(n.value)?(B(),K("img",{key:0,src:n.value.imageUrl,alt:n.value.name},null,8,qk)):(B(),K(mt,{key:1},[X(" Placeholder for items without images "),h[4]||(h[4]=g("div",{class:"placeholder-large"}," ? ",-1))],2112))]),g("div",Gk,[g("p",Wk,L(n.value.description),1),g("div",zk,[g("div",Yk,[h[5]||(h[5]=g("span",{class:"metadata-label"},"Category:",-1)),g("span",Qk,L(r(n.value.category)),1)]),g("div",Xk,[h[6]||(h[6]=g("span",{class:"metadata-label"},"Rarity:",-1)),g("span",{class:"metadata-value",style:qt({color:o(n.value.rarity)})},L(l(n.value.rarity)),5)]),g("div",Jk,[h[7]||(h[7]=g("span",{class:"metadata-label"},"How to unlock:",-1)),g("span",Zk,L(c(n.value.unlockMethod)),1)])])])])])):X("v-if",!0)]))}},tP=ct(eP,[["__scopeId","data-v-32e0f507"]]);let rc=0;const nP=60*1e3;let bl=0;const sP=5*60*1e3;let uo=null;function iP(t,e){if(!t||!t.serverTimestamp)return{valid:!0};const n=t.serverTimestamp.toMillis?t.serverTimestamp.toMillis():t.timestamp,s=Date.now(),i=Math.max(0,(s-n)/(1e3*60*60)),r=8,o=15,l=Math.ceil(i*r),c=Math.ceil(i*o),u=e.strength-(t.strength||0),h=e.agility-(t.agility||0),f=e.endurance-(t.endurance||0),m=u+h+f,y=e.fightStats.totalFights-(t.totalFights||0);return console.log(`Time-based validation: ${i.toFixed(2)} hours passed`),console.log(`Max allowed gains: ${l} stats, ${c} fights`),console.log(`Actual gains: ${m} total stats, ${y} fights`),m>l&&i>.1?{valid:!1,reason:`Suspicious stat gain: +${m} in ${i.toFixed(2)} hours (max: ${l})`}:y>c&&i>.1?{valid:!1,reason:`Suspicious fight gain: +${y} in ${i.toFixed(2)} hours (max: ${c})`}:{valid:!0}}function rP(t,e,n,s){const i=mu(s),r=100;return{strength:Math.min(Math.max(0,t),i,r),agility:Math.min(Math.max(0,e),i,r),endurance:Math.min(Math.max(0,n),i,r)}}function mu(t){const e=[[0,20],[5,30],[10,40],[20,60],[40,80],[60,100]];for(let n=e.length-1;n>=0;n--)if(t>=e[n][0])return e[n][1];return e[0][1]}function ev(t){const e={};for(let s=1;s<=12;s++)e[s]=0;for(const s of t){const i=dr.find(r=>r.name===s);i&&i.tier&&e[i.tier]++}return e}function tv(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(t){const e=Math.random()*16|0;return(t==="x"?e:e&3|8).toString(16)})}function Na(){let t=localStorage.getItem("playerID");t||(t=tv(),localStorage.setItem("playerID",t),console.log("Generated new player ID:",t));let e=localStorage.getItem("playerNickname");return e||(e="Anonymous Fighter",localStorage.setItem("playerNickname",e)),{playerID:t,nickname:e}}function oP(){$e().savePlayerData();const e=Date.now();e-rc>nP&&($r(),rc=e)}async function oc(){$e().savePlayerData();try{return await $r(),rc=Date.now(),!0}catch(e){return console.error("Error syncing to leaderboard:",e),!1}}async function $r(){var t,e,n,s,i,r,o,l,c,u,h,f,m,y,C,D,S,M;if(!navigator.onLine)return console.log("Can't sync to leaderboard: offline"),Promise.resolve();try{const{playerID:P,nickname:V}=Na(),R=$e(),H=R.strength+R.agility+R.endurance;if(H<=0&&R.fightStats.totalFights<=0)return console.log("No meaningful data to sync yet"),Promise.resolve();let O=0;R.fightStats.totalFights>0&&(O=Math.round(R.fightStats.wins/R.fightStats.totalFights*100));const I=ev(R.defeatedOpponents);let E=0;for(let G=12;G>=1;G--)if(I[G]>0){E=G;break}const v=Js(Zt,"leaderboard");gs("leaderboard_sync",{nickname:V,total_power:H});const _=fs(v,Ws("playerId","==",P),ps(1)),T=await $n(_);let b;T.empty?(b=qs(Zt,"leaderboard",P),console.log("Creating new leaderboard entry for:",V,"with power:",H)):(b=qs(Zt,"leaderboard",T.docs[0].id),console.log("Updating existing leaderboard entry for:",V,"with power:",H));const A=rP(R.strength,R.agility,R.endurance,R.fightStats.totalFights),de=A.strength+A.agility+A.endurance;de!==H&&(console.warn("Stats were adjusted for leaderboard submission due to exceeding limits"),console.log("Original:",{strength:R.strength,agility:R.agility,endurance:R.endurance,total:H}),console.log("Adjusted:",{strength:A.strength,agility:A.agility,endurance:A.endurance,total:de}));let W=null,q=!1;if(!T.empty){W=T.docs[0].data();const Q=iP(W,R);Q.valid||(console.warn("Time-based validation failed:",Q.reason),q=!0)}return fu(b,{playerId:P,nickname:V,strength:A.strength,agility:A.agility,endurance:A.endurance,totalPower:de,wins:R.fightStats.wins||0,losses:R.fightStats.losses||0,winRate:O,totalFights:R.fightStats.totalFights||0,defeatedCount:R.defeatedOpponents.length||0,defeatedByTier:I,highestDefeatedTier:E,defeatedOpponentsDetail:R.opponentVictoryCounts||{},timestamp:new Date().getTime(),serverTimestamp:Jm(),trainingTimestamps:{strength:((e=(t=R.trainingHistory)==null?void 0:t.lastTraining)==null?void 0:e.strength)||0,agility:((s=(n=R.trainingHistory)==null?void 0:n.lastTraining)==null?void 0:s.agility)||0,endurance:((r=(i=R.trainingHistory)==null?void 0:i.lastTraining)==null?void 0:r.endurance)||0},suspiciousActivity:q,validated:!0,validatedAt:new Date().toISOString(),clientVersion:"0.0.43",giantKills:((l=(o=R.achievements)==null?void 0:o.giantKillerOpponents)==null?void 0:l.length)||0,comebacks:((c=R.achievements)==null?void 0:c.comebackVictories)||0,quickWins:((u=R.achievements)==null?void 0:u.quickWins)||0,tierChallenges:((h=R.fightStats)==null?void 0:h.tierChallenges)||0,skillsUsed:((f=R.usedSkills)==null?void 0:f.length)||0,perfectBlocks:((m=R.achievements)==null?void 0:m.perfectBlocks)||0,criticalStrikes:((y=R.achievements)==null?void 0:y.criticalStrikes)||0,counterAttacks:((C=R.achievements)==null?void 0:C.counterAttacks)||0,firstStrikes:((D=R.achievements)==null?void 0:D.firstStrikes)||0,nightFighter:((S=R.achievements)==null?void 0:S.nightFighter)||0,morningWarrior:((M=R.achievements)==null?void 0:M.morningWarrior)||0}).then(()=>(aP(),!0))}catch(P){return console.error("Error syncing to leaderboard:",P),Promise.resolve()}}async function aP(){try{const t=await Oa(qs(Zt,"system","composite_leaderboard"));(!t.exists()||Date.now()-t.data().timestamp>15*60*1e3)&&(console.log("Triggering composite leaderboard update"),ac())}catch(t){console.error("Error checking composite leaderboard:",t)}}async function ac(){try{return await lP()?await cP():await nv()}catch(t){return console.error("Error updating composite leaderboard:",t),!1}}async function lP(){try{const t=Js(Zt,"leaderboard");console.log("Testing highestDefeatedTier index...");const e=fs(t,Ws("totalFights",">",0),Ai("highestDefeatedTier","desc"),ps(1));try{await $n(e),console.log("highestDefeatedTier index is ready")}catch(s){if(console.error("Error with highestDefeatedTier index:",s),s.code==="failed-precondition")return console.warn("Required index for highestDefeatedTier is missing. Please create the composite index from the error link above."),!1;throw s}console.log("Testing wins index...");const n=fs(t,Ws("totalFights",">",0),Ai("wins","desc"),ps(1));try{await $n(n),console.log("wins index is ready")}catch(s){if(console.error("Error with wins index:",s),s.code==="failed-precondition")return console.warn("Required index for wins is missing. Please create the composite index from the error link above."),!1;throw s}return console.log("All indexes are ready, using optimized queries"),!0}catch(t){return console.error("Unexpected error checking indexes:",t),!1}}async function cP(){try{const t=Js(Zt,"leaderboard"),e=new Map;console.log("Fetching top players by highest tier defeated...");const n=fs(t,Ws("totalFights",">",0),Ai("highestDefeatedTier","desc"),ps(500));(await $n(n)).forEach(o=>{const l=o.data();e.set(l.playerId,{id:l.playerId,nickname:l.nickname,totalPower:l.totalPower,strength:l.strength||0,agility:l.agility||0,endurance:l.endurance||0,wins:l.wins||0,losses:l.losses||0,winRate:l.winRate||0,totalFights:l.totalFights||0,defeatedCount:l.defeatedCount||0,defeatedOpponentsDetail:l.defeatedOpponentsDetail||{},timestamp:l.timestamp,giantKills:l.giantKills||0,comebacks:l.comebacks||0,quickWins:l.quickWins||0,tierChallenges:l.tierChallenges||0,skillsUsed:l.skillsUsed||0,perfectBlocks:l.perfectBlocks||0,criticalStrikes:l.criticalStrikes||0,counterAttacks:l.counterAttacks||0,firstStrikes:l.firstStrikes||0,nightFighter:l.nightFighter||0,morningWarrior:l.morningWarrior||0})}),console.log("Fetching top players by wins...");const i=fs(t,Ws("totalFights",">",0),Ai("wins","desc"),ps(500));return(await $n(i)).forEach(o=>{const l=o.data();(!e.has(l.playerId)||l.timestamp>e.get(l.playerId).timestamp)&&e.set(l.playerId,{id:l.playerId,nickname:l.nickname,totalPower:l.totalPower,strength:l.strength||0,agility:l.agility||0,endurance:l.endurance||0,wins:l.wins||0,losses:l.losses||0,winRate:l.winRate||0,totalFights:l.totalFights||0,defeatedCount:l.defeatedCount||0,defeatedOpponentsDetail:l.defeatedOpponentsDetail||{},timestamp:l.timestamp,giantKills:l.giantKills||0,comebacks:l.comebacks||0,quickWins:l.quickWins||0,tierChallenges:l.tierChallenges||0,skillsUsed:l.skillsUsed||0,perfectBlocks:l.perfectBlocks||0,criticalStrikes:l.criticalStrikes||0,counterAttacks:l.counterAttacks||0,firstStrikes:l.firstStrikes||0,nightFighter:l.nightFighter||0,morningWarrior:l.morningWarrior||0})}),sv(e,"optimized_dual_query")}catch(t){return console.error("Error in optimized leaderboard update:",t),nv()}}async function nv(){try{const t=Js(Zt,"leaderboard"),e=new Map;console.log("Using basic query (limited to 500 documents)...");const n=fs(t,Ai("timestamp","desc"),ps(500));return(await $n(n)).forEach(i=>{const r=i.data();if(!r.totalFights||r.totalFights<=0)return;const o=e.get(r.playerId);(!o||r.timestamp>o.timestamp)&&e.set(r.playerId,{id:r.playerId,nickname:r.nickname,totalPower:r.totalPower||0,strength:r.strength||0,agility:r.agility||0,endurance:r.endurance||0,wins:r.wins||0,losses:r.losses||0,winRate:r.winRate||0,totalFights:r.totalFights||0,defeatedCount:r.defeatedCount||0,defeatedOpponentsDetail:r.defeatedOpponentsDetail||{},timestamp:r.timestamp,giantKills:r.giantKills||0,comebacks:r.comebacks||0,quickWins:r.quickWins||0,tierChallenges:r.tierChallenges||0,skillsUsed:r.skillsUsed||0,perfectBlocks:r.perfectBlocks||0,criticalStrikes:r.criticalStrikes||0,counterAttacks:r.counterAttacks||0,firstStrikes:r.firstStrikes||0,nightFighter:r.nightFighter||0,morningWarrior:r.morningWarrior||0})}),sv(e,"basic_timestamp_query")}catch(t){return console.error("Error in basic leaderboard update:",t),!1}}async function sv(t,e){let n=Array.from(t.values());console.log(`Filtering leaderboard entries: ${n.length} total players to check`);const s=n.length;n=n.filter(r=>{if(!r.totalFights||r.totalFights<=0)return!1;const o=mu(r.totalFights),l=r.strength<=o&&r.agility<=o&&r.endurance<=o,c=r.strength+r.agility+r.endurance,u=Math.abs(r.totalPower-c)<3,h=r.suspiciousActivity===!0;return(!l||!u||h)&&(console.warn(`Filtered out suspicious player: ${r.nickname} (ID: ${r.id})`),l||(console.warn(`Stats exceeding limits - Fights: ${r.totalFights}, Stats: STR ${r.strength}, AGI ${r.agility}, END ${r.endurance}`),console.warn(`Max allowed: ${o}`)),u||console.warn(`Total power mismatch - Reported: ${r.totalPower}, Calculated: ${c}`),h&&console.warn("Player flagged for suspicious time-based progression")),l&&u&&!h}),n.length<s&&console.log(`Filtered out ${s-n.length} suspicious players from leaderboard`),n.forEach(r=>{let o=0;if(r.defeatedByTier){for(let l=12;l>=1;l--)if(r.defeatedByTier[l]>0){o=l;break}}r.highestDefeatedTier=o,r.score=r.defeatedCount*3+r.wins}),n.sort((r,o)=>o.highestDefeatedTier!==r.highestDefeatedTier?o.highestDefeatedTier-r.highestDefeatedTier:o.score!==r.score?o.score-r.score:o.defeatedCount!==r.defeatedCount?o.defeatedCount-r.defeatedCount:o.wins!==r.wins?o.wins-r.wins:o.losses-r.losses),n=n.slice(0,100);const i=qs(Zt,"system","composite_leaderboard");return await fu(i,{timestamp:Date.now(),lastUpdated:new Date().toISOString(),topPlayers:n,totalPlayers:t.size,queryStrategy:e}),console.log(`Updated composite leaderboard with ${n.length} players using ${e}`),!0}async function iv(t=20){try{return console.log("Attempting to fetch leaderboard using composite method"),await uP(t)}catch(e){return console.error("Error fetching composite leaderboard, falling back to direct query:",e),lc(t)}}async function uP(t=20){const e=Date.now();if(uo&&e-bl<sP)return console.log("Using cached composite leaderboard"),uo.slice(0,t);try{const n=await Oa(qs(Zt,"system","composite_leaderboard"));if(n.exists()){const s=n.data(),i=s.topPlayers||[],r=s.timestamp;return e-r<30*60*1e3?(uo=i,bl=e,console.log(`Fetched ${i.length} leaderboard entries from composite document`),i.slice(0,t)):(console.log("Composite leaderboard is stale, triggering update"),ac(),uo=i,bl=e,i.slice(0,t))}else return console.log("No composite leaderboard exists, creating one"),await ac(),lc(t)}catch(n){return console.error("Error fetching composite leaderboard:",n),lc(t)}}async function lc(t=20){try{const e=Js(Zt,"leaderboard"),n=await $n(e),s=new Map;n.forEach(r=>{const o=r.data(),l=s.get(o.playerId);(!l||o.timestamp>l.timestamp)&&s.set(o.playerId,{id:o.playerId,nickname:o.nickname,totalPower:o.totalPower,strength:o.strength||0,agility:o.agility||0,endurance:o.endurance||0,wins:o.wins||0,losses:o.losses||0,winRate:o.winRate||0,totalFights:o.totalFights||0,defeatedCount:o.defeatedCount||0,defeatedOpponentsDetail:o.defeatedOpponentsDetail||{},timestamp:o.timestamp,giantKills:o.giantKills||0,comebacks:o.comebacks||0,quickWins:o.quickWins||0,tierChallenges:o.tierChallenges||0,skillsUsed:o.skillsUsed||0,perfectBlocks:o.perfectBlocks||0,criticalStrikes:o.criticalStrikes||0,counterAttacks:o.counterAttacks||0,firstStrikes:o.firstStrikes||0,nightFighter:o.nightFighter||0,morningWarrior:o.morningWarrior||0})});let i=Array.from(s.values());return i=i.filter(r=>{const o=r.wins>0||r.losses>0,l=mu(r.totalFights),c=r.strength<=l&&r.agility<=l&&r.endurance<=l,u=r.strength+r.agility+r.endurance,h=Math.abs(r.totalPower-u)<3;return o&&c&&h}),i.forEach(r=>{let o=0;if(r.defeatedByTier){for(let l=12;l>=1;l--)if(r.defeatedByTier[l]>0){o=l;break}}r.highestDefeatedTier=o,r.score=r.defeatedCount*3+r.wins}),i.sort((r,o)=>o.highestDefeatedTier!==r.highestDefeatedTier?o.highestDefeatedTier-r.highestDefeatedTier:o.score!==r.score?o.score-r.score:o.defeatedCount!==r.defeatedCount?o.defeatedCount-r.defeatedCount:o.wins!==r.wins?o.wins-r.wins:o.losses-r.losses),i=i.slice(0,t),console.log(`Fetched ${i.length} leaderboard entries using direct method`),i}catch(e){return console.error("Error fetching leaderboard:",e),[]}}const cc=Object.freeze(Object.defineProperty({__proto__:null,countDefeatedByTier:ev,ensurePlayerIdentity:Na,generateUUID:tv,getLeaderboard:iv,manualSaveAndSync:oc,saveAndSyncProgress:oP,syncToLeaderboard:$r},Symbol.toStringTag,{value:"Module"})),dP={key:0,class:"leaderboard-modal"},hP={class:"leaderboard-dialog"},fP={class:"modal-header"},pP={key:0,class:"loading-container"},gP={key:1,class:"error-container"},mP={key:2,class:"leaderboard-content"},vP={key:0,class:"entries-container"},yP={class:"rank"},_P=["onClick"],EP={class:"achievements"},TP=["onClick","title"],bP={class:"achievement-count"},wP={class:"stats"},AP=["onClick","title"],IP={class:"stats-total"},SP={class:"wins-col"},CP={class:"wins-value"},kP={class:"losses-col"},PP={class:"losses-value"},RP={class:"defeated-col"},DP={class:"defeated-value"},MP={key:1,class:"no-entries"},OP={key:2,class:"current-player-info"},NP={class:"leaderboard-entry is-current-player"},xP={class:"rank"},VP={class:"achievements"},FP=["title"],$P={class:"achievement-count"},LP={class:"stats"},BP=["title"],UP={class:"stats-total"},HP={class:"wins-col"},jP={class:"wins-value"},KP={class:"losses-col"},qP={class:"losses-value"},GP={class:"defeated-col"},WP={class:"defeated-value"},zP={key:3,class:"no-fights-message"},YP={key:4,class:"last-updated-info"},QP={key:0,class:"achievement-details"},XP={class:"tooltip-header"},JP={key:0},ZP={key:1,class:"achievement-item"},eR={class:"achievement-item-value"},tR={key:2,class:"achievement-item"},nR={class:"achievement-item-value"},sR={key:3,class:"achievement-item"},iR={class:"achievement-item-value"},rR={key:4,class:"achievement-item"},oR={class:"achievement-item-value"},aR={key:5},lR={key:6,class:"achievement-item"},cR={class:"achievement-item-value"},uR={key:7,class:"achievement-item"},dR={class:"achievement-item-value"},hR={key:8,class:"achievement-item"},fR={class:"achievement-item-value"},pR={key:9,class:"achievement-item"},gR={class:"achievement-item-value"},mR={key:10},vR={key:11,class:"achievement-item"},yR={class:"achievement-item-value"},_R={key:12,class:"achievement-item"},ER={class:"achievement-item-value"},TR={key:13},bR={key:14,class:"achievement-item"},wR={class:"achievement-item-value"},AR={key:15,class:"achievement-item"},IR={key:0,class:"stats-details"},SR={class:"tooltip-header"},CR={class:"stats-item"},kR={class:"stats-item-value str-value"},PR={class:"stats-item"},RR={class:"stats-item-value agi-value"},DR={class:"stats-item"},MR={class:"stats-item-value end-value"},OR={class:"stats-item total-power"},NR={class:"stats-item-value total-value"},xR={key:0,class:"time-details"},VR={class:"tooltip-header"},FR={key:0,class:"time-item"},$R={class:"time-item-value"},LR={key:1,class:"time-item"},BR={class:"time-item-value"},UR={key:2,class:"time-item"},HR={class:"time-item-value tier-value"},jR={class:"time-item fight-stats"},KR={class:"time-item-value"},qR={class:"win-record"},GR={class:"loss-record"},WR={__name:"LeaderboardModal",props:{visible:Boolean},emits:["close"],setup(t,{emit:e}){const n=t,s=ue(!0),i=ue(""),r=ue([]),o=ue([]),l=ue(null),c=ue(null),u=ue(null),h=ue(!1),f=ue({}),m=ue(!1),y=ue({}),C=ue(!1),D=ue({}),S=$e();on(()=>n.visible,ie=>{ie&&M()});async function M(){s.value=!0,i.value="";try{const ie=await Oa(qs(Zt,"system","composite_leaderboard"));if(ie.exists()){const me=ie.data();me.lastUpdated&&(c.value=new Date(me.lastUpdated))}const F=await iv(500);r.value=F,o.value=F.filter(me=>me.defeatedCount>2),P()}catch(ie){i.value="Failed to load leaderboard data. Check your connection and try again.",console.error("Leaderboard error:",ie)}finally{s.value=!1}}function P(){const ie=localStorage.getItem("playerID"),F=localStorage.getItem("playerNickname")||"Anonymous Fighter",me=r.value.find(Te=>Te.id===ie);if(me){const Te=r.value.indexOf(me);l.value={...me,rank:Te+1}}else{const Te=S.fightStats.wins||0,xe=S.fightStats.losses||0;Te>0||xe>0?l.value={id:ie,nickname:F,strength:S.strength||0,agility:S.agility||0,endurance:S.endurance||0,wins:Te,losses:xe,defeatedCount:S.defeatedOpponents.length||0,rank:"?"}:l.value=null}}function V(ie){return ie===localStorage.getItem("playerID")}function R(ie){if(!ie)return 0;let F=0;return ie.giantKills>0&&F++,ie.comebacks>0&&F++,ie.quickWins>0&&F++,ie.tierChallenges>0&&F++,ie.skillsUsed>5&&F++,ie.perfectBlocks>0&&F++,ie.criticalStrikes>0&&F++,ie.counterAttacks>0&&F++,ie.firstStrikes>0&&F++,ie.nightFighter>0&&F++,ie.morningWarrior>0&&F++,F}function H(ie){return R(ie)>0}function O(ie){const F=R(ie);return F===1?"1 Achievement":`${F} Achievements`}function I(ie){return ie.giantKills>0||ie.comebacks>0||ie.quickWins>0||ie.tierChallenges>0}function E(ie){return ie.perfectBlocks>0||ie.criticalStrikes>0||ie.counterAttacks>0||ie.firstStrikes>0}function v(ie){return ie.nightFighter>0||ie.morningWarrior>0}function _(ie,F){var Te;m.value&&W(),u.value=ie;const me=(Te=F==null?void 0:F.target)==null?void 0:Te.getBoundingClientRect();me?f.value={top:`${me.bottom+window.scrollY+5}px`,left:`${me.left+window.scrollX-80}px`}:f.value={top:"50%",left:"50%",transform:"translate(-50%, -50%)"},h.value=!0,setTimeout(()=>{document.addEventListener("click",b)},10)}function T(){h.value=!1,document.removeEventListener("click",b)}function b(ie){const F=document.querySelector(".achievement-detail-tooltip"),me=document.querySelectorAll(".achievement-summary");if(F&&!F.contains(ie.target)){let Te=!1;me.forEach(xe=>{xe.contains(ie.target)&&(Te=!0)}),Te||T()}}function A(ie){return ie?`STR: ${ie.strength} | AGI: ${ie.agility} | END: ${ie.endurance}`:""}function de(ie,F){var Te;h.value&&T(),u.value=ie;const me=(Te=F==null?void 0:F.target)==null?void 0:Te.getBoundingClientRect();me?y.value={top:`${me.bottom+window.scrollY+5}px`,left:`${me.left+window.scrollX-80}px`}:y.value={top:"50%",left:"50%",transform:"translate(-50%, -50%)"},m.value=!0,setTimeout(()=>{document.addEventListener("click",q)},10)}function W(){m.value=!1,document.removeEventListener("click",q)}function q(ie){const F=document.querySelector(".stats-detail-tooltip"),me=document.querySelectorAll(".stats-summary");if(F&&!F.contains(ie.target)){let Te=!1;me.forEach(xe=>{xe.contains(ie.target)&&(Te=!0)}),Te||W()}}function G(ie,F){var Te;m.value&&W(),h.value&&T(),u.value=ie;const me=(Te=F==null?void 0:F.target)==null?void 0:Te.getBoundingClientRect();me?D.value={top:`${me.bottom+window.scrollY+5}px`,left:`${me.left+window.scrollX-80}px`}:D.value={top:"50%",left:"50%",transform:"translate(-50%, -50%)"},C.value=!0,setTimeout(()=>{document.addEventListener("click",le)},10)}function Q(){C.value=!1,document.removeEventListener("click",le)}function le(ie){const F=document.querySelector(".time-detail-tooltip"),me=document.querySelectorAll(".name");if(F&&!F.contains(ie.target)){let Te=!1;me.forEach(xe=>{xe.contains(ie.target)&&(Te=!0)}),Te||Q()}}function ke(ie){if(!ie)return"Unknown";const me=Date.now()-ie;if(me<0){const rt=Math.abs(me),Re=Math.floor(rt/(60*1e3));if(Re<60)return`${Re} mins in the future`;const k=Math.floor(rt/(60*60*1e3));return k<24?`${k} hours in the future`:`${Math.floor(rt/(24*60*60*1e3))} days in the future`}const Te=Math.floor(me/(60*1e3));if(Te<60)return`${Te} mins ago`;const xe=Math.floor(me/(60*60*1e3));if(xe<24)return`${xe} hours ago`;const Xe=Math.floor(me/(24*60*60*1e3));return Xe<30?`${Xe} days ago`:`${Math.floor(Xe/30)} months ago`}function Ge(ie){if(!ie)return"Never";const F=[ie.strength||0,ie.agility||0,ie.endurance||0],me=Math.max(...F);return me?ke(me):"Never"}Wt(()=>{n.visible&&M()}),Fs(()=>{document.removeEventListener("click",b),document.removeEventListener("click",q),document.removeEventListener("click",le)});function Fe(ie){if(!ie)return"";const F=Math.floor((new Date-ie)/(60*1e3));if(F<1)return"just now";if(F<60)return`${F} ${F===1?"minute":"minutes"} ago`;{const me=Math.floor(F/60);return me<24?`${me} ${me===1?"hour":"hours"} ago`:ie.toLocaleString()}}return(ie,F)=>t.visible?(B(),K("div",dP,[g("div",hP,[g("div",fP,[F[4]||(F[4]=g("div",{class:"title-section"},[g("h2",null,"Leaderboard"),g("a",{href:"https://www.reddit.com/r/idlemuaythai/",target:"_blank",class:"reddit-button",title:"Join the discussion on Reddit"},[g("svg",{class:"reddit-icon",viewBox:"0 0 24 24",width:"12",height:"12"},[g("path",{d:"M12 0A12 12 0 0 0 0 12a12 12 0 0 0 12 12 12 12 0 0 0 12-12A12 12 0 0 0 12 0zm5.01 4.744c.688 0 1.25.561 1.25 1.249a1.25 1.25 0 0 1-2.498.056l-2.597-.547-.8 3.747c1.824.07 3.48.632 4.674 1.488.308-.309.73-.491 1.207-.491.968 0 1.754.786 1.754 1.754 0 .716-.435 1.333-1.01 1.614a3.111 3.111 0 0 1 .042.52c0 2.694-3.13 4.87-7.004 4.87-3.874 0-7.004-2.176-7.004-4.87 0-.183.015-.366.043-.534A1.748 1.748 0 0 1 4.028 12c0-.968.786-1.754 1.754-1.754.463 0 .898.196 1.207.49 1.207-.883 2.878-1.43 4.744-1.487l.885-4.182a.342.342 0 0 1 .14-.197.35.35 0 0 1 .238-.042l2.906.617a1.214 1.214 0 0 1 1.108-.701zM9.25 12C8.561 12 8 12.562 8 13.25a1.25 1.25 0 0 0 1.25 1.248 1.25 1.25 0 0 0 1.248-1.249 1.25 1.25 0 0 0-1.249-1.249zm5.5 0a1.25 1.25 0 0 0-1.25 1.25 1.25 1.25 0 0 0 1.25 1.248 1.25 1.25 0 0 0 1.249-1.249A1.25 1.25 0 0 0 14.75 12zm-2.42 3.242a.375.375 0 0 0-.536 0c-.298.298-.741.582-1.419.582-.677 0-1.12-.284-1.418-.582a.375.375 0 0 0-.536 0 .376.376 0 0 0 0 .536c.298.298.903.749 1.955.749 1.052 0 1.657-.45 1.955-.749a.376.376 0 0 0 0-.536z",fill:"currentColor"})]),ft(" r/idlemuaythai ")])],-1)),g("button",{class:"close-button",onClick:F[0]||(F[0]=me=>ie.$emit("close"))},"×")]),s.value?(B(),K("div",pP,F[5]||(F[5]=[g("div",{class:"loading-spinner"},null,-1),g("p",null,"Loading top fighters...",-1)]))):i.value?(B(),K("div",gP,[g("p",null,L(i.value),1),g("button",{onClick:M,class:"retry-button"},"Retry")])):(B(),K("div",mP,[F[12]||(F[12]=Ic('<div class="leaderboard-header" data-v-7a58f9fe><div class="rank" data-v-7a58f9fe>#</div><div class="name" data-v-7a58f9fe>Fighter</div><div class="achievements" data-v-7a58f9fe>🏆</div><div class="stats" data-v-7a58f9fe>💪</div><div class="wins" data-v-7a58f9fe>W</div><div class="losses" data-v-7a58f9fe>L</div><div class="defeated-col" data-v-7a58f9fe>D</div></div>',1)),o.value.length>0?(B(),K("div",vP,[(B(!0),K(mt,null,ns(o.value,(me,Te)=>(B(),K("div",{key:me.id,class:Oe(["leaderboard-entry",{"is-current-player":V(me.id)},{"top-five":Te<5},{"top-ten":Te>=5&&Te<10}])},[g("div",yP,L(Te+1),1),g("div",{class:Oe(["name",{"top-five-name":Te<5,"top-ten-name":Te>=5&&Te<10}]),onClick:xe=>G(me,xe),title:"Click for activity info"},L(me.nickname),11,_P),g("div",EP,[g("div",{class:"achievement-summary",onClick:xe=>_(me,xe),title:O(me)},[g("span",bP,L(R(me)),1),F[6]||(F[6]=g("span",{class:"trophy-icon"},"🏆",-1))],8,TP)]),g("div",wP,[g("div",{class:"stats-summary",onClick:xe=>de(me,xe),title:A(me)},[g("span",IP,L(me.totalPower),1)],8,AP)]),g("div",SP,[g("span",CP,L(me.wins||0),1)]),g("div",kP,[g("span",PP,L(me.losses||0),1)]),g("div",RP,[g("span",DP,L(me.defeatedCount||0),1)])],2))),128))])):(B(),K("div",MP,F[7]||(F[7]=[g("p",null,"No players with more than 2 defeats found. Keep fighting!",-1)]))),l.value?(B(),K("div",OP,[F[9]||(F[9]=g("div",{class:"divider"},null,-1)),g("div",NP,[g("div",xP,L(l.value.rank),1),g("div",{class:"name",onClick:F[1]||(F[1]=me=>G(l.value,me)),title:"Click for activity info"},L(l.value.nickname)+" (You) ",1),g("div",VP,[g("div",{class:"achievement-summary",onClick:F[2]||(F[2]=me=>_(l.value,me)),title:O(l.value)},[g("span",$P,L(R(l.value)),1),F[8]||(F[8]=g("span",{class:"trophy-icon"},"🏆",-1))],8,FP)]),g("div",LP,[g("div",{class:"stats-summary",onClick:F[3]||(F[3]=me=>de(l.value,me)),title:A(l.value)},[g("span",UP,L(l.value.totalPower),1)],8,BP)]),g("div",HP,[g("span",jP,L(l.value.wins||0),1)]),g("div",KP,[g("span",qP,L(l.value.losses||0),1)]),g("div",GP,[g("span",WP,L(l.value.defeatedCount||0),1)])])])):X("v-if",!0),X(" Message for players who haven't fought yet "),!l.value&&ee(S).fightStats.wins===0&&ee(S).fightStats.losses===0?(B(),K("div",zP,F[10]||(F[10]=[g("div",{class:"divider"},null,-1),g("p",null,"You need to win or lose at least one fight to appear on the leaderboard.",-1)]))):X("v-if",!0),X(" Last updated timestamp "),c.value?(B(),K("div",YP,[F[11]||(F[11]=g("div",{class:"divider"},null,-1)),g("p",null,"Leaderboard last updated: "+L(Fe(c.value)),1)])):X("v-if",!0)])),X(" Achievement details tooltip "),h.value?(B(),K("div",{key:3,class:"detail-tooltip achievement-detail-tooltip",style:qt(f.value)},[g("span",{class:"close-tooltip",onClick:T},"×"),u.value?(B(),K("div",QP,[g("div",XP,[g("h3",null,L(u.value.nickname)+"'s Achievements",1)]),X(" Special achievements "),I(u.value)?(B(),K("h4",JP,"Special Achievements")):X("v-if",!0),u.value.giantKills>0?(B(),K("div",ZP,[F[13]||(F[13]=g("span",{class:"achievement-item-icon"},"⚔️",-1)),F[14]||(F[14]=g("span",null,"Giant Killer",-1)),g("span",eR,L(u.value.giantKills),1)])):X("v-if",!0),u.value.comebacks>0?(B(),K("div",tR,[F[15]||(F[15]=g("span",{class:"achievement-item-icon"},"🔄",-1)),F[16]||(F[16]=g("span",null,"Comeback Victories",-1)),g("span",nR,L(u.value.comebacks),1)])):X("v-if",!0),u.value.quickWins>0?(B(),K("div",sR,[F[17]||(F[17]=g("span",{class:"achievement-item-icon"},"⚡",-1)),F[18]||(F[18]=g("span",null,"Quick Victories",-1)),g("span",iR,L(u.value.quickWins),1)])):X("v-if",!0),u.value.tierChallenges>0?(B(),K("div",rR,[F[19]||(F[19]=g("span",{class:"achievement-item-icon"},"🎯",-1)),F[20]||(F[20]=g("span",null,"Higher Tier Challenges",-1)),g("span",oR,L(u.value.tierChallenges),1)])):X("v-if",!0),X(" Combat technique achievements "),E(u.value)?(B(),K("h4",aR,"Combat Techniques")):X("v-if",!0),u.value.perfectBlocks>0?(B(),K("div",lR,[F[21]||(F[21]=g("span",{class:"achievement-item-icon"},"🛡️",-1)),F[22]||(F[22]=g("span",null,"Perfect Blocks",-1)),g("span",cR,L(u.value.perfectBlocks),1)])):X("v-if",!0),u.value.criticalStrikes>0?(B(),K("div",uR,[F[23]||(F[23]=g("span",{class:"achievement-item-icon"},"💥",-1)),F[24]||(F[24]=g("span",null,"Critical Strikes",-1)),g("span",dR,L(u.value.criticalStrikes),1)])):X("v-if",!0),u.value.counterAttacks>0?(B(),K("div",hR,[F[25]||(F[25]=g("span",{class:"achievement-item-icon"},"↩️",-1)),F[26]||(F[26]=g("span",null,"Counter Attacks",-1)),g("span",fR,L(u.value.counterAttacks),1)])):X("v-if",!0),u.value.firstStrikes>0?(B(),K("div",pR,[F[27]||(F[27]=g("span",{class:"achievement-item-icon"},"🥇",-1)),F[28]||(F[28]=g("span",null,"First Strikes",-1)),g("span",gR,L(u.value.firstStrikes),1)])):X("v-if",!0),X(" Time-based achievements "),v(u.value)?(B(),K("h4",mR,"Time-based Victories")):X("v-if",!0),u.value.nightFighter>0?(B(),K("div",vR,[F[29]||(F[29]=g("span",{class:"achievement-item-icon"},"🌙",-1)),F[30]||(F[30]=g("span",null,"Night Fighter",-1)),g("span",yR,L(u.value.nightFighter),1)])):X("v-if",!0),u.value.morningWarrior>0?(B(),K("div",_R,[F[31]||(F[31]=g("span",{class:"achievement-item-icon"},"☀️",-1)),F[32]||(F[32]=g("span",null,"Morning Warrior",-1)),g("span",ER,L(u.value.morningWarrior),1)])):X("v-if",!0),X(" Skills achievement "),u.value.skillsUsed>5?(B(),K("h4",TR,"Skill Mastery")):X("v-if",!0),u.value.skillsUsed>5?(B(),K("div",bR,[F[33]||(F[33]=g("span",{class:"achievement-item-icon"},"🎭",-1)),F[34]||(F[34]=g("span",null,"Different Skills Used",-1)),g("span",wR,L(u.value.skillsUsed),1)])):X("v-if",!0),H(u.value)?X("v-if",!0):(B(),K("div",AR,F[35]||(F[35]=[g("span",null,"No achievements yet",-1)])))])):X("v-if",!0)],4)):X("v-if",!0),X(" Stats details tooltip "),m.value?(B(),K("div",{key:4,class:"detail-tooltip stats-detail-tooltip",style:qt(y.value)},[g("span",{class:"close-tooltip",onClick:W},"×"),u.value?(B(),K("div",IR,[g("div",SR,[g("h3",null,L(u.value.nickname)+"'s Stats",1)]),g("div",CR,[F[36]||(F[36]=g("span",{class:"stats-item-icon str-icon"},"🔥",-1)),F[37]||(F[37]=g("span",null,"Strength",-1)),g("span",kR,L(u.value.strength),1)]),g("div",PR,[F[38]||(F[38]=g("span",{class:"stats-item-icon agi-icon"},"💨",-1)),F[39]||(F[39]=g("span",null,"Agility",-1)),g("span",RR,L(u.value.agility),1)]),g("div",DR,[F[40]||(F[40]=g("span",{class:"stats-item-icon end-icon"},"🛡️",-1)),F[41]||(F[41]=g("span",null,"Endurance",-1)),g("span",MR,L(u.value.endurance),1)]),g("div",OR,[F[42]||(F[42]=g("span",{class:"stats-item-icon"},"💪",-1)),F[43]||(F[43]=g("span",null,"Total Power",-1)),g("span",NR,L(u.value.totalPower),1)])])):X("v-if",!0)],4)):X("v-if",!0),X(" Time/Activity details tooltip "),C.value?(B(),K("div",{key:5,class:"detail-tooltip time-detail-tooltip",style:qt(D.value)},[g("span",{class:"close-tooltip",onClick:Q},"×"),u.value?(B(),K("div",xR,[g("div",VR,[g("h3",null,L(u.value.nickname)+"'s Activity",1)]),u.value.timestamp?(B(),K("div",FR,[F[44]||(F[44]=g("span",{class:"time-item-icon"},"📅",-1)),F[45]||(F[45]=g("span",null,"Last Updated",-1)),g("span",$R,L(ke(u.value.timestamp)),1)])):X("v-if",!0),u.value.trainingTimestamps?(B(),K("div",LR,[F[46]||(F[46]=g("span",{class:"time-item-icon"},"🏋️",-1)),F[47]||(F[47]=g("span",null,"Last Training",-1)),g("span",BR,L(Ge(u.value.trainingTimestamps)),1)])):X("v-if",!0),u.value.highestDefeatedTier?(B(),K("div",UR,[F[48]||(F[48]=g("span",{class:"time-item-icon"},"🏆",-1)),F[49]||(F[49]=g("span",null,"Highest Tier Defeated",-1)),g("span",HR,L(u.value.highestDefeatedTier),1)])):X("v-if",!0),g("div",jR,[F[51]||(F[51]=g("span",{class:"time-item-icon"},"⚔️",-1)),F[52]||(F[52]=g("span",null,"Fight Record",-1)),g("span",KR,[g("span",qR,L(u.value.wins||0)+"W",1),F[50]||(F[50]=ft(" / ")),g("span",GR,L(u.value.losses||0)+"L",1)])])])):X("v-if",!0)],4)):X("v-if",!0)])])):X("v-if",!0)}},rv=ct(WR,[["__scopeId","data-v-7a58f9fe"]]),zR={key:0,class:"nickname-modal"},YR={class:"nickname-dialog"},QR={key:0,class:"error"},XR={__name:"NicknamePrompt",props:{visible:Boolean},emits:["close"],setup(t,{emit:e}){const n=e,s=ue(localStorage.getItem("playerNickname")||""),i=ue("");function r(){return s.value.trim().length<3?(i.value="Name must be at least 3 characters",!1):!0}function o(){r()&&(localStorage.setItem("playerNickname",s.value.trim()),$r(),n("close",{nickname:s.value.trim()}))}function l(){localStorage.setItem("playerNickname","Anonymous Fighter"),n("close",{nickname:"Anonymous Fighter"})}return(c,u)=>t.visible?(B(),K("div",zR,[g("div",YR,[u[1]||(u[1]=g("h2",null,"Enter Your Fighter Name",-1)),u[2]||(u[2]=g("p",null,"Join the global leaderboard with your unique fighter name!",-1)),by(g("input",{"onUpdate:modelValue":u[0]||(u[0]=h=>s.value=h),placeholder:"Enter name (3-20 characters)",maxlength:"20",onKeyup:r0(o,["enter"])},null,544),[[t0,s.value]]),i.value?(B(),K("div",QR,L(i.value),1)):X("v-if",!0),g("div",{class:"actions"},[g("button",{onClick:o,class:"primary-btn"},"Save"),g("button",{onClick:l,class:"secondary-btn"},"Later")])])])):X("v-if",!0)}},ov=ct(XR,[["__scopeId","data-v-51059cba"]]),JR={class:"profile-container"},ZR={class:"nickname-display"},eD={class:"nickname-value"},tD={class:"reset-content"},nD={class:"reset-stats"},sD={__name:"ProfileMenu",setup(t){const e=$e(),n=sn(),s=Di(),i=Zs(),r=ue(!1),o=ue(!1),l=ue(!1),c=ue(!1),u=Le(()=>{const V=localStorage.getItem("playerNickname");return V||e.playerName||"Fighter"});Wt(()=>{Na()});function h(){r.value=!r.value}function f(){r.value=!1}async function m(){if(e.savePlayerData(),n.saveSkillsData(),s.saveTrainingState(),navigator.onLine){const V=await oc();alert(V?"Game saved and synced to leaderboard!":"Game saved locally, but sync to leaderboard failed. Check your connection.")}else alert("Game saved locally. You're offline, so leaderboard wasn't updated.");f()}function y(){l.value=!0,f()}function C(){c.value=!0,f()}function D(V){c.value=!1,V&&V.nickname&&oc().then(R=>{R&&console.log("Nickname updated and synced to leaderboard")})}function S(){o.value=!0,f()}function M(){o.value=!1}async function P(){const V=localStorage.getItem("playerID");b0(),e.$reset(),n.$reset(),s.$reset(),i.$reset(),e.loadPlayerData(),n.loadSkillsData();try{const{db:R}=await St(async()=>{const{db:b}=await Promise.resolve().then(()=>OI);return{db:b}},void 0),{collection:H,query:O,where:I,getDocs:E,deleteDoc:v,generateUUID:_}=await St(async()=>{const{collection:b,query:A,where:de,getDocs:W,deleteDoc:q,generateUUID:G}=await Promise.resolve().then(()=>DI);return{collection:b,query:A,where:de,getDocs:W,deleteDoc:q,generateUUID:G}},void 0);if(V&&navigator.onLine){const b=H(R,"leaderboard"),A=O(b,I("playerId","==",V)),de=await E(A),W=[];de.forEach(q=>{W.push(v(q.ref)),console.log("Deleting leaderboard entry:",q.id)}),W.length>0&&(await Promise.all(W),console.log(`Deleted ${W.length} leaderboard entries based on UUID`))}const T=_();localStorage.setItem("playerID",T),console.log("Generated new player ID after reset:",T)}catch(R){console.error("Error during database cleanup:",R)}o.value=!1,alert("Game data has been completely reset. The page will now reload."),setTimeout(()=>{window.location.reload()},500)}return Wt(()=>{document.addEventListener("click",V=>{r.value&&!V.target.closest(".profile-container")&&f()})}),(V,R)=>(B(),K("div",JR,[g("button",{class:"profile-icon",onClick:sr(h,["stop"]),title:"Profile Options"},R[3]||(R[3]=[g("span",null,"👤",-1)])),r.value?(B(),K("div",{key:0,class:"menu-dropdown",onClick:R[0]||(R[0]=sr(()=>{},["stop"]))},[g("div",ZR,[R[4]||(R[4]=g("span",{class:"nickname-label"},"Name:",-1)),g("span",eD,L(u.value),1)]),g("div",{class:"menu-options"},[g("button",{class:"menu-option",onClick:m},R[5]||(R[5]=[g("span",{class:"option-icon"},"💾",-1),g("span",{class:"option-text"},"Save Game",-1)])),g("button",{class:"menu-option",onClick:y},R[6]||(R[6]=[g("span",{class:"option-icon"},"🏆",-1),g("span",{class:"option-text"},"Leaderboard",-1)])),g("button",{class:"menu-option",onClick:C},R[7]||(R[7]=[g("span",{class:"option-icon"},"✏️",-1),g("span",{class:"option-text"},"Change Name",-1)])),R[9]||(R[9]=Ic('<a href="https://www.reddit.com/r/idlemuaythai/" target="_blank" rel="noopener noreferrer" class="menu-option" data-v-28e8ed7c><span class="option-icon reddit-icon-menu" data-v-28e8ed7c><svg viewBox="0 0 24 24" width="16" height="16" data-v-28e8ed7c><path d="M12 0A12 12 0 0 0 0 12a12 12 0 0 0 12 12 12 12 0 0 0 12-12A12 12 0 0 0 12 0zm5.01 4.744c.688 0 1.25.561 1.25 1.249a1.25 1.25 0 0 1-2.498.056l-2.597-.547-.8 3.747c1.824.07 3.48.632 4.674 1.488.308-.309.73-.491 1.207-.491.968 0 1.754.786 1.754 1.754 0 .716-.435 1.333-1.01 1.614a3.111 3.111 0 0 1 .042.52c0 2.694-3.13 4.87-7.004 4.87-3.874 0-7.004-2.176-7.004-4.87 0-.183.015-.366.043-.534A1.748 1.748 0 0 1 4.028 12c0-.968.786-1.754 1.754-1.754.463 0 .898.196 1.207.49 1.207-.883 2.878-1.43 4.744-1.487l.885-4.182a.342.342 0 0 1 .14-.197.35.35 0 0 1 .238-.042l2.906.617a1.214 1.214 0 0 1 1.108-.701zM9.25 12C8.561 12 8 12.562 8 13.25a1.25 1.25 0 0 0 1.25 1.248 1.25 1.25 0 0 0 1.248-1.249 1.25 1.25 0 0 0-1.249-1.249zm5.5 0a1.25 1.25 0 0 0-1.25 1.25 1.25 1.25 0 0 0 1.25 1.248 1.25 1.25 0 0 0 1.249-1.249A1.25 1.25 0 0 0 14.75 12zm-2.42 3.242a.375.375 0 0 0-.536 0c-.298.298-.741.582-1.419.582-.677 0-1.12-.284-1.418-.582a.375.375 0 0 0-.536 0 .376.376 0 0 0 0 .536c.298.298.903.749 1.955.749 1.052 0 1.657-.45 1.955-.749a.376.376 0 0 0 0-.536z" fill="#FF4500" data-v-28e8ed7c></path></svg></span><span class="option-text" data-v-28e8ed7c>Community</span></a><a href="https://x.com/baibao" target="_blank" rel="noopener noreferrer" class="menu-option" data-v-28e8ed7c><span class="option-icon" data-v-28e8ed7c>𝕏</span><span class="option-text" data-v-28e8ed7c>Contact Developer</span></a>',2)),g("button",{class:"menu-option",onClick:S},R[8]||(R[8]=[g("span",{class:"option-icon"},"🔄",-1),g("span",{class:"option-text"},"Hard Reset",-1)]))])])):X("v-if",!0),X(" Reset Confirmation Modal "),o.value?(B(),K("div",{key:1,class:"modal-backdrop",onClick:M},[g("div",{class:"reset-modal",onClick:R[1]||(R[1]=sr(()=>{},["stop"]))},[R[12]||(R[12]=g("div",{class:"reset-header"},"Confirm Hard Reset",-1)),g("div",tD,[R[10]||(R[10]=g("p",null," Are you sure you want to reset all game data? This action cannot be undone. ",-1)),R[11]||(R[11]=g("p",null,"Your current progress:",-1)),g("ul",nD,[g("li",null," Player Level: STR "+L(ee(e).strength)+", AGI "+L(ee(e).agility)+", END "+L(ee(e).endurance),1),g("li",null,"Training Points: "+L(ee(e).trainingPoints),1),g("li",null," Fight Record: "+L(ee(e).fightStats.wins)+"W / "+L(ee(e).fightStats.losses)+"L ",1),g("li",null,"Skills Mastered: "+L(ee(n).ownedSkills.length),1),g("li",null," Opponents Defeated: "+L(ee(e).defeatedOpponents.length),1)])]),g("div",{class:"reset-actions"},[g("button",{class:"cancel-button",onClick:M},"Cancel"),g("button",{class:"confirm-button",onClick:P}," Reset All Data ")])])])):X("v-if",!0),X(" Leaderboard Modal "),l.value?(B(),ss(rv,{key:2,visible:l.value,onClose:R[2]||(R[2]=H=>l.value=!1)},null,8,["visible"])):X("v-if",!0),X(" Nickname Modal "),c.value?(B(),ss(ov,{key:3,visible:c.value,onClose:D},null,8,["visible"])):X("v-if",!0)]))}},iD=ct(sD,[["__scopeId","data-v-28e8ed7c"]]),rD={__name:"GuideButton",emits:["open-guide"],setup(t,{emit:e}){const n=e;function s(){n("open-guide")}return(i,r)=>(B(),K("div",{class:"guide-button-container",onClick:s,title:"How to Play"},r[0]||(r[0]=[g("span",{class:"guide-label"},"Guide",-1)])))}},oD=ct(rD,[["__scopeId","data-v-72090b12"]]),aD={__name:"LeaderboardButton",setup(t){const e=ue(!1);function n(){e.value=!0}return(s,i)=>(B(),K(mt,null,[g("button",{class:"leaderboard-button",onClick:n,title:"View Leaderboard"},i[1]||(i[1]=[g("span",null,"🏆",-1)])),e.value?(B(),ss(rv,{key:0,visible:e.value,onClose:i[0]||(i[0]=r=>e.value=!1)},null,8,["visible"])):X("v-if",!0)],64))}},lD=ct(aD,[["__scopeId","data-v-6c92fba1"]]),cD={class:"guide-container"},uD={__name:"HowToPlayGuide",emits:["close"],setup(t,{emit:e}){const n=e;function s(){window.history.length>1?window.history.back():n("close")}return(i,r)=>(B(),K("div",cD,[g("div",{class:"guide-header"},[g("div",{class:"header-actions"},[g("button",{class:"back-button",onClick:s},r[0]||(r[0]=[g("span",null,"⬅️",-1),ft(" Back to Game ")])),r[1]||(r[1]=g("a",{href:"https://x.com/baibao",target:"_blank",rel:"noopener noreferrer",class:"twitter-link"},[g("span",{class:"twitter-icon"},"𝕏"),ft(" @baibao ")],-1))]),r[2]||(r[2]=g("h1",{class:"guide-title"},"How to Play: Muay Thai Idle Fight",-1))]),r[4]||(r[4]=Ic('<div class="guide-content" data-v-87b0e7dd><section class="guide-section" data-v-87b0e7dd><h2 class="section-title" data-v-87b0e7dd>🥊 BASICS</h2><p data-v-87b0e7dd> 🔥 Train. Fight. Dominate. Welcome to Muay Thai Idle Fight, where you train like a warrior and battle your way to the top! </p></section><section class="guide-section" data-v-87b0e7dd><h2 class="section-title" data-v-87b0e7dd>💪 Train Like a Champion!</h2><ul data-v-87b0e7dd><li data-v-87b0e7dd> Boost <strong data-v-87b0e7dd>Strength (STR), Agility (AGI), and Endurance (END)</strong>. </li><li data-v-87b0e7dd>Training takes time but works even when you&#39;re offline!</li><li data-v-87b0e7dd> The <strong data-v-87b0e7dd>higher your stats, the longer training takes</strong>—but it’s worth it. </li><li data-v-87b0e7dd> Enable <strong data-v-87b0e7dd>&quot;Continuous Training&quot;</strong> to keep growing automatically! </li><li data-v-87b0e7dd> Every completed <strong data-v-87b0e7dd>training session earns you 1 Training Point</strong></li></ul></section><section class="guide-section" data-v-87b0e7dd><h2 class="section-title" data-v-87b0e7dd>🧠 Unlock Powerful Skills!</h2><ul data-v-87b0e7dd><li data-v-87b0e7dd> Skills <strong data-v-87b0e7dd>boost stats but can have trade-offs</strong>—pick wisely! </li><li data-v-87b0e7dd> Unlock with <strong data-v-87b0e7dd>Training Points (TP)</strong> earned from <strong data-v-87b0e7dd>training &amp; fights</strong>. </li><li data-v-87b0e7dd> Skills are ranked: <strong data-v-87b0e7dd>Small, Medium, Big, and Ultimate</strong>. </li><li data-v-87b0e7dd><strong data-v-87b0e7dd>Strategize</strong>—speed demons, iron tanks, or heavy hitters? Your call! </li><li data-v-87b0e7dd><strong data-v-87b0e7dd>Dynamic Scaling:</strong> Skills become less effective as: <ul data-v-87b0e7dd><li data-v-87b0e7dd>Your <strong data-v-87b0e7dd>base stats increase</strong> (higher stats = lower skill effectiveness)</li><li data-v-87b0e7dd>You <strong data-v-87b0e7dd>learn more skills</strong> (more skills = diminishing returns)</li></ul></li><li data-v-87b0e7dd><strong data-v-87b0e7dd>Example:</strong> A +15% strength skill gives different boosts based on your progress: <ul data-v-87b0e7dd><li data-v-87b0e7dd>Early game (Strength 10, 3 skills): +13% effective boost</li><li data-v-87b0e7dd>Mid game (Strength 50, 10 skills): +7.5% effective boost</li><li data-v-87b0e7dd>Late game (Strength 150, 20 skills): +3.8% effective boost</li></ul></li><li data-v-87b0e7dd> The &quot;Effectiveness&quot; percentage shows how powerful your skills currently are </li></ul></section><section class="guide-section" data-v-87b0e7dd><h2 class="section-title" data-v-87b0e7dd>💡 TRAINING POINTS</h2><ul data-v-87b0e7dd><li data-v-87b0e7dd> Training Points (TP) are earned by completing training sessions and winning fights </li><li data-v-87b0e7dd>Use Training Points to purchase skills</li><li data-v-87b0e7dd> Skills cost between 15-30 Training Points depending on their power and tier </li><li data-v-87b0e7dd> Balance earning points through training with spending them on skills </li></ul></section><section class="guide-section" data-v-87b0e7dd><h2 class="section-title" data-v-87b0e7dd>⚔️ Fight Like a Warrior!</h2><ul data-v-87b0e7dd><li data-v-87b0e7dd>Fights are turn-based with 1-second intervals</li><li data-v-87b0e7dd>Both fighters start with 100 HP</li><li data-v-87b0e7dd>The first fighter to reduce their opponent to 0 HP wins</li><li data-v-87b0e7dd><strong data-v-87b0e7dd>Stats affect combat:</strong><ul data-v-87b0e7dd><li data-v-87b0e7dd><strong data-v-87b0e7dd>Strength:</strong> Determines damage output and chance for crushing blows <ul data-v-87b0e7dd><li data-v-87b0e7dd><strong data-v-87b0e7dd>Example:</strong> Strength 15 = ~15 damage per hit</li><li data-v-87b0e7dd><strong data-v-87b0e7dd>Example:</strong> Strength 30 = ~30 damage per hit</li></ul></li><li data-v-87b0e7dd><strong data-v-87b0e7dd>Agility:</strong> Affects attack speed, evasion chance, and special attacks <ul data-v-87b0e7dd><li data-v-87b0e7dd><strong data-v-87b0e7dd>Example:</strong> Agility 20 vs opponent with Agility 10 = attack 20% faster</li><li data-v-87b0e7dd><strong data-v-87b0e7dd>Example:</strong> Agility 40 = higher chance for combo attacks (up to 18% chance)</li><li data-v-87b0e7dd><strong data-v-87b0e7dd>Example:</strong> Agility 60 vs opponent&#39;s STR 30 = 60% chance to evade attacks</li></ul></li><li data-v-87b0e7dd><strong data-v-87b0e7dd>Endurance:</strong> Reduces incoming damage and enables blocking <ul data-v-87b0e7dd><li data-v-87b0e7dd><strong data-v-87b0e7dd>Example:</strong> Endurance 25 = 10% damage reduction + 20% block chance</li><li data-v-87b0e7dd><strong data-v-87b0e7dd>Example:</strong> Endurance 50 = 25% damage reduction + 30% block chance</li><li data-v-87b0e7dd><strong data-v-87b0e7dd>Example:</strong> Endurance 75 = 45% damage reduction + chance for perfect blocks</li></ul></li></ul></li><li data-v-87b0e7dd><strong data-v-87b0e7dd>Crushing Blows:</strong> When your strength significantly exceeds your opponent&#39;s agility, you can land a crushing blow that bypasses evasion and deals extra damage <ul data-v-87b0e7dd><li data-v-87b0e7dd><strong data-v-87b0e7dd>Example:</strong> Your STR 75 vs opponent&#39;s AGI 50 gives ~33% chance for crushing blows that deal 1.75x damage</li></ul></li><li data-v-87b0e7dd><strong data-v-87b0e7dd>Evasion:</strong> High agility relative to your opponent&#39;s strength gives you a chance to completely avoid attacks <ul data-v-87b0e7dd><li data-v-87b0e7dd><strong data-v-87b0e7dd>Example:</strong> Your AGI 60 vs opponent&#39;s STR 30 (2:1 ratio) gives you ~60% chance to evade attacks</li><li data-v-87b0e7dd><strong data-v-87b0e7dd>Example:</strong> Your AGI 90 vs opponent&#39;s STR 30 (3:1 ratio) gives you ~90% chance to evade attacks</li><li data-v-87b0e7dd><strong data-v-87b0e7dd>Combo Evasion:</strong> High agility fighters gain bonus evasion against combo attacks after the first hit</li><li data-v-87b0e7dd><strong data-v-87b0e7dd>Example:</strong> AGI 60 vs opponent with AGI 60 = +25% evasion chance against the second hit in a combo</li></ul></li><li data-v-87b0e7dd><strong data-v-87b0e7dd>Special Combat Events:</strong> Combat includes events that can turn the tide of battle: <ul data-v-87b0e7dd><li data-v-87b0e7dd><strong data-v-87b0e7dd>Critical Hits:</strong> ~10% chance to deal 1.5x damage</li><li data-v-87b0e7dd><strong data-v-87b0e7dd>Perfect Blocks:</strong> ~10% chance (with high endurance) to reduce incoming damage by 90%</li><li data-v-87b0e7dd><strong data-v-87b0e7dd>Combo Attacks:</strong> Chain multiple attacks together based on agility (chance) and strength (damage) <ul data-v-87b0e7dd><li data-v-87b0e7dd><strong data-v-87b0e7dd>Example:</strong> AGI 40 = 10% chance for combo, STR 30 = +24% combo damage bonus</li><li data-v-87b0e7dd><strong data-v-87b0e7dd>Example:</strong> AGI 60 = 15% chance for combo, STR 50 = +48% combo damage bonus</li></ul></li><li data-v-87b0e7dd><strong data-v-87b0e7dd>Momentum:</strong> Build momentum during battle to unlock more powerful moves</li></ul></li></ul></section><section class="guide-section" data-v-87b0e7dd><h2 class="section-title" data-v-87b0e7dd>👹 OPPONENTS</h2><ul data-v-87b0e7dd><li data-v-87b0e7dd>Opponents are organized in tiers with increasing difficulty</li><li data-v-87b0e7dd>Each opponent has unique stats and skills</li><li data-v-87b0e7dd>Defeated opponents appear first in the selection menu</li><li data-v-87b0e7dd>Get 1 TP when won</li><li data-v-87b0e7dd> Some opponents specialize in specific stats (strength, agility, or endurance) </li></ul></section><section class="guide-section" data-v-87b0e7dd><h2 class="section-title" data-v-87b0e7dd>🏆 ACHIEVEMENTS</h2><p data-v-87b0e7dd> Fighters earn special achievements that showcase their unique fighting style and accomplishments. These achievements are displayed on the leaderboard and represent your prowess in different aspects of combat: </p><ul data-v-87b0e7dd><li data-v-87b0e7dd><strong data-v-87b0e7dd>⚔️ Giant Killer:</strong> Victories against opponents with significantly higher stats than you. <ul data-v-87b0e7dd><li data-v-87b0e7dd>Shows your ability to overcome challenging odds through superior technique and strategy.</li><li data-v-87b0e7dd>The count increases each time you defeat an opponent with total power at least 25% higher than yours.</li></ul></li><li data-v-87b0e7dd><strong data-v-87b0e7dd>🔄 Comeback Victories:</strong> Wins achieved after your health dropped below 20%. <ul data-v-87b0e7dd><li data-v-87b0e7dd>Demonstrates your resilience and ability to turn the tide of battle even when nearly defeated.</li><li data-v-87b0e7dd>Earned when you win a fight after being reduced to less than 20 HP at any point during the match.</li></ul></li><li data-v-87b0e7dd><strong data-v-87b0e7dd>⚡ Quick Victories:</strong> Defeating opponents in record time. <ul data-v-87b0e7dd><li data-v-87b0e7dd>Shows your efficiency and dominance in combat.</li><li data-v-87b0e7dd>Earned by winning fights in under 10 seconds (or approximately 10 combat turns).</li></ul></li><li data-v-87b0e7dd><strong data-v-87b0e7dd>🎯 Higher Tier Challenges:</strong> Taking on and fighting opponents from higher tiers. <ul data-v-87b0e7dd><li data-v-87b0e7dd>Demonstrates your ambition and willingness to test yourself against elite competition.</li><li data-v-87b0e7dd>Counts how many times you&#39;ve challenged opponents at least 2 tiers above your current level.</li></ul></li><li data-v-87b0e7dd><strong data-v-87b0e7dd>🎭 Different Skills Used:</strong> Mastery of various fighting techniques and skills. <ul data-v-87b0e7dd><li data-v-87b0e7dd>Shows your versatility as a fighter and tactical adaptability.</li><li data-v-87b0e7dd>Represents the number of different skills you&#39;ve effectively incorporated into your fighting style.</li></ul></li><li data-v-87b0e7dd><strong data-v-87b0e7dd>🔄 Perfect Blocks:</strong> Total number of perfect blocks performed in combat. <ul data-v-87b0e7dd><li data-v-87b0e7dd>Demonstrates your defensive precision and timing.</li><li data-v-87b0e7dd>Counts each time you execute a perfect block that reduces damage by 90%.</li></ul></li><li data-v-87b0e7dd><strong data-v-87b0e7dd>💥 Critical Strike Count:</strong> Total number of critical hits landed on opponents. <ul data-v-87b0e7dd><li data-v-87b0e7dd>Shows your ability to find and exploit openings in enemy defenses.</li><li data-v-87b0e7dd>Accumulates with each critical hit that deals 1.5x damage.</li></ul></li><li data-v-87b0e7dd><strong data-v-87b0e7dd>🏹 Counter Master:</strong> Total successful counter-attacks after evading. <ul data-v-87b0e7dd><li data-v-87b0e7dd>Represents your mastery of defensive-to-offensive transitions.</li><li data-v-87b0e7dd>Counts attacks landed immediately after successfully evading an opponent&#39;s strike.</li></ul></li><li data-v-87b0e7dd><strong data-v-87b0e7dd>⚡ First Strike Victories:</strong> Fights won by striking first and maintaining advantage. <ul data-v-87b0e7dd><li data-v-87b0e7dd>Shows your strategic understanding of initiative in combat.</li><li data-v-87b0e7dd>Tallies wins where you landed the first hit and maintained control throughout.</li></ul></li><li data-v-87b0e7dd><strong data-v-87b0e7dd>🌙 Night Fighter:</strong> Total fights completed during night hours. <ul data-v-87b0e7dd><li data-v-87b0e7dd>Demonstrates your dedication to training at all hours.</li><li data-v-87b0e7dd>Counts fights completed between 8PM and 6AM local time.</li></ul></li><li data-v-87b0e7dd><strong data-v-87b0e7dd>☀️ Morning Warrior:</strong> Training sessions completed in morning hours. <ul data-v-87b0e7dd><li data-v-87b0e7dd>Shows your discipline and consistent training schedule.</li><li data-v-87b0e7dd>Accumulates training sessions started between 5AM and 9AM local time.</li></ul></li></ul><p class="tip" data-v-87b0e7dd><strong data-v-87b0e7dd>Leaderboard Recognition:</strong> Your achievements are displayed on the global leaderboard. Click the trophy icon 🏆 next to a fighter&#39;s name to see their full list of achievements! </p></section><section class="guide-section" data-v-87b0e7dd><h2 class="section-title" data-v-87b0e7dd>📈 PROGRESSION</h2><ol data-v-87b0e7dd><li data-v-87b0e7dd> Train, earn TP, unlock skills, <strong data-v-87b0e7dd>level up your fighter</strong>, and <strong data-v-87b0e7dd>crush opponents</strong>. </li><li data-v-87b0e7dd><strong data-v-87b0e7dd>Idle means progress happens even when you&#39;re offline!</strong></li><li data-v-87b0e7dd> Check back, train smarter, and <strong data-v-87b0e7dd>become the ultimate Muay Thai legend!</strong></li></ol><p class="tip" data-v-87b0e7dd><strong data-v-87b0e7dd>Remember:</strong> This is an idle game, so progress happens even when you&#39;re not actively playing. Check back regularly to start new training sessions and challenge new opponents! </p><p class="tip" data-v-87b0e7dd><strong data-v-87b0e7dd>Skill Scaling:</strong> As you progress, focus on balancing your stats and choosing skills strategically. Skills will naturally become less powerful in late-game, encouraging you to keep training your base stats. </p></section></div>',1)),g("div",{class:"guide-footer"},[g("button",{class:"back-button large",onClick:s},"Return to Game"),r[3]||(r[3]=g("div",{class:"version-info"},"v1.3.3",-1))])]))}},dD=ct(uD,[["__scopeId","data-v-87b0e7dd"]]),hD={key:0,class:"price-options"},fD={__name:"BuyMeCoffee",setup(t){const e=ue(!1),n=ue(null),s={small:"https://buy.stripe.com/9AQ5mreSdgBLgLK288",medium:"https://buy.stripe.com/7sIdSX9xT85f676fYZ",large:"https://buy.stripe.com/5kA8yD6lHdpzfHG4gi"};function i(){e.value=!e.value}function r(l){e.value=!1,window.open(s[l],"_blank")}function o(l){n.value&&!n.value.contains(l.target)&&(e.value=!1)}return Wt(()=>{document.addEventListener("click",o)}),Pr(()=>{document.removeEventListener("click",o)}),(l,c)=>(B(),K("div",{class:"coffee-container",ref_key:"containerRef",ref:n},[g("button",{onClick:i,class:"coffee-button"},c[3]||(c[3]=[g("div",{class:"coffee-icon"},"☕",-1),g("span",null,"Buy me a coffee",-1)])),X(" Price selection dropdown with animation "),Ue(N_,{name:"fade"},{default:Qf(()=>[e.value?(B(),K("div",hD,[g("div",{class:"price-option",onClick:c[0]||(c[0]=u=>r("small"))},c[4]||(c[4]=[g("span",{class:"price-name"},"Small ☕",-1),g("span",{class:"price-amount"},"$2",-1)])),g("div",{class:"price-option",onClick:c[1]||(c[1]=u=>r("medium"))},c[5]||(c[5]=[g("span",{class:"price-name"},"Medium ☕☕",-1),g("span",{class:"price-amount"},"$5",-1)])),g("div",{class:"price-option",onClick:c[2]||(c[2]=u=>r("large"))},c[6]||(c[6]=[g("span",{class:"price-name"},"Large ☕☕☕",-1),g("span",{class:"price-amount"},"$10",-1)]))])):X("v-if",!0)]),_:1})],512))}},pD=ct(fD,[["__scopeId","data-v-449fea9c"]]),gD={key:0,class:"modal-overlay"},mD={class:"cheater-warning-modal"},vD={class:"warning-content"},yD={__name:"CheaterWarningModal",setup(t,{expose:e}){const n=ue(!1),s=ue("Suspicious stat progression");Wt(()=>{localStorage.getItem("showCheaterWarning")==="true"&&(n.value=!0)});function i(){n.value=!1,localStorage.removeItem("showCheaterWarning")}return e({showWarning:r=>{s.value=r||"Suspicious stat progression",n.value=!0}}),(r,o)=>n.value?(B(),K("div",gD,[g("div",mD,[o[4]||(o[4]=g("div",{class:"warning-header"},[g("span",{class:"warning-icon"},"⚠️"),g("h2",null,"ACCOUNT FLAGGED")],-1)),g("div",vD,[o[1]||(o[1]=g("p",null,"Your account has been flagged for suspicious activity.",-1)),g("p",null,[o[0]||(o[0]=g("strong",null,"Reason:",-1)),ft(" "+L(s.value),1)]),o[2]||(o[2]=g("p",null,"Your stats have been adjusted to comply with fair play rules.",-1)),o[3]||(o[3]=g("p",{class:"warning-note"},"Note: Continued violations will result in permanent exclusion from the leaderboard.",-1))]),g("div",{class:"warning-footer"},[g("button",{onClick:i,class:"close-button"},"Acknowledge and Continue")])])])):X("v-if",!0)}},_D=ct(yD,[["__scopeId","data-v-ca29c5e6"]]);async function ED(){try{const t=localStorage.getItem("playerID");if(!t)return console.log("No player ID found, skipping cheat check"),!1;console.log("Checking for cheat flags on the server...");const e=Js(Zt,"leaderboard"),n=fs(e,Ws("playerId","==",t),ps(1)),s=await $n(n);if(s.empty)return console.log("Player not found in leaderboard, skipping cheat check"),!1;const i=s.docs[0].data();if(i.penaltyApplied===!0){console.log("CHEATER DETECTED: Player has been flagged for cheating"),console.log("Applying penalties to local storage...");const r=i.strength||0,o=i.agility||0,l=i.endurance||0,c=$e(),u=c.strength,h=c.agility,f=c.endurance;return c.strength=Math.min(c.strength,r),c.agility=Math.min(c.agility,o),c.endurance=Math.min(c.endurance,l),c.trainingHistory.suspiciousActivity.push({timestamp:Date.now(),type:"server_penalty_applied",details:`Stats adjusted due to server-detected cheating. STR: ${u}->${c.strength}, AGI: ${h}->${c.agility}, END: ${f}->${c.endurance}`,reason:i.penaltyReason||"Suspicious stat values"}),c.savePlayerData(),TD(i.penaltyReason),!0}return console.log("No cheat flags detected, player is in good standing"),!1}catch(t){return console.error("Error checking for cheat flags:",t),!1}}function TD(t){console.warn("⚠️ CHEATING DETECTED ⚠️"),console.warn(`Your stats have been adjusted because: ${t}`),console.warn("Future suspicious activity will result in further penalties."),localStorage.setItem("showCheaterWarning","true")}const bD={key:0},wD={key:1},AD={key:2,class:"container"},ID={class:"game-header"},SD={class:"header-controls"},CD={class:"player-stats"},kD={class:"coffee-section"},PD={class:"tab-navigation"},RD={key:0,class:"new-item-badge"},DD={class:"game-content"},MD={key:0,class:"content-container"},OD={key:1,class:"content-container"},ND={key:2,class:"content-container"},xD={class:"game-footer"},VD={class:"version-text"},FD={__name:"App",setup(t){const e="0.0.43",n=ue("fight"),s=ue(!1),i=ue(!1);function r(){i.value=!0,window.history.pushState({guide:!0},"How to Play","#guide")}function o(){i.value=!1,window.location.hash==="#guide"&&window.history.pushState({},"",window.location.pathname)}function l(m){i.value=window.location.hash==="#guide"}window.location.hash==="#guide"&&(i.value=!0),Wt(()=>{window.addEventListener("popstate",l)}),Fs(()=>{window.removeEventListener("popstate",l)});const c=ue(!1);function u(){const m=localStorage.getItem("muayThai_playerData"),y=localStorage.getItem("playerNickname");m&&!y&&(c.value=!0)}function h(){c.value=!1}const f=ue(null);return Wt(async()=>{const m=$e(),y=sn(),C=Di(),D=Zm();if(m.loadPlayerData(),y.loadSkillsData(),D.loadLockerData(),C.checkPendingTraining(),D.checkAchievements(m),Na(),u(),navigator.onLine){$r();try{await ED()&&f.value&&(c.value=!1)}catch(V){console.error("Error checking for cheat flags:",V)}}const S=setInterval(()=>{m.savePlayerData(),y.saveSkillsData(),C.saveTrainingState(),D.saveLockerData(),D.checkAchievements(m)},6e4);Fs(()=>{clearInterval(S),C.cleanup(),m.savePlayerData(),y.saveSkillsData(),C.saveTrainingState(),D.saveLockerData(),C.cleanup()}),window.addEventListener("beforeunload",()=>{m.savePlayerData(),y.saveSkillsData(),C.saveTrainingState(),D.saveLockerData()}),document.addEventListener("visibilitychange",()=>{document.visibilityState==="hidden"?(m.savePlayerData(),y.saveSkillsData(),C.saveTrainingState(),D.saveLockerData()):document.visibilityState==="visible"&&(C.checkPendingTraining(),D.checkAchievements(m))});const M=D.unlockedItems.length,P=setInterval(()=>{D.unlockedItems.length>M&&(s.value=!0)},5e3);Fs(()=>{clearInterval(P)}),on(n,V=>{V==="locker"&&(s.value=!1)})}),(m,y)=>i.value?(B(),K("div",bD,[Ue(dD,{onClose:o})])):c.value?(B(),K("div",wD,[Ue(ov,{visible:c.value,onClose:h},null,8,["visible"])])):(B(),K("div",AD,[g("div",ID,[y[3]||(y[3]=g("div",{class:"title-container"},[g("img",{src:v0,alt:"Muay Thai Logo",class:"game-logo"}),g("h1",{class:"game-title"},"Muay Thai Idle Fight")],-1)),g("div",SD,[Ue(oD,{onOpenGuide:r}),Ue(lD),Ue(iD)])]),g("div",CD,[Ue(EC)]),g("div",kD,[Ue(pD)]),g("div",PD,[g("button",{class:Oe(["tab-button",{active:n.value==="fight"}]),onClick:y[0]||(y[0]=C=>n.value="fight")}," Fight ",2),g("button",{class:Oe(["tab-button",{active:n.value==="skills"}]),onClick:y[1]||(y[1]=C=>n.value="skills")}," Skills ",2),g("button",{class:Oe(["tab-button",{active:n.value==="locker"}]),onClick:y[2]||(y[2]=C=>n.value="locker")},[y[4]||(y[4]=ft(" Locker Room ")),s.value?(B(),K("span",RD,"!")):X("v-if",!0)],2)]),g("div",DD,[n.value==="fight"?(B(),K("div",MD,[Ue(Pk)])):X("v-if",!0),n.value==="skills"?(B(),K("div",OD,[Ue(YC)])):X("v-if",!0),n.value==="locker"?(B(),K("div",ND,[Ue(tP)])):X("v-if",!0)]),g("div",xD,[g("span",VD,"v"+L(ee(e)),1)]),X(" Cheater warning modal that shows when needed "),Ue(_D,{ref_key:"cheaterWarningModal",ref:f},null,512)]))}},Wo="0.0.43";console.log(`Muay Thai Idle Fight v${Wo}`);document.addEventListener("visibilitychange",()=>{const t=document.hidden;window.dispatchEvent(new CustomEvent("app-visibility-changed",{detail:{isHidden:t}})),t?document.body.classList.add("app-backgrounded"):(document.body.classList.remove("app-backgrounded"),vu())});function vu(){if(!navigator.onLine)return;const t=sessionStorage.getItem("lastRefreshedVersion");fetch("/version.json?nocache="+new Date().getTime(),{method:"GET",headers:{"Cache-Control":"no-cache, no-store, must-revalidate",Pragma:"no-cache",Expires:"0"},cache:"no-store"}).then(e=>e.json()).then(e=>{e.version&&e.version!==Wo&&e.version!==t&&(console.log(`New version available: ${e.version}. Current: ${Wo}. Refreshing...`),sessionStorage.setItem("lastRefreshedVersion",e.version),"caches"in window&&caches.keys().then(n=>Promise.all(n.map(s=>caches.delete(s)))),"serviceWorker"in navigator&&navigator.serviceWorker.getRegistrations().then(n=>{for(let s of n)s.update()}),setTimeout(()=>{window.location.href=window.location.href.split("?")[0]+"?forceRefresh="+Date.now()},300))}).catch(e=>{console.log("Failed to check for updates:",e)})}setTimeout(vu,2e3);setInterval(vu,5*60*1e3);const yu=l0(FD);yu.use(d0());yu.config.globalProperties.$appVersion=Wo;yu.mount("#app");
